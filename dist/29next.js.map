{
  "version": 3,
  "sources": ["../src/managers/ReceiptManager.js", "../src/index.js", "../src/api/ApiClient.js", "../src/utils/Logger.js", "../src/components/checkout/AddressHandler.js", "../src/components/checkout/FormValidator.js", "../src/managers/SpreedlyManager.js", "../src/utils/KonamiCodeHandler.js", "../src/components/checkout/PaymentHandler.js", "../src/components/checkout/BillingAddressHandler.js", "../src/components/checkout/PaymentSelector.js", "../src/components/checkout/AddressAutocomplete.js", "../src/components/checkout/PhoneInputHandler.js", "../src/components/checkout/ProspectCartHandler.js", "../src/managers/CheckoutManager.js", "../src/helpers/CampaignHelper.js", "../src/managers/StateManager.js", "../src/managers/CartManager.js", "../src/utils/DebugUtils.js", "../src/managers/SelectorManager.js", "../src/managers/ToggleManager.js", "../src/managers/DebugManager.js", "../src/managers/TimerManager.js", "../src/managers/DisplayManager.js", "../src/managers/CartDisplayManager.js", "../src/managers/AttributionManager.js", "../src/managers/EventManager.js", "../node_modules/@floating-ui/utils/dist/floating-ui.utils.mjs", "../node_modules/@floating-ui/core/dist/floating-ui.core.mjs", "../node_modules/@floating-ui/utils/dist/floating-ui.utils.dom.mjs", "../node_modules/@floating-ui/dom/dist/floating-ui.dom.esm.js", "../src/managers/TooltipManager.js", "../src/managers/UpsellManager.js", "../src/utils/PBAccordion.js", "../src/utils/UtmTransfer.js", "../src/core/TwentyNineNext.js"],
  "sourcesContent": ["/**\r\n * ReceiptPage - Handles the receipt page functionality\r\n * \r\n * This class is responsible for:\r\n * - Fetching order details using the ref_id from URL parameters\r\n * - Updating the DOM elements with order information\r\n * - Handling any receipt-specific interactions\r\n */\r\n\r\nexport class ReceiptPage {\r\n  #apiClient;\r\n  #logger;\r\n  #app;\r\n  #orderData = null;\r\n  #orderFetched = false; // Flag to prevent duplicate API calls\r\n  #initialized = false; // Flag to prevent duplicate initialization\r\n  #debugMode = false;\r\n  \r\n  /**\r\n   * Initialize the ReceiptPage\r\n   * @param {Object} apiClient - The API client instance\r\n   * @param {Object} logger - The logger instance\r\n   * @param {Object} app - The main application instance\r\n   */\r\n  constructor(apiClient, logger, app) {\r\n    this.#apiClient = apiClient;\r\n    this.#logger = logger;\r\n    this.#app = app;\r\n    \r\n    // Check for debug mode\r\n    const debugMeta = document.querySelector('meta[name=\"os-debug\"]');\r\n    this.#debugMode = debugMeta?.getAttribute('content') === 'true';\r\n    \r\n    this.#safeLog('info', 'ReceiptPage component created');\r\n    \r\n    // Initialize immediately\r\n    this.init();\r\n  }\r\n  \r\n  // Safe logging method to handle potential missing logger methods\r\n  #safeLog(level, message, ...args) {\r\n    try {\r\n      if (this.#logger && typeof this.#logger[level] === 'function') {\r\n        this.#logger[level](message, ...args);\r\n      } else if (console[level]) {\r\n        console[level](message, ...args);\r\n      } else {\r\n        console.log(`[${level.toUpperCase()}] ${message}`, ...args);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error logging message:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Initialize the receipt page\r\n   */\r\n  async init() {\r\n    // Prevent duplicate initialization\r\n    if (this.#initialized) {\r\n      this.#safeLog('info', 'Receipt page already initialized, skipping');\r\n      return;\r\n    }\r\n    \r\n    this.#safeLog('info', 'Initializing Receipt Page');\r\n    this.#initialized = true;\r\n    \r\n    // Get ref_id from URL parameters\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const refId = urlParams.get('ref_id');\r\n    \r\n    if (!refId) {\r\n      this.#safeLog('error', 'No ref_id found in URL parameters');\r\n      this.#showError('Order reference not found. Please check your URL.');\r\n      return;\r\n    }\r\n    \r\n    this.#safeLog('info', `Found ref_id in URL: ${refId}`);\r\n    \r\n    try {\r\n      // Fetch order details\r\n      await this.#fetchOrderDetails(refId);\r\n      \r\n      // Update the DOM with order details\r\n      this.#updateReceiptContent();\r\n    } catch (error) {\r\n      this.#safeLog('error', 'Error initializing receipt page:', error);\r\n      this.#showError('Failed to load order details. Please try again later.');\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Fetch order details from the API\r\n   * @param {string} refId - The order reference ID\r\n   */\r\n  async #fetchOrderDetails(refId) {\r\n    this.#safeLog('info', `Fetching order details for ref_id: ${refId}`);\r\n    \r\n    // Check if we've already fetched this order to prevent duplicate requests\r\n    if (this.#orderFetched && this.#orderData) {\r\n      this.#safeLog('info', 'Order already fetched, using cached data');\r\n      return this.#orderData;\r\n    }\r\n    \r\n    try {\r\n      // Check if API client is available\r\n      if (!this.#apiClient) {\r\n        throw new Error('API client not available');\r\n      }\r\n      \r\n      // Fetch order details\r\n      this.#safeLog('debug', 'Making API request to fetch order details');\r\n      this.#orderData = await this.#apiClient.getOrder(refId);\r\n      this.#orderFetched = true; // Set flag to prevent duplicate requests\r\n      \r\n      this.#safeLog('info', 'Order details fetched successfully');\r\n      this.#safeLog('debug', 'Order data:', this.#orderData);\r\n      \r\n      return this.#orderData;\r\n    } catch (error) {\r\n      this.#safeLog('error', `Error fetching order details for ref_id ${refId}:`, error);\r\n      throw error;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Update the receipt content with order details\r\n   */\r\n  #updateReceiptContent() {\r\n    if (!this.#orderData) {\r\n      this.#safeLog('error', 'No order data available to update receipt content');\r\n      return;\r\n    }\r\n    \r\n    this.#safeLog('info', 'Updating receipt content with order details');\r\n    \r\n    // Update customer name\r\n    this.#updateElement('fname', this.#orderData.user?.first_name || '');\r\n    \r\n    // Update billing information\r\n    if (this.#orderData.billing_address) {\r\n      this.#updateElement('billing_fname', `${this.#orderData.billing_address.first_name} ${this.#orderData.billing_address.last_name}`);\r\n      this.#updateElement('billing_address', this.#formatAddress(this.#orderData.billing_address));\r\n      this.#updateElement('billing_location', this.#formatLocation(this.#orderData.billing_address));\r\n      this.#updateElement('billing_country', this.#getCountryName(this.#orderData.billing_address.country) || '');\r\n    }\r\n    \r\n    // Update shipping information\r\n    if (this.#orderData.shipping_address) {\r\n      this.#updateElement('shipping_fname', `${this.#orderData.shipping_address.first_name} ${this.#orderData.shipping_address.last_name}`);\r\n      this.#updateElement('shipping_address', this.#formatAddress(this.#orderData.shipping_address));\r\n      this.#updateElement('shipping_location', this.#formatLocation(this.#orderData.shipping_address));\r\n      this.#updateElement('shipping_country', this.#getCountryName(this.#orderData.shipping_address.country) || '');\r\n    }\r\n    \r\n    // Update payment method - determine from order data\r\n    const paymentMethod = this.#determinePaymentMethod();\r\n    this.#updateElement('payment_method', paymentMethod);\r\n    \r\n    // Update order lines\r\n    this.#updateOrderLines();\r\n    \r\n    // Update shipping method - use both attribute names for compatibility\r\n    const shippingMethod = this.#orderData.shipping_method || 'Standard Shipping';\r\n    this.#updateElement('shipping-method', shippingMethod); // Hyphen version\r\n    this.#updateElement('shipping_method', shippingMethod); // Underscore version\r\n    \r\n    // Update shipping price\r\n    if (this.#orderData.shipping_excl_tax !== undefined) {\r\n      const shippingPrice = this.#formatCurrency(parseFloat(this.#orderData.shipping_excl_tax));\r\n      this.#updateElement('shipping-price', shippingPrice);\r\n      \r\n      // Always show shipping container regardless of price\r\n      const shippingContainer = document.querySelector('[data-os-receipt=\"shipping-container\"]');\r\n      if (shippingContainer) {\r\n        shippingContainer.style.display = 'flex';\r\n      }\r\n    }\r\n    \r\n    // Update tax information - show only if taxes exist\r\n    const taxContainer = document.querySelector('[data-os-receipt=\"tax-container\"]');\r\n    if (taxContainer) {\r\n      const totalTax = parseFloat(this.#orderData.total_tax || 0);\r\n      \r\n      if (totalTax > 0) {\r\n        // Show tax container and update tax amount\r\n        taxContainer.style.display = 'flex';\r\n        this.#updateElement('taxes', this.#formatCurrency(totalTax));\r\n      } else {\r\n        // Hide tax container if no taxes\r\n        taxContainer.style.display = 'none';\r\n      }\r\n    }\r\n    \r\n    // Update total\r\n    const total = this.#formatCurrency(parseFloat(this.#orderData.total_incl_tax) || 0);\r\n    this.#updateElement('total', total);\r\n    \r\n    // Update order number\r\n    this.#updateElement('order_number', this.#orderData.number || '');\r\n    \r\n    // Update order reference\r\n    this.#updateElement('order_reference', this.#orderData.ref_id || '');\r\n    \r\n    this.#safeLog('info', 'Receipt content updated successfully');\r\n  }\r\n  \r\n  /**\r\n   * Determine payment method from order data\r\n   * @returns {string} The formatted payment method\r\n   */\r\n  #determinePaymentMethod() {\r\n    // Check if payment_detail exists in the order data\r\n    if (this.#orderData.payment_detail && this.#orderData.payment_detail.payment_method) {\r\n      return this.#formatPaymentMethod(this.#orderData.payment_detail.payment_method);\r\n    }\r\n    \r\n    // If no payment_detail, try to determine from other fields\r\n    if (this.#orderData.payment_method) {\r\n      return this.#formatPaymentMethod(this.#orderData.payment_method);\r\n    }\r\n    \r\n    // Default to Credit Card if we can't determine\r\n    return 'Credit Card';\r\n  }\r\n  \r\n  /**\r\n   * Update order lines in the receipt\r\n   */\r\n  #updateOrderLines() {\r\n    if (!this.#orderData.lines || !Array.isArray(this.#orderData.lines)) {\r\n      this.#safeLog('warn', 'No order lines available');\r\n      return;\r\n    }\r\n    \r\n    const orderLinesContainer = document.querySelector('[data-os-receipt=\"order-lines\"]');\r\n    if (!orderLinesContainer) {\r\n      this.#safeLog('warn', 'Order lines container not found in DOM');\r\n      return;\r\n    }\r\n    \r\n    // Clear existing content\r\n    orderLinesContainer.innerHTML = '';\r\n    \r\n    // Template for a product line\r\n    const lineTemplate = document.querySelector('[data-os-receipt=\"product-line\"]');\r\n    \r\n    // If no template is found, create a simple one\r\n    let template = lineTemplate ? lineTemplate.outerHTML : `\r\n      <div data-os-receipt=\"product-line\" class=\"cart-summary__line\">\r\n        <div class=\"cart-summary__line-item\">\r\n          <div data-os-receipt=\"line-title\" class=\"cart-line__title\"></div>\r\n          <div data-os-receipt=\"line-saving\" class=\"cart-line__discount\"></div>\r\n        </div>\r\n        <div class=\"cart-summary__line-item\">\r\n          <p data-os-receipt=\"line-compare\" class=\"pb-cart__line-price pb--compare\"></p>\r\n          <p data-os-receipt=\"line-subtotal\" class=\"pb-cart__line-price\"></p>\r\n        </div>\r\n      </div>\r\n    `;\r\n    \r\n    // Add each order line\r\n    this.#orderData.lines.forEach(line => {\r\n      // Create a new line element\r\n      const lineElement = document.createElement('div');\r\n      lineElement.innerHTML = template;\r\n      const newLine = lineElement.firstElementChild;\r\n      \r\n      // Update line details\r\n      const productTitle = line.product_title || line.title || line.package_title || 'Product';\r\n      this.#updateElementInNode(newLine, 'line-title', productTitle);\r\n      \r\n      // Calculate savings if compare price is available\r\n      if (line.price_excl_tax_excl_discounts && \r\n          parseFloat(line.price_excl_tax_excl_discounts) > parseFloat(line.price_excl_tax)) {\r\n        const originalPrice = parseFloat(line.price_excl_tax_excl_discounts);\r\n        const currentPrice = parseFloat(line.price_excl_tax);\r\n        const savingsPercent = Math.round((1 - currentPrice / originalPrice) * 100);\r\n        \r\n        this.#updateElementInNode(newLine, 'line-saving', `(${savingsPercent}% OFF)`);\r\n        this.#updateElementInNode(newLine, 'line-compare', this.#formatCurrency(originalPrice));\r\n      } else {\r\n        // Hide savings elements if no compare price\r\n        const savingElement = newLine.querySelector('[data-os-receipt=\"line-saving\"]');\r\n        const compareElement = newLine.querySelector('[data-os-receipt=\"line-compare\"]');\r\n        if (savingElement) savingElement.style.display = 'none';\r\n        if (compareElement) compareElement.style.display = 'none';\r\n      }\r\n      \r\n      // Update subtotal - use price excluding tax instead of price including tax\r\n      const price = parseFloat(line.price_excl_tax) || 0;\r\n      this.#updateElementInNode(newLine, 'line-subtotal', this.#formatCurrency(price));\r\n      \r\n      // Add the line to the container\r\n      orderLinesContainer.appendChild(newLine);\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Update an element with the given value\r\n   * @param {string} attribute - The data-os-receipt attribute value\r\n   * @param {string} value - The value to set\r\n   */\r\n  #updateElement(attribute, value) {\r\n    const elements = document.querySelectorAll(`[data-os-receipt=\"${attribute}\"]`);\r\n    \r\n    if (elements.length === 0) {\r\n      this.#safeLog('debug', `No elements found with data-os-receipt=\"${attribute}\"`);\r\n      return;\r\n    }\r\n    \r\n    elements.forEach(element => {\r\n      element.textContent = value;\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Update an element within a specific node\r\n   * @param {HTMLElement} node - The parent node\r\n   * @param {string} attribute - The data-os-receipt attribute value\r\n   * @param {string} value - The value to set\r\n   */\r\n  #updateElementInNode(node, attribute, value) {\r\n    const element = node.querySelector(`[data-os-receipt=\"${attribute}\"]`);\r\n    \r\n    if (!element) {\r\n      this.#safeLog('debug', `No element found with data-os-receipt=\"${attribute}\" in node`);\r\n      return;\r\n    }\r\n    \r\n    element.textContent = value;\r\n  }\r\n  \r\n  /**\r\n   * Format an address for display\r\n   * @param {Object} address - The address object\r\n   * @returns {string} The formatted address\r\n   */\r\n  #formatAddress(address) {\r\n    let formattedAddress = '';\r\n    \r\n    if (address.line1) {\r\n      formattedAddress += address.line1;\r\n    }\r\n    \r\n    if (address.line2) {\r\n      formattedAddress += formattedAddress ? `, ${address.line2}` : address.line2;\r\n    }\r\n    \r\n    return formattedAddress;\r\n  }\r\n  \r\n  /**\r\n   * Format location (city, state, zip) for display\r\n   * @param {Object} address - The address object\r\n   * @returns {string} The formatted location\r\n   */\r\n  #formatLocation(address) {\r\n    let parts = [];\r\n    \r\n    if (address.line4) {\r\n      parts.push(address.line4); // City is in line4\r\n    }\r\n    \r\n    if (address.state) {\r\n      parts.push(address.state);\r\n    }\r\n    \r\n    if (address.postcode) {\r\n      parts.push(address.postcode);\r\n    }\r\n    \r\n    return parts.join(', ');\r\n  }\r\n  \r\n  /**\r\n   * Get country name from country code\r\n   * @param {string} countryCode - The country code\r\n   * @returns {string} The country name\r\n   */\r\n  #getCountryName(countryCode) {\r\n    const countryMap = {\r\n      'US': 'United States',\r\n      'CA': 'Canada',\r\n      'GB': 'United Kingdom',\r\n      'AU': 'Australia',\r\n      'NZ': 'New Zealand',\r\n      // Add more countries as needed\r\n    };\r\n    \r\n    return countryMap[countryCode] || countryCode;\r\n  }\r\n  \r\n  /**\r\n   * Format payment method for display\r\n   * @param {string} method - The payment method\r\n   * @returns {string} The formatted payment method\r\n   */\r\n  #formatPaymentMethod(method) {\r\n    const methodMap = {\r\n      'card_token': 'Credit Card',\r\n      'paypal': 'PayPal',\r\n      'apple_pay': 'Apple Pay',\r\n      'google_pay': 'Google Pay',\r\n      'credit': 'Credit Card',\r\n      'card': 'Credit Card'\r\n    };\r\n    \r\n    return methodMap[method] || method;\r\n  }\r\n  \r\n  /**\r\n   * Format currency for display\r\n   * @param {number} amount - The amount\r\n   * @returns {string} The formatted currency\r\n   */\r\n  #formatCurrency(amount) {\r\n    const currency = this.#orderData.currency || 'USD';\r\n    \r\n    // Ensure amount is a number\r\n    const numericAmount = parseFloat(amount);\r\n    \r\n    if (isNaN(numericAmount)) {\r\n      this.#safeLog('warn', `Invalid amount for currency formatting: ${amount}`);\r\n      return `$0.00 ${currency}`;\r\n    }\r\n    \r\n    try {\r\n      return new Intl.NumberFormat('en-US', {\r\n        style: 'currency',\r\n        currency: currency\r\n      }).format(numericAmount);\r\n    } catch (error) {\r\n      this.#safeLog('error', `Error formatting currency: ${error}`);\r\n      return `$${numericAmount.toFixed(2)} ${currency}`;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Show an error message on the page\r\n   * @param {string} message - The error message\r\n   */\r\n  #showError(message) {\r\n    this.#safeLog('error', `Displaying error message: ${message}`);\r\n    \r\n    // Find a container to show the error\r\n    const container = document.querySelector('.receipt-content') || document.body;\r\n    \r\n    // Create error element\r\n    const errorElement = document.createElement('div');\r\n    errorElement.className = 'receipt-error';\r\n    errorElement.style.color = 'red';\r\n    errorElement.style.padding = '20px';\r\n    errorElement.style.margin = '20px 0';\r\n    errorElement.style.border = '1px solid red';\r\n    errorElement.style.borderRadius = '5px';\r\n    errorElement.style.backgroundColor = 'rgba(255, 0, 0, 0.1)';\r\n    errorElement.textContent = message;\r\n    \r\n    // Add to the beginning of the container\r\n    container.prepend(errorElement);\r\n  }\r\n} ", "/**\r\n * 29next Client - Checkout Focus\r\n * A streamlined JavaScript utility for connecting 29next campaigns with checkout functionality.\r\n * \r\n * This is the main entry point for the library. It handles auto-initialization\r\n * and exports the TwentyNineNext class for manual initialization.\r\n */\r\n\r\nimport { TwentyNineNext } from './core/TwentyNineNext.js';\r\n\r\n// Initialize the client\r\nconst initialize = () => {\r\n  try {\r\n    // Skip initialization if explicitly disabled\r\n    if (document.querySelector('meta[name=\"os-disable-auto-init\"]')) {\r\n      console.log('29next Client: Auto-initialization disabled');\r\n      return;\r\n    }\r\n\r\n    // Get configuration from meta tags\r\n    const config = {\r\n      apiKey: document.querySelector('meta[name=\"os-api-key\"]')?.getAttribute('content') ?? null,\r\n      campaignId: document.querySelector('meta[name=\"os-campaign-id\"]')?.getAttribute('content') ?? null,\r\n      debug: document.querySelector('meta[name=\"os-debug\"]')?.getAttribute('content') === 'true',\r\n      paypalClientId: document.querySelector('meta[name=\"os-paypal-client-id\"]')?.getAttribute('content') ?? null,\r\n    };\r\n    \r\n    // Log initialization attempt\r\n    console.log('29next Client: Initializing with config', \r\n      JSON.stringify({\r\n        apiKey: config.apiKey ? '✓ Set' : '✗ Not set',\r\n        campaignId: config.campaignId ? '✓ Set' : '✗ Not set',\r\n        debug: config.debug\r\n      })\r\n    );\r\n    \r\n    // Set up the on29NextReady array if it doesn't exist yet\r\n    window.on29NextReady = Array.isArray(window.on29NextReady) ? window.on29NextReady : [];\r\n    \r\n    // Store the original callbacks\r\n    const callbacks = [...window.on29NextReady];\r\n    \r\n    // Create the client instance\r\n    window.twentyNineNext = new TwentyNineNext(config);\r\n    \r\n    // Process existing callbacks\r\n    callbacks.forEach(callback => {\r\n      window.twentyNineNext.onReady(callback);\r\n    });\r\n    \r\n    // Replace the array with an object that uses onReady for future callbacks\r\n    window.on29NextReady = {\r\n      push: callback => window.twentyNineNext.onReady(callback)\r\n    };\r\n  } catch (error) {\r\n    console.error('29next Client: Error during initialization', error);\r\n  }\r\n};\r\n\r\n// Initialize now if the DOM is already loaded, otherwise wait for DOMContentLoaded\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', initialize);\r\n} else {\r\n  initialize();\r\n}\r\n\r\nexport { TwentyNineNext };", "/**\n * ApiClient - Handles API requests to the 29next API\n * \n * This class is responsible for making API requests to the 29next API,\n * including fetching campaign data, creating carts, and processing orders.\n */\n\nexport class ApiClient {\n  #app;\n  #apiKey;\n  #baseUrl = 'https://campaigns.apps.29next.com/api/v1';\n  #logger;\n\n  constructor(app) {\n    this.#app = app;\n    this.#logger = app.logger.createModuleLogger('API');\n  }\n\n  init() {\n    this.#logger.info('Initializing ApiClient');\n    \n    this.#apiKey = this.#app.config.apiKey;\n    \n    if (this.#apiKey) {\n      this.#logger.info('API key is set');\n    } else {\n      const apiKeyMeta = document.querySelector('meta[name=\"os-api-key\"]');\n      this.#apiKey = apiKeyMeta?.getAttribute('content');\n      this.#logger.info(this.#apiKey ? 'API key retrieved from meta tag' : 'API key is not set');\n    }\n    \n    const proxyMeta = document.querySelector('meta[name=\"os-proxy-url\"]');\n    const proxyUrl = proxyMeta?.getAttribute('content');\n    if (proxyUrl) {\n      this.#baseUrl = proxyUrl;\n      this.#logger.info(`Using proxy URL: ${proxyUrl}`);\n    }\n  }\n\n  #buildUrl(endpoint) {\n    const cleanEndpoint = endpoint.startsWith('/') ? endpoint.slice(1) : endpoint;\n    return `${this.#baseUrl}/${cleanEndpoint}`;\n  }\n\n  async #request(endpoint, method = 'GET', data = null) {\n    if (!this.#apiKey) {\n      this.#logger.warn('API key is not set');\n      if (endpoint === 'campaigns/') {\n        this.#logger.info('Returning mock campaign data since API key is not set');\n        return [{\n          name: 'Mock Campaign',\n          id: 'mock-campaign',\n          currency: 'USD',\n          locale: 'en-US',\n          packages: [],\n          products: []\n        }];\n      }\n      throw new Error('API key is required');\n    }\n\n    const url = this.#buildUrl(endpoint);\n    const options = {\n      method,\n      mode: 'cors',\n      credentials: 'same-origin',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json',\n        'Authorization': this.#apiKey\n      }\n    };\n\n    if (method !== 'GET' && data) options.body = JSON.stringify(data);\n\n    this.#logger.debug(`Making ${method} request to ${url}`, method !== 'GET' ? { requestData: data } : {});\n\n    try {\n      const response = await fetch(url, options);\n      this.#logger.debug(`Received response from ${url} with status ${response.status}`);\n\n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        this.#logger.error(`API error response from ${url}:`, errorData);\n        throw new Error(JSON.stringify(errorData));\n      }\n\n      const responseData = await response.json();\n      this.#logger.debug(`Successfully processed response from ${url}`);\n      return responseData;\n    } catch (error) {\n      this.#logger.error(`API request failed: ${endpoint}`, error);\n      if (error.message?.match(/NetworkError|Failed to fetch|Network request failed/)) {\n        this.#logger.warn('This appears to be a CORS issue. Make sure the API endpoint allows cross-origin requests.');\n      }\n      throw error;\n    }\n  }\n\n  async getCampaign() {\n    try {\n      const campaignsData = await this.#request('campaigns/');\n      this.#logger.debug('Campaign data received');\n\n      if (Array.isArray(campaignsData) && campaignsData.length > 0) return campaignsData[0];\n      if (campaignsData?.name) return campaignsData;\n\n      throw new Error('No valid campaign data found');\n    } catch (error) {\n      this.#logger.error('Error fetching campaign:', error);\n      this.#logger.warn('Using fallback empty campaign object');\n      return {\n        name: 'Default Campaign',\n        currency: 'USD',\n        packages: [],\n        formatPrice: price => `$${Number.parseFloat(price).toFixed(2)}`\n      };\n    }\n  }\n\n  /**\n   * Get attribution data from the app instance\n   * @returns {Object} Attribution data\n   */\n  #getAttributionData() {\n    // Try to get from AttributionManager first\n    if (this.#app.attribution) {\n      // Use getAttributionForApi() which formats data correctly for the API\n      if (typeof this.#app.attribution.getAttributionForApi === 'function') {\n        return this.#app.attribution.getAttributionForApi();\n      }\n      return this.#app.attribution.getAttributionData();\n    }\n    \n    // Fall back to state if AttributionManager is not available\n    if (this.#app.state) {\n      // Try to get the API-formatted attribution data first\n      const apiFormatted = this.#app.state.getState('attribution');\n      if (apiFormatted) {\n        return apiFormatted;\n      }\n      // Fall back to the complete attribution data if necessary\n      return this.#app.state.getState('cart.attribution') || {};\n    }\n    \n    return {};\n  }\n\n  /**\n   * Create a cart via the API\n   * @param {Object} cartData - The cart data\n   * @returns {Promise<Object>} The created cart\n   */\n  async createCart(cartData) {\n    this.#logger.debug('Creating cart', cartData);\n    \n    // Ensure attribution data is included\n    if (!cartData.attribution) {\n      cartData.attribution = this.#getAttributionData();\n      this.#logger.debug('Added attribution data to cart:', cartData.attribution);\n    } else {\n      this.#logger.debug('Cart already has attribution data:', cartData.attribution);\n    }\n    \n    try {\n      const response = await this.#request('carts/', 'POST', cartData);\n      this.#logger.info('Cart created successfully', response);\n      return response;\n    } catch (error) {\n      this.#logger.error('Error creating cart', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Create an order via the API\n   * @param {Object} orderData - The order data\n   * @returns {Promise<Object>} The created order\n   */\n  async createOrder(orderData) {\n    this.#logger.debug('Creating order', orderData);\n    \n    // Ensure attribution data is included\n    if (!orderData.attribution) {\n      orderData.attribution = this.#getAttributionData();\n      this.#logger.debug('Added attribution data to order:', orderData.attribution);\n    } else {\n      this.#logger.debug('Order already has attribution data:', orderData.attribution);\n    }\n    \n    // Check if this is a test order with test_card token\n    if (orderData.payment_token === 'test_card' || \n        (orderData.payment_detail && orderData.payment_detail.card_token === 'test_card')) {\n      \n      this.#logger.debug('Using test card token for order');\n      \n      // Ensure payment_detail is properly formatted for test card\n      orderData.payment_detail = orderData.payment_detail || {};\n      orderData.payment_detail.payment_method = 'card_token';\n      orderData.payment_detail.card_token = 'test_card';\n      \n      // If there was a payment_token at the root level, move it to payment_detail\n      if (orderData.payment_token) {\n        delete orderData.payment_token;\n      }\n    }\n    \n    try {\n      const response = await this.#request('orders/', 'POST', orderData);\n      this.#logger.info('Order created successfully', response);\n      \n      // Store order reference ID in sessionStorage\n      if (response.ref_id) {\n        sessionStorage.setItem('order_ref_id', response.ref_id);\n        this.#logger.debug(`Order reference ID stored: ${response.ref_id}`);\n      }\n      \n      return response;\n    } catch (error) {\n      this.#logger.error('Error creating order', error);\n      throw error;\n    }\n  }\n\n  async getOrder(orderRef) {\n    if (!orderRef) throw new Error('Order reference is required');\n    this.#logger.debug(`Fetching order with ref: ${orderRef}`);\n    return this.#request(`orders/${orderRef}/`);\n  }\n\n  /**\n   * Add an upsell to an existing order\n   * @param {string} orderRef - Order reference ID\n   * @param {Object} upsellData - The upsell data including package_id and quantity\n   * @returns {Promise<Object>} The updated order\n   */\n  async createOrderUpsell(orderRef, upsellData) {\n    if (!orderRef) throw new Error('Order reference is required');\n    this.#logger.debug(`Adding upsell to order ref: ${orderRef}`, upsellData);\n    \n    // Format the upsell data properly\n    const formattedData = {\n      lines: Array.isArray(upsellData.lines) ? upsellData.lines : [\n        {\n          package_id: upsellData.package_id,\n          quantity: upsellData.quantity || 1\n        }\n      ]\n    };\n    \n    // Add payment detail if provided\n    if (upsellData.payment_detail) {\n      formattedData.payment_detail = upsellData.payment_detail;\n    }\n    \n    try {\n      const response = await this.#request(`orders/${orderRef}/upsells/`, 'POST', formattedData);\n      this.#logger.info('Upsell added successfully', response);\n      return response;\n    } catch (error) {\n      this.#logger.error('Error adding upsell to order', error);\n      throw error;\n    }\n  }\n\n  /**\n   * Get the next page URL from the meta tag\n   * @param {string} refId - Optional reference ID to append to the URL\n   * @returns {string|null} Formatted next page URL or null if meta tag not found\n   */\n  getNextPageUrlFromMeta(refId = null) {\n    const nextPageMeta = document.querySelector('meta[name=\"os-next-page\"]');\n    if (!nextPageMeta || !nextPageMeta.getAttribute('content')) {\n      this.#logger.debug('No meta tag found for next page URL');\n      return null;\n    }\n    \n    const nextPagePath = nextPageMeta.getAttribute('content');\n    this.#logger.debug(`Found meta tag with next page URL: ${nextPagePath}`);\n    \n    // Convert to full URL if it's not already\n    const redirectUrl = nextPagePath.startsWith('http') ? \n      new URL(nextPagePath) : \n      new URL(nextPagePath, `${location.protocol}//${location.host}`);\n    \n    // Add ref_id as query param if provided\n    if (refId) {\n      redirectUrl.searchParams.append('ref_id', refId);\n    }\n    \n    return redirectUrl.href;\n  }\n\n  async processPayment(orderData, paymentMethod) {\n    this.#logger.debug(`Processing ${paymentMethod} payment for order`);\n\n    const paymentMethodMap = {\n      'credit': 'card_token',\n      'paypal': 'paypal',\n      'apple_pay': 'apple_pay',\n      'google_pay': 'google_pay'\n    };\n\n    orderData.payment_detail = orderData.payment_detail ?? {};\n    orderData.payment_detail.payment_method = paymentMethodMap[paymentMethod] ?? paymentMethod;\n\n    if (paymentMethod === 'credit' && !orderData.payment_detail.card_token) {\n      throw new Error('Credit card payment requires a card token');\n    }\n    if (paymentMethod !== 'credit') delete orderData.payment_detail.card_token;\n    \n    // Only set success_url from meta tag if available\n    if (!orderData.success_url) {\n      // Get from meta tag using utility method\n      const nextPageUrl = this.getNextPageUrlFromMeta(orderData.ref_id);\n      if (nextPageUrl) {\n        orderData.success_url = nextPageUrl;\n        this.#logger.debug(`Set success_url from meta tag: ${orderData.success_url}`);\n      } else {\n        this.#logger.debug('No meta tag found for success_url, API will use order_status_url as fallback');\n      }\n    }\n    \n    // Add payment_failed_url to redirect back to current page with error parameters\n    if (!orderData.payment_failed_url) {\n      const currentUrl = new URL(window.location.href);\n      currentUrl.searchParams.set('payment_failed', 'true');\n      currentUrl.searchParams.set('payment_method', paymentMethod);\n      orderData.payment_failed_url = currentUrl.href;\n      this.#logger.debug(`Set payment_failed_url to: ${orderData.payment_failed_url}`);\n    }\n\n    return this.createOrder(orderData);\n  }\n\n  getNextUrlFromOrderResponse(orderResponse) {\n    this.#logger.debug('Getting next URL for redirect');\n\n    const refId = orderResponse.ref_id;\n    \n    // If the API provides a payment_complete_url, use it directly (highest priority)\n    if (orderResponse.payment_complete_url) {\n      this.#logger.debug(`Using payment complete URL from API: ${orderResponse.payment_complete_url}`);\n      return orderResponse.payment_complete_url;\n    }\n    \n    // Check for next page URL in meta tag (second priority) using utility method\n    const nextPageUrl = this.getNextPageUrlFromMeta(refId);\n    if (nextPageUrl) {\n      return nextPageUrl;\n    }\n    \n    // Always use order_status_url as final fallback\n    if (orderResponse.order_status_url) {\n      this.#logger.debug(`Using order status URL from API: ${orderResponse.order_status_url}`);\n      return orderResponse.order_status_url;\n    }\n    \n    // If somehow no order_status_url exists (should not happen), log a warning\n    this.#logger.warn('No order_status_url found in API response - using fallback URL');\n    return `${window.location.origin}/checkout/confirmation/?ref_id=${refId || ''}`;\n  }\n}", "/**\r\n * Logger - Provides logging functionality for the 29next client\r\n */\r\n\r\n// Add global declaration for TypeScript compatibility\r\n// This would typically be in a separate .d.ts file in a TypeScript project\r\n// But including it as a comment for reference\r\n// declare global {\r\n//   interface Window {\r\n//     twentyNineNextStartupTime: number;\r\n//   }\r\n// }\r\n\r\nexport class Logger {\r\n  #debug;\r\n  #prefix = '29next';\r\n  #startupTime = 0;\r\n\r\n  constructor(debug = false) {\r\n    this.#debug = debug;\r\n    this.setStartupTime();\r\n  }\r\n\r\n  setDebug(debug) {\r\n    this.#debug = debug;\r\n  }\r\n\r\n  /**\r\n   * Sets the startup time to the current timestamp\r\n   */\r\n  setStartupTime() {\r\n    this.#startupTime = +new Date();\r\n    // Make startup time available globally\r\n    window.twentyNineNextStartupTime = this.#startupTime;\r\n  }\r\n\r\n  /**\r\n   * Gets the elapsed time since startup in milliseconds\r\n   */\r\n  getElapsedTime() {\r\n    return (+new Date()) - this.#startupTime;\r\n  }\r\n\r\n  createModuleLogger(moduleName) {\r\n    const modulePrefix = `${this.#prefix} [${moduleName}]`;\r\n    return {\r\n      debug: (...args) => this.#debugLog(modulePrefix, ...args),\r\n      info: (...args) => this.#info(modulePrefix, ...args),\r\n      warn: (...args) => this.#warn(modulePrefix, ...args),\r\n      error: (...args) => this.#error(modulePrefix, ...args),\r\n      // Add timing methods to module loggers\r\n      debugWithTime: (...args) => this.#debugLogWithTime(modulePrefix, ...args),\r\n      infoWithTime: (...args) => this.#infoWithTime(modulePrefix, ...args),\r\n      warnWithTime: (...args) => this.#warnWithTime(modulePrefix, ...args),\r\n      errorWithTime: (...args) => this.#errorWithTime(modulePrefix, ...args)\r\n    };\r\n  }\r\n\r\n  #info(prefix, message, ...args) {\r\n    console.info(`%c${prefix}%c ${message}`, 'color: #0066cc; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  #warn(prefix, message, ...args) {\r\n    console.warn(`%c${prefix}%c ${message}`, 'color: #ff9900; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  #error(prefix, message, ...args) {\r\n    console.error(`%c${prefix}%c ${message}`, 'color: #cc0000; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  #debugLog(prefix, message, ...args) {\r\n    if (this.#debug) {\r\n      console.debug(`%c${prefix}:debug%c ${message}`, 'color: #666666; font-weight: bold;', 'color: inherit;', ...args);\r\n    }\r\n  }\r\n\r\n  // New methods with timing information\r\n  #infoWithTime(prefix, message, ...args) {\r\n    const diff = this.getElapsedTime();\r\n    console.info(`%c${prefix} +${diff}ms%c ${message}`, 'color: #0066cc; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  #warnWithTime(prefix, message, ...args) {\r\n    const diff = this.getElapsedTime();\r\n    console.warn(`%c${prefix} +${diff}ms%c ${message}`, 'color: #ff9900; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  #errorWithTime(prefix, message, ...args) {\r\n    const diff = this.getElapsedTime();\r\n    console.error(`%c${prefix} +${diff}ms%c ${message}`, 'color: #cc0000; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  #debugLogWithTime(prefix, message, ...args) {\r\n    if (this.#debug) {\r\n      const diff = this.getElapsedTime();\r\n      console.debug(`%c${prefix}:debug +${diff}ms%c ${message}`, 'color: #666666; font-weight: bold;', 'color: inherit;', ...args);\r\n    }\r\n  }\r\n\r\n  // Standalone timing log methods\r\n  logWithTime(message, ...args) {\r\n    const diff = this.getElapsedTime();\r\n    console.log(`%c${this.#prefix} +${diff}ms%c ${message}`, 'color: #0066cc; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  warnWithTime(message, ...args) {\r\n    const diff = this.getElapsedTime();\r\n    console.warn(`%c${this.#prefix} +${diff}ms%c ${message}`, 'color: #ff9900; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  errorWithTime(message, ...args) {\r\n    const diff = this.getElapsedTime();\r\n    console.error(`%c${this.#prefix} +${diff}ms%c ${message}`, 'color: #cc0000; font-weight: bold;', 'color: inherit;', ...args);\r\n  }\r\n\r\n  debugWithTime(message, ...args) {\r\n    if (this.#debug) {\r\n      const diff = this.getElapsedTime();\r\n      console.debug(`%c${this.#prefix}:debug +${diff}ms%c ${message}`, 'color: #666666; font-weight: bold;', 'color: inherit;', ...args);\r\n    }\r\n  }\r\n}", "export class AddressHandler {\r\n  #form;\r\n  #logger;\r\n  #addressConfig;\r\n  #countries = [];\r\n  #states = {};\r\n  #elements;\r\n\r\n  constructor(form, logger) {\r\n    this.#form = form;\r\n    this.#logger = logger;\r\n    this.#addressConfig = this.#getAddressConfig();\r\n    this.#elements = {\r\n      shippingCountry: document.querySelector('[os-checkout-field=\"country\"]'),\r\n      shippingState: document.querySelector('[os-checkout-field=\"province\"]'),\r\n      billingCountry: document.querySelector('[os-checkout-field=\"billing-country\"]'),\r\n      billingState: document.querySelector('[os-checkout-field=\"billing-province\"]'),\r\n    };\r\n\r\n    this.#loadCachedData();\r\n    if (this.#elements.shippingCountry || this.#elements.billingCountry) {\r\n      this.#logger.info('AddressHandler initialized');\r\n      this.#init();\r\n    } else {\r\n      this.#logger.warn('No country selects found');\r\n    }\r\n  }\r\n\r\n  async #init() {\r\n    await this.#loadCountriesAndStates();\r\n    await Promise.all([\r\n      this.#elements.shippingCountry && this.#initCountrySelect(this.#elements.shippingCountry, this.#elements.shippingState),\r\n      this.#elements.billingCountry && this.#initCountrySelect(this.#elements.billingCountry, this.#elements.billingState),\r\n    ]);\r\n    this.#setupCountryChangeListeners();\r\n    this.#detectUserCountry();\r\n    this.#setupAutocompleteDetection();\r\n  }\r\n\r\n  #getAddressConfig() {\r\n    return {\r\n      defaultCountry: window.osConfig?.addressConfig?.defaultCountry ?? document.querySelector('meta[name=\"os-address-default-country\"]')?.content ?? 'US',\r\n      showCountries: window.osConfig?.addressConfig?.showCountries ?? document.querySelector('meta[name=\"os-address-show-countries\"]')?.content?.split(',').map(c => c.trim()) ?? [],\r\n      dontShowStates: window.osConfig?.addressConfig?.dontShowStates ?? document.querySelector('meta[name=\"os-address-dont-show-states\"]')?.content?.split(',').map(s => s.trim()) ?? [],\r\n      countries: window.osConfig?.addressConfig?.countries ?? [],\r\n    };\r\n  }\r\n\r\n  async #initCountrySelect(countrySelect, stateSelect) {\r\n    countrySelect.innerHTML = '<option value=\"\">Select Country</option>' + \r\n      this.#countries.map(c => `<option value=\"${c.iso2}\">${c.name}</option>`).join('');\r\n    countrySelect.value = this.#addressConfig.defaultCountry;\r\n    if (stateSelect && countrySelect.value) await this.#updateStateSelect(stateSelect, countrySelect.value);\r\n    this.#logger.debug(`Country select initialized with default ${this.#addressConfig.defaultCountry}`);\r\n  }\r\n\r\n  #setupCountryChangeListeners() {\r\n    const pairs = [\r\n      [this.#elements.shippingCountry, this.#elements.shippingState],\r\n      [this.#elements.billingCountry, this.#elements.billingState]\r\n    ];\r\n    pairs.forEach(([country, state]) => {\r\n      country?.addEventListener('change', () => state && this.#updateStateSelect(state, country.value));\r\n    });\r\n  }\r\n\r\n  async #updateStateSelect(stateSelect, countryCode, isPriority = false) {\r\n    if (!countryCode) return stateSelect.innerHTML = '<option value=\"\">Select State/Province</option>';\r\n    const states = this.#states[countryCode] || (await this.#loadStates(countryCode));\r\n    if (isPriority) await states;\r\n    this.#populateStateSelect(stateSelect, states);\r\n    this.#logger.debug(`State select updated for ${countryCode}`);\r\n  }\r\n\r\n  #populateStateSelect(stateSelect, states) {\r\n    const currentValue = stateSelect.value || stateSelect.getAttribute('data-pending-state') || '';\r\n    stateSelect.innerHTML = '<option value=\"\">Select State/Province</option>' + \r\n      states.map(s => `<option value=\"${s.iso2}\">${s.name}</option>`).join('');\r\n    stateSelect.parentElement.style.display = states.length ? '' : 'none';\r\n    if (currentValue && Array.from(stateSelect.options).some(o => o.value === currentValue)) stateSelect.value = currentValue;\r\n  }\r\n\r\n  #loadCachedData() {\r\n    const loadCache = key => {\r\n      const data = JSON.parse(localStorage.getItem(key) ?? '{}');\r\n      return (Date.now() - (data.timestamp ?? 0) < 24 * 60 * 60 * 1000) ? data : {};\r\n    };\r\n    this.#countries = loadCache('os_countries_cache').countries ?? [];\r\n    \r\n    // Filter cached countries if showCountries is specified\r\n    if (this.#countries.length && this.#addressConfig.showCountries.length) {\r\n      this.#countries = this.#countries.filter(c => \r\n        this.#addressConfig.showCountries.includes(c.iso2));\r\n      this.#logger.debug(`Filtered cached countries to: ${this.#addressConfig.showCountries.join(', ')}`);\r\n    }\r\n    \r\n    this.#states = loadCache('os_states_cache').states ?? {};\r\n    this.#logger.debug(`Loaded cached data: ${this.#countries.length} countries, ${Object.keys(this.#states).length} state sets`);\r\n  }\r\n\r\n  #saveCache(key, data) {\r\n    localStorage.setItem(key, JSON.stringify({ ...data, timestamp: Date.now() }));\r\n  }\r\n\r\n  async #loadCountriesAndStates() {\r\n    if (this.#countries.length) return;\r\n    this.#countries = this.#addressConfig.countries.length ? \r\n      this.#addressConfig.countries.map(c => ({ iso2: c.iso2 || c.code, name: c.name })) :\r\n      (await (await fetch('https://api.countrystatecity.in/v1/countries', { \r\n        headers: { 'X-CSCAPI-KEY': 'c2R3MzNhYmpvYUJPdmhkUlE5TUJWYUtJUGs2TTlNU3cyRmxmVW9wVQ==' } \r\n      })).json()).filter(c => !this.#addressConfig.showCountries.length || this.#addressConfig.showCountries.includes(c.iso2));\r\n    this.#countries.sort((a, b) => a.name.localeCompare(b.name));\r\n    this.#saveCache('os_countries_cache', { countries: this.#countries });\r\n    this.#logger.info(`Loaded ${this.#countries.length} countries`);\r\n  }\r\n\r\n  async #loadStates(countryCode) {\r\n    if (this.#states[countryCode]) return this.#states[countryCode];\r\n    try {\r\n      const states = (await (await fetch(`https://api.countrystatecity.in/v1/countries/${countryCode}/states`, { \r\n        headers: { 'X-CSCAPI-KEY': 'c2R3MzNhYmpvYUJPdmhkUlE5TUJWYUtJUGs2TTlNU3cyRmxmVW9wVQ==' } \r\n      })).json()).filter(s => !this.#addressConfig.dontShowStates.includes(s.iso2));\r\n      this.#states[countryCode] = states;\r\n      this.#saveCache('os_states_cache', { states: this.#states });\r\n      this.#logger.debug(`Loaded ${states.length} states for ${countryCode}`);\r\n      return states;\r\n    } catch (error) {\r\n      this.#logger.error(`Failed to load states for ${countryCode}:`, error);\r\n      this.#states[countryCode] = countryCode === 'US' ? /* US states list */ [] : [];\r\n      return this.#states[countryCode];\r\n    }\r\n  }\r\n\r\n  async #detectUserCountry() {\r\n    if (this.#elements.shippingCountry?.value || this.#elements.billingCountry?.value) return;\r\n    const countryCode = this.#addressConfig.defaultCountry || (await Promise.any(['https://ipapi.co/json/', 'https://ipinfo.io/json'].map(u => fetch(u).then(r => r.json()))))?.country_code;\r\n    [this.#elements.shippingCountry, this.#elements.billingCountry].forEach(c => {\r\n      if (c) {\r\n        c.value = countryCode;\r\n        c.dispatchEvent(new Event('change'));\r\n      }\r\n    });\r\n    this.#logger.debug(`User country detected/set to ${countryCode}`);\r\n  }\r\n\r\n  #setupAutocompleteDetection() {\r\n    const fields = Object.values(this.#elements).filter(Boolean);\r\n    const observer = new MutationObserver(mutations => {\r\n      mutations.forEach(m => {\r\n        if (m.attributeName === 'value' && m.target.value) {\r\n          const state = m.target === this.#elements.shippingCountry ? this.#elements.shippingState : this.#elements.billingState;\r\n          state && this.#updateStateSelect(state, m.target.value, true);\r\n          this.#logger.debug(`Autocomplete detected on ${m.target.getAttribute('os-checkout-field')}`);\r\n        }\r\n      });\r\n    });\r\n    fields.forEach(f => observer.observe(f, { attributes: true, attributeFilter: ['value'] }));\r\n    this.#preloadCommonStates();\r\n    this.#logger.debug('Autocomplete detection set up');\r\n  }\r\n\r\n  #preloadCommonStates() {\r\n    const countries = this.#addressConfig.showCountries.length ? this.#addressConfig.showCountries : ['US', 'CA', 'GB', 'AU'];\r\n    countries.forEach(c => !this.#states[c] && this.#loadStates(c));\r\n    this.#logger.debug(`Preloading states for ${countries.join(', ')}`);\r\n  }\r\n}", "/**\r\n * FormValidator - Handles form validation for checkout\r\n */\r\nexport class FormValidator {\r\n  #logger;\r\n  #form;\r\n  #validationErrors = {};\r\n  #debugMode = false;\r\n  #spreedlyEnabled = false;\r\n  #spreedlyFieldsValid = false;\r\n  #spreedlyReady = false;\r\n\r\n  constructor(options = {}) {\r\n    this.#debugMode = options.debugMode || false;\r\n    this.#logger = options.logger || console;\r\n    this.#form = this.#getFormElement();\r\n    this.#spreedlyEnabled = typeof Spreedly !== 'undefined';\r\n\r\n    if (!this.#form) return;\r\n\r\n    this.#setupListeners();\r\n  }\r\n\r\n  #getFormElement() {\r\n    const form = document.querySelector('form[os-checkout=\"form\"]') || document.querySelector('form#combo_form');\r\n    if (!form) this.#safeLog('warn', 'No checkout form found');\r\n    return form;\r\n  }\r\n\r\n  #safeLog(level, message, ...args) {\r\n    try {\r\n      const logFn = this.#logger?.[level] || console[level] || console.log;\r\n      logFn.call(console, `[${level.toUpperCase()}] ${message}`, ...args);\r\n    } catch (error) {\r\n      console.error('Error logging:', error);\r\n    }\r\n  }\r\n\r\n  #setupListeners() {\r\n    this.#form.addEventListener('submit', e => this.#handleSubmit(e));\r\n    document.querySelector('[os-checkout-payment=\"combo\"]')?.addEventListener('click', () => {\r\n      if (this.validateAllFields()) this.#form.submit();\r\n    });\r\n    document.addEventListener('payment-method-changed', () => this.clearAllErrors());\r\n\r\n    if (this.#spreedlyEnabled && typeof Spreedly.on === 'function') {\r\n      this.#setupSpreedlyListeners();\r\n    }\r\n\r\n    // Add ZIP code formatting\r\n    this.#setupZipCodeFormatting();\r\n  }\r\n\r\n  #setupSpreedlyListeners() {\r\n    const listeners = {\r\n      'ready': () => {\r\n        this.#spreedlyReady = true;\r\n        this.#safeLog('debug', 'Spreedly is ready');\r\n      },\r\n      'paymentMethod': (token, pmData) => {\r\n        this.#spreedlyFieldsValid = true;\r\n        this.#safeLog('debug', 'Spreedly payment method created');\r\n        this.#clearSpreedlyErrors();\r\n      },\r\n      'validation': (result) => {\r\n        this.#safeLog('debug', `Spreedly field validation: ${result.fieldType} ${result.valid ? 'valid' : 'invalid'}`);\r\n        const field = document.getElementById(`spreedly-${result.fieldType}`);\r\n        if (field) {\r\n          field.classList.toggle('spreedly-valid', result.valid);\r\n          field.classList.toggle('error', !result.valid);\r\n        }\r\n        if (result.valid) {\r\n          this.clearErrorForField(field);\r\n        } else {\r\n          const errorMessage = this.#getSpreedlyFieldErrorMessage(result.fieldType);\r\n          this.#handleSpreedlyError({ attribute: result.fieldType, message: errorMessage });\r\n        }\r\n      },\r\n      'errors': (errors) => {\r\n        this.#spreedlyFieldsValid = false;\r\n        this.#safeLog('debug', 'Spreedly validation errors:', errors);\r\n        errors.forEach(error => this.#handleSpreedlyError(error));\r\n      },\r\n      'fieldEvent': (name, event, activeElement, inputData) => {\r\n        // Real-time feedback like Spreedly's example\r\n        const field = document.getElementById(`spreedly-${name}`);\r\n        if (event === 'input' && field) {\r\n          const isValid = name === 'number' ? inputData.validNumber : inputData.validCvv;\r\n          field.classList.toggle('spreedly-valid', isValid);\r\n          field.classList.toggle('error', !isValid);\r\n          if (isValid) {\r\n            this.clearErrorForField(field);\r\n          } else {\r\n            const errorMessage = this.#getSpreedlyFieldErrorMessage(name);\r\n            this.#showError(field, errorMessage);\r\n          }\r\n        }\r\n      }\r\n    };\r\n  \r\n    Object.entries(listeners).forEach(([event, handler]) => Spreedly.on(event, handler));\r\n  }\r\n\r\n  #getSpreedlyFieldErrorMessage(fieldType) {\r\n    const errorMessages = {\r\n      'number': 'Please enter a valid credit card number',\r\n      'cvv': 'Please enter a valid security code (CVV)'\r\n    };\r\n    return errorMessages[fieldType] || `Invalid ${fieldType}`;\r\n  }\r\n\r\n  #handleSpreedlyError(error) {\r\n    const fieldMap = {\r\n      'number': 'spreedly-number',\r\n      'card_number': 'spreedly-number',\r\n      'cvv': 'spreedly-cvv',\r\n      'month': 'cc-month',\r\n      'year': 'cc-year',\r\n      'full_name': 'cc-name',\r\n      'first_name': 'cc-name',\r\n      'last_name': 'cc-name'\r\n    };\r\n    const container = document.getElementById(fieldMap[error.attribute]) || \r\n                     document.querySelector(`[os-checkout-field=\"${fieldMap[error.attribute]}\"]`);\r\n    if (container) this.#showError(container, error.message);\r\n  }\r\n\r\n  #handleSubmit(event) {\r\n    if (!this.validateAllFields()) {\r\n      event.preventDefault();\r\n      this.#safeLog('warn', 'Form validation failed');\r\n    }\r\n  }\r\n\r\n  validateAllFields(selectedPaymentMethod = this.getSelectedPaymentMethod()) {\r\n    this.#debugMode && this.#logValidationStart(selectedPaymentMethod);\r\n    \r\n    const isCreditCard = ['credit', 'credit-card'].includes(selectedPaymentMethod);\r\n    let isValid = true;\r\n    \r\n    // First validate required fields\r\n    const requiredFields = Array.from(document.querySelectorAll('[os-checkout-validate=\"required\"]'));\r\n    const firstErrorField = this.#validateFields(requiredFields, isCreditCard);\r\n    \r\n    // For credit card payments, validate credit card fields\r\n    let ccValid = true;\r\n    if (isCreditCard) {\r\n      ccValid = this.validateCreditCard();\r\n    }\r\n    \r\n    // Now validate any filled phone fields (even if not required)\r\n    const phoneError = this.#validatePhoneFields();\r\n    \r\n    // Handle validation results\r\n    if (firstErrorField) {\r\n      this.#scrollToError(firstErrorField);\r\n      isValid = false;\r\n    } else if (phoneError) {\r\n      isValid = false;\r\n    } else if (!ccValid) {\r\n      isValid = false;\r\n    }\r\n\r\n    return isValid;\r\n  }\r\n\r\n  #logValidationStart(method) {\r\n    this.#safeLog('debug', 'Starting field validation for payment method:', method);\r\n    this.#safeLog('debug', 'Same as shipping:', this.isSameAsShipping());\r\n    this.#safeLog('debug', 'Spreedly enabled:', this.#spreedlyEnabled);\r\n    this.#safeLog('debug', 'Spreedly ready:', this.#spreedlyReady);\r\n  }\r\n\r\n  #validateFields(fields, isCreditCard) {\r\n    let firstErrorField = null;\r\n    \r\n    for (const field of fields) {\r\n      const fieldName = field.getAttribute('os-checkout-field');\r\n      if (this.#shouldSkipField(fieldName, isCreditCard)) {\r\n        this.clearErrorForField(field);\r\n        continue;\r\n      }\r\n\r\n      const label = field.previousElementSibling?.textContent || fieldName || field.placeholder;\r\n      if (!this.#validateField(field, label)) {\r\n        firstErrorField = firstErrorField || field;\r\n      }\r\n    }\r\n    return firstErrorField;\r\n  }\r\n\r\n  #shouldSkipField(fieldName, isCreditCard) {\r\n    return (this.isSameAsShipping() && fieldName?.startsWith('billing-')) ||\r\n           (isCreditCard && ['cc-number', 'cvv'].includes(fieldName));\r\n  }\r\n\r\n  #validateCreditCardExpiryFields() {\r\n    const [monthField, yearField] = this.#getExpiryFields();\r\n    return this.#validateExpiryField(monthField, 'month') && \r\n           this.#validateExpiryField(yearField, 'year');\r\n  }\r\n\r\n  #getExpiryFields() {\r\n    const monthSelectors = ['[os-checkout-field=\"cc-month\"]', '[os-checkout-field=\"exp-month\"]', '#credit_card_exp_month'];\r\n    const yearSelectors = ['[os-checkout-field=\"cc-year\"]', '[os-checkout-field=\"exp-year\"]', '#credit_card_exp_year'];\r\n    return [\r\n      monthSelectors.map(s => document.querySelector(s)).find(Boolean),\r\n      yearSelectors.map(s => document.querySelector(s)).find(Boolean)\r\n    ];\r\n  }\r\n\r\n  #validateExpiryField(field, type) {\r\n    if (!field || !field.value) {\r\n      this.#safeLog('error', `${type} field is empty`);\r\n      this.#showError(field, `Please select an expiration ${type}`);\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n\r\n  #clearSpreedlyErrors() {\r\n    ['cc-number', 'cvv'].forEach(name => \r\n      this.clearErrorForField(document.querySelector(`[os-checkout-field=\"${name}\"]`)));\r\n    ['spreedly-number', 'spreedly-cvv'].forEach(id => \r\n      this.clearErrorForField(document.getElementById(id)));\r\n  }\r\n\r\n  #validateField(field, label) {\r\n    if (!field) return true;\r\n\r\n    const value = field.value.trim();\r\n    const validation = this.#getFieldValidation(field, value, this.#getReadableFieldLabel(field, label));\r\n    \r\n    if (!validation.isValid) {\r\n      this.#showError(field, validation.errorMessage);\r\n    } else {\r\n      this.clearErrorForField(field);\r\n    }\r\n    return validation.isValid;\r\n  }\r\n\r\n  #getReadableFieldLabel(field, fallbackLabel) {\r\n    const fieldName = field.getAttribute('os-checkout-field') || field.name;\r\n    \r\n    // Map of field names to user-friendly labels\r\n    const labelMap = {\r\n      'fname': 'First Name',\r\n      'lname': 'Last Name',\r\n      'email': 'Email',\r\n      'phone': 'Phone Number',\r\n      'address1': 'Address',\r\n      'address2': 'Apartment or Suite',\r\n      'city': 'City',\r\n      'province': 'State/Province',\r\n      'postal': 'ZIP/Postal Code',\r\n      'country': 'Country',\r\n      'cc-number': 'Credit Card Number',\r\n      'cvv': 'Security Code',\r\n      'cc-month': 'Expiration Month',\r\n      'cc-year': 'Expiration Year',\r\n      'cc-name': 'Name on Card',\r\n      'exp-month': 'Expiration Month',\r\n      'exp-year': 'Expiration Year',\r\n      'billing-fname': 'Billing First Name',\r\n      'billing-lname': 'Billing Last Name',\r\n      'billing-address1': 'Billing Address',\r\n      'billing-address2': 'Billing Apartment or Suite',\r\n      'billing-city': 'Billing City',\r\n      'billing-province': 'Billing State/Province',\r\n      'billing-postal': 'Billing ZIP/Postal Code',\r\n      'billing-country': 'Billing Country',\r\n      'billing-phone': 'Billing Phone Number'\r\n    };\r\n    \r\n    // Return the mapped label if available, otherwise use the fallback label\r\n    return labelMap[fieldName] || fallbackLabel || fieldName;\r\n  }\r\n\r\n  #getFieldValidation(field, value, label) {\r\n    const tag = field.tagName.toLowerCase();\r\n    const fieldName = field.getAttribute('os-checkout-field') || field.name;\r\n\r\n    if (tag === 'select') return {\r\n      isValid: !!value,\r\n      errorMessage: `Please select a ${label}`\r\n    };\r\n    \r\n    // Special handling for phone field - allow empty but validate if has value\r\n    if (field.type === 'tel' && field.iti) {\r\n      // If empty, it's valid (phone is optional)\r\n      if (!value.trim()) {\r\n        return { isValid: true, errorMessage: '' };\r\n      }\r\n      \r\n      // If they entered something, validate it as a US number\r\n      const isValid = field.iti.isValidNumber();\r\n      \r\n      return {\r\n        isValid: isValid,\r\n        errorMessage: `Please enter a valid US phone number (e.g. 555-555-5555)`\r\n      };\r\n    }\r\n    \r\n    if (!value) return { isValid: false, errorMessage: `Please enter your ${label}` };\r\n    \r\n    if (fieldName && (fieldName.includes('city') || fieldName.endsWith('-city'))) {\r\n      return this.#validateCity(value, label);\r\n    }\r\n    \r\n    if (fieldName && (fieldName.includes('zip') || fieldName.includes('postal') || fieldName.endsWith('-zip'))) {\r\n      return this.#validateZipCode(value, fieldName);\r\n    }\r\n    \r\n    if (field.type === 'email') return {\r\n      isValid: this.#isValidEmail(value),\r\n      errorMessage: `Please enter a valid email address`\r\n    };\r\n    return { isValid: true, errorMessage: '' };\r\n  }\r\n\r\n  #validateCity(value, label) {\r\n    // City should be a minimum of 2 letters without special characters, numbers, etc. Maximum length is 24 characters\r\n    const cityRegex = /^[a-zA-Z\\s]{2,24}$/;\r\n    return {\r\n      isValid: cityRegex.test(value),\r\n      errorMessage: `Please enter a valid city name (2-24 letters, no numbers or special characters)`\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Validate a US ZIP code (5 digits or ZIP+4 format)\r\n   * @param {string} value - ZIP code to validate\r\n   * @param {string} fieldName - Name of the field for error message\r\n   * @returns {Object} Validation result with isValid and errorMessage\r\n   */\r\n  #validateZipCode(value, fieldName = 'Zip') {\r\n    // US ZIP code pattern: 5 digits or 5 digits + hyphen + 4 digits\r\n    const zipPattern = /(^\\d{5}$)|(^\\d{5}-\\d{4}$)/;\r\n    const isValid = zipPattern.test(value);\r\n    \r\n    return {\r\n      isValid,\r\n      errorMessage: isValid ? '' : `Field must be a valid US Zip code.`\r\n    };\r\n  }\r\n\r\n  #showError(input, message) {\r\n    if (!input) return;\r\n    \r\n    input.classList.add('error');\r\n    const wrapper = input.closest('.frm-flds') || input.closest('.form-group') || input.parentElement;\r\n    const errorElement = this.#getOrCreateErrorElement(wrapper);\r\n    \r\n    errorElement.textContent = message;\r\n    Object.assign(errorElement.style, {\r\n      color: 'red',\r\n      fontSize: '0.875rem',\r\n      marginTop: '0.25rem'\r\n    });\r\n\r\n    if (!input.hasErrorListener) {\r\n      input.hasErrorListener = true;\r\n      ['input', 'change'].forEach(event => \r\n        input.addEventListener(event, () => this.clearErrorForField(input)));\r\n      if (input.type === 'tel' && input.iti) {\r\n        input.addEventListener('countrychange', () => this.clearErrorForField(input));\r\n      }\r\n    }\r\n  }\r\n\r\n  #getOrCreateErrorElement(wrapper) {\r\n    let errorElement = wrapper.querySelector('.pb-input-error');\r\n    if (!errorElement) {\r\n      errorElement = document.createElement('div');\r\n      errorElement.className = 'pb-input-error';\r\n      wrapper.appendChild(errorElement);\r\n    }\r\n    return errorElement;\r\n  }\r\n\r\n  clearErrorForField(field) {\r\n    if (!field) return;\r\n    \r\n    field.classList.remove('error');\r\n    const wrapper = field.closest('.frm-flds') || field.closest('.form-group') || field.parentElement;\r\n    wrapper?.querySelector('.pb-input-error')?.remove();\r\n\r\n    const fieldName = field.getAttribute('os-checkout-field');\r\n    if (['cc-number', 'cvv'].includes(fieldName)) {\r\n      const spreedlyId = `spreedly-${fieldName === 'cc-number' ? 'number' : 'cvv'}`;\r\n      const spreedlyContainer = document.getElementById(spreedlyId);\r\n      if (spreedlyContainer) {\r\n        spreedlyContainer.classList.remove('error');\r\n        spreedlyContainer.closest('.frm-flds')?.querySelector('.pb-input-error')?.remove();\r\n      }\r\n    }\r\n  }\r\n\r\n  clearAllErrors() {\r\n    this.#validationErrors = {};\r\n    document.querySelectorAll('.error').forEach(el => el.classList.remove('error'));\r\n    document.querySelectorAll('.pb-input-error').forEach(el => el.remove());\r\n    this.#clearSpreedlyErrors();\r\n  }\r\n\r\n  #scrollToError(element) {\r\n    if (!element) return;\r\n    \r\n    window.scrollTo({\r\n      top: element.getBoundingClientRect().top + window.pageYOffset - 100,\r\n      behavior: 'smooth'\r\n    });\r\n    setTimeout(() => element.focus(), 500);\r\n  }\r\n\r\n  #isValidEmail(email) {\r\n    return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\r\n  }\r\n\r\n  isSameAsShipping() {\r\n    const checkbox = document.querySelector('[os-checkout-field=\"same-as-shipping\"] input[type=\"checkbox\"]') || \r\n                     document.querySelector('[os-input-field=\"use-shipping-address\"] input[type=\"checkbox\"]') || \r\n                     document.querySelector('#use_shipping_address');\r\n    return checkbox ? checkbox.checked : true;\r\n  }\r\n\r\n  getSelectedPaymentMethod() {\r\n    return document.querySelector('input[name=\"payment_method\"]:checked')?.value || \r\n           document.querySelector('input[name=\"combo_mode\"]:checked')?.value || \r\n           'credit';\r\n  }\r\n\r\n  getFormValues() {\r\n    const values = {};\r\n    this.#form.querySelectorAll('input, select, textarea').forEach(field => {\r\n      if (['button', 'submit'].includes(field.type) || field.disabled || !field.name) return;\r\n\r\n      const fieldName = field.getAttribute('os-checkout-field') || field.name;\r\n      if (field.type === 'checkbox') {\r\n        values[fieldName] = field.checked;\r\n      } else if (field.type === 'radio') {\r\n        if (field.checked) values[fieldName] = field.value;\r\n      } else if (fieldName.includes('.')) {\r\n        const [parent, child] = fieldName.split('.');\r\n        values[parent] = values[parent] || {};\r\n        values[parent][child] = field.value;\r\n      } else {\r\n        values[fieldName] = field.value;\r\n      }\r\n    });\r\n    return values;\r\n  }\r\n\r\n  validateCreditCard() {\r\n    let isValid = true;\r\n  \r\n    // Validate expiry fields\r\n    const [monthField, yearField] = this.#getExpiryFields();\r\n    if (!this.#validateExpiryField(monthField, 'month')) isValid = false;\r\n    if (!this.#validateExpiryField(yearField, 'year')) isValid = false;\r\n  \r\n    // If Spreedly is enabled, validate its fields\r\n    if (this.#spreedlyEnabled && typeof Spreedly.validate === 'function') {\r\n      // Check if the Spreedly fields already have valid class\r\n      const numberContainer = document.getElementById('spreedly-number');\r\n      const cvvContainer = document.getElementById('spreedly-cvv');\r\n  \r\n      let numberValid = numberContainer?.classList.contains('spreedly-valid');\r\n      let cvvValid = cvvContainer?.classList.contains('spreedly-valid');\r\n  \r\n      // Trigger Spreedly validation\r\n      Spreedly.validate();\r\n      \r\n      // Use the visual validation state of the fields\r\n      if (!numberValid && numberContainer) {\r\n        this.#showError(numberContainer, 'Please enter a valid credit card number');\r\n        isValid = false;\r\n      }\r\n      \r\n      if (!cvvValid && cvvContainer) {\r\n        this.#showError(cvvContainer, 'Please enter a valid security code (CVV)');\r\n        isValid = false;\r\n      }\r\n    } else {\r\n      // Fallback for non-Spreedly setups\r\n      const ccNumber = document.querySelector('[os-checkout-field=\"cc-number\"]');\r\n      const cvv = document.querySelector('[os-checkout-field=\"cvv\"]');\r\n      \r\n      if (!ccNumber?.value.trim()) {\r\n        this.#showError(ccNumber, 'Please enter a credit card number');\r\n        isValid = false;\r\n      }\r\n      if (!cvv?.value.trim()) {\r\n        this.#showError(cvv, 'Please enter a security code (CVV)');\r\n        isValid = false;\r\n      }\r\n    }\r\n  \r\n    return isValid;\r\n  }\r\n\r\n  #validatePhoneFields() {\r\n    // Find all phone input fields\r\n    const phoneFields = Array.from(document.querySelectorAll('input[type=\"tel\"]'));\r\n    let hasError = false;\r\n    \r\n    for (const field of phoneFields) {\r\n      // Skip if field is empty (phone is optional)\r\n      if (!field.value.trim() || !field.iti) continue;\r\n      \r\n      // Validate phone number if entered\r\n      const isValid = field.iti.isValidNumber();\r\n      \r\n      if (!isValid) {\r\n        // Get specific error code for better error messages\r\n        const errorCode = field.iti.getValidationError();\r\n        \r\n        // Map error codes to user-friendly messages\r\n        const errorMessages = {\r\n          0: 'Please enter a valid US phone number (e.g. 555-555-5555)',\r\n          1: 'Invalid country code',\r\n          2: 'Phone number is too short',\r\n          3: 'Phone number is too long',\r\n          4: 'Please enter a valid phone number',\r\n          5: 'Invalid phone number format'\r\n        };\r\n        \r\n        const message = errorMessages[errorCode] || 'Please enter a valid US phone number';\r\n        this.#showError(field, message);\r\n        \r\n        if (!hasError) {\r\n          this.#scrollToError(field);\r\n          hasError = true;\r\n        }\r\n      } else {\r\n        this.clearErrorForField(field);\r\n      }\r\n    }\r\n    \r\n    return hasError;\r\n  }\r\n\r\n  /**\r\n   * Set up auto-formatting for ZIP code fields\r\n   */\r\n  #setupZipCodeFormatting() {\r\n    // Find all ZIP/postal code fields\r\n    const zipFields = [\r\n      ...document.querySelectorAll('[os-checkout-field=\"postal\"]'),\r\n      ...document.querySelectorAll('[os-checkout-field=\"billing-postal\"]'),\r\n      ...document.querySelectorAll('[os-checkout-field=\"zip\"]')\r\n    ];\r\n    \r\n    zipFields.forEach(field => {\r\n      if (field) {\r\n        field.addEventListener('input', (e) => this.#formatZipCode(e));\r\n        this.#logger.debug(`ZIP code formatting setup for: ${field.getAttribute('os-checkout-field') || field.name || 'unknown'}`);\r\n      }\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Format ZIP code as user types: \r\n   * - Allow only numbers and hyphen\r\n   * - Automatically add hyphen after 5 digits if the user is entering more\r\n   * @param {Event} event - Input event\r\n   */\r\n  #formatZipCode(event) {\r\n    const input = event.target;\r\n    const cursorPos = input.selectionStart;\r\n    const oldValue = input.value;\r\n    \r\n    // Remove non-digits and non-hyphens\r\n    let cleaned = oldValue.replace(/[^\\d-]/g, '');\r\n    \r\n    // Only allow one hyphen after the 5th digit\r\n    if (cleaned.length > 5) {\r\n      const firstPart = cleaned.slice(0, 5);\r\n      \r\n      if (cleaned.charAt(5) !== '-') {\r\n        // Insert hyphen after 5 digits\r\n        const secondPart = cleaned.slice(5).replace(/-/g, '');\r\n        cleaned = `${firstPart}-${secondPart}`;\r\n      } else {\r\n        // Keep existing hyphen and remove any others\r\n        const secondPart = cleaned.slice(6).replace(/-/g, '');\r\n        cleaned = `${firstPart}-${secondPart}`;\r\n      }\r\n    }\r\n    \r\n    // Limit to ZIP+4 format (12345-6789)\r\n    if (cleaned.includes('-')) {\r\n      const [first, second] = cleaned.split('-');\r\n      cleaned = `${first.slice(0, 5)}-${second.slice(0, 4)}`;\r\n    } else {\r\n      cleaned = cleaned.slice(0, 5);\r\n    }\r\n    \r\n    // Only update if changed to avoid cursor jumping\r\n    if (cleaned !== oldValue) {\r\n      input.value = cleaned;\r\n      \r\n      // Adjust cursor position\r\n      const posAdjust = cleaned.length - oldValue.length;\r\n      input.setSelectionRange(cursorPos + posAdjust, cursorPos + posAdjust);\r\n    }\r\n  }\r\n}", "/**\r\n * SpreedlyManager - Manages Spreedly iframe integration for secure credit card processing\r\n * \r\n * This class handles:\r\n * - Loading the Spreedly script if not already loaded\r\n * - Setting up the iframe fields for card number and CVV\r\n * - Styling the iframe fields to match the site design\r\n * - Handling tokenization of credit card data\r\n * - Managing validation and error handling\r\n */\r\n\r\nexport class SpreedlyManager {\r\n  #environmentKey;\r\n  #debugMode = false;\r\n  #isReady = false;\r\n  #onReadyCallback = null;\r\n  #onErrorCallback = null;\r\n  #onPaymentMethodCallback = null;\r\n  #onValidationCallback = null;\r\n  #config = null;\r\n  #app = null;\r\n\r\n  /**\r\n   * Create a new SpreedlyManager\r\n   * @param {string} environmentKey - The Spreedly environment key\r\n   * @param {Object} options - Configuration options\r\n   * @param {boolean} options.debug - Enable debug mode\r\n   * @param {Object} options.app - The app instance for accessing global config\r\n   */\r\n  constructor(environmentKey, options = {}) {\r\n    this.#environmentKey = environmentKey;\r\n    this.#debugMode = options.debug || false;\r\n    this.#app = options.app || null;\r\n    \r\n    // Load Spreedly configuration\r\n    this.#loadConfig();\r\n    \r\n    if (!environmentKey) {\r\n      this.#log('error', 'No environment key provided to SpreedlyManager');\r\n      return;\r\n    }\r\n    \r\n    this.#log('debug', `SpreedlyManager initialized with environment key: ${environmentKey}`);\r\n    this.#initialize();\r\n  }\r\n\r\n  /**\r\n   * Load Spreedly configuration from global config\r\n   */\r\n  #loadConfig() {\r\n    // Default configuration\r\n    this.#config = {\r\n      fieldType: {\r\n        number: 'text',\r\n        cvv: 'text'\r\n      },\r\n      numberFormat: 'prettyFormat',\r\n      placeholder: {\r\n        number: 'Credit Card Number',\r\n        cvv: 'CVV *'\r\n      },\r\n      labels: {\r\n        number: 'Card Number',\r\n        cvv: 'CVV'\r\n      },\r\n      titles: {\r\n        number: 'Credit card number',\r\n        cvv: 'Card verification value'\r\n      },\r\n      styling: {\r\n        number: 'color: #212529; font-size: .925rem; font-weight: 400; width: 100%; height:100%; font-family: system-ui,-apple-system,\"Segoe UI\",Roboto,\"Helvetica Neue\",\"Noto Sans\",\"Liberation Sans\",Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",\"Noto Color Emoji\";',\r\n        cvv: 'color: #212529; font-size: .925rem; font-weight: 400; width: 100%; height: 100%; font-family: system-ui,-apple-system,\"Segoe UI\",Roboto,\"Helvetica Neue\",\"Noto Sans\",\"Liberation Sans\",Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",\"Noto Color Emoji\";'\r\n      },\r\n      placeholder_styling: '',\r\n      required: {\r\n        number: true,\r\n        cvv: true\r\n      },\r\n      autocomplete: true\r\n    };\r\n\r\n    // Merge with global configuration if it exists\r\n    if (window.osConfig && window.osConfig.spreedlyConfig) {\r\n      this.#log('debug', 'Found global Spreedly configuration', window.osConfig.spreedlyConfig);\r\n      \r\n      // Merge field types\r\n      if (window.osConfig.spreedlyConfig.fieldType) {\r\n        this.#config.fieldType = {\r\n          ...this.#config.fieldType,\r\n          ...window.osConfig.spreedlyConfig.fieldType\r\n        };\r\n      }\r\n      \r\n      // Merge number format\r\n      if (window.osConfig.spreedlyConfig.numberFormat) {\r\n        this.#config.numberFormat = window.osConfig.spreedlyConfig.numberFormat;\r\n      }\r\n      \r\n      // Merge placeholders\r\n      if (window.osConfig.spreedlyConfig.placeholder) {\r\n        this.#config.placeholder = {\r\n          ...this.#config.placeholder,\r\n          ...window.osConfig.spreedlyConfig.placeholder\r\n        };\r\n      }\r\n      \r\n      // Merge labels\r\n      if (window.osConfig.spreedlyConfig.labels) {\r\n        this.#config.labels = {\r\n          ...this.#config.labels,\r\n          ...window.osConfig.spreedlyConfig.labels\r\n        };\r\n      }\r\n      \r\n      // Merge titles\r\n      if (window.osConfig.spreedlyConfig.titles) {\r\n        this.#config.titles = {\r\n          ...this.#config.titles,\r\n          ...window.osConfig.spreedlyConfig.titles\r\n        };\r\n      }\r\n      \r\n      // Merge styling\r\n      if (window.osConfig.spreedlyConfig.styling) {\r\n        this.#config.styling = {\r\n          ...this.#config.styling,\r\n          ...window.osConfig.spreedlyConfig.styling\r\n        };\r\n      }\r\n      \r\n      // Merge placeholder styling\r\n      if (window.osConfig.spreedlyConfig.placeholder_styling) {\r\n        this.#config.placeholder_styling = window.osConfig.spreedlyConfig.placeholder_styling;\r\n      }\r\n      \r\n      // Merge required attributes\r\n      if (window.osConfig.spreedlyConfig.required) {\r\n        this.#config.required = {\r\n          ...this.#config.required,\r\n          ...window.osConfig.spreedlyConfig.required\r\n        };\r\n      }\r\n      \r\n      // Merge autocomplete setting\r\n      if (window.osConfig.spreedlyConfig.hasOwnProperty('autocomplete')) {\r\n        this.#config.autocomplete = window.osConfig.spreedlyConfig.autocomplete;\r\n      }\r\n    }\r\n    \r\n    this.#log('debug', 'Spreedly configuration initialized', this.#config);\r\n  }\r\n\r\n  /**\r\n   * Initialize Spreedly\r\n   * Load the script if needed and set up the iframe fields\r\n   */\r\n  #initialize() {\r\n    if (typeof Spreedly === 'undefined') {\r\n      this.#log('debug', 'Spreedly not loaded, loading script...');\r\n      this.#loadScript()\r\n        .then(() => {\r\n          this.#log('debug', 'Spreedly script loaded');\r\n          this.#setupSpreedly();\r\n        })\r\n        .catch(error => {\r\n          this.#log('error', 'Failed to load Spreedly script', error);\r\n          if (this.#onErrorCallback) {\r\n            this.#onErrorCallback(['Failed to load Spreedly. Please refresh the page and try again.']);\r\n          }\r\n        });\r\n    } else {\r\n      this.#log('debug', 'Spreedly already loaded');\r\n      this.#setupSpreedly();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load the Spreedly script\r\n   * @returns {Promise} A promise that resolves when the script is loaded\r\n   */\r\n  #loadScript() {\r\n    return new Promise((resolve, reject) => {\r\n      const script = document.createElement('script');\r\n      script.src = 'https://core.spreedly.com/iframe/iframe-v1.min.js';\r\n      script.async = true;\r\n      script.onload = resolve;\r\n      script.onerror = reject;\r\n      document.head.appendChild(script);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set up Spreedly with the environment key and prepare the iframe fields\r\n   */\r\n  #setupSpreedly() {\r\n    try {\r\n      this.#log('debug', 'Setting up Spreedly...');\r\n      \r\n      // First, prepare the HTML structure for the iframe fields\r\n      this.#prepareHtmlStructure();\r\n      \r\n      // Initialize Spreedly with the environment key\r\n      Spreedly.init(this.#environmentKey, {\r\n        \"numberEl\": \"spreedly-number\",\r\n        \"cvvEl\": \"spreedly-cvv\"\r\n      });\r\n      \r\n      // Set up event listeners\r\n      Spreedly.on('ready', () => {\r\n        this.#log('debug', 'Spreedly iframe ready');\r\n        \r\n        // Apply configuration from the loaded config\r\n        this.#applySpreedlyConfig();\r\n        \r\n        // Mark as ready and call the ready callback if set\r\n        this.#isReady = true;\r\n        if (this.#onReadyCallback) {\r\n          this.#onReadyCallback();\r\n        }\r\n      });\r\n      \r\n      // Set up other event listeners\r\n      this.#setupEventListeners();\r\n      \r\n      this.#log('debug', 'Spreedly setup complete');\r\n    } catch (error) {\r\n      this.#log('error', 'Error setting up Spreedly', error);\r\n      if (this.#onErrorCallback) {\r\n        this.#onErrorCallback(['Failed to set up Spreedly. Please refresh the page and try again.']);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Apply configuration to Spreedly iframe fields\r\n   */\r\n  #applySpreedlyConfig() {\r\n    try {\r\n      this.#log('debug', 'Applying Spreedly configuration...');\r\n      \r\n      // Apply field types\r\n      Spreedly.setFieldType('number', this.#config.fieldType.number);\r\n      Spreedly.setFieldType('cvv', this.#config.fieldType.cvv);\r\n      \r\n      // Apply number format\r\n      Spreedly.setNumberFormat(this.#config.numberFormat);\r\n      \r\n      // Apply placeholders\r\n      Spreedly.setPlaceholder('number', this.#config.placeholder.number);\r\n      Spreedly.setPlaceholder('cvv', this.#config.placeholder.cvv);\r\n      \r\n      // Apply labels\r\n      Spreedly.setLabel('number', this.#config.labels.number);\r\n      Spreedly.setLabel('cvv', this.#config.labels.cvv);\r\n      \r\n      // Apply titles\r\n      Spreedly.setTitle('number', this.#config.titles.number);\r\n      Spreedly.setTitle('cvv', this.#config.titles.cvv);\r\n      \r\n      // Apply styling\r\n      Spreedly.setStyle('number', this.#config.styling.number);\r\n      Spreedly.setStyle('cvv', this.#config.styling.cvv);\r\n      \r\n      // Apply placeholder styling if specified\r\n      if (this.#config.placeholder_styling) {\r\n        Spreedly.setStyle('placeholder', this.#config.placeholder_styling);\r\n      }\r\n      \r\n      // Set required attributes if needed\r\n      if (this.#config.required.number) {\r\n        Spreedly.setRequiredAttribute('number');\r\n      }\r\n      if (this.#config.required.cvv) {\r\n        Spreedly.setRequiredAttribute('cvv');\r\n      }\r\n      \r\n      // Handle autocomplete\r\n      if (!this.#config.autocomplete) {\r\n        Spreedly.toggleAutoComplete();\r\n      }\r\n      \r\n      this.#log('debug', 'Spreedly configuration applied');\r\n    } catch (error) {\r\n      this.#log('error', 'Error applying Spreedly configuration', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Prepare the HTML structure for the iframe fields\r\n   * This uses the existing inputs rather than creating new ones\r\n   */\r\n  #prepareHtmlStructure() {\r\n    try {\r\n      this.#log('debug', 'Preparing HTML structure for Spreedly iframe fields');\r\n      \r\n      // Find the existing input containers\r\n      const numberField = document.querySelector('[os-checkout-field=\"cc-number\"]');\r\n      const cvvField = document.querySelector('[os-checkout-field=\"cvv\"]');\r\n      \r\n      if (!numberField || !cvvField) {\r\n        this.#log('error', 'Could not find credit card fields');\r\n        return;\r\n      }\r\n      \r\n      // Simply use the IDs of the existing fields\r\n      numberField.id = 'spreedly-number';\r\n      cvvField.id = 'spreedly-cvv';\r\n      \r\n      // Make sure the fields are set up for the iframe\r\n      numberField.setAttribute('data-spreedly', 'number');\r\n      cvvField.setAttribute('data-spreedly', 'cvv');\r\n      \r\n      this.#log('debug', 'HTML structure prepared for Spreedly iframe fields - using existing DOM elements');\r\n    } catch (error) {\r\n      this.#log('error', 'Error preparing HTML structure for Spreedly iframe fields', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set up event listeners for Spreedly events\r\n   */\r\n  #setupEventListeners() {\r\n    // Listen for validation errors\r\n    Spreedly.on('errors', (errors) => {\r\n      this.#log('error', 'Spreedly validation errors:', errors);\r\n      \r\n      // Format error messages\r\n      const errorMessages = errors.map(error => error.message);\r\n      \r\n      // Call the error callback if set\r\n      if (this.#onErrorCallback) {\r\n        this.#onErrorCallback(errorMessages);\r\n      }\r\n      \r\n      // Show errors on the form\r\n      this.#showErrors(errors);\r\n    });\r\n    \r\n    // Listen for successful payment method creation\r\n    Spreedly.on('paymentMethod', (token, pmData) => {\r\n      this.#log('debug', 'Spreedly payment method created:', token);\r\n      \r\n      // Clear any existing errors\r\n      this.clearAllErrors();\r\n      \r\n      // Call the payment method callback if set\r\n      if (this.#onPaymentMethodCallback) {\r\n        this.#onPaymentMethodCallback(token, pmData);\r\n      }\r\n    });\r\n    \r\n    // Listen for field validation events\r\n    Spreedly.on('validation', (result) => {\r\n      this.#log('debug', 'Spreedly field validation:', result);\r\n      \r\n      // Clear any existing error for this field\r\n      this.#clearFieldError(result.fieldType);\r\n      \r\n      // Call the validation callback if set\r\n      if (this.#onValidationCallback) {\r\n        this.#onValidationCallback(result);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Show errors on the form\r\n   * @param {Array} errors - Array of error objects from Spreedly\r\n   */\r\n  #showErrors(errors) {\r\n    errors.forEach(error => {\r\n      const fieldType = error.attribute;\r\n      let field = null;\r\n      \r\n      // Map Spreedly field types to our fields\r\n      if (fieldType === 'number' || fieldType === 'card_number') {\r\n        field = document.getElementById('spreedly-number');\r\n      } else if (fieldType === 'cvv') {\r\n        field = document.getElementById('spreedly-cvv');\r\n      } else if (fieldType === 'month' || fieldType === 'year') {\r\n        // Find the month/year select elements\r\n        field = document.querySelector(`[os-checkout-field=\"cc-${fieldType}\"]`) || \r\n               document.querySelector(`[os-checkout-field=\"exp-${fieldType}\"]`) || \r\n               document.querySelector(`#credit_card_exp_${fieldType}`);\r\n      } else if (fieldType === 'full_name' || fieldType === 'first_name' || fieldType === 'last_name') {\r\n        field = document.querySelector('[os-checkout-field=\"cc-name\"]');\r\n      }\r\n      \r\n      if (field) {\r\n        // Add error class to the field\r\n        field.classList.add('error');\r\n        \r\n        // Find the parent wrapper\r\n        const wrapper = field.closest('.frm-flds') || field.parentElement;\r\n        \r\n        // Create or update error message\r\n        let errorElement = wrapper.querySelector('.pb-input-error');\r\n        if (!errorElement) {\r\n          errorElement = document.createElement('div');\r\n          errorElement.className = 'pb-input-error';\r\n          wrapper.appendChild(errorElement);\r\n        }\r\n        \r\n        // Set error message and style\r\n        errorElement.textContent = error.message;\r\n        errorElement.style.color = 'red';\r\n        errorElement.style.fontSize = '0.875rem';\r\n        errorElement.style.marginTop = '0.25rem';\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Clear error for a specific field\r\n   * @param {string} fieldType - The field type (number, cvv, etc.)\r\n   */\r\n  #clearFieldError(fieldType) {\r\n    let field = null;\r\n    \r\n    // Map Spreedly field types to our fields\r\n    if (fieldType === 'number' || fieldType === 'card_number') {\r\n      field = document.getElementById('spreedly-number');\r\n    } else if (fieldType === 'cvv') {\r\n      field = document.getElementById('spreedly-cvv');\r\n    }\r\n    \r\n    if (field) {\r\n      // Remove error class from the field\r\n      field.classList.remove('error');\r\n      \r\n      // Find the parent wrapper\r\n      const wrapper = field.closest('.frm-flds') || field.parentElement;\r\n      \r\n      // Remove error message if it exists\r\n      const errorElement = wrapper.querySelector('.pb-input-error');\r\n      if (errorElement) {\r\n        errorElement.remove();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all errors\r\n   */\r\n  clearAllErrors() {\r\n    // Clear errors for number field\r\n    this.#clearFieldError('number');\r\n    \r\n    // Clear errors for CVV field\r\n    this.#clearFieldError('cvv');\r\n    \r\n    // Clear errors for month/year fields\r\n    const monthField = document.querySelector('[os-checkout-field=\"cc-month\"]') || \r\n                      document.querySelector('[os-checkout-field=\"exp-month\"]') || \r\n                      document.querySelector('#credit_card_exp_month');\r\n    const yearField = document.querySelector('[os-checkout-field=\"cc-year\"]') || \r\n                     document.querySelector('[os-checkout-field=\"exp-year\"]') || \r\n                     document.querySelector('#credit_card_exp_year');\r\n    \r\n    if (monthField) {\r\n      monthField.classList.remove('error');\r\n      const monthWrapper = monthField.closest('.frm-flds') || monthField.parentElement;\r\n      const monthError = monthWrapper.querySelector('.pb-input-error');\r\n      if (monthError) monthError.remove();\r\n    }\r\n    \r\n    if (yearField) {\r\n      yearField.classList.remove('error');\r\n      const yearWrapper = yearField.closest('.frm-flds') || yearField.parentElement;\r\n      const yearError = yearWrapper.querySelector('.pb-input-error');\r\n      if (yearError) yearError.remove();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Tokenize a credit card\r\n   * @param {Object} cardData - The card data to tokenize\r\n   * @param {string} cardData.full_name - The cardholder name\r\n   * @param {string} cardData.month - The expiration month (2 digits)\r\n   * @param {string} cardData.year - The expiration year (4 digits)\r\n   */\r\n  tokenizeCard(cardData) {\r\n    this.#log('debug', 'Tokenizing card with data:', {\r\n      ...cardData,\r\n      full_name: cardData.full_name,\r\n      month: cardData.month,\r\n      year: cardData.year\r\n    });\r\n    \r\n    // Clear any existing errors\r\n    this.clearAllErrors();\r\n    \r\n    // Validate required fields\r\n    if (!cardData.full_name || !cardData.month || !cardData.year) {\r\n      this.#log('error', 'Missing required card data');\r\n      \r\n      const errors = [];\r\n      if (!cardData.full_name) errors.push({ attribute: 'full_name', message: 'Cardholder name is required' });\r\n      if (!cardData.month) errors.push({ attribute: 'month', message: 'Expiration month is required' });\r\n      if (!cardData.year) errors.push({ attribute: 'year', message: 'Expiration year is required' });\r\n      \r\n      this.#showErrors(errors);\r\n      \r\n      if (this.#onErrorCallback) {\r\n        this.#onErrorCallback(errors.map(e => e.message));\r\n      }\r\n      \r\n      return;\r\n    }\r\n    \r\n    // Check if Spreedly is ready\r\n    if (!this.#isReady) {\r\n      this.#log('error', 'Spreedly is not ready yet');\r\n      \r\n      if (this.#onErrorCallback) {\r\n        this.#onErrorCallback(['Payment system is not ready yet. Please try again in a moment.']);\r\n      }\r\n      \r\n      return;\r\n    }\r\n    \r\n    // Tokenize the card\r\n    try {\r\n      Spreedly.tokenizeCreditCard(cardData);\r\n      this.#log('debug', 'Card tokenization initiated');\r\n    } catch (error) {\r\n      this.#log('error', 'Error tokenizing card', error);\r\n      \r\n      if (this.#onErrorCallback) {\r\n        this.#onErrorCallback(['An error occurred while processing your card. Please try again.']);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set a callback to be called when Spreedly is ready\r\n   * @param {Function} callback - The callback function\r\n   */\r\n  setOnReady(callback) {\r\n    this.#onReadyCallback = callback;\r\n    \r\n    // If already ready, call the callback immediately\r\n    if (this.#isReady && callback) {\r\n      callback();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set a callback to be called when Spreedly encounters an error\r\n   * @param {Function} callback - The callback function\r\n   */\r\n  setOnError(callback) {\r\n    this.#onErrorCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Set a callback to be called when a payment method is created\r\n   * @param {Function} callback - The callback function\r\n   */\r\n  setOnPaymentMethod(callback) {\r\n    this.#onPaymentMethodCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Set a callback to be called when a field is validated\r\n   * @param {Function} callback - The callback function\r\n   */\r\n  setOnValidation(callback) {\r\n    this.#onValidationCallback = callback;\r\n  }\r\n\r\n  /**\r\n   * Log a message with the specified level\r\n   * @param {string} level - The log level (debug, info, warn, error)\r\n   * @param {string} message - The message to log\r\n   * @param {*} data - Additional data to log\r\n   */\r\n  #log(level, message, data) {\r\n    if (this.#debugMode || level === 'error') {\r\n      const prefix = '[SpreedlyManager]';\r\n      \r\n      if (data) {\r\n        console[level](`${prefix} ${message}`, data);\r\n      } else {\r\n        console[level](`${prefix} ${message}`);\r\n      }\r\n    }\r\n  }\r\n}  ", "/**\n * KonamiCodeHandler - Utility class for handling the Konami code Easter egg\n * \n * This class provides functionality for detecting the Konami code sequence\n * and triggering a test order with predefined data.\n */\n\nexport class KonamiCodeHandler {\n  #konamiCodeSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];\n  #konamiCodePosition = 0;\n  #indicatorTimeout;\n  #indicator;\n  #logger;\n  #callback;\n  \n  /**\n   * Create a new KonamiCodeHandler instance\n   * @param {Object} options - Configuration options\n   * @param {Function} options.callback - Function to call when Konami code is detected\n   * @param {Object} options.logger - Logger instance for logging\n   */\n  constructor({ callback, logger } = {}) {\n    this.#logger = logger;\n    this.#callback = callback;\n    this.#createIndicator();\n    this.#initListener();\n    \n    if (this.#logger) {\n      this.#logger.debug('KonamiCodeHandler initialized');\n    }\n  }\n  \n  /**\n   * Create the visual indicator element\n   * @private\n   */\n  #createIndicator() {\n    this.#indicator = document.createElement('div');\n    this.#indicator.style.position = 'fixed';\n    this.#indicator.style.bottom = '10px';\n    this.#indicator.style.right = '10px';\n    this.#indicator.style.background = 'rgba(0, 0, 0, 0.7)';\n    this.#indicator.style.color = '#fff';\n    this.#indicator.style.padding = '5px 10px';\n    this.#indicator.style.borderRadius = '5px';\n    this.#indicator.style.fontFamily = 'monospace';\n    this.#indicator.style.fontSize = '12px';\n    this.#indicator.style.zIndex = '9999';\n    this.#indicator.style.display = 'none';\n    this.#indicator.textContent = 'Konami: 0/' + this.#konamiCodeSequence.length;\n    document.body.appendChild(this.#indicator);\n  }\n  \n  /**\n   * Initialize the keydown event listener\n   * @private\n   */\n  #initListener() {\n    document.addEventListener('keydown', (e) => {\n      // Check if the pressed key matches the next key in the sequence\n      if (e.key === this.#konamiCodeSequence[this.#konamiCodePosition]) {\n        // Move to the next position in the sequence\n        this.#konamiCodePosition++;\n        \n        // Only show the indicator after the first 4 keystrokes (up, up, down, down)\n        if (this.#konamiCodePosition >= 4) {\n          this.#indicator.style.display = 'block';\n          this.#indicator.textContent = `Konami: ${this.#konamiCodePosition}/${this.#konamiCodeSequence.length}`;\n        }\n        \n        // If we've reached the end of the sequence, trigger the callback\n        if (this.#konamiCodePosition === this.#konamiCodeSequence.length) {\n          if (this.#callback) {\n            this.#callback();\n          }\n          \n          // Reset the position for next time\n          this.#konamiCodePosition = 0;\n          \n          // Hide the indicator\n          setTimeout(() => {\n            this.#indicator.style.display = 'none';\n          }, 500);\n        }\n        \n        // Hide the indicator after a delay if not completed\n        if (this.#konamiCodePosition >= 4) {\n          clearTimeout(this.#indicatorTimeout);\n          this.#indicatorTimeout = setTimeout(() => {\n            this.#indicator.style.display = 'none';\n          }, 3000);\n        }\n      } else {\n        // Reset the position if the wrong key is pressed\n        if (this.#konamiCodePosition > 0) {\n          this.#konamiCodePosition = 0;\n          \n          // Only hide the indicator if it's currently shown\n          if (this.#indicator.style.display === 'block') {\n            this.#indicator.textContent = `Konami: 0/${this.#konamiCodeSequence.length}`;\n            \n            // Hide the indicator after a delay\n            clearTimeout(this.#indicatorTimeout);\n            this.#indicatorTimeout = setTimeout(() => {\n              this.#indicator.style.display = 'none';\n            }, 1500);\n          }\n        }\n      }\n    });\n  }\n  \n  /**\n   * Set Konami code test mode in session storage\n   * This can be used by other components to detect when Konami code is active\n   */\n  static setTestMode() {\n    sessionStorage.setItem('konami_test_mode', 'true');\n    return true;\n  }\n  \n  /**\n   * Check if Konami code test mode is active\n   * @returns {boolean} True if Konami code test mode is active\n   */\n  static isTestMode() {\n    return sessionStorage.getItem('konami_test_mode') === 'true';\n  }\n  \n  /**\n   * Clear Konami code test mode from session storage\n   */\n  static clearTestMode() {\n    sessionStorage.removeItem('konami_test_mode');\n  }\n  \n  /**\n   * Get predefined test order data for Konami code test mode\n   * @param {Object} state - Application state\n   * @param {Function} getPackageIdFromUrl - Function to get package ID from URL\n   * @param {Function} getCartLines - Function to get cart lines\n   * @returns {Object} Test order data\n   */\n  static getTestOrderData(state, getPackageIdFromUrl, getCartLines) {\n    try {\n      // Get cart items from the app state\n      const cartItems = state?.cart?.items || [];\n      \n      // If cart is empty, create a dummy item\n      const packageId = getPackageIdFromUrl ? getPackageIdFromUrl() : 1;\n      const lines = cartItems.length > 0 && getCartLines ? \n        getCartLines(cartItems) : \n        [{ package_id: packageId || 1, quantity: 1 }];\n      \n      // Create a complete test order data object\n      return {\n        user: {\n          email: 'test@test.com',\n          first_name: 'Test',\n          last_name: 'Order'\n        },\n        shipping_address: {\n          first_name: 'Test',\n          last_name: 'Order',\n          line1: 'Test Address 123',\n          line2: '',\n          line3: '',\n          line4: 'Tempe',\n          state: 'AZ',\n          postcode: '85281',\n          country: 'US',\n          phone_number: '+14807581224'\n        },\n        billing_address: {\n          first_name: 'Test',\n          last_name: 'Order',\n          line1: 'Test Address 123',\n          line2: '',\n          line3: '',\n          line4: 'Tempe',\n          state: 'AZ',\n          postcode: '85281',\n          country: 'US',\n          phone_number: '+14807581224'\n        },\n        shipping_method: 1,\n        attribution: state?.cart?.attribution || {},\n        lines: lines,\n        // Don't include payment-related fields here as they'll be added by the payment handler\n        success_url: window.location.origin + '/checkout/confirmation/'\n      };\n    } catch (error) {\n      console.error('Error getting Konami test order data:', error);\n      return null;\n    }\n  }\n  \n  /**\n   * Show a message to the user when Konami code is activated\n   * @returns {HTMLElement} The message element\n   */\n  static showActivationMessage() {\n    const messageElement = document.createElement('div');\n    messageElement.style.position = 'fixed';\n    messageElement.style.top = '50%';\n    messageElement.style.left = '50%';\n    messageElement.style.transform = 'translate(-50%, -50%)';\n    messageElement.style.background = 'rgba(0, 0, 0, 0.8)';\n    messageElement.style.color = '#fff';\n    messageElement.style.padding = '20px';\n    messageElement.style.borderRadius = '10px';\n    messageElement.style.zIndex = '9999';\n    messageElement.style.textAlign = 'center';\n    messageElement.style.fontFamily = 'monospace';\n    messageElement.style.fontSize = '18px';\n    messageElement.innerHTML = `\n      <h3>🎮 KONAMI CODE ACTIVATED! 🎮</h3>\n      <p>Creating test order with predefined data:</p>\n      <p style=\"font-size: 14px; margin-top: 10px; text-align: left;\">\n        Email: test@test.com<br>\n        Name: Test Order<br>\n        Address: Test Address 123<br>\n        City: Tempe, AZ 85281<br>\n        Country: US<br>\n        Phone: +14807581224<br>\n        Card: 4111111111111111 (test mode)\n      </p>\n    `;\n    document.body.appendChild(messageElement);\n    return messageElement;\n  }\n} ", "/**\n * PaymentHandler - Handles payment processing for checkout\n */\nimport { SpreedlyManager } from '../../managers/SpreedlyManager.js';\nimport { FormValidator } from './FormValidator.js';\nimport { KonamiCodeHandler } from '../../utils/KonamiCodeHandler.js';\n\nexport class PaymentHandler {\n  #apiClient;\n  #logger;\n  #app;\n  #form;\n  #spreedlyManager = null;\n  #formValidator = null;\n  #paymentMethod = 'credit-card';\n  #isProcessing = false;\n  #debugMode = false;\n  #testCards = {\n    visa: '4111111111111111',\n    mastercard: '5555555555554444',\n    amex: '378282246310005',\n    discover: '6011111111111117'\n  };\n  #expressCheckoutButtons = {\n    paypal: null,\n    applePay: null,\n    googlePay: null\n  };\n  #deviceSupport = {\n    applePay: false,\n    googlePay: false\n  };\n\n  constructor(apiClient, logger, app) {\n    this.#apiClient = apiClient;\n    this.#logger = logger;\n    this.#app = app;\n    this.#form = this.#getCheckoutForm();\n\n    if (!this.#form) return;\n\n    this.#setupFormPrevention();\n    this.#setupCheckoutButton();\n    \n    this.#formValidator = new FormValidator({ \n      debugMode: this.#debugMode,\n      logger: this.#logger\n    });\n    this.#form.__formValidator = this.#formValidator;\n\n    this.#initPaymentMethods();\n    this.#initSpreedly();\n    this.#initExpressCheckout();\n    this.#checkForPaymentFailedParameters();\n  }\n\n  #getCheckoutForm() {\n    const form = document.querySelector('form[os-checkout=\"form\"]') || document.querySelector('form#combo_form');\n    if (!form) {\n      this.#safeLog('warn', 'No checkout form found');\n    }\n    return form;\n  }\n\n  #setupFormPrevention() {\n    this.#form.removeAttribute('action');\n    this.#form.setAttribute('method', 'post');\n    \n    const hiddenInput = document.createElement('input');\n    hiddenInput.type = 'hidden';\n    hiddenInput.name = 'prevent_serialization';\n    hiddenInput.value = 'true';\n    this.#form.appendChild(hiddenInput);\n\n    this.#form.addEventListener('submit', this.#preventFormSubmission.bind(this), true);\n    this.#form.onsubmit = this.#preventFormSubmission.bind(this);\n    this.#convertSubmitButtons();\n  }\n\n  #preventFormSubmission(e) {\n    if (e) {\n      e.preventDefault();\n      e.stopPropagation();\n      e.stopImmediatePropagation();\n    }\n    \n    this.#form.removeAttribute('action');\n    this.#form.setAttribute('method', 'post');\n    window.stop?.();\n    \n    this.#safeLog('debug', 'Form submission prevented');\n    return false;\n  }\n\n  #convertSubmitButtons() {\n    try {\n      const submitButtons = this.#form.querySelectorAll('button[type=\"submit\"], input[type=\"submit\"]');\n      submitButtons.forEach((button, index) => {\n        button.setAttribute('type', 'button');\n        button.addEventListener('click', (e) => {\n          e.preventDefault();\n          this.#safeLog('debug', `Submit button ${index + 1} clicked`);\n          this.processPayment();\n        });\n      });\n    } catch (error) {\n      this.#safeLog('error', 'Error converting submit buttons:', error);\n    }\n  }\n\n  #setupCheckoutButton() {\n    const checkoutButton = document.querySelector('[os-checkout-payment=\"combo\"]');\n    if (!checkoutButton) {\n      this.#safeLog('warn', 'Checkout button not found');\n      return;\n    }\n\n    const newButton = checkoutButton.cloneNode(true);\n    checkoutButton.parentNode.replaceChild(newButton, checkoutButton);\n    \n    newButton.addEventListener('click', (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      e.stopImmediatePropagation();\n      \n      this.#form.onsubmit = this.#preventFormSubmission.bind(this);\n      this.#form.removeAttribute('action');\n      this.#form.setAttribute('method', 'post');\n      \n      this.#safeLog('debug', 'Checkout button clicked');\n      setTimeout(() => this.processPayment(), 0);\n    });\n  }\n\n  #safeLog(level, message, ...args) {\n    try {\n      const logFn = this.#logger?.[level] || console[level] || console.log;\n      logFn.call(console, `[${level.toUpperCase()}] ${message}`, ...args);\n    } catch (error) {\n      console.error('Error logging:', error);\n    }\n  }\n\n  #initPaymentMethods() {\n    try {\n      const paymentMethodSelector = document.querySelector('[os-checkout-field=\"payment-method\"]') || \n                                   document.querySelector('input[name=\"combo_mode\"]:checked');\n      if (!paymentMethodSelector) {\n        this.#safeLog('warn', 'Payment method selector not found');\n        return;\n      }\n\n      this.#paymentMethod = paymentMethodSelector.value || 'credit-card';\n      this.#setupPaymentMethodListeners();\n    } catch (error) {\n      this.#safeLog('error', 'Error initializing payment methods:', error);\n    }\n  }\n\n  #setupPaymentMethodListeners() {\n    const radioButtons = document.querySelectorAll('input[name=\"combo_mode\"]');\n    const handler = (e) => {\n      this.#paymentMethod = e.target.value;\n      this.#safeLog('debug', `Payment method changed to: ${this.#paymentMethod}`);\n      document.dispatchEvent(new CustomEvent('payment-method-changed', {\n        detail: { mode: this.#paymentMethod }\n      }));\n    };\n\n    if (radioButtons.length > 0) {\n      radioButtons.forEach(radio => radio.addEventListener('change', handler));\n    } else {\n      document.querySelector('[os-checkout-field=\"payment-method\"]')\n        ?.addEventListener('change', handler);\n    }\n  }\n\n  #initSpreedly() {\n    try {\n      const environmentKey = document.querySelector('meta[name=\"spreedly-environment-key\"]')?.content ||\n                            document.querySelector('meta[name=\"os-payment-env-key\"]')?.content;\n      if (!environmentKey) {\n        this.#safeLog('warn', 'Spreedly environment key not found');\n        return;\n      }\n\n      this.#spreedlyManager = new SpreedlyManager(environmentKey, { \n        debug: this.#debugMode,\n        app: this.#app\n      });\n      this.#setupSpreedlyCallbacks();\n      this.#initializeExpirationFields();\n    } catch (error) {\n      this.#safeLog('error', 'Error initializing Spreedly:', error);\n    }\n  }\n\n  #setupSpreedlyCallbacks() {\n    this.#spreedlyManager.setOnReady(() => this.#safeLog('debug', 'Spreedly ready'));\n    this.#spreedlyManager.setOnError((errors) => {\n      this.#safeLog('error', 'Spreedly errors:', errors);\n      this.#isProcessing = false;\n      this.#hideProcessingState();\n      \n      // Map Spreedly validation errors to user-friendly messages\n      const errorMessage = this.#formatSpreedlyErrors(errors);\n      this.#handlePaymentError(errorMessage);\n    });\n    this.#spreedlyManager.setOnPaymentMethod((token, pmData) => {\n      this.#safeLog('debug', 'Spreedly payment method token received:', token);\n      this.#createOrder({\n        payment_token: token,\n        payment_method: 'credit-card',\n        ...this.#getOrderData()\n      });\n    });\n  }\n\n  #formatSpreedlyErrors(errors) {\n    if (!errors || errors.length === 0) {\n      return 'An unknown error occurred with your payment method';\n    }\n    \n    // Map common Spreedly error messages to user-friendly messages\n    const errorMap = {\n      'The card number is not a valid credit card number': 'Please enter a valid credit card number',\n      'Credit card number entered is not valid': 'Please enter a valid credit card number',\n      'The card number is too short': 'The card number you entered is too short',\n      'The card number is too long': 'The card number you entered is too long',\n      'The card security code is invalid': 'Please enter a valid security code (CVV)',\n      'The card security code is too short': 'The security code (CVV) is too short',\n      'The card security code is too long': 'The security code (CVV) is too long',\n      'The card has expired': 'This card has expired. Please use a different card',\n      'The card expiration month is invalid': 'Please select a valid expiration month',\n      'The card expiration year is invalid': 'Please select a valid expiration year'\n    };\n    \n    // Check if any of the errors match our map\n    for (const error of errors) {\n      for (const [key, value] of Object.entries(errorMap)) {\n        if (error.includes(key)) {\n          return value;\n        }\n      }\n    }\n    \n    // If no specific mapping, return the first error\n    return errors[0];\n  }\n\n  #initializeExpirationFields() {\n    try {\n      const [monthSelect, yearSelect] = this.#getExpirationElements();\n      this.#populateExpirationOptions(monthSelect, yearSelect);\n    } catch (error) {\n      this.#safeLog('error', 'Error initializing expiration fields:', error);\n    }\n  }\n\n  #getExpirationElements() {\n    const monthSelectors = ['[os-checkout-field=\"cc-month\"]', '[os-checkout-field=\"exp-month\"]', '#credit_card_exp_month'];\n    const yearSelectors = ['[os-checkout-field=\"cc-year\"]', '[os-checkout-field=\"exp-year\"]', '#credit_card_exp_year'];\n    \n    return [\n      monthSelectors.map(s => document.querySelector(s)).find(Boolean),\n      yearSelectors.map(s => document.querySelector(s)).find(Boolean)\n    ];\n  }\n\n  #populateExpirationOptions(monthSelect, yearSelect) {\n    if (monthSelect) {\n      monthSelect.innerHTML = '<option value=\"\">Month</option>';\n      for (let i = 1; i <= 12; i++) {\n        const month = i.toString().padStart(2, '0');\n        monthSelect.appendChild(new Option(month, month));\n      }\n    }\n\n    if (yearSelect) {\n      yearSelect.innerHTML = '<option value=\"\">Year</option>';\n      const currentYear = new Date().getFullYear();\n      for (let i = 0; i < 20; i++) {\n        const year = currentYear + i;\n        yearSelect.appendChild(new Option(year, year));\n      }\n    }\n  }\n\n  #isTestMode() {\n    // Check for URL parameter or Konami code flag in sessionStorage\n    return new URLSearchParams(window.location.search).get('test') === 'true' || \n           KonamiCodeHandler.isTestMode();\n  }\n\n  /**\n   * Set Konami code test mode flag\n   * This method can be called from CheckoutManager when Konami code is activated\n   */\n  setKonamiTestMode() {\n    KonamiCodeHandler.setTestMode();\n    this.#safeLog('info', '🎮 Konami code test mode activated');\n    return true;\n  }\n\n  processPayment() {\n    // Check if Konami code test mode is active and clear it after use\n    const isKonamiMode = KonamiCodeHandler.isTestMode();\n    if (isKonamiMode) {\n      KonamiCodeHandler.clearTestMode();\n      this.#safeLog('info', '🎮 Processing payment in Konami test mode');\n    }\n\n    if (this.#isProcessing) {\n      this.#safeLog('warn', 'Payment already processing');\n      return;\n    }\n\n    // Clear any previous errors before starting a new payment attempt\n    this.#clearPaymentErrors();\n\n    this.#enforceFormPrevention();\n    this.#isProcessing = true;\n    this.#safeLog('debug', `Processing payment with method: ${this.#paymentMethod}`);\n\n    try {\n      // If in Konami mode, bypass validation and use predefined test data\n      if (isKonamiMode) {\n        this.#showProcessingState();\n        \n        // Get order data using predefined test data\n        const orderData = KonamiCodeHandler.getTestOrderData(\n          this.#app?.state?.getState(),\n          this.#getPackageIdFromUrl.bind(this),\n          this.#getCartLines.bind(this)\n        );\n          \n        if (!orderData) {\n          this.#hideProcessingState();\n          return;\n        }\n        \n        // Create the order with test payment details using the specific test card\n        this.#createOrder({\n          ...orderData,\n          payment_detail: { \n            payment_method: 'card_token', \n            card_token: 'test_card',\n            test_card_number: '6011111111111117' // Use specific test card for Konami mode\n          }\n        });\n        return;\n      }\n      \n      // Regular payment flow (including test mode)\n      if (!this.#formValidator.validateAllFields(this.#paymentMethod)) {\n        this.#isProcessing = false;\n        this.#hideProcessingState();\n        return;\n      }\n\n      this.#showProcessingState();\n      const orderData = this.#getOrderData();\n      if (!orderData) return;\n\n      // If in test mode, bypass Spreedly validation and use test card token\n      if (this.#isTestMode()) {\n        this.#createOrder({\n          ...orderData,\n          payment_detail: { \n            payment_method: 'card_token', \n            card_token: 'test_card' // Use test_card token for test mode\n          }\n        });\n        return;\n      }\n\n      switch (this.#paymentMethod) {\n        case 'credit-card':\n        case 'credit':\n          this.#processCreditCard();\n          break;\n        case 'paypal':\n          this.#processPaypal();\n          break;\n        default:\n          this.#handlePaymentError(`Unknown payment method: ${this.#paymentMethod}`);\n      }\n    } catch (error) {\n      this.#safeLog('error', 'Error processing payment:', error);\n      this.#handlePaymentError('Unexpected error occurred');\n      this.#hideProcessingState();\n    }\n  }\n\n  #enforceFormPrevention() {\n    this.#form?.removeAttribute('action');\n    this.#form?.setAttribute('method', 'post');\n    this.#form.onsubmit = this.#preventFormSubmission.bind(this);\n    this.#form?.querySelectorAll('button[type=\"submit\"], input[type=\"submit\"]')\n      .forEach(btn => {\n        btn.disabled = true;\n        btn.setAttribute('type', 'button');\n      });\n  }\n\n  #showProcessingState() {\n    const submitButton = document.querySelector('[os-checkout-payment=\"combo\"]');\n    if (submitButton) {\n      submitButton.disabled = true;\n      submitButton.classList.add('is-submitting');\n    }\n  }\n\n  #hideProcessingState() {\n    const submitButton = document.querySelector('[os-checkout-payment=\"combo\"]');\n    if (submitButton) {\n      submitButton.disabled = false;\n      submitButton.classList.remove('is-submitting');\n    }\n    this.#isProcessing = false;\n  }\n\n  #processCreditCard() {\n    if (!this.#spreedlyManager) {\n      this.#handlePaymentError('Credit card processing unavailable');\n      return;\n    }\n  \n    const [fullName, month, year] = this.#getCreditCardFields();\n  \n    // If we're in debug test card mode or regular test mode, use test card flow\n    if (this.#isDebugTestCardMode() || this.#isTestMode()) {\n      this.#processTestCard(fullName, month, year);\n      return;\n    }\n  \n    // Validate credit card fields using the FormValidator\n    if (!this.#formValidator.validateCreditCard()) {\n      this.#safeLog('debug', 'Credit card validation failed on initial check');\n      if (!month || !year) {\n        this.#isProcessing = false;\n        this.#hideProcessingState();\n        return;\n      }\n    }\n  \n    // Proceed with tokenization\n    this.#spreedlyManager.tokenizeCard({ \n      full_name: fullName || '', \n      month, \n      year \n    });\n\n    // Add callback to log tokenization results\n    this.#spreedlyManager.setOnPaymentMethod((token, pmData) => {\n    //   console.log('Card tokenization successful:', {\n    //     token,\n    //     paymentMethodData: pmData,\n    //     cardholderName: fullName,\n    //     expirationMonth: month,\n    //     expirationYear: year\n    //   });\n      \n      // Comment out order creation\n      this.#createOrder({\n        payment_token: token,\n        payment_method: 'credit-card',\n        ...this.#getOrderData()\n      });\n    });\n  }\n\n  #getCreditCardFields() {\n    // Check if billing address is different from shipping\n    const isDifferentBilling = !this.#formValidator.isSameAsShipping();\n    \n    // Get first and last name from the appropriate form (billing or shipping)\n    const firstName = document.querySelector(`[os-checkout-field=\"${isDifferentBilling ? 'billing-fname' : 'fname'}\"]`)?.value || '';\n    const lastName = document.querySelector(`[os-checkout-field=\"${isDifferentBilling ? 'billing-lname' : 'lname'}\"]`)?.value || '';\n    \n    // Capitalize the names\n    const capitalize = (str) => str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n    const fullName = `${capitalize(firstName)} ${capitalize(lastName)}`.trim();\n    \n    return [\n      fullName,\n      document.querySelector('[os-checkout-field=\"cc-month\"]')?.value || \n      document.querySelector('[os-checkout-field=\"exp-month\"]')?.value || \n      document.querySelector('#credit_card_exp_month')?.value || '',\n      document.querySelector('[os-checkout-field=\"cc-year\"]')?.value || \n      document.querySelector('[os-checkout-field=\"exp-year\"]')?.value || \n      document.querySelector('#credit_card_exp_year')?.value || ''\n    ];\n  }\n\n  #isDebugTestCardMode() {\n    const params = new URLSearchParams(window.location.search);\n    return (this.#debugMode || params.get('debug') === 'true') && params.has('test-card');\n  }\n\n  #processTestCard(fullName, month, year) {\n    // Get the actual card number from the input field\n    const cardNumber = document.querySelector('[os-checkout-field=\"cc-number\"]')?.value || \n                      document.querySelector('#credit_card_number')?.value;\n    \n    if (!cardNumber) {\n      this.#handlePaymentError('Please enter a credit card number');\n      return;\n    }\n\n    // Create a test token with the actual card number\n    this.#createOrder({\n      payment_token: `test_card_token_${Date.now()}`,\n      payment_method: 'credit-card',\n      test_card_number: cardNumber,\n      ...this.#getOrderData()\n    });\n  }\n\n  #processPaypal() {\n    this.#createOrder({\n      payment_method: 'paypal',\n      ...this.#getOrderData()\n    });\n  }\n\n  #getPackageIdFromUrl() {\n    const params = new URLSearchParams(window.location.search);\n    const id = params.get('package_id') || params.get('pid');\n    return id ? parseInt(id, 10) || null : null;\n  }\n\n  #getOrderData() {\n    try {\n      const shippingData = this.#getAddressData(['fname', 'lname', 'address1', 'address2', 'city', 'province', 'postal', 'country', 'phone']);\n      const billingData = this.#formValidator.isSameAsShipping() ? null : \n        this.#getAddressData(['billing-fname', 'billing-lname', 'billing-address1', 'billing-address2', 'billing-city', 'billing-province', 'billing-postal', 'billing-country', 'billing-phone']);\n\n      const shippingAddress = this.#formatAddress(shippingData);\n      const billingAddress = billingData ? this.#formatAddress(billingData) : { ...shippingAddress };\n\n      if (!this.#app?.state) {\n        this.#handlePaymentError('Cart data missing');\n        return null;\n      }\n\n      const state = this.#app.state.getState();\n      if (!state.cart?.items?.length) {\n        this.#handlePaymentError('Cart is empty');\n        return null;\n      }\n\n      return {\n        user: {\n          email: state.user?.email || '',\n          first_name: state.user?.firstName || shippingAddress.first_name,\n          last_name: state.user?.lastName || shippingAddress.last_name\n        },\n        shipping_address: shippingAddress,\n        billing_address: billingAddress,\n        shipping_method: this.#getShippingMethod(state),\n        attribution: state.cart.attribution || {},\n        lines: this.#getCartLines(state.cart.items)\n      };\n    } catch (error) {\n      this.#safeLog('error', 'Error getting order data:', error);\n      this.#handlePaymentError('Error preparing order');\n      return null;\n    }\n  }\n\n  #getAddressData(fields) {\n    const data = {};\n    fields.forEach(field => {\n      const value = document.querySelector(`[os-checkout-field=\"${field}\"]`)?.value;\n      if (value) data[field.replace('billing-', '')] = value;\n    });\n    return data;\n  }\n\n  #formatAddress(data) {\n    return {\n      first_name: data.fname || '',\n      last_name: data.lname || '',\n      line1: data.address1 || '',\n      line2: data.address2 || '',\n      line3: '',\n      line4: data.city || '',\n      state: data.province || '',\n      postcode: data.postal || '',\n      country: data.country || '',\n      phone_number: data.phone || ''\n    };\n  }\n\n  #getShippingMethod(state) {\n    const method = state.cart?.shippingMethod;\n    return typeof method === 'number' ? method : \n           parseInt(method, 10) || 1;\n  }\n\n  #getCartLines(items) {\n    return items.map(item => {\n      let packageId = parseInt(item.id || item.external_id, 10) || this.#getPackageIdFromUrl();\n      if (!packageId) throw new Error(`Invalid package ID for item: ${item.name}`);\n      \n      // Create the line item\n      const lineItem = {\n        package_id: packageId,\n        quantity: item.quantity || 1\n      };\n      \n      // If is_upsell property exists on the item, add it to the line item\n      if (item.is_upsell === true) {\n        lineItem.is_upsell = true;\n        this.#safeLog('debug', `Adding line item with is_upsell=true: ${packageId}`);\n      }\n      \n      return lineItem;\n    });\n  }\n\n  #createOrder(orderData) {\n    if (!orderData || !this.#apiClient) {\n      this.#handlePaymentError('Cannot create order');\n      this.#hideProcessingState();\n      return;\n    }\n\n    this.#enforceFormPrevention();\n    const formattedOrderData = this.#formatOrderData(orderData);\n\n    this.#apiClient.createOrder(formattedOrderData)\n      .then(response => this.#handleOrderSuccess(response))\n      .catch(error => this.#handlePaymentError(this.#formatErrorMessage(error)))\n      .finally(() => this.#hideProcessingState());\n  }\n\n  #formatOrderData(orderData) {\n    const formatted = { ...orderData };\n    \n    // Only set success_url from meta tag if not already set in orderData\n    if (!formatted.success_url && this.#apiClient) {\n      // Use ApiClient to get next page URL from meta tag\n      const nextPageUrl = this.#apiClient.getNextPageUrlFromMeta(orderData.ref_id);\n      if (nextPageUrl) {\n        formatted.success_url = nextPageUrl;\n      }\n    }\n    \n    // Add payment_failed_url to redirect back to the current page with error parameters\n    if (!formatted.payment_failed_url) {\n      const currentUrl = new URL(window.location.href);\n      currentUrl.searchParams.set('payment_failed', 'true');\n      \n      // Add the payment method to the failed URL if available\n      if (orderData.payment_method) {\n        currentUrl.searchParams.set('payment_method', orderData.payment_method);\n      } else if (formatted.payment_detail?.payment_method) {\n        currentUrl.searchParams.set('payment_method', formatted.payment_detail.payment_method);\n      }\n      \n      formatted.payment_failed_url = currentUrl.href;\n      this.#safeLog('debug', `Set payment_failed_url to: ${formatted.payment_failed_url}`);\n    }\n    \n    if (orderData.payment_token) {\n      formatted.payment_detail = { card_token: orderData.payment_token };\n      delete formatted.payment_token;\n    }\n    if (orderData.payment_method) {\n      formatted.payment_detail = formatted.payment_detail || {};\n      formatted.payment_detail.payment_method = {\n        'credit-card': 'card_token',\n        'credit': 'card_token',\n        'paypal': 'paypal'\n      }[orderData.payment_method] || orderData.payment_method;\n      delete formatted.payment_method;\n    }\n    formatted.shipping_method = parseInt(formatted.shipping_method, 10) || 1;\n    formatted.billing_address = formatted.billing_address || formatted.shipping_address;\n    return formatted;\n  }\n\n  #formatErrorMessage(error) {\n    try {\n      const errorData = JSON.parse(error.message);\n      \n      // Handle specific payment errors\n      if (errorData?.payment_details) {\n        return this.#formatPaymentErrorMessage(errorData);\n      }\n      \n      if (errorData?.message) {\n        return `Order creation failed: ${\n          Array.isArray(errorData.message) ? \n            errorData.message.map(e => Object.entries(e).map(([k, v]) => `${k}: ${v}`).join(', ')).join(', ') :\n            Object.entries(errorData.message).map(([k, v]) => `${k}: ${v}`).join(', ')\n        }`;\n      }\n    } catch {\n      return error.message || 'Unknown error';\n    }\n    return 'Order creation failed';\n  }\n\n  #formatPaymentErrorMessage(errorData) {\n    // Create a user-friendly message based on the payment error\n    const errorCode = errorData.payment_response_code;\n    const errorDetails = errorData.payment_details;\n    \n    // Map common error codes to user-friendly messages\n    const errorMessages = {\n      '3005': 'The card number you entered is invalid. Please check and try again.',\n      '3006': 'The card expiration date is invalid. Please check and try again.',\n      '3007': 'The card security code (CVV) is invalid. Please check and try again.',\n      '3008': 'The card has been declined. Please try another payment method.',\n      '3009': 'This card has expired. Please use a different card.',\n      '3010': 'The card has insufficient funds. Please try another payment method.'\n    };\n    \n    return errorMessages[errorCode] || errorDetails || 'There was a problem processing your payment. Please try again.';\n  }\n\n  #handlePaymentError(message) {\n    this.#hideProcessingState();\n    \n    // Clear any previous error indicators\n    this.#clearPaymentErrors();\n    \n    // Check if this is a credit card specific error\n    const isCreditCardError = this.#paymentMethod === 'credit-card' && \n      (message.includes('card') || message.includes('Card') || message.includes('CVV'));\n    \n    if (isCreditCardError) {\n      // Display error on the credit card field\n      this.#displayCreditCardError(message);\n    }\n    \n    // Handle Spreedly errors in the toast handler\n    const spreedlyErrorContainer = document.querySelector('[os-checkout-element=\"spreedly-error\"]');\n    if (spreedlyErrorContainer) {\n      const errorMessageElement = spreedlyErrorContainer.querySelector('[data-os-message=\"error\"]');\n      if (errorMessageElement) {\n        errorMessageElement.textContent = message;\n        spreedlyErrorContainer.style.display = 'flex';\n      }\n    } else {\n      // Fallback to general error container\n      const errorContainer = document.querySelector('[os-checkout-element=\"payment-error\"]');\n      if (errorContainer) {\n        errorContainer.textContent = message;\n        errorContainer.style.display = 'block';\n        errorContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      } else {\n        alert(`Payment Error: ${message}`);\n      }\n    }\n  }\n  \n  #displayCreditCardError(message) {\n    // Find the credit card field container\n    let fieldSelector = '[os-checkout-field=\"cc-number\"]';\n    let fieldId = '#credit_card_number';\n    \n    // Determine which field has the error based on the message\n    if (message.toLowerCase().includes('cvv') || message.toLowerCase().includes('security code')) {\n      fieldSelector = '[os-checkout-field=\"cc-cvv\"]';\n      fieldId = '#credit_card_cvv';\n    } else if (message.toLowerCase().includes('expiration') || message.toLowerCase().includes('expired')) {\n      fieldSelector = '[os-checkout-field=\"cc-month\"], [os-checkout-field=\"cc-year\"]';\n      fieldId = '#credit_card_exp_month, #credit_card_exp_year';\n    }\n    \n    // Find the field container\n    const fieldSelectors = fieldSelector.split(',').map(s => s.trim());\n    const idSelectors = fieldId.split(',').map(s => s.trim());\n    \n    // Apply error styling to all matching fields\n    [...fieldSelectors, ...idSelectors].forEach(selector => {\n      const field = document.querySelector(selector);\n      if (!field) return;\n      \n      const container = field.closest('.form-group') || field.parentElement;\n      if (!container) return;\n      \n      // Add error class to the field\n      field.classList.add('is-invalid');\n      \n      // Create or update error message element\n      let errorElement = container.querySelector('.invalid-feedback');\n      if (!errorElement) {\n        errorElement = document.createElement('div');\n        errorElement.className = 'invalid-feedback';\n        container.appendChild(errorElement);\n      }\n      \n      errorElement.textContent = message;\n      errorElement.style.display = 'block';\n    });\n    \n    // Scroll to the first field with error\n    const firstErrorField = document.querySelector(fieldSelectors[0]) || document.querySelector(idSelectors[0]);\n    if (firstErrorField) {\n      firstErrorField.focus();\n      firstErrorField.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    }\n  }\n  \n  #clearPaymentErrors() {\n    // Clear all credit card field errors\n    const ccFieldSelectors = [\n      '[os-checkout-field=\"cc-number\"]', '#credit_card_number',\n      '[os-checkout-field=\"cc-cvv\"]', '#credit_card_cvv',\n      '[os-checkout-field=\"cc-month\"]', '#credit_card_exp_month',\n      '[os-checkout-field=\"cc-year\"]', '#credit_card_exp_year'\n    ];\n    \n    ccFieldSelectors.forEach(selector => {\n      const field = document.querySelector(selector);\n      if (!field) return;\n      \n      field.classList.remove('is-invalid');\n      const container = field.closest('.form-group') || field.parentElement;\n      if (container) {\n        const errorElement = container.querySelector('.invalid-feedback');\n        if (errorElement) {\n          errorElement.style.display = 'none';\n        }\n      }\n    });\n    \n    // Clear general error container\n    const errorContainer = document.querySelector('[os-checkout-element=\"payment-error\"]');\n    if (errorContainer) {\n      errorContainer.style.display = 'none';\n    }\n  }\n\n  #handleOrderSuccess(orderData) {\n    sessionStorage.setItem('order_reference', orderData.ref_id);\n    \n    // Set pending purchase event flag\n    sessionStorage.setItem(`pending_purchase_event_${orderData.ref_id}`, 'true');\n    \n    // Trigger order.created event for the EventManager\n    this.#app?.triggerEvent?.('order.created', orderData);\n    \n\n    // If payment_complete_url exists, use it directly\n    // This is primarily for PayPal and other redirect payment flows\n    if (orderData.payment_complete_url) {\n      this.#safeLog('debug', `Redirecting to payment gateway: ${orderData.payment_complete_url}`);\n      window.location.href = orderData.payment_complete_url;\n      return;\n    }\n    \n    // Otherwise use the standard redirect approach for completed payments\n    const redirectUrl = this.#getRedirectUrl(orderData);\n    window.location.href = redirectUrl;\n  }\n\n  #getRedirectUrl(orderData) {\n    // If we have ApiClient, use its method for consistency\n    if (this.#apiClient) {\n      return this.#apiClient.getNextUrlFromOrderResponse(orderData);\n    }\n    \n    // Fallback implementation if ApiClient is not available\n    // First check for meta tag (highest priority after payment_complete_url)\n    const metaUrl = document.querySelector('meta[name=\"os-next-page\"]')?.content;\n    if (metaUrl) {\n      const url = metaUrl.startsWith('http') ? \n        metaUrl : \n        new URL(metaUrl, window.location.origin).href;\n      \n      return `${url}${url.includes('?') ? '&' : '?'}ref_id=${orderData.ref_id}`;\n    }\n    \n    // Then use order_status_url as the fallback\n    if (orderData.order_status_url) {\n      return orderData.order_status_url;\n    }\n    \n    // Last resort - use confirmation_url or construct one\n    return orderData.confirmation_url || \n           `${window.location.origin}/checkout/confirmation/?ref_id=${orderData.ref_id}`;\n  }\n\n  /**\n   * Initialize express checkout buttons\n   */\n  #initExpressCheckout() {\n    try {\n      // Detect device support for payment methods\n      this.#detectDeviceSupport();\n\n      // Initialize PayPal Express button\n      const paypalButton = document.querySelector('[os-checkout-payment=\"paypal\"]');\n      if (paypalButton) {\n        paypalButton.addEventListener('click', (e) => {\n          e.preventDefault();\n          this.processExpressCheckout('paypal');\n        });\n        this.#expressCheckoutButtons.paypal = paypalButton;\n      }\n\n      // Initialize Apple Pay button if supported\n      if (this.#deviceSupport.applePay) {\n        const applePayButton = document.querySelector('[os-checkout-payment=\"apple-pay\"]');\n        if (applePayButton) {\n          applePayButton.addEventListener('click', (e) => {\n            e.preventDefault();\n            this.processExpressCheckout('apple_pay');\n          });\n          this.#expressCheckoutButtons.applePay = applePayButton;\n        }\n      } else {\n        // Hide Apple Pay button if not supported\n        const applePayBtn = document.querySelector('[os-checkout-payment=\"apple-pay\"]');\n        if (applePayBtn) {\n          applePayBtn.style.display = 'none';\n        }\n      }\n\n      // Initialize Google Pay button if supported\n      if (this.#deviceSupport.googlePay) {\n        const googlePayButton = document.querySelector('[os-checkout-payment=\"google-pay\"]');\n        if (googlePayButton) {\n          googlePayButton.addEventListener('click', (e) => {\n            e.preventDefault();\n            this.processExpressCheckout('google_pay');\n          });\n          this.#expressCheckoutButtons.googlePay = googlePayButton;\n        }\n      } else {\n        // Hide Google Pay button if not supported\n        const googlePayBtn = document.querySelector('[os-checkout-payment=\"google-pay\"]');\n        if (googlePayBtn) {\n          googlePayBtn.style.display = 'none';\n        }\n      }\n\n      // Hide the express checkout container if no buttons are active\n      if (!this.#hasActiveExpressButtons()) {\n        const container = document.querySelector('[os-checkout-container=\"express-checkout\"]');\n        if (container) {\n          container.style.display = 'none';\n        }\n      }\n\n    } catch (error) {\n      this.#safeLog('error', 'Error initializing express checkout:', error);\n    }\n  }\n\n  /**\n   * Detect which payment methods are supported by the device/browser\n   */\n  #detectDeviceSupport() {\n    // Check for Apple Pay support\n    if (window.ApplePaySession && window.ApplePaySession.canMakePayments) {\n      this.#deviceSupport.applePay = window.ApplePaySession.canMakePayments();\n      this.#safeLog('debug', `Apple Pay support: ${this.#deviceSupport.applePay}`);\n    }\n\n    // Basic Google Pay support check\n    this.#deviceSupport.googlePay = !!(window.chrome && window.chrome.runtime);\n    this.#safeLog('debug', `Google Pay support: ${this.#deviceSupport.googlePay}`);\n  }\n\n  /**\n   * Check if there are any active express checkout buttons\n   * @returns {boolean} True if at least one express button is initialized\n   */\n  #hasActiveExpressButtons() {\n    return !!(\n      this.#expressCheckoutButtons.paypal || \n      this.#expressCheckoutButtons.applePay || \n      this.#expressCheckoutButtons.googlePay\n    );\n  }\n\n  /**\n   * Process an express checkout payment\n   * @param {string} method - Payment method ('paypal', 'apple_pay', 'google_pay')\n   */\n  processExpressCheckout(method) {\n    this.#safeLog('info', `Processing ${method} express checkout`);\n    \n    // Determine which button to use based on the method\n    let button;\n    switch (method) {\n      case 'paypal':\n        button = this.#expressCheckoutButtons.paypal;\n        break;\n      case 'apple_pay':\n        button = this.#expressCheckoutButtons.applePay;\n        break;\n      case 'google_pay':\n        button = this.#expressCheckoutButtons.googlePay;\n        break;\n      default:\n        this.#safeLog('error', `Unknown express checkout method: ${method}`);\n        return;\n    }\n    \n    // Show processing state\n    this.#setExpressButtonProcessing(button, true);\n    \n    try {\n      // Get cart data from state manager\n      const cart = this.#app.state.getState('cart');\n      \n      if (!cart || !cart.items || cart.items.length === 0) {\n        this.#safeLog('error', `Cannot process ${method} checkout: cart is empty`);\n        this.#handleExpressCheckoutError('Your cart is empty. Please add items to your cart before checking out.', button);\n        return;\n      }\n\n      // Prepare simplified API request for express checkout\n      // Express checkout doesn't need user and address information\n      const orderData = {\n        lines: cart.items.map(item => ({\n          package_id: item.id,\n          quantity: item.quantity || 1,\n          is_upsell: !!item.is_upsell\n        })),\n        payment_detail: {\n          payment_method: method\n        },\n        attribution: this.#app.attribution?.getAttributionData() || cart.attribution || {},\n        shipping_method: (cart.shippingMethod?.id || 1).toString()\n      };\n\n      // Get success_url from meta tag using ApiClient\n      if (this.#apiClient) {\n        const nextPageUrl = this.#apiClient.getNextPageUrlFromMeta();\n        if (nextPageUrl) {\n          orderData.success_url = nextPageUrl;\n          this.#safeLog('debug', `Express checkout success URL set from meta tag: ${nextPageUrl}`);\n        } else {\n          this.#safeLog('debug', 'No meta tag found for express checkout success_url, API will use order_status_url');\n        }\n      }\n      \n      // Add payment_failed_url to redirect back to current page with error parameters\n      const currentUrl = new URL(window.location.href);\n      currentUrl.searchParams.set('payment_failed', 'true');\n      currentUrl.searchParams.set('payment_method', method);\n      orderData.payment_failed_url = currentUrl.href;\n      this.#safeLog('debug', `Express checkout payment_failed_url set to: ${orderData.payment_failed_url}`);\n\n      // Add vouchers if available\n      if (cart.vouchers && cart.vouchers.length > 0) {\n        orderData.vouchers = cart.vouchers.map(voucher => voucher.code || voucher);\n      }\n\n      this.#safeLog('debug', 'Express checkout order data:', orderData);\n\n      // Create order through API\n      this.#apiClient.createOrder(orderData)\n        .then(response => {\n          this.#safeLog('debug', `${method} express checkout order created:`, response);\n          \n          if (response.payment_complete_url) {\n            // Trigger event before redirect\n            this.#app.triggerEvent('express.checkout.started', {\n              method,\n              order: response\n            });\n            \n            // Redirect to payment processor\n            window.location.href = response.payment_complete_url;\n          } else {\n            throw new Error('No payment URL returned from API');\n          }\n        })\n        .catch(error => {\n          this.#safeLog('error', `${method} express checkout error:`, error);\n          this.#handleExpressCheckoutError(`There was an error processing your ${method.replace('_', ' ')} payment. Please try again or use a different payment method.`, button);\n        });\n    } catch (error) {\n      this.#safeLog('error', `Error in ${method} express checkout:`, error);\n      this.#handleExpressCheckoutError('An unexpected error occurred. Please try again.', button);\n    }\n  }\n\n  /**\n   * Set express checkout button to processing state\n   * @param {HTMLElement} button - Button element\n   * @param {boolean} isProcessing - Whether the button is processing\n   */\n  #setExpressButtonProcessing(button, isProcessing) {\n    if (!button) return;\n    \n    if (isProcessing) {\n      button.setAttribute('disabled', 'disabled');\n      button.classList.add('processing');\n      \n      // Store original content and replace with processing indicator\n      if (!button.dataset.originalHtml) {\n        button.dataset.originalHtml = button.innerHTML;\n        const loadingSpinner = document.createElement('div');\n        loadingSpinner.className = 'payment-btn-spinner';\n        loadingSpinner.innerHTML = '<div class=\"spinner\"></div>';\n        button.innerHTML = '';\n        button.appendChild(loadingSpinner);\n      }\n    } else {\n      button.removeAttribute('disabled');\n      button.classList.remove('processing');\n      \n      // Restore original content\n      if (button.dataset.originalHtml) {\n        button.innerHTML = button.dataset.originalHtml;\n        delete button.dataset.originalHtml;\n      }\n    }\n  }\n\n  /**\n   * Handle express checkout error\n   * @param {string} message - Error message\n   * @param {HTMLElement} button - Button element that was clicked\n   */\n  #handleExpressCheckoutError(message, button) {\n    // Reset button state\n    this.#setExpressButtonProcessing(button, false);\n    \n    // Create or update error message\n    const container = document.querySelector('.express-checkout-wrapper');\n    if (!container) return;\n    \n    let errorContainer = container.querySelector('.express-checkout-error');\n    \n    if (!errorContainer) {\n      errorContainer = document.createElement('div');\n      errorContainer.className = 'express-checkout-error';\n      container.appendChild(errorContainer);\n    }\n    \n    errorContainer.textContent = message;\n    errorContainer.style.display = 'block';\n    \n    // Hide error after 5 seconds\n    setTimeout(() => {\n      errorContainer.style.display = 'none';\n    }, 5000);\n    \n    // Trigger error event\n    this.#app.triggerEvent('express.checkout.error', { message });\n  }\n\n  /**\n   * Reset processing state for all express checkout buttons\n   */\n  resetExpressButtons() {\n    this.#setExpressButtonProcessing(this.#expressCheckoutButtons.paypal, false);\n    this.#setExpressButtonProcessing(this.#expressCheckoutButtons.applePay, false);\n    this.#setExpressButtonProcessing(this.#expressCheckoutButtons.googlePay, false);\n  }\n\n  /**\n   * Check URL parameters for payment_failed and display appropriate error message\n   */\n  #checkForPaymentFailedParameters() {\n    try {\n      const urlParams = new URLSearchParams(window.location.search);\n      const paymentFailed = urlParams.get('payment_failed');\n      \n      if (paymentFailed === 'true') {\n        const paymentMethod = urlParams.get('payment_method');\n        let errorMessage = 'Your payment could not be processed. Please try again or use a different payment method.';\n        \n        // Customize message based on payment method\n        if (paymentMethod) {\n          const methodDisplay = {\n            'paypal': 'PayPal',\n            'apple_pay': 'Apple Pay',\n            'google_pay': 'Google Pay',\n            'card_token': 'credit card',\n            'credit-card': 'credit card',\n            'credit': 'credit card'\n          }[paymentMethod] || paymentMethod;\n          \n          errorMessage = `Your ${methodDisplay} payment could not be processed. Please try again or use a different payment method.`;\n        }\n        \n        // Handle errors from express checkout methods differently\n        const isExpressCheckout = ['paypal', 'apple_pay', 'google_pay'].includes(paymentMethod);\n        if (isExpressCheckout) {\n          this.#displayTopBannerError(errorMessage, paymentMethod);\n        } else {\n          // Default to credit card error display for card_token or unknown methods\n          this.#handlePaymentError(errorMessage);\n        }\n        \n        // Clear the URL parameters to prevent showing the error again on refresh\n        const newUrl = new URL(window.location.href);\n        newUrl.searchParams.delete('payment_failed');\n        newUrl.searchParams.delete('payment_method');\n        window.history.replaceState({}, document.title, newUrl.href);\n      }\n    } catch (error) {\n      this.#safeLog('error', 'Error checking payment failed parameters:', error);\n    }\n  }\n  \n  /**\n   * Display a prominent error banner at the top of the checkout form\n   * @param {string} message - Error message to display\n   * @param {string} method - Payment method that failed\n   */\n  #displayTopBannerError(message, method) {\n    try {\n      // Check if there's already a top banner error\n      let errorBanner = document.querySelector('[os-checkout-element=\"top-error-banner\"]');\n      \n      if (!errorBanner) {\n        // Create the banner\n        errorBanner = document.createElement('div');\n        errorBanner.setAttribute('os-checkout-element', 'top-error-banner');\n        errorBanner.className = 'checkout-error-banner';\n        errorBanner.style.width = '100%';\n        errorBanner.style.padding = '12px 16px';\n        errorBanner.style.backgroundColor = '#fff3cd';\n        errorBanner.style.color = '#856404';\n        errorBanner.style.borderRadius = '4px';\n        errorBanner.style.marginBottom = '20px';\n        errorBanner.style.border = '1px solid #ffeeba';\n        errorBanner.style.display = 'flex';\n        errorBanner.style.alignItems = 'center';\n        errorBanner.style.justifyContent = 'space-between';\n        \n        // Create message div\n        const messageDiv = document.createElement('div');\n        messageDiv.textContent = message;\n        \n        // Create close button\n        const closeButton = document.createElement('button');\n        closeButton.textContent = '×';\n        closeButton.style.background = 'none';\n        closeButton.style.border = 'none';\n        closeButton.style.fontSize = '20px';\n        closeButton.style.fontWeight = 'bold';\n        closeButton.style.cursor = 'pointer';\n        closeButton.style.marginLeft = '10px';\n        closeButton.addEventListener('click', () => {\n          errorBanner.style.display = 'none';\n        });\n        \n        // Assemble banner\n        errorBanner.appendChild(messageDiv);\n        errorBanner.appendChild(closeButton);\n        \n        // Insert banner at the top of the checkout form\n        const checkoutForm = this.#form;\n        if (checkoutForm) {\n          checkoutForm.insertBefore(errorBanner, checkoutForm.firstChild);\n        } else {\n          // Try to find other common checkout container elements\n          const checkoutContainer = \n            document.querySelector('[os-checkout-container=\"form\"]') || \n            document.querySelector('.checkout-form') ||\n            document.querySelector('.checkout-container');\n          \n          if (checkoutContainer) {\n            checkoutContainer.insertBefore(errorBanner, checkoutContainer.firstChild);\n          } else {\n            // Last resort - add to body\n            const mainContent = document.querySelector('main') || document.body;\n            mainContent.insertBefore(errorBanner, mainContent.firstChild);\n          }\n        }\n        \n        // Scroll to error banner\n        errorBanner.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      } else {\n        // Update existing banner\n        const messageDiv = errorBanner.querySelector('div');\n        if (messageDiv) {\n          messageDiv.textContent = message;\n        } else {\n          errorBanner.textContent = message;\n        }\n        errorBanner.style.display = 'flex';\n        errorBanner.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      }\n      \n      this.#safeLog('debug', `Displayed top banner error for ${method}: ${message}`);\n    } catch (error) {\n      this.#safeLog('error', 'Error displaying top banner error:', error);\n      // Fall back to the standard error method\n      this.#handlePaymentError(message);\n    }\n  }\n}", "/**\r\n * BillingAddressHandler - Manages the billing address form\r\n * \r\n * This class handles the billing address form functionality, including:\r\n * - Toggle between using shipping address or a different billing address\r\n * - Copying shipping address values to billing fields\r\n * - Showing/hiding the billing form based on user selection\r\n * - Showing/hiding the billing location fields when address is entered\r\n */\r\n\r\nexport class BillingAddressHandler {\r\n  #app;\r\n  #logger;\r\n  #sameAsShippingCheckbox;\r\n  #billingFormContainer;\r\n  #shippingFields = {};\r\n  #billingFields = {};\r\n  #fieldMap = {\r\n    'fname': 'billing-fname',\r\n    'lname': 'billing-lname',\r\n    'address1': 'billing-address1',\r\n    'address2': 'billing-address2',\r\n    'city': 'billing-city',\r\n    'province': 'billing-province',\r\n    'postal': 'billing-postal',\r\n    'country': 'billing-country',\r\n    'phone': 'billing-phone'\r\n  };\r\n  #isTransitioning = false;\r\n  #lastState = null;\r\n  #billingLocationComponent = null;\r\n  #billingAddress1Field = null;\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    \r\n    // Ensure we have a valid logger with all required methods\r\n    if (app?.logger) {\r\n      // If app.logger is a module logger, use it directly\r\n      if (typeof app.logger.debug === 'function' && \r\n          typeof app.logger.info === 'function' && \r\n          typeof app.logger.warn === 'function' && \r\n          typeof app.logger.error === 'function') {\r\n        this.#logger = app.logger;\r\n      } else {\r\n        // Otherwise, try to create a module logger\r\n        this.#logger = app.logger.createModuleLogger ? \r\n          app.logger.createModuleLogger('BILLING') : \r\n          console;\r\n      }\r\n    } else {\r\n      // Fallback to console if no logger is available\r\n      this.#logger = console;\r\n    }\r\n    \r\n    this.#init();\r\n  }\r\n\r\n  #init() {\r\n    try {\r\n      // Find the checkbox for \"same as shipping\" - try multiple possible selectors\r\n      this.#sameAsShippingCheckbox = \r\n        document.querySelector('[os-checkout-field=\"same-as-shipping\"]') || \r\n        document.querySelector('[name=\"use_shipping_address\"]') || \r\n        document.querySelector('#use_shipping_address');\r\n      \r\n      this.#billingFormContainer = document.querySelector('[os-checkout-element=\"different-billing-address\"]');\r\n      \r\n      // Find billing location component (city, state, zip)\r\n      this.#billingLocationComponent = document.querySelector('[data-os-component=\"billing-location\"]');\r\n      \r\n      // Find billing address field for input monitoring\r\n      this.#billingAddress1Field = document.querySelector('[os-checkout-field=\"billing-address1\"]');\r\n      \r\n      if (!this.#sameAsShippingCheckbox) {\r\n        this.#logWarn('Same as shipping checkbox not found. Tried multiple selectors including [name=\"use_shipping_address\"] and #use_shipping_address');\r\n        \r\n        // Log all checkboxes in the form for debugging\r\n        const allCheckboxes = document.querySelectorAll('input[type=\"checkbox\"]');\r\n        this.#logDebug(`Found ${allCheckboxes.length} checkboxes on the page:`);\r\n        allCheckboxes.forEach((checkbox, index) => {\r\n          this.#logDebug(`Checkbox ${index + 1}: id=${checkbox.id}, name=${checkbox.name}, class=${checkbox.className}`);\r\n        });\r\n        \r\n        return;\r\n      }\r\n      \r\n      if (!this.#billingFormContainer) {\r\n        this.#logWarn('Billing form container not found with selector [os-checkout-element=\"different-billing-address\"]');\r\n        \r\n        // Try alternative selector\r\n        this.#billingFormContainer = document.querySelector('.billing_form-container');\r\n        if (this.#billingFormContainer) {\r\n          this.#logInfo('Found billing form container with alternative selector .billing_form-container');\r\n        } else {\r\n          return;\r\n        }\r\n      }\r\n      \r\n      this.#logDebug('BillingAddressHandler initialized');\r\n      \r\n      // Cache all shipping and billing field elements\r\n      this.#cacheFieldElements();\r\n      \r\n      // Set initial state based on checkbox\r\n      this.#lastState = this.#sameAsShippingCheckbox.checked;\r\n      this.#toggleBillingForm(this.#lastState, false);\r\n      \r\n      // Set up billing location visibility\r\n      this.#setupBillingLocationVisibility();\r\n      \r\n      // Add event listeners\r\n      this.#setupEventListeners();\r\n    } catch (error) {\r\n      this.#logError('Error initializing BillingAddressHandler:', error);\r\n    }\r\n  }\r\n\r\n  // Safe logging methods that check if the method exists before calling\r\n  #logDebug(message, ...args) {\r\n    if (typeof this.#logger.debug === 'function') {\r\n      this.#logger.debug(message, ...args);\r\n    } else if (typeof this.#logger.log === 'function') {\r\n      this.#logger.log(message, ...args);\r\n    }\r\n  }\r\n\r\n  #logInfo(message, ...args) {\r\n    if (typeof this.#logger.info === 'function') {\r\n      this.#logger.info(message, ...args);\r\n    } else if (typeof this.#logger.log === 'function') {\r\n      this.#logger.log(message, ...args);\r\n    }\r\n  }\r\n\r\n  #logWarn(message, ...args) {\r\n    if (typeof this.#logger.warn === 'function') {\r\n      this.#logger.warn(message, ...args);\r\n    } else if (typeof this.#logger.log === 'function') {\r\n      this.#logger.log(`WARNING: ${message}`, ...args);\r\n    }\r\n  }\r\n\r\n  #logError(message, error) {\r\n    if (typeof this.#logger.error === 'function') {\r\n      this.#logger.error(message, error);\r\n    } else if (typeof this.#logger.log === 'function') {\r\n      this.#logger.log(`ERROR: ${message}`, error);\r\n    } else {\r\n      console.error(message, error);\r\n    }\r\n  }\r\n\r\n  #setupBillingLocationVisibility() {\r\n    // If we don't have the billing location component or address field, we can't proceed\r\n    if (!this.#billingLocationComponent) {\r\n      this.#logWarn('Billing location component not found with selector [data-os-component=\"billing-location\"]');\r\n      return;\r\n    }\r\n    \r\n    if (!this.#billingAddress1Field) {\r\n      this.#logWarn('Billing address1 field not found with selector [os-checkout-field=\"billing-address1\"]');\r\n      return;\r\n    }\r\n    \r\n    // Set initial state - hide the location component\r\n    this.#billingLocationComponent.classList.add('cc-hidden');\r\n    \r\n    this.#logDebug('Billing location component initially hidden');\r\n  }\r\n\r\n  #cacheFieldElements() {\r\n    // Cache shipping fields\r\n    Object.keys(this.#fieldMap).forEach(shippingField => {\r\n      const element = document.querySelector(`[os-checkout-field=\"${shippingField}\"]`);\r\n      if (element) {\r\n        this.#shippingFields[shippingField] = element;\r\n      }\r\n    });\r\n    \r\n    // Cache billing fields\r\n    Object.values(this.#fieldMap).forEach(billingField => {\r\n      const element = document.querySelector(`[os-checkout-field=\"${billingField}\"]`);\r\n      if (element) {\r\n        this.#billingFields[billingField] = element;\r\n      }\r\n    });\r\n    \r\n    this.#logDebug(`Cached ${Object.keys(this.#shippingFields).length} shipping fields and ${Object.keys(this.#billingFields).length} billing fields`);\r\n  }\r\n\r\n  #setupEventListeners() {\r\n    // Listen for changes to the \"same as shipping\" checkbox\r\n    this.#sameAsShippingCheckbox.addEventListener('change', (e) => {\r\n      if (!this.#isTransitioning) {\r\n        this.#lastState = e.target.checked;\r\n        this.#toggleBillingForm(e.target.checked, true);\r\n        \r\n        // If checked, copy shipping values to billing\r\n        if (e.target.checked) {\r\n          this.copyShippingToBilling();\r\n        }\r\n        \r\n        this.#logDebug(`Billing address changed: ${e.target.checked ? 'Same as shipping' : 'Different from shipping'}`);\r\n      }\r\n    });\r\n    \r\n    // Listen for payment method changes\r\n    document.addEventListener('payment-method-changed', () => {\r\n      if (this.#lastState !== null && !this.#isTransitioning) {\r\n        this.#toggleBillingForm(this.#lastState, false);\r\n        this.#logDebug(`Payment method changed, billing address state: ${this.#lastState ? 'Same as shipping' : 'Different from shipping'}`);\r\n      }\r\n    });\r\n    \r\n    // Listen for address autocomplete showing location fields\r\n    document.addEventListener('location-fields-shown', () => {\r\n      if (this.#billingLocationComponent) {\r\n        this.#showBillingLocationComponent();\r\n        this.#logDebug('Location fields shown by AddressAutocomplete, showing billing location component as well');\r\n      }\r\n    });\r\n    \r\n    // Listen for changes to shipping fields to update billing if \"same as shipping\" is checked\r\n    Object.entries(this.#shippingFields).forEach(([fieldName, element]) => {\r\n      element.addEventListener('change', () => {\r\n        if (this.#sameAsShippingCheckbox.checked) {\r\n          const billingFieldName = this.#fieldMap[fieldName];\r\n          const billingElement = this.#billingFields[billingFieldName];\r\n          \r\n          if (billingElement) {\r\n            billingElement.value = element.value;\r\n            \r\n            // Trigger change event on the billing field\r\n            billingElement.dispatchEvent(new Event('change', { bubbles: true }));\r\n          }\r\n        }\r\n      });\r\n    });\r\n    \r\n    // Set up input handler for billing address1 field\r\n    if (this.#billingAddress1Field && this.#billingLocationComponent) {\r\n      // Show location component when user types in address\r\n      this.#billingAddress1Field.addEventListener('input', () => {\r\n        // Show location component after minimum characters\r\n        if (this.#billingAddress1Field.value.length >= 3) {\r\n          this.#showBillingLocationComponent();\r\n        }\r\n      });\r\n      \r\n      // Set up mutation observer for autocomplete\r\n      this.#setupBillingAddressAutocompleteDetection();\r\n    }\r\n  }\r\n\r\n  #setupBillingAddressAutocompleteDetection() {\r\n    // Create mutation observer to detect when autocomplete fills the address field\r\n    const observer = new MutationObserver((mutations) => {\r\n      mutations.forEach((mutation) => {\r\n        if (mutation.type === 'attributes' && \r\n            (mutation.attributeName === 'value' || mutation.attributeName === 'autocomplete-value')) {\r\n          if (this.#billingAddress1Field.value.length > 0) {\r\n            this.#showBillingLocationComponent();\r\n            this.#logDebug('Autocomplete detected on billing address field');\r\n          }\r\n        }\r\n      });\r\n    });\r\n    \r\n    // Observe changes to the value attribute of the billing address field\r\n    observer.observe(this.#billingAddress1Field, { \r\n      attributes: true, \r\n      attributeFilter: ['value', 'autocomplete-value'] \r\n    });\r\n    \r\n    // Also listen for Google Places API autocomplete events\r\n    document.addEventListener('google-places-autocomplete-filled', (e) => {\r\n      if (e.detail && e.detail.field === 'billing-address1') {\r\n        this.#showBillingLocationComponent();\r\n        this.#logDebug('Google Places autocomplete detected on billing address field');\r\n      }\r\n    });\r\n    \r\n    this.#logDebug('Billing address autocomplete detection set up');\r\n  }\r\n\r\n  #showBillingLocationComponent() {\r\n    if (this.#billingLocationComponent && this.#billingLocationComponent.classList.contains('cc-hidden')) {\r\n      this.#billingLocationComponent.classList.remove('cc-hidden');\r\n      this.#logDebug('Billing location component shown');\r\n    }\r\n  }\r\n\r\n  #toggleBillingForm(isChecked, animate = true) {\r\n    if (!this.#billingFormContainer || this.#isTransitioning) return;\r\n\r\n    this.#isTransitioning = true;\r\n\r\n    if (!this.#billingFormContainer.style.transition) {\r\n      this.#billingFormContainer.style.transition = 'height 0.3s ease-out, opacity 0.3s ease-out';\r\n    }\r\n\r\n    const handleTransitionEnd = (e) => {\r\n      if (e.propertyName === 'height') {\r\n        if (!isChecked) {\r\n          this.#billingFormContainer.style.height = 'auto';\r\n        }\r\n        this.#billingFormContainer.style.overflow = '';\r\n        this.#isTransitioning = false;\r\n        this.#billingFormContainer.removeEventListener('transitionend', handleTransitionEnd);\r\n        \r\n        this.#logDebug(`Billing form transition completed: ${isChecked ? 'collapsed' : 'expanded'}`);\r\n      }\r\n    };\r\n\r\n    if (animate) {\r\n      this.#billingFormContainer.removeEventListener('transitionend', handleTransitionEnd);\r\n      \r\n      if (!isChecked) {\r\n        // Expanding\r\n        this.#billingFormContainer.style.display = 'flex';\r\n        this.#billingFormContainer.style.height = '0px';\r\n        this.#billingFormContainer.style.overflow = 'hidden';\r\n        \r\n        requestAnimationFrame(() => {\r\n          const targetHeight = this.#billingFormContainer.scrollHeight;\r\n          this.#billingFormContainer.style.height = `${targetHeight}px`;\r\n          this.#billingFormContainer.style.opacity = '1';\r\n          \r\n          this.#logDebug(`Expanding billing form to height: ${targetHeight}px`);\r\n        });\r\n        \r\n        this.#billingFormContainer.addEventListener('transitionend', handleTransitionEnd);\r\n      } else {\r\n        // Collapsing\r\n        this.#billingFormContainer.style.height = `${this.#billingFormContainer.scrollHeight}px`;\r\n        this.#billingFormContainer.style.overflow = 'hidden';\r\n        \r\n        requestAnimationFrame(() => {\r\n          this.#billingFormContainer.style.height = '0px';\r\n          this.#billingFormContainer.style.opacity = '0';\r\n          \r\n          this.#logDebug('Collapsing billing form');\r\n        });\r\n        \r\n        this.#billingFormContainer.addEventListener('transitionend', handleTransitionEnd);\r\n        \r\n        this.#billingFormContainer.addEventListener('transitionend', (e) => {\r\n          if (e.propertyName === 'height' && isChecked) {\r\n            this.#billingFormContainer.style.display = 'none';\r\n            this.#logDebug('Billing form hidden after collapse');\r\n          }\r\n        }, { once: true });\r\n      }\r\n    } else {\r\n      // No animation for initial state\r\n      this.#billingFormContainer.style.display = isChecked ? 'none' : 'flex';\r\n      this.#billingFormContainer.style.height = isChecked ? '0' : 'auto';\r\n      this.#billingFormContainer.style.opacity = isChecked ? '0' : '1';\r\n      this.#billingFormContainer.style.overflow = '';\r\n      this.#isTransitioning = false;\r\n      \r\n      this.#logDebug(`Set billing form without animation: ${isChecked ? 'hidden' : 'visible'}`);\r\n    }\r\n  }\r\n\r\n  // Deprecated method - use #toggleBillingForm instead\r\n  #updateBillingFormVisibility() {\r\n    this.#toggleBillingForm(this.#sameAsShippingCheckbox.checked, false);\r\n  }\r\n\r\n  /**\r\n   * Copy shipping address values to billing address fields\r\n   */\r\n  copyShippingToBilling() {\r\n    try {\r\n      Object.entries(this.#shippingFields).forEach(([shippingField, shippingElement]) => {\r\n        const billingFieldName = this.#fieldMap[shippingField];\r\n        const billingElement = this.#billingFields[billingFieldName];\r\n        \r\n        if (billingElement && shippingElement) {\r\n          billingElement.value = shippingElement.value;\r\n          \r\n          // Trigger change event on the billing field\r\n          billingElement.dispatchEvent(new Event('change', { bubbles: true }));\r\n        }\r\n      });\r\n      \r\n      // If address1 is copied and has value, show location component\r\n      if (this.#billingFields['billing-address1'] && \r\n          this.#billingFields['billing-address1'].value && \r\n          this.#billingFields['billing-address1'].value.length > 0) {\r\n        this.#showBillingLocationComponent();\r\n      }\r\n      \r\n      this.#logDebug('Copied shipping address to billing address');\r\n    } catch (error) {\r\n      this.#logError('Error copying shipping to billing:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the billing address data\r\n   * If \"same as shipping\" is checked, returns null to indicate shipping should be used\r\n   * Otherwise returns an object with the billing address fields\r\n   */\r\n  getBillingAddressData() {\r\n    // If same as shipping is checked, return null to indicate shipping should be used\r\n    if (this.#sameAsShippingCheckbox && this.#sameAsShippingCheckbox.checked) {\r\n      return null;\r\n    }\r\n    \r\n    // Otherwise, collect billing address data\r\n    const billingData = {};\r\n    \r\n    Object.entries(this.#billingFields).forEach(([fieldName, element]) => {\r\n      // Convert from billing-fname to fname format for API\r\n      const apiFieldName = fieldName.replace('billing-', '');\r\n      billingData[apiFieldName] = element.value;\r\n    });\r\n    \r\n    return billingData;\r\n  }\r\n\r\n  /**\r\n   * Check if billing address is same as shipping\r\n   * @returns {boolean} Whether billing address is same as shipping\r\n   */\r\n  isSameAsShipping() {\r\n    const isSame = this.#sameAsShippingCheckbox ? this.#sameAsShippingCheckbox.checked : true;\r\n    this.#logDebug(`Billing address is ${isSame ? 'same as' : 'different from'} shipping`);\r\n    return isSame;\r\n  }\r\n}", "/**\r\n * PaymentSelector - Handles payment method selection and form toggling\r\n */\r\n\r\nexport class PaymentSelector {\r\n  #logger;\r\n  #container;\r\n  #radioInputs;\r\n  #forms;\r\n  #activeTransitions = new Map();\r\n  #currentMode = null;\r\n\r\n  constructor(logger) {\r\n    this.#logger = logger;\r\n    this.#container = document.querySelector('[os-payment-mode]');\r\n    this.#radioInputs = document.querySelectorAll('input[name=\"combo_mode\"]');\r\n    this.#forms = document.querySelectorAll('[os-checkout-element$=\"-form\"]');\r\n\r\n    if (this.#container && this.#radioInputs.length > 0) {\r\n      this.#logger.debug('PaymentSelector initialized with elements found');\r\n      this.#init();\r\n    } else {\r\n      this.#logger.warn('PaymentSelector elements not found');\r\n    }\r\n  }\r\n\r\n  #init() {\r\n    const checkedRadio = document.querySelector('input[name=\"combo_mode\"]:checked');\r\n    if (checkedRadio && this.#container) {\r\n      this.#setPaymentMode(checkedRadio.value, false);\r\n    }\r\n\r\n    this.#radioInputs.forEach(radio => \r\n      radio.addEventListener('change', e => this.#setPaymentMode(e.target.value, true))\r\n    );\r\n\r\n    this.#logger.debug('PaymentSelector event listeners attached');\r\n  }\r\n\r\n  #setPaymentMode(mode, animate = true) {\r\n    this.#logger.debug(`Setting payment mode to: ${mode}, animate: ${animate}`);\r\n    \r\n    this.#container?.setAttribute('os-payment-mode', mode);\r\n    this.#currentMode = mode;\r\n\r\n    this.#forms.forEach(form => {\r\n      form.style.transition = 'none';\r\n      form.offsetHeight; // Force reflow\r\n      form.style.transition = '';\r\n    });\r\n\r\n    this.#forms.forEach(form => {\r\n      const formType = form.getAttribute('os-checkout-element');\r\n      const isSelected = formType === `${mode}-form`;\r\n\r\n      if (this.#activeTransitions.has(form)) {\r\n        const oldHandler = this.#activeTransitions.get(form);\r\n        form.removeEventListener('transitionend', oldHandler);\r\n        this.#activeTransitions.delete(form);\r\n      }\r\n\r\n      if (animate) {\r\n        form.style.display = 'block';\r\n        form.style.overflow = 'hidden';\r\n        const currentHeight = form.scrollHeight;\r\n        form.style.height = `${currentHeight}px`;\r\n        form.offsetHeight; // Force reflow\r\n\r\n        const transitionEndHandler = e => {\r\n          if (e.propertyName === 'height') {\r\n            if (isSelected) {\r\n              form.style.height = 'auto';\r\n              form.style.overflow = '';\r\n            } else {\r\n              form.style.display = 'none';\r\n            }\r\n            this.#activeTransitions.delete(form);\r\n          }\r\n        };\r\n\r\n        this.#activeTransitions.set(form, transitionEndHandler);\r\n        form.addEventListener('transitionend', transitionEndHandler, { once: true });\r\n\r\n        requestAnimationFrame(() => {\r\n          form.style.height = isSelected ? `${form.scrollHeight}px` : '0';\r\n          form.style.opacity = isSelected ? '1' : '0';\r\n        });\r\n      } else {\r\n        form.style.transition = 'none';\r\n        Object.assign(form.style, {\r\n          display: isSelected ? 'block' : 'none',\r\n          height: isSelected ? 'auto' : '0',\r\n          opacity: isSelected ? '1' : '0',\r\n          overflow: ''\r\n        });\r\n        form.offsetHeight; // Force reflow\r\n        form.style.transition = '';\r\n      }\r\n    });\r\n\r\n    document.dispatchEvent(new CustomEvent('payment-method-changed', { detail: { mode } }));\r\n  }\r\n}", "export class AddressAutocomplete {\r\n    #logger;\r\n    #fieldsShown = false;\r\n    #elements;\r\n    #enableAutocomplete;\r\n  \r\n    constructor(logger, options = {}) {\r\n      this.#logger = logger;\r\n      this.#enableAutocomplete = options.enableGoogleMapsAutocomplete !== false;\r\n      \r\n      this.#elements = {\r\n        shipping: {\r\n          address: document.querySelector('[os-checkout-field=\"address1\"]'),\r\n          city: document.querySelector('[os-checkout-field=\"city\"]'),\r\n          state: document.querySelector('[os-checkout-field=\"province\"]'),\r\n          zip: document.querySelector('[os-checkout-field=\"postal\"]'),\r\n          country: document.querySelector('[os-checkout-field=\"country\"]'),\r\n        },\r\n        billing: {\r\n          address: document.querySelector('[os-checkout-field=\"billing-address1\"]'),\r\n          city: document.querySelector('[os-checkout-field=\"billing-city\"]'),\r\n          state: document.querySelector('[os-checkout-field=\"billing-province\"]'),\r\n          zip: document.querySelector('[os-checkout-field=\"billing-postal\"]'),\r\n          country: document.querySelector('[os-checkout-field=\"billing-country\"]'),\r\n        },\r\n        locations: document.querySelectorAll('[data-os-component=\"location\"]'),\r\n      };\r\n  \r\n      this.#logger.info(`AddressAutocomplete initialized (autocomplete ${this.#enableAutocomplete ? 'enabled' : 'disabled'})`);\r\n      this.#hideLocationFields();\r\n      this.#init();\r\n    }\r\n  \r\n    async #init() {\r\n      this.#setupAutofillDetection();\r\n      \r\n      // Skip Google Maps initialization if autocomplete is disabled\r\n      if (!this.#enableAutocomplete) {\r\n        this.#logger.debug('Google Maps autocomplete disabled, using basic field listeners');\r\n        return this.#setupBasicFieldListeners();\r\n      }\r\n      \r\n      await this.#initAutocompleteWithRetry();\r\n    }\r\n  \r\n    #hideLocationFields() {\r\n      if (this.#fieldsShown) return;\r\n      this.#elements.locations.forEach(el => el.classList.add('cc-hidden'));\r\n      this.#logger.debug('Location fields hidden');\r\n    }\r\n  \r\n    #showLocationFields() {\r\n      if (this.#fieldsShown) return;\r\n      this.#elements.locations.forEach(el => el.classList.remove('cc-hidden'));\r\n      this.#fieldsShown = true;\r\n      document.dispatchEvent(new CustomEvent('location-fields-shown'));\r\n      this.#logger.debug('Location fields shown');\r\n    }\r\n  \r\n    #isGoogleMapsAvailable() {\r\n      return !!window.google?.maps?.places;\r\n    }\r\n  \r\n    async #initAutocompleteWithRetry(attempt = 0) {\r\n      // Skip if autocomplete is disabled\r\n      if (!this.#enableAutocomplete) {\r\n        return this.#setupBasicFieldListeners();\r\n      }\r\n      \r\n      if (this.#isGoogleMapsAvailable()) {\r\n        this.#logger.debug('Google Maps API available');\r\n        return this.#initializeAutocomplete();\r\n      }\r\n      if (attempt >= 3) {\r\n        this.#logger.warn('Google Maps API unavailable after 3 attempts');\r\n        return this.#setupBasicFieldListeners();\r\n      }\r\n  \r\n      this.#logger.debug(`Retrying Google Maps check, attempt ${attempt + 1}`);\r\n      await new Promise(resolve => setTimeout(resolve, 1000 * 1.5 ** attempt));\r\n      return this.#initAutocompleteWithRetry(attempt + 1);\r\n    }\r\n  \r\n    #initializeAutocomplete() {\r\n      const { shipping, billing } = this.#elements;\r\n      [shipping, billing].forEach(fields => {\r\n        if (fields.address) {\r\n          this.#setupAutocomplete(fields.address, fields);\r\n          this.#logger.debug(`Autocomplete set up for ${fields.address.getAttribute('os-checkout-field')}`);\r\n        }\r\n      });\r\n    }\r\n  \r\n    #setupAutocomplete(input, fields) {\r\n      try {\r\n        const autocomplete = new google.maps.places.Autocomplete(input, {\r\n          types: ['address'],\r\n          fields: ['address_components', 'formatted_address'],\r\n        });\r\n  \r\n        autocomplete.addListener('place_changed', () => {\r\n          const place = autocomplete.getPlace();\r\n          if (!place.address_components) return;\r\n  \r\n          this.#showLocationFields();\r\n          const components = Object.fromEntries(\r\n            place.address_components.map(c => [c.types[0], { long: c.long_name, short: c.short_name }])\r\n          );\r\n  \r\n          fields.address.value = [components.street_number?.long, components.route?.long].filter(Boolean).join(' ');\r\n          fields.city && (fields.city.value = components.locality?.long ?? '');\r\n          fields.zip && (fields.zip.value = components.postal_code?.long ?? '');\r\n  \r\n          if (fields.country && components.country) {\r\n            const countryCode = components.country.short;\r\n            if (fields.country.value !== countryCode) {\r\n              fields.country.value = countryCode;\r\n              fields.country.dispatchEvent(new Event('change', { bubbles: true }));\r\n              this.#logger.debug(`Country set to ${countryCode}`);\r\n            }\r\n            if (fields.state && components.administrative_area_level_1) {\r\n              this.#setStateWithRetry(fields.state, components.administrative_area_level_1.short);\r\n            }\r\n          }\r\n  \r\n          [fields.address, fields.city, fields.zip].forEach(el => el?.dispatchEvent(new Event('change', { bubbles: true })));\r\n        });\r\n  \r\n        input.addEventListener('blur', () => input.value.length > 10 && this.#showLocationFields());\r\n        input.addEventListener('keydown', e => e.key === 'Enter' && e.preventDefault());\r\n      } catch (error) {\r\n        this.#logger.error('Autocomplete setup failed:', error);\r\n        this.#setupBasicFieldListeners();\r\n      }\r\n    }\r\n  \r\n    async #setStateWithRetry(stateSelect, stateCode, attempt = 0) {\r\n      if (attempt >= 5) {\r\n        this.#logger.warn(`Failed to set state ${stateCode} after 5 attempts`);\r\n        return;\r\n      }\r\n      await new Promise(resolve => setTimeout(resolve, 300 * 1.5 ** attempt));\r\n  \r\n      const hasOption = Array.from(stateSelect.options).some(opt => opt.value === stateCode);\r\n      if (hasOption) {\r\n        stateSelect.value = stateCode;\r\n        stateSelect.dispatchEvent(new Event('change', { bubbles: true }));\r\n        this.#logger.debug(`State set to ${stateCode}`);\r\n      } else {\r\n        this.#setStateWithRetry(stateSelect, stateCode, attempt + 1);\r\n      }\r\n    }\r\n  \r\n    #setupBasicFieldListeners() {\r\n      [this.#elements.shipping.address, this.#elements.billing.address].forEach(field => {\r\n        field?.addEventListener('blur', () => field.value.length > 10 && this.#showLocationFields());\r\n      });\r\n      this.#logger.debug('Basic field listeners set up');\r\n    }\r\n  \r\n    #setupAutofillDetection() {\r\n      const style = document.createElement('style');\r\n      style.textContent = `\r\n        @keyframes onAutoFillStart { from { opacity: 0.99; } to { opacity: 1; } }\r\n        input:-webkit-autofill { animation-name: onAutoFillStart; }\r\n      `;\r\n      document.head.appendChild(style);\r\n  \r\n      const fields = [this.#elements.shipping.address, this.#elements.billing.address].filter(Boolean);\r\n      fields.forEach(field => {\r\n        field.addEventListener('input', () => field.value.length > 10 && this.#showLocationFields());\r\n        field.addEventListener('change', () => field.value.length > 0 && this.#showLocationFields());\r\n        field.addEventListener('animationstart', e => {\r\n          if (e.animationName === 'onAutoFillStart') {\r\n            this.#logger.debug(`Autofill detected on ${field.getAttribute('os-checkout-field')}`);\r\n            this.#showLocationFields();\r\n          }\r\n        });\r\n      });\r\n      this.#logger.debug('Autofill detection initialized');\r\n    }\r\n  }", "export class PhoneInputHandler {\r\n  #logger;\r\n  #intlTelInputAvailable = !!window.intlTelInput;\r\n\r\n  constructor(logger) {\r\n    this.#logger = logger;\r\n\r\n    if (!this.#intlTelInputAvailable) {\r\n      this.#logger.warn('intlTelInput not found, loading dynamically');\r\n      this.#loadIntlTelInput().then(() => this.#initPhoneInputs());\r\n    } else {\r\n      this.#logger.info('intlTelInput available, initializing phone inputs');\r\n      this.#initPhoneInputs();\r\n    }\r\n  }\r\n\r\n  async #loadIntlTelInput() {\r\n    const resources = [\r\n      { tag: 'link', rel: 'stylesheet', href: 'https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.min.css' },\r\n      { tag: 'script', src: 'https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js', async: true },\r\n      { tag: 'script', src: 'https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js', async: true },\r\n    ];\r\n\r\n    await Promise.all(resources.map(({ tag, ...attrs }) => {\r\n      const element = document.createElement(tag);\r\n      Object.assign(element, attrs);\r\n      document.head.appendChild(element);\r\n      return tag === 'link' ? Promise.resolve() : new Promise(resolve => element.onload = resolve);\r\n    }));\r\n\r\n    this.#intlTelInputAvailable = true;\r\n    this.#logger.debug('intlTelInput and utils loaded');\r\n  }\r\n\r\n  #initPhoneInputs() {\r\n    if (!this.#intlTelInputAvailable) return;\r\n\r\n    const phoneInputs = document.querySelectorAll('input[type=\"tel\"]');\r\n    this.#logger.info(`Found ${phoneInputs.length} phone inputs`);\r\n    phoneInputs.forEach((input, i) => this.#initializePhoneInput(input, i + 1));\r\n  }\r\n\r\n  #initializePhoneInput(input, index) {\r\n    try {\r\n      const iti = window.intlTelInput(input, {\r\n        utilsScript: 'https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js',\r\n        separateDialCode: true,\r\n        onlyCountries: ['us'],\r\n        initialCountry: 'us',\r\n        allowDropdown: false,\r\n        dropdownContainer: document.body,\r\n        useFullscreenPopup: true,\r\n        formatOnDisplay: true,\r\n        autoPlaceholder: 'aggressive',\r\n        customContainer: 'iti-tel-input',\r\n        autoFormat: true,\r\n        nationalMode: true\r\n      });\r\n\r\n      input.iti = iti;\r\n      this.#logger.debug(`Phone input ${index} (${input.getAttribute('os-checkout-field') ?? 'unknown'}) initialized`);\r\n\r\n      this.#setupPhoneInputSync(input, iti);\r\n      this.#setupPhoneValidation(input, iti);\r\n\r\n      // Add input event listener for formatting and validation\r\n      input.addEventListener('input', () => {\r\n        const number = input.value.trim();\r\n        \r\n        // Format the number as user types\r\n        if (number) {\r\n          // Remove all non-numeric characters\r\n          const numericValue = number.replace(/\\D/g, '');\r\n          \r\n          // Format according to US pattern (XXX) XXX-XXXX\r\n          let formattedNumber = '';\r\n          if (numericValue.length > 0) {\r\n            if (numericValue.length <= 3) {\r\n              formattedNumber = `(${numericValue}`;\r\n            } else if (numericValue.length <= 6) {\r\n              formattedNumber = `(${numericValue.slice(0, 3)}) ${numericValue.slice(3)}`;\r\n            } else {\r\n              formattedNumber = `(${numericValue.slice(0, 3)}) ${numericValue.slice(3, 6)}-${numericValue.slice(6, 10)}`;\r\n            }\r\n          }\r\n          \r\n          // Only update if the format is different to avoid cursor jumping\r\n          if (input.value !== formattedNumber) {\r\n            // Store cursor position\r\n            const cursorPos = input.selectionStart;\r\n            const oldLength = input.value.length;\r\n            \r\n            // Update value\r\n            input.value = formattedNumber;\r\n            \r\n            // Calculate new cursor position\r\n            if (cursorPos !== null) {\r\n              const newLength = formattedNumber.length;\r\n              const cursorOffset = newLength - oldLength;\r\n              input.setSelectionRange(cursorPos + cursorOffset, cursorPos + cursorOffset);\r\n            }\r\n          }\r\n        }\r\n\r\n        const isValid = iti.isValidNumber();\r\n        const numberType = iti.getNumberType();\r\n        const validationError = iti.getValidationError();\r\n\r\n        // Clear any existing error if the field is empty\r\n        if (!number) {\r\n          this.#clearError(input);\r\n          return;\r\n        }\r\n\r\n        console.group('Phone Number Validation');\r\n        console.log('Number:', number);\r\n        console.log('Is Valid:', isValid);\r\n        console.log('Formatted Number:', iti.getNumber());\r\n        console.log('Number Type:', this.#getNumberTypeName(numberType));\r\n        console.log('Validation Error:', validationError);\r\n        console.groupEnd();\r\n\r\n        this.#logger.debug('Phone validation:', {\r\n          number,\r\n          isValid,\r\n          formattedNumber: iti.getNumber(),\r\n          type: this.#getNumberTypeName(numberType),\r\n          error: validationError\r\n        });\r\n      });\r\n\r\n      // Add blur event for validation and final formatting\r\n      input.addEventListener('blur', () => {\r\n        const number = input.value.trim();\r\n        if (number) {\r\n          const isValid = iti.isValidNumber();\r\n          \r\n          // On blur, ensure the number is in full international format\r\n          if (isValid) {\r\n            input.value = iti.getNumber(intlTelInputUtils.numberFormat.NATIONAL);\r\n          }\r\n          \r\n          console.log('Phone field blur - Final validation:', {\r\n            number,\r\n            isValid,\r\n            formattedNumber: iti.getNumber()\r\n          });\r\n\r\n          if (!isValid) {\r\n            this.#showError(input, 'Please enter a valid US phone number (e.g. 555-555-5555)');\r\n          } else {\r\n            this.#clearError(input);\r\n          }\r\n        }\r\n      });\r\n\r\n    } catch (error) {\r\n      this.#logger.error(`Error initializing phone input ${index}:`, error);\r\n    }\r\n  }\r\n\r\n  #showError(input, message) {\r\n    // Add error class to input\r\n    input.classList.add('error');\r\n    \r\n    // Add error class to iti container\r\n    const itiContainer = input.closest('.iti');\r\n    if (itiContainer) {\r\n      itiContainer.classList.add('error');\r\n      itiContainer.style.border = '1px solid red';\r\n    }\r\n    \r\n    // Find or create error message element\r\n    const wrapper = input.closest('.frm-flds') || input.closest('.form-group');\r\n    let errorElement = wrapper.querySelector('.pb-input-error');\r\n    if (!errorElement) {\r\n      errorElement = document.createElement('div');\r\n      errorElement.className = 'pb-input-error';\r\n      wrapper.appendChild(errorElement);\r\n    }\r\n    \r\n    // Set error message and styles\r\n    errorElement.textContent = message;\r\n    Object.assign(errorElement.style, {\r\n      color: 'red',\r\n      fontSize: '0.875rem',\r\n      marginTop: '0.25rem',\r\n      display: 'block',\r\n      position: 'relative',\r\n      clear: 'both'\r\n    });\r\n  }\r\n\r\n  #clearError(input) {\r\n    // Remove error class from input\r\n    input.classList.remove('error');\r\n    \r\n    // Remove error class from iti container\r\n    const itiContainer = input.closest('.iti');\r\n    if (itiContainer) {\r\n      itiContainer.classList.remove('error');\r\n      itiContainer.style.border = '';\r\n    }\r\n    \r\n    // Remove error message\r\n    const wrapper = input.closest('.frm-flds') || input.closest('.form-group');\r\n    const errorElement = wrapper.querySelector('.pb-input-error');\r\n    if (errorElement) {\r\n      errorElement.remove();\r\n    }\r\n  }\r\n\r\n  // Helper method to convert number type to readable name\r\n  #getNumberTypeName(type) {\r\n    const types = {\r\n      0: 'FIXED_LINE',\r\n      1: 'MOBILE',\r\n      2: 'FIXED_LINE_OR_MOBILE',\r\n      3: 'TOLL_FREE',\r\n      4: 'PREMIUM_RATE',\r\n      5: 'SHARED_COST',\r\n      6: 'VOIP',\r\n      7: 'PERSONAL_NUMBER',\r\n      8: 'PAGER',\r\n      9: 'UAN',\r\n      10: 'UNKNOWN'\r\n    };\r\n    return types[type] || 'UNKNOWN';\r\n  }\r\n\r\n  #setupPhoneInputSync(input, iti) {\r\n    const fieldAttr = input.getAttribute('os-checkout-field');\r\n    if (!fieldAttr) {\r\n      this.#logger.warn('Phone input missing os-checkout-field attribute');\r\n      return;\r\n    }\r\n\r\n    const countrySelect = document.querySelector(\r\n      fieldAttr === 'phone' ? '[os-checkout-field=\"country\"]' : '[os-checkout-field=\"billing-country\"]'\r\n    );\r\n\r\n    if (!countrySelect) {\r\n      this.#logger.warn(`Country select not found for ${fieldAttr}`);\r\n      return;\r\n    }\r\n\r\n    // Set country select to US if it exists\r\n    if (countrySelect.value !== 'US') {\r\n      countrySelect.value = 'US';\r\n      countrySelect.dispatchEvent(new Event('change', { bubbles: true }));\r\n      this.#logger.debug('Country select updated to US');\r\n    }\r\n  }\r\n\r\n  #setupPhoneValidation(input, iti) {\r\n    input.validatePhone = () => !input.value.trim() ? !input.hasAttribute('required') : iti.isValidNumber();\r\n    input.getFormattedNumber = () => iti.getNumber();\r\n\r\n    const form = input.closest('form');\r\n    form?.addEventListener('submit', () => {\r\n      if (input.value.trim() && iti.isValidNumber()) {\r\n        input.value = iti.getNumber();\r\n        this.#logger.debug(`Formatted phone number set to ${input.value} on submit`);\r\n      }\r\n    });\r\n  }\r\n}", "/**\r\n * ProspectCartHandler - Creates carts for users based on form data\r\n * \r\n * This component monitors checkout form fields and creates a cart in the API\r\n * when users fill out their email and other information. This helps with:\r\n * 1. Lead capture for abandoned carts\r\n * 2. Analytics for checkout funnel optimization\r\n * 3. Enabling cart recovery emails\r\n */\r\n\r\nexport class ProspectCartHandler {\r\n  #app;\r\n  #logger;\r\n  #initialized = false;\r\n  #cartCreated = false;\r\n  #cartAttempted = false;\r\n  #beginCheckoutFired = false; // Track if beginCheckout event has been fired\r\n  #debounceTimeout = null;\r\n  #debounceDelay = 3000; // 3 seconds debounce\r\n  #lastFormData = null; // Track the last form data we attempted to use\r\n  \r\n  // Form field selectors\r\n  #selectors = {\r\n    firstName: '[os-checkout-field=\"fname\"]',\r\n    lastName: '[os-checkout-field=\"lname\"]',\r\n    email: '[os-checkout-field=\"email\"]',\r\n    phone: '[os-checkout-field=\"phone\"]',\r\n    address1: '[os-checkout-field=\"address1\"]',\r\n    address2: '[os-checkout-field=\"address2\"]',\r\n    city: '[os-checkout-field=\"city\"]',\r\n    province: '[os-checkout-field=\"province\"]',\r\n    postal: '[os-checkout-field=\"postal\"]',\r\n    country: '[os-checkout-field=\"country\"]'\r\n  };\r\n  \r\n  // Form fields\r\n  #fields = {\r\n    firstName: null,\r\n    lastName: null,\r\n    email: null,\r\n    phone: null,\r\n    address1: null,\r\n    address2: null,\r\n    city: null,\r\n    province: null,\r\n    postal: null,\r\n    country: null\r\n  };\r\n  \r\n  // Email validation regex\r\n  #emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n\r\n  /**\r\n   * Initialize the ProspectCartHandler\r\n   * @param {Object} app - The main application instance\r\n   */\r\n  constructor(app) {\r\n    this.#app = app;\r\n    \r\n    // Create a module-specific logger\r\n    if (this.#app && this.#app.logger) {\r\n      this.#logger = this.#app.logger.createModuleLogger('PROSPECT');\r\n    } else {\r\n      // Create a simple logger fallback\r\n      this.#logger = {\r\n        debug: (message, data) => console.log(`[PROSPECT DEBUG] ${message}`, data !== undefined ? data : ''),\r\n        info: (message, data) => console.info(`[PROSPECT INFO] ${message}`, data !== undefined ? data : ''),\r\n        warn: (message, data) => console.warn(`[PROSPECT WARN] ${message}`, data !== undefined ? data : ''),\r\n        error: (message, data) => console.error(`[PROSPECT ERROR] ${message}`, data !== undefined ? data : '')\r\n      };\r\n    }\r\n    \r\n    // Initialize the component\r\n    this.#init();\r\n  }\r\n  \r\n  /**\r\n   * Initialize the component\r\n   */\r\n  #init() {\r\n    this.#logger.info('Initializing ProspectCartHandler');\r\n    \r\n    // Find form fields\r\n    this.#findFormFields();\r\n    \r\n    // If required fields are found, attach event listeners\r\n    if (this.#fields.email && (this.#fields.firstName || this.#fields.lastName)) {\r\n      this.#attachEventListeners();\r\n      this.#initialized = true;\r\n      this.#logger.info('ProspectCartHandler initialized successfully');\r\n    } else {\r\n      this.#logger.warn('Required form fields not found, ProspectCartHandler not initialized');\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Find form fields in the DOM\r\n   */\r\n  #findFormFields() {\r\n    // Find each form field\r\n    Object.keys(this.#selectors).forEach(field => {\r\n      this.#fields[field] = document.querySelector(this.#selectors[field]);\r\n      \r\n      // Also try with data-os-field attribute if not found\r\n      if (!this.#fields[field]) {\r\n        const altSelector = this.#selectors[field].replace('os-checkout-field', 'data-os-field');\r\n        this.#fields[field] = document.querySelector(altSelector);\r\n      }\r\n      \r\n      // Log if field is found\r\n      if (this.#fields[field]) {\r\n        this.#logger.debug(`Found ${field} field`);\r\n      } else {\r\n        this.#logger.debug(`${field} field not found`);\r\n      }\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Attach event listeners to form fields\r\n   */\r\n  #attachEventListeners() {\r\n    // Attach blur event listeners to key fields\r\n    if (this.#fields.email) {\r\n      this.#fields.email.addEventListener('blur', () => this.#handleFieldChange());\r\n    }\r\n    \r\n    if (this.#fields.firstName) {\r\n      this.#fields.firstName.addEventListener('blur', () => this.#handleFieldChange());\r\n    }\r\n    \r\n    if (this.#fields.lastName) {\r\n      this.#fields.lastName.addEventListener('blur', () => this.#handleFieldChange());\r\n    }\r\n    \r\n    // Listen for form submission to prevent multiple cart creation attempts\r\n    const form = document.querySelector('form[os-checkout=\"form\"]');\r\n    if (form) {\r\n      form.addEventListener('submit', () => {\r\n        // If the form is being submitted, we don't need to create a prospect cart\r\n        this.#cartAttempted = true;\r\n        if (this.#debounceTimeout) {\r\n          clearTimeout(this.#debounceTimeout);\r\n        }\r\n      });\r\n    }\r\n    \r\n    this.#logger.debug('Event listeners attached to form fields');\r\n  }\r\n  \r\n  /**\r\n   * Handle field change event\r\n   */\r\n  #handleFieldChange() {\r\n    // If cart already created or attempted, don't try again\r\n    if (this.#cartCreated || this.#cartAttempted) {\r\n      return;\r\n    }\r\n    \r\n    // Clear any existing timeout\r\n    if (this.#debounceTimeout) {\r\n      clearTimeout(this.#debounceTimeout);\r\n    }\r\n    \r\n    // Check if we should fire the beginCheckout event\r\n    // We do this before the debounce to capture the intent early\r\n    this.#checkAndFireBeginCheckout();\r\n    \r\n    // Set a new timeout to debounce the cart creation\r\n    this.#debounceTimeout = setTimeout(() => {\r\n      this.#checkAndCreateCart();\r\n    }, this.#debounceDelay);\r\n  }\r\n  \r\n  /**\r\n   * Check if we should fire the beginCheckout event\r\n   * and fire it if we haven't already\r\n   */\r\n  #checkAndFireBeginCheckout() {\r\n    // If we've already fired the event, don't fire it again\r\n    if (this.#beginCheckoutFired) {\r\n      return;\r\n    }\r\n    \r\n    // Check if we have enough information to consider this a checkout start\r\n    const hasEmail = this.#fields.email && \r\n                    this.#fields.email.value && \r\n                    this.#fields.email.value.trim().length > 0;\r\n                    \r\n    const hasName = (this.#fields.firstName && this.#fields.firstName.value && \r\n                    this.#fields.firstName.value.trim().length > 0) || \r\n                    (this.#fields.lastName && this.#fields.lastName.value && \r\n                    this.#fields.lastName.value.trim().length > 0);\r\n    \r\n    // If the user has entered an email or name, consider it a checkout start\r\n    if (hasEmail || hasName) {\r\n      this.#logger.debug('User has started entering checkout information, firing beginCheckout event');\r\n      \r\n      // Fire the beginCheckout event\r\n      if (this.#app.events) {\r\n        this.#app.events.beginCheckout();\r\n        this.#beginCheckoutFired = true;\r\n        this.#logger.info('beginCheckout event fired');\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Check if we have enough information to create a cart\r\n   * and create it if we do\r\n   */\r\n  #checkAndCreateCart() {\r\n    // If cart already created or attempted, don't create another one\r\n    if (this.#cartCreated || this.#cartAttempted) {\r\n      this.#logger.debug('Cart already created or attempted, skipping');\r\n      return;\r\n    }\r\n    \r\n    // Check if we have enough information to create a cart\r\n    if (!this.#hasMinimumRequiredFields()) {\r\n      this.#logger.debug('Not enough information to create a cart');\r\n      return;\r\n    }\r\n    \r\n    // Check if the form data has changed since our last attempt\r\n    const currentFormData = this.#getFormData();\r\n    if (this.#lastFormData && this.#isSameFormData(currentFormData, this.#lastFormData)) {\r\n      this.#logger.debug('Form data has not changed since last attempt, skipping');\r\n      return;\r\n    }\r\n    \r\n    // Store the current form data\r\n    this.#lastFormData = currentFormData;\r\n    \r\n    // Mark that we've attempted to create a cart\r\n    this.#cartAttempted = true;\r\n    \r\n    // Create the cart\r\n    this.#createProspectCart();\r\n  }\r\n  \r\n  /**\r\n   * Check if we have the minimum required fields to create a cart\r\n   * @returns {boolean} Whether we have the minimum required fields\r\n   */\r\n  #hasMinimumRequiredFields() {\r\n    // We need a valid email\r\n    const hasValidEmail = this.#fields.email && \r\n                         this.#fields.email.value && \r\n                         this.#emailRegex.test(this.#fields.email.value);\r\n    \r\n    if (!hasValidEmail) {\r\n      this.#logger.debug('Email is missing or invalid');\r\n      return false;\r\n    }\r\n    \r\n    // We need at least one name field (first or last)\r\n    const hasFirstName = this.#fields.firstName && \r\n                        this.#fields.firstName.value && \r\n                        this.#fields.firstName.value.trim().length >= 2;\r\n    \r\n    const hasLastName = this.#fields.lastName && \r\n                       this.#fields.lastName.value && \r\n                       this.#fields.lastName.value.trim().length >= 2;\r\n    \r\n    if (!hasFirstName && !hasLastName) {\r\n      this.#logger.debug('First name and last name are missing or too short');\r\n      return false;\r\n    }\r\n    \r\n    this.#logger.debug('Minimum required fields are present');\r\n    return true;\r\n  }\r\n  \r\n  /**\r\n   * Get the current form data\r\n   * @returns {Object} The form data\r\n   */\r\n  #getFormData() {\r\n    const data = {};\r\n    \r\n    // Get values from all fields\r\n    Object.keys(this.#fields).forEach(field => {\r\n      if (this.#fields[field]) {\r\n        data[field] = this.#fields[field].value;\r\n      }\r\n    });\r\n    \r\n    return data;\r\n  }\r\n  \r\n  /**\r\n   * Check if two form data objects are the same\r\n   * @param {Object} data1 - The first form data object\r\n   * @param {Object} data2 - The second form data object\r\n   * @returns {boolean} Whether the form data objects are the same\r\n   */\r\n  #isSameFormData(data1, data2) {\r\n    // Check if the required fields are the same\r\n    return data1.email === data2.email && \r\n           data1.firstName === data2.firstName && \r\n           data1.lastName === data2.lastName;\r\n  }\r\n  \r\n  /**\r\n   * Create a prospect cart\r\n   */\r\n  #createProspectCart() {\r\n    this.#logger.info('Creating prospect cart');\r\n    \r\n    // Get cart data from StateManager\r\n    const cartData = this.#app.state.getState('cart');\r\n    \r\n    // If cart has no lines, don't create a cart\r\n    if (!cartData || !cartData.items || cartData.items.length === 0) {\r\n      this.#logger.warn('No cart items available, skipping cart creation');\r\n      this.#cartAttempted = false; // Reset so we can try again later\r\n      return;\r\n    }\r\n    \r\n    // Get attribution data from state - it's already initialized and stored\r\n    const attributionData = cartData.attribution || {};\r\n    this.#logger.debug('Using attribution data from state', attributionData);\r\n    \r\n    // Get user information\r\n    const firstName = this.#fields.firstName ? this.#fields.firstName.value : '';\r\n    const lastName = this.#fields.lastName ? this.#fields.lastName.value : '';\r\n    const email = this.#fields.email ? this.#fields.email.value : '';\r\n    const phone = this.#getPhoneNumber();\r\n    \r\n    // Update user state with user information\r\n    this.#updateUserState(email, firstName, lastName, phone);\r\n    \r\n    // Create cart data object with essential information\r\n    const prospectCartData = {\r\n      lines: cartData.items.map(item => {\r\n        // Create the line item with required properties\r\n        const lineItem = {\r\n          package_id: item.id,\r\n          quantity: item.quantity || 1\r\n        };\r\n        \r\n        // Preserve is_upsell flag if it exists\r\n        if (item.is_upsell === true) {\r\n          lineItem.is_upsell = true;\r\n          this.#logger.debug(`Adding upsell item to prospect cart: ${item.id}`);\r\n        }\r\n        \r\n        return lineItem;\r\n      }),\r\n      user: {\r\n        first_name: firstName,\r\n        last_name: lastName,\r\n        email: email\r\n      },\r\n      attribution: attributionData\r\n    };\r\n\r\n    // Only add phone number if it's valid\r\n    if (phone) {\r\n      prospectCartData.user.phone_number = phone;\r\n    } else {\r\n      this.#logger.warn('Invalid phone number format - sending cart without phone number');\r\n    }\r\n    \r\n    // Add shipping method if available\r\n    if (cartData.shippingMethod) {\r\n      prospectCartData.shipping_method = cartData.shippingMethod.code || cartData.shippingMethod.id;\r\n    }\r\n    \r\n    // Only add address data if it's complete and valid\r\n    const addressData = this.#getValidAddressData();\r\n    if (addressData && Object.keys(addressData).length > 0) {\r\n      // Check if we have a valid address (with valid postal code if country is provided)\r\n      if (this.#isAddressValid(addressData)) {\r\n        this.#logger.debug('Adding valid address data to cart');\r\n        prospectCartData.address = addressData;\r\n      } else {\r\n        this.#logger.info('Address data is incomplete or invalid - sending cart with user info only');\r\n      }\r\n    } else {\r\n      this.#logger.debug('No address data available - sending cart with user info only');\r\n    }\r\n    \r\n    // Create the cart via API\r\n    this.#createCartViaApi(prospectCartData);\r\n  }\r\n  \r\n  /**\r\n   * Update user state with user information\r\n   * @param {string} email - User's email\r\n   * @param {string} firstName - User's first name\r\n   * @param {string} lastName - User's last name\r\n   * @param {string} phone - User's phone number\r\n   */\r\n  #updateUserState(email, firstName, lastName, phone) {\r\n    if (!this.#app.state) {\r\n      this.#logger.warn('State manager not available, cannot update user state');\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      // Get current user state\r\n      const currentUser = this.#app.state.getState('user') || {};\r\n      \r\n      // Update user state with new information\r\n      const updatedUser = {\r\n        ...currentUser,\r\n        email: email || currentUser.email,\r\n        firstName: firstName || currentUser.firstName,\r\n        lastName: lastName || currentUser.lastName,\r\n        phone: phone || currentUser.phone\r\n      };\r\n      \r\n      // Set the updated user state\r\n      this.#app.state.setState('user', updatedUser);\r\n      this.#logger.debug('Updated user state with user information', updatedUser);\r\n    } catch (error) {\r\n      this.#logger.error('Error updating user state:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Check if address data is valid\r\n   * @param {Object} address - The address data\r\n   * @returns {boolean} Whether the address is valid\r\n   */\r\n  #isAddressValid(address) {\r\n    // If we have a country but no postal code, or an invalid postal code, the address is invalid\r\n    if (address.country === 'US' && (!address.postcode || !this.#isValidPostalCode(address.postcode, 'US'))) {\r\n      this.#logger.warn('US address requires a valid postal code');\r\n      return false;\r\n    }\r\n    \r\n    // For other countries, we're less strict\r\n    return true;\r\n  }\r\n  \r\n  /**\r\n   * Get address data from form fields, validating postal code if present\r\n   * @returns {Object} The validated address data\r\n   */\r\n  #getValidAddressData() {\r\n    // Get country and postal code first to check validity\r\n    const country = this.#fields.country && this.#fields.country.value ? \r\n                   this.#fields.country.value : '';\r\n    \r\n    const postalCode = this.#fields.postal && this.#fields.postal.value ? \r\n                      this.#fields.postal.value : '';\r\n    \r\n    // For US addresses, if postal code is invalid, don't include any address data\r\n    if (country === 'US' && postalCode && !this.#isValidPostalCode(postalCode, country)) {\r\n      this.#logger.warn(`Invalid postal code for US: ${postalCode} - omitting all address data`);\r\n      return null;\r\n    }\r\n    \r\n    // Only include address fields that have values\r\n    const address = {};\r\n    \r\n    // Add name and phone to address if available\r\n    if (this.#fields.firstName && this.#fields.firstName.value) {\r\n      address.first_name = this.#fields.firstName.value;\r\n    }\r\n    \r\n    if (this.#fields.lastName && this.#fields.lastName.value) {\r\n      address.last_name = this.#fields.lastName.value;\r\n    }\r\n    \r\n    const phone = this.#getPhoneNumber();\r\n    if (phone) {\r\n      address.phone_number = phone;\r\n    }\r\n    \r\n    // Add optional address fields if they have values\r\n    if (this.#fields.address1 && this.#fields.address1.value) {\r\n      address.line1 = this.#fields.address1.value;\r\n    }\r\n    \r\n    if (this.#fields.address2 && this.#fields.address2.value) {\r\n      address.line2 = this.#fields.address2.value;\r\n    }\r\n    \r\n    if (this.#fields.city && this.#fields.city.value) {\r\n      address.line4 = this.#fields.city.value; // City\r\n    }\r\n    \r\n    if (this.#fields.province && this.#fields.province.value) {\r\n      address.state = this.#fields.province.value;\r\n    }\r\n    \r\n    // Add country and postal code if available and valid\r\n    if (country) {\r\n      address.country = country;\r\n    }\r\n    \r\n    if (postalCode && (!country || this.#isValidPostalCode(postalCode, country))) {\r\n      address.postcode = postalCode;\r\n    }\r\n    \r\n    return address;\r\n  }\r\n  \r\n  /**\r\n   * Check if a postal code is valid for a country\r\n   * @param {string} postalCode - The postal code to validate\r\n   * @param {string} country - The country code\r\n   * @returns {boolean} Whether the postal code is valid\r\n   */\r\n  #isValidPostalCode(postalCode, country) {\r\n    // Skip validation if no postal code or country\r\n    if (!postalCode || !country) {\r\n      return true;\r\n    }\r\n    \r\n    // Validate based on country\r\n    switch (country.toUpperCase()) {\r\n      case 'US':\r\n        // US postal codes should be 5 digits or 5+4 digits\r\n        return /^\\d{5}(-\\d{4})?$/.test(postalCode);\r\n        \r\n      case 'CA':\r\n        // Canadian postal codes: A1A 1A1\r\n        return /^[A-Za-z]\\d[A-Za-z][ -]?\\d[A-Za-z]\\d$/.test(postalCode);\r\n        \r\n      case 'GB':\r\n      case 'UK':\r\n        // UK postal codes are complex but generally follow this pattern\r\n        return /^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$/i.test(postalCode);\r\n        \r\n      case 'AU':\r\n        // Australian postal codes are 4 digits\r\n        return /^\\d{4}$/.test(postalCode);\r\n        \r\n      case 'NZ':\r\n        // New Zealand postal codes are 4 digits\r\n        return /^\\d{4}$/.test(postalCode);\r\n        \r\n      case 'DE':\r\n        // German postal codes are 5 digits\r\n        return /^\\d{5}$/.test(postalCode);\r\n        \r\n      case 'FR':\r\n        // French postal codes are 5 digits\r\n        return /^\\d{5}$/.test(postalCode);\r\n        \r\n      // Add more countries as needed\r\n        \r\n      default:\r\n        // For other countries, accept any non-empty string\r\n        // The API will validate if needed\r\n        return postalCode.trim().length > 0;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Get phone number from field, handling international format\r\n   * @returns {string} The phone number\r\n   */\r\n  #getPhoneNumber() {\r\n    if (!this.#fields.phone) return '';\r\n    \r\n    // Check if we have an international telephone input instance\r\n    if (this.#fields.phone.iti && typeof this.#fields.phone.iti.getNumber === 'function') {\r\n      const number = this.#fields.phone.iti.getNumber();\r\n      // Only return the number if it's valid\r\n      if (this.#fields.phone.iti.isValidNumber()) {\r\n        return number;\r\n      }\r\n      return ''; // Return empty string if invalid\r\n    }\r\n    \r\n    // If no international telephone input, validate the number format\r\n    const value = this.#fields.phone.value;\r\n    if (!value) return '';\r\n    \r\n    // Basic phone number validation\r\n    const phoneRegex = /^\\+?[1-9]\\d{1,14}$/;\r\n    return phoneRegex.test(value.replace(/\\D/g, '')) ? value : '';\r\n  }\r\n  \r\n  /**\r\n   * Create a cart via the API\r\n   * @param {Object} cartData - The cart data\r\n   */\r\n  #createCartViaApi(cartData) {\r\n    // Check if we have access to the API client\r\n    if (!this.#app.api || typeof this.#app.api.createCart !== 'function') {\r\n      this.#logger.error('API client not available');\r\n      this.#cartAttempted = false; // Reset so we can try again later\r\n      return;\r\n    }\r\n    \r\n    // Log the cart data being sent\r\n    this.#logger.debug('Sending cart data to API', cartData);\r\n    \r\n    // Create the cart\r\n    this.#app.api.createCart(cartData)\r\n      .then(response => {\r\n        this.#logger.info('Prospect cart created successfully', response);\r\n        this.#cartCreated = true;\r\n        \r\n        // Trigger prospect cart created event\r\n        if (this.#app.events) {\r\n          this.#app.events.trigger('prospect.cartCreated', {\r\n            cart: response\r\n          });\r\n          \r\n          // Trigger begin_checkout event for analytics if not already fired\r\n          if (!this.#beginCheckoutFired) {\r\n            this.#logger.info('Triggering beginCheckout event for analytics');\r\n            this.#app.events.beginCheckout();\r\n            this.#beginCheckoutFired = true;\r\n          } else {\r\n            this.#logger.debug('beginCheckout event already fired, skipping');\r\n          }\r\n        }\r\n      })\r\n      .catch(error => {\r\n        this.#logger.error('Error creating prospect cart', error);\r\n        // Reset the attempted flag so we can try again later with different data\r\n        this.#cartAttempted = false;\r\n      });\r\n  }\r\n  \r\n  /**\r\n   * Manually trigger the beginCheckout event\r\n   * This can be called from outside the class if needed\r\n   */\r\n  triggerBeginCheckout() {\r\n    if (this.#app && this.#app.events) {\r\n      // Only fire if not already fired\r\n      if (!this.#beginCheckoutFired) {\r\n        this.#logger.info('Manually triggering beginCheckout event');\r\n        this.#app.events.beginCheckout();\r\n        this.#beginCheckoutFired = true;\r\n        return true;\r\n      } else {\r\n        this.#logger.debug('beginCheckout event already fired, skipping');\r\n        return false;\r\n      }\r\n    } else {\r\n      this.#logger.warn('Cannot trigger beginCheckout event: Events manager not available');\r\n      return false;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Reset the beginCheckout flag\r\n   * This can be used if the user clears the form or starts over\r\n   */\r\n  resetBeginCheckoutFlag() {\r\n    this.#beginCheckoutFired = false;\r\n    this.#logger.debug('Reset beginCheckout flag');\r\n    return true;\r\n  }\r\n} ", "/**\r\n * CheckoutPage - Handles checkout page functionality\r\n * \r\n * This class is responsible for initializing and managing the checkout page,\r\n * including form validation, payment processing, and address handling.\r\n */\r\n\r\nimport { AddressHandler } from '../components/checkout/AddressHandler.js';\r\nimport { FormValidator } from '../components/checkout/FormValidator.js';\r\nimport { PaymentHandler } from '../components/checkout/PaymentHandler.js';\r\nimport { BillingAddressHandler } from '../components/checkout/BillingAddressHandler.js';\r\nimport { PaymentSelector } from '../components/checkout/PaymentSelector.js';\r\nimport { AddressAutocomplete } from '../components/checkout/AddressAutocomplete.js';\r\nimport { PhoneInputHandler } from '../components/checkout/PhoneInputHandler.js';\r\nimport { ProspectCartHandler } from '../components/checkout/ProspectCartHandler.js';\r\nimport { KonamiCodeHandler } from '../utils/KonamiCodeHandler.js';\r\n\r\nexport class CheckoutPage {\r\n  #apiClient;\r\n  #logger;\r\n  #form;\r\n  #app;\r\n  #konamiCodeHandler;\r\n\r\n  constructor(apiClient, logger, app) {\r\n    this.#apiClient = apiClient;\r\n    this.#logger = logger;\r\n    this.#app = app; // Store the app instance for use with ProspectCartHandler\r\n    this.#form = document.querySelector('form[os-checkout=\"form\"]') || document.querySelector('form#combo_form');\r\n    \r\n    if (!this.#form) {\r\n      this.#logger.warn('No checkout form found with [os-checkout=\"form\"] selector or form#combo_form');\r\n      return;\r\n    }\r\n    \r\n    // CRITICAL: Remove any action and set method to post to prevent URL serialization\r\n    this.#form.removeAttribute('action');\r\n    this.#form.setAttribute('method', 'post');\r\n    this.#form.setAttribute('novalidate', 'novalidate');\r\n    \r\n    // Add a hidden input to indicate JavaScript is enabled\r\n    const hiddenInput = document.createElement('input');\r\n    hiddenInput.type = 'hidden';\r\n    hiddenInput.name = 'js_enabled';\r\n    hiddenInput.value = 'true';\r\n    this.#form.appendChild(hiddenInput);\r\n    \r\n    // Add a hidden input to prevent serialization\r\n    const preventSerializationInput = document.createElement('input');\r\n    preventSerializationInput.type = 'hidden';\r\n    preventSerializationInput.name = 'prevent_serialization';\r\n    preventSerializationInput.value = 'true';\r\n    this.#form.appendChild(preventSerializationInput);\r\n    \r\n    // Add multiple layers of form submission prevention\r\n    const preventSubmit = (e) => {\r\n      if (e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        e.stopImmediatePropagation();\r\n      }\r\n      \r\n      // Ensure form doesn't have action and has post method\r\n      this.#form.removeAttribute('action');\r\n      this.#form.setAttribute('method', 'post');\r\n      \r\n      // Cancel any form submission that might be in progress\r\n      if (typeof window.stop === 'function') {\r\n        window.stop();\r\n      }\r\n      \r\n      this.#logger.debug('Form direct submission prevented');\r\n      return false;\r\n    };\r\n    \r\n    this.#form.addEventListener('submit', preventSubmit, true);\r\n    this.#form.onsubmit = preventSubmit;\r\n    \r\n    // Disable all submit buttons in the form\r\n    this.#disableSubmitButtons();\r\n    \r\n    this.#logger.debug('CheckoutPage initialized with form found');\r\n    this.#initializeComponents();\r\n    \r\n    // Initialize Konami code handler\r\n    this.#initKonamiCodeHandler();\r\n  }\r\n\r\n  #initializeComponents() {\r\n    try {\r\n      // First, fix the billing form by duplicating shipping form fields\r\n      this.#injectBillingFormFields();\r\n      \r\n      // Initialize components one by one with proper error handling\r\n      this.#initAddressHandler();\r\n      this.#initBillingAddressHandler();\r\n      this.#initPaymentSelector();\r\n      this.#initFormValidator();\r\n      this.#initPaymentHandler();\r\n      this.#initAddressAutocomplete();\r\n      this.#initPhoneInputHandler();\r\n      this.#initProspectCartHandler();\r\n      \r\n      this.#setupEventListeners();\r\n      \r\n      document.dispatchEvent(new CustomEvent('os:checkout.ready', {\r\n        detail: { checkoutPage: this }\r\n      }));\r\n      \r\n      this.#logger.info('Checkout page components initialized successfully');\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing checkout components', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialize the Konami code handler\r\n   */\r\n  #initKonamiCodeHandler() {\r\n    try {\r\n      // Create a new KonamiCodeHandler instance with a callback to trigger the Easter egg\r\n      this.#konamiCodeHandler = new KonamiCodeHandler({\r\n        callback: () => this.#triggerKonamiCodeEasterEgg(),\r\n        logger: this.#logger\r\n      });\r\n      \r\n      this.#logger.debug('Konami code handler initialized');\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing Konami code handler:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Trigger the Konami code Easter egg - create a test order with predefined data\r\n   */\r\n  #triggerKonamiCodeEasterEgg() {\r\n    try {\r\n      this.#logger.info('🎮 Konami code activated! Creating test order...');\r\n      \r\n      // Show the activation message\r\n      const messageElement = KonamiCodeHandler.showActivationMessage();\r\n      \r\n      // Process the test payment after a short delay\r\n      setTimeout(() => {\r\n        // Remove the message\r\n        document.body.removeChild(messageElement);\r\n        \r\n        // Process the test payment\r\n        if (this.paymentHandler) {\r\n          // Set Konami test mode\r\n          KonamiCodeHandler.setTestMode();\r\n          \r\n          // Process the payment - the payment handler will detect the Konami test mode\r\n          this.paymentHandler.processPayment();\r\n          \r\n          this.#logger.info('Konami code test order initiated');\r\n        } else {\r\n          this.#logger.error('Payment handler not initialized, cannot create test order');\r\n          alert('Could not create test order: Payment handler not initialized');\r\n        }\r\n      }, 2000);\r\n    } catch (error) {\r\n      this.#logger.error('Error triggering Konami code Easter egg:', error);\r\n    }\r\n  }\r\n\r\n  #initAddressHandler() {\r\n    try {\r\n      this.addressHandler = new AddressHandler(this.#form, this.#logger);\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing AddressHandler', error);\r\n    }\r\n  }\r\n\r\n  #initBillingAddressHandler() {\r\n    try {\r\n      this.billingAddressHandler = new BillingAddressHandler(this.#app);\r\n      \r\n      // Store the billing address handler on the form for access by other components\r\n      if (this.#form && this.billingAddressHandler) {\r\n        this.#form.__billingAddressHandler = this.billingAddressHandler;\r\n        this.#logger.debug('BillingAddressHandler initialized and attached to form');\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing BillingAddressHandler', error);\r\n    }\r\n  }\r\n\r\n  #initPaymentSelector() {\r\n    try {\r\n      this.paymentSelector = new PaymentSelector(this.#logger);\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing PaymentSelector', error);\r\n    }\r\n  }\r\n\r\n  #initFormValidator() {\r\n    try {\r\n      this.formValidator = new FormValidator({ \r\n        debugMode: window.location.search.includes('debug=true'),\r\n        logger: this.#logger\r\n      });\r\n      \r\n      if (this.#form && this.formValidator) {\r\n        this.#form.__formValidator = this.formValidator;\r\n        this.#logger.debug('FormValidator initialized and attached to form');\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing FormValidator', error);\r\n    }\r\n  }\r\n\r\n  #initPaymentHandler() {\r\n    try {\r\n      this.paymentHandler = new PaymentHandler(this.#apiClient, this.#logger, this.#app);\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing PaymentHandler', error);\r\n    }\r\n  }\r\n\r\n  #initAddressAutocomplete() {\r\n    try {\r\n      // Pass Google Maps options from the app instance\r\n      const googleMapsOptions = {\r\n        enableGoogleMapsAutocomplete: this.#app.options.enableGoogleMapsAutocomplete\r\n      };\r\n      \r\n      this.addressAutocomplete = new AddressAutocomplete(this.#logger, googleMapsOptions);\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing AddressAutocomplete', error);\r\n    }\r\n  }\r\n\r\n  #initPhoneInputHandler() {\r\n    try {\r\n      this.phoneInputHandler = new PhoneInputHandler(this.#logger);\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing PhoneInputHandler', error);\r\n    }\r\n  }\r\n\r\n  #initProspectCartHandler() {\r\n    try {\r\n      // Initialize the ProspectCartHandler if we have the app instance\r\n      if (this.#app) {\r\n        this.prospectCartHandler = new ProspectCartHandler(this.#app);\r\n        this.#logger.info('ProspectCartHandler initialized');\r\n      } else {\r\n        this.#logger.warn('App instance not provided, ProspectCartHandler not initialized');\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error initializing ProspectCartHandler', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fix billing form by duplicating shipping form fields\r\n   * This ensures the billing form has the correct field attributes\r\n   */\r\n  #injectBillingFormFields() {\r\n    try {\r\n      this.#logger.info('Fixing billing form by duplicating shipping form');\r\n      \r\n      // Find the shipping form and billing container\r\n      const shippingForm = document.querySelector('[os-checkout-component=\"shipping-form\"]');\r\n      const billingContainer = document.querySelector('[os-checkout-component=\"billing-form\"]');\r\n      \r\n      // If both elements exist, proceed with duplication\r\n      if (shippingForm && billingContainer) {\r\n        // Log the found elements\r\n        this.#logger.info(`Found shipping form and billing container`);\r\n        \r\n        // Clone the shipping form\r\n        const billingForm = shippingForm.cloneNode(true);\r\n        \r\n        // Update all field attributes to billing-specific ones\r\n        const fieldMap = {\r\n          'fname': 'billing-fname',\r\n          'lname': 'billing-lname',\r\n          'address1': 'billing-address1',\r\n          'address2': 'billing-address2',\r\n          'city': 'billing-city',\r\n          'province': 'billing-province',\r\n          'postal': 'billing-postal',\r\n          'country': 'billing-country',\r\n          'phone': 'billing-phone'\r\n        };\r\n        \r\n        // Update all input, select fields\r\n        billingForm.querySelectorAll('input, select').forEach(field => {\r\n          const fieldAttr = field.getAttribute('os-checkout-field');\r\n          if (fieldAttr && fieldMap[fieldAttr]) {\r\n            field.setAttribute('os-checkout-field', fieldMap[fieldAttr]);\r\n            \r\n            // Also update IDs and names to avoid duplicates\r\n            if (field.id) {\r\n              field.id = 'billing_' + field.id;\r\n            }\r\n            if (field.name) {\r\n              field.name = 'billing_' + field.name;\r\n            }\r\n            if (field.getAttribute('data-name')) {\r\n              field.setAttribute('data-name', 'Billing ' + field.getAttribute('data-name'));\r\n            }\r\n            \r\n            // Update autocomplete attributes\r\n            if (field.getAttribute('autocomplete')) {\r\n              field.setAttribute('autocomplete', 'billing ' + field.getAttribute('autocomplete'));\r\n            }\r\n          }\r\n        });\r\n        \r\n        // Update location container attribute\r\n        const locationContainer = billingForm.querySelector('[data-os-component=\"location\"]');\r\n        if (locationContainer) {\r\n          locationContainer.setAttribute('data-os-component', 'billing-location');\r\n        }\r\n        \r\n        // Clear any existing content in the billing container\r\n        billingContainer.innerHTML = '';\r\n        \r\n        // Append the modified form to the billing container\r\n        billingContainer.appendChild(billingForm);\r\n        \r\n        this.#logger.info('Billing form successfully created from shipping form');\r\n      } else {\r\n        this.#logger.warn('Could not fix billing form - shipping form or billing container not found');\r\n        this.#logger.warn(`Shipping form found: ${!!shippingForm}, Billing container found: ${!!billingContainer}`);\r\n        \r\n        // Log all checkout components for debugging\r\n        const allComponents = document.querySelectorAll('[os-checkout-component]');\r\n        this.#logger.warn(`Found ${allComponents.length} checkout components:`);\r\n        allComponents.forEach(comp => {\r\n          this.#logger.warn(`- ${comp.getAttribute('os-checkout-component')}`);\r\n        });\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error fixing billing form:', error);\r\n    }\r\n  }\r\n\r\n  #setupEventListeners() {\r\n    try {\r\n      document.addEventListener('payment-method-changed', e => {\r\n        this.#logger.debug(`Payment method changed to: ${e.detail.mode}`);\r\n        const container = document.querySelector('[os-payment-mode]');\r\n        container?.setAttribute('os-payment-mode', e.detail.mode);\r\n      });\r\n      \r\n      // Ensure we're properly handling form submission\r\n      if (this.#form) {\r\n        this.#form.addEventListener('submit', e => this.#handleSubmit(e));\r\n        this.#logger.debug('Form submit event listener attached');\r\n      }\r\n      \r\n      // Listen for prospect cart created event if ProspectCartHandler is initialized\r\n      if (this.#app && this.#app.events && this.prospectCartHandler) {\r\n        this.#app.events.on('prospect.cartCreated', (data) => {\r\n          this.#logger.info('Prospect cart created successfully', data);\r\n          // You can add additional logic here if needed\r\n        });\r\n      }\r\n      \r\n      // Listen for order created event\r\n      if (this.#app && this.#app.events) {\r\n        this.#app.events.on('order.created', (data) => {\r\n          this.#logger.info('Order created successfully', data);\r\n          // You can add additional logic here if needed\r\n        });\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error setting up event listeners:', error);\r\n    }\r\n  }\r\n\r\n  #handleSubmit(event) {\r\n    // Always prevent the default form submission first\r\n    if (event) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n      event.stopImmediatePropagation();\r\n    }\r\n    \r\n    this.#logger.debug('Form submission intercepted by #handleSubmit');\r\n    \r\n    // Prevent any form submission\r\n    if (this.#form) {\r\n      this.#form.removeAttribute('action');\r\n      this.#form.setAttribute('method', 'post');\r\n      \r\n      const preventSubmit = (e) => {\r\n        if (e) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          e.stopImmediatePropagation();\r\n        }\r\n        \r\n        // Ensure form doesn't have action and has post method\r\n        if (this.#form) {\r\n          this.#form.removeAttribute('action');\r\n          this.#form.setAttribute('method', 'post');\r\n        }\r\n        \r\n        // Cancel any form submission that might be in progress\r\n        if (typeof window.stop === 'function') {\r\n          window.stop();\r\n        }\r\n        \r\n        this.#logger.debug('Form direct submission prevented');\r\n        return false;\r\n      };\r\n      \r\n      this.#form.onsubmit = preventSubmit;\r\n    }\r\n    \r\n    if (this.formValidator && !this.formValidator.validateAllFields()) {\r\n      this.#logger.warn('Form validation failed, stopping submission');\r\n      return false;\r\n    }\r\n    \r\n    if (this.paymentHandler) {\r\n      this.#logger.debug('Delegating to paymentHandler.processPayment()');\r\n      this.paymentHandler.processPayment();\r\n    } else {\r\n      this.#logger.error('Payment handler not initialized');\r\n    }\r\n    \r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Disable all submit buttons in the form to prevent accidental form submission\r\n   * @private\r\n   */\r\n  #disableSubmitButtons() {\r\n    try {\r\n      if (!this.#form) return;\r\n      \r\n      // Find all submit buttons in the form\r\n      const submitButtons = this.#form.querySelectorAll('button[type=\"submit\"], input[type=\"submit\"]');\r\n      \r\n      if (submitButtons.length > 0) {\r\n        this.#logger.debug(`Found ${submitButtons.length} submit buttons, converting to type=\"button\"`);\r\n        \r\n        submitButtons.forEach((button, index) => {\r\n          // Change type to button\r\n          button.setAttribute('type', 'button');\r\n          \r\n          // Add click handler to process payment\r\n          button.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            this.#logger.debug(`Submit button ${index + 1} clicked, delegating to payment handler`);\r\n            \r\n            if (this.paymentHandler) {\r\n              this.paymentHandler.processPayment();\r\n            } else {\r\n              this.#logger.error('Payment handler not initialized');\r\n            }\r\n          });\r\n          \r\n          this.#logger.debug(`Converted submit button ${index + 1} to type=\"button\"`);\r\n        });\r\n      } else {\r\n        this.#logger.debug('No submit buttons found in the form');\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error disabling submit buttons:', error);\r\n    }\r\n  }\r\n}", "/**\r\n * CampaignHelper - Utility class for working with campaign data\r\n * \r\n * This class provides helper methods for accessing and using campaign data\r\n * that was retrieved during initialization.\r\n */\r\n\r\nexport class CampaignHelper {\r\n  #app;\r\n  #logger;\r\n  #viewItemListFired = false;\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('CAMPAIGN');\r\n  }\r\n\r\n  getCampaignData() {\r\n    const campaignData = this.#app.campaignData;\r\n    return campaignData;\r\n  }\r\n\r\n  getCampaignName() {\r\n    return this.#app.campaignData?.name ?? '';\r\n  }\r\n\r\n  getCampaignId() {\r\n    return this.#app.campaignData?.id ?? '';\r\n  }\r\n\r\n  getProducts() {\r\n    const products = this.#app.campaignData?.products ?? [];\r\n    return products;\r\n  }\r\n\r\n  getProductById(productId) {\r\n    return this.getProducts().find(product => product.id === productId);\r\n  }\r\n\r\n  getCurrency() {\r\n    return this.#app.campaignData?.currency ?? 'USD';\r\n  }\r\n\r\n  getLocale() {\r\n    return this.#app.campaignData?.locale ?? 'en-US';\r\n  }\r\n\r\n  formatPrice(price) {\r\n    if (typeof price !== 'number') return '';\r\n\r\n    try {\r\n      return new Intl.NumberFormat(this.getLocale(), {\r\n        style: 'currency',\r\n        currency: this.getCurrency()\r\n      }).format(price);\r\n    } catch (error) {\r\n      this.#logger.error('Error formatting price:', error);\r\n      return price.toString();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Manually trigger the view_item_list event\r\n   */\r\n  triggerViewItemList() {\r\n    if (!this.#app.campaignData) {\r\n      this.#logger.warn('Cannot trigger view_item_list: No campaign data available');\r\n      return;\r\n    }\r\n    \r\n    if (!this.#app.eventManager) {\r\n      this.#logger.warn('Cannot trigger view_item_list: EventManager not found');\r\n      return;\r\n    }\r\n    \r\n    // Use the new viewVisibleItemList method if available, otherwise fall back to the old method\r\n    if (typeof this.#app.eventManager.viewVisibleItemList === 'function') {\r\n      this.#logger.debug('Manually triggering viewVisibleItemList event');\r\n      this.#app.eventManager.viewVisibleItemList();\r\n    } else if (this.#app.events?.viewItemList) {\r\n      this.#logger.debug('Falling back to events.viewItemList method');\r\n      this.#app.events.viewItemList(this.#app.campaignData);\r\n    } else {\r\n      this.#logger.warn('No suitable method found to trigger view_item_list event');\r\n    }\r\n    \r\n    this.#viewItemListFired = true;\r\n  }\r\n}", "/**\r\n * StateManager - Manages application state\r\n * \r\n * This class provides a centralized state management system for the application,\r\n * including local cart functionality. It uses a pub/sub pattern to notify\r\n * subscribers when state changes.\r\n */\r\n\r\nexport class StateManager {\r\n  #app;\r\n  #logger;\r\n  #state;\r\n  #subscribers = {};\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('STATE');\r\n    this.#state = this.#initDefaultState();\r\n    this.#loadState();\r\n    this.#recalculateCart(false);\r\n    this.#logger.info('StateManager initialized');\r\n  }\r\n\r\n  #initDefaultState() {\r\n    return {\r\n      cart: {\r\n        items: [],\r\n        totals: {\r\n          subtotal: 0,\r\n          retail_subtotal: 0,\r\n          savings: 0,\r\n          savings_percentage: 0,\r\n          shipping: 0,\r\n          tax: 0,\r\n          total: 0,\r\n          recurring_total: 0,\r\n          currency: 'USD',\r\n          currency_symbol: '$'\r\n        },\r\n        shippingMethod: null,\r\n        couponCode: null,\r\n        attribution: {\r\n          utm_source: '',\r\n          utm_medium: '',\r\n          utm_campaign: '',\r\n          utm_content: '',\r\n          utm_term: '',\r\n          gclid: '',\r\n          fbclid: '',\r\n          sub1: '',\r\n          sub2: '',\r\n          sub3: '',\r\n          sub4: '',\r\n          sub5: '',\r\n          referrer: '',\r\n          landing_page: '',\r\n          user_agent: '',\r\n          device_type: '',\r\n          fbc: '',\r\n          fbp: ''\r\n        }\r\n      },\r\n      user: { email: null, firstName: null, lastName: null, phone: null },\r\n      ui: { loading: false, currentStep: 'cart', errors: {} }\r\n    };\r\n  }\r\n\r\n  #loadState() {\r\n    try {\r\n      const savedState = sessionStorage.getItem('os_state');\r\n      if (savedState) {\r\n        const parsedState = JSON.parse(savedState);\r\n        this.#state = { ...this.#state, ...parsedState, ui: { ...this.#state.ui } };\r\n        this.#logger.info('State loaded from sessionStorage');\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error loading state from sessionStorage:', error);\r\n    }\r\n  }\r\n\r\n  #saveState() {\r\n    try {\r\n      const stateToSave = {\r\n        cart: { ...this.#state.cart, totals: this.#calculateCartTotals() },\r\n        user: this.#state.user\r\n      };\r\n      sessionStorage.setItem('os_state', JSON.stringify(stateToSave));\r\n      this.#logger.debug('State saved to sessionStorage');\r\n    } catch (error) {\r\n      this.#logger.error('Error saving state to sessionStorage:', error);\r\n    }\r\n  }\r\n\r\n  getState(path = null) {\r\n    if (!path) return { ...this.#state, cart: { ...this.#state.cart, totals: this.#calculateCartTotals() } };\r\n    if (path === 'cart') return { ...this.#state.cart, totals: this.#calculateCartTotals() };\r\n    if (path === 'cart.totals' || path.startsWith('cart.totals.')) return this.#calculateCartTotals();\r\n\r\n    return path.split('.').reduce((obj, key) => obj?.[key] ?? null, this.#state);\r\n  }\r\n\r\n  setState(path, value, notify = true) {\r\n    let current = this.#state;\r\n    const parts = path.split('.');\r\n    for (const [i, part] of parts.entries()) {\r\n      if (i === parts.length - 1) {\r\n        current[part] = value;\r\n      } else {\r\n        current[part] ??= {};\r\n        current = current[part];\r\n      }\r\n    }\r\n\r\n    if (path.startsWith('cart.items')) this.#recalculateCart(false);\r\n    this.#saveState();\r\n    if (notify) {\r\n      this.#notifySubscribers(path, value);\r\n      if (path.startsWith('cart.items')) this.#notifySubscribers('cart', this.getState('cart'));\r\n    }\r\n    return this;\r\n  }\r\n\r\n  subscribe(path, callback) {\r\n    this.#subscribers[path] ??= [];\r\n    this.#subscribers[path].push(callback);\r\n    try {\r\n      callback(this.getState(path), path);\r\n    } catch (error) {\r\n      this.#logger.error(`Error in initial subscriber callback for ${path}:`, error);\r\n    }\r\n    return () => this.#subscribers[path] = this.#subscribers[path].filter(cb => cb !== callback);\r\n  }\r\n\r\n  #notifySubscribers(path, value) {\r\n    this.#logger.debug(`Notifying subscribers for path: ${path}`);\r\n    \r\n    for (const [subPath, callbacks] of Object.entries(this.#subscribers)) {\r\n      if (subPath === path || subPath === '*' || path.startsWith(`${subPath}.`)) {\r\n        const subValue = subPath === '*' ? this.getState() : this.getState(subPath);\r\n        callbacks.forEach(callback => {\r\n          try {\r\n            callback(subValue, subPath);\r\n          } catch (error) {\r\n            this.#logger.error(`Error in subscriber callback for ${subPath}:`, error);\r\n          }\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  clearState() {\r\n    this.#state = this.#initDefaultState();\r\n    sessionStorage.removeItem('os_state');\r\n    this.#notifySubscribers('*', this.#state);\r\n    this.#logger.info('State cleared');\r\n  }\r\n\r\n  addToCart(item) {\r\n    if (!item?.id || !item.name || item.price === undefined) {\r\n      this.#logger.error('Invalid item:', item);\r\n      throw new Error('Invalid item. Must have id, name, and price.');\r\n    }\r\n\r\n    const cart = this.getState('cart');\r\n    const packageData = this.#app.campaignData?.packages?.find(pkg => \r\n      pkg.ref_id.toString() === item.id.toString() || pkg.external_id?.toString() === item.id.toString()\r\n    );\r\n\r\n    const enhancedItem = {\r\n      ...item,\r\n      ...(packageData && {\r\n        name: packageData.name || item.name,\r\n        price: Number.parseFloat(packageData.price) || item.price,\r\n        price_total: Number.parseFloat(packageData.price_total) || item.price * (item.quantity || 1),\r\n        retail_price: Number.parseFloat(packageData.price_retail) ?? undefined,\r\n        retail_price_total: Number.parseFloat(packageData.price_retail_total) ?? undefined,\r\n        is_recurring: packageData.is_recurring ?? false,\r\n        price_recurring: packageData.price_recurring ? Number.parseFloat(packageData.price_recurring) : undefined,\r\n        price_recurring_total: packageData.price_recurring_total ? Number.parseFloat(packageData.price_recurring_total) : undefined,\r\n        interval: packageData.interval ?? undefined,\r\n        interval_count: packageData.interval_count ?? undefined,\r\n        image: packageData.image || item.image,\r\n        external_id: packageData.external_id ?? undefined\r\n      }),\r\n      quantity: item.quantity || 1\r\n    };\r\n\r\n    const existingItemIndex = cart.items.findIndex(i => i.id === item.id);\r\n    const updatedItems = existingItemIndex >= 0\r\n      ? this.#updateExistingItem(cart.items, existingItemIndex, enhancedItem)\r\n      : [...cart.items, enhancedItem];\r\n\r\n    this.setState('cart.items', updatedItems);\r\n    this.#logger.info(`Item added to cart: ${enhancedItem.name}`);\r\n    this.#app.triggerEvent('cart.updated', { cart: this.getState('cart') });\r\n    return this.getState('cart');\r\n  }\r\n\r\n  #updateExistingItem(items, index, newItem) {\r\n    const updatedItems = [...items];\r\n    updatedItems[index] = {\r\n      ...updatedItems[index],\r\n      quantity: (updatedItems[index].quantity || 1) + (newItem.quantity || 1),\r\n      price_total: updatedItems[index].price * (updatedItems[index].quantity || 1 + (newItem.quantity || 1)),\r\n      ...(updatedItems[index].retail_price && {\r\n        retail_price_total: updatedItems[index].retail_price * (updatedItems[index].quantity || 1 + (newItem.quantity || 1))\r\n      }),\r\n      ...(updatedItems[index].price_recurring && {\r\n        price_recurring_total: updatedItems[index].price_recurring * (updatedItems[index].quantity || 1 + (newItem.quantity || 1))\r\n      })\r\n    };\r\n    return updatedItems;\r\n  }\r\n\r\n  updateCartItem(itemId, updates) {\r\n    const cart = this.getState('cart');\r\n    const itemIndex = cart.items.findIndex(item => item.id === itemId);\r\n    if (itemIndex === -1) {\r\n      this.#logger.error(`Item not found in cart: ${itemId}`);\r\n      throw new Error(`Item not found in cart: ${itemId}`);\r\n    }\r\n\r\n    const updatedItems = [...cart.items];\r\n    updatedItems[itemIndex] = { ...updatedItems[itemIndex], ...updates };\r\n    if (updatedItems[itemIndex].quantity === 0) updatedItems.splice(itemIndex, 1);\r\n\r\n    this.setState('cart.items', updatedItems);\r\n    this.#logger.info(`Cart item updated: ${itemId}`);\r\n    this.#app.triggerEvent('cart.updated', { cart: this.getState('cart') });\r\n    return this.getState('cart');\r\n  }\r\n\r\n  removeFromCart(itemId) {\r\n    const updatedItems = this.getState('cart').items.filter(item => item.id !== itemId);\r\n    this.setState('cart.items', updatedItems);\r\n    this.#logger.info(`Item removed from cart: ${itemId}`);\r\n    this.#app.triggerEvent('cart.updated', { cart: this.getState('cart') });\r\n    return this.getState('cart');\r\n  }\r\n\r\n  clearCart() {\r\n    this.setState('cart.items', []);\r\n    this.setState('cart.couponCode', null);\r\n    this.setState('cart.shippingMethod', null);\r\n    this.#logger.info('Cart cleared');\r\n    this.#app.triggerEvent('cart.updated', { cart: this.getState('cart') });\r\n    return this.getState('cart');\r\n  }\r\n\r\n  setShippingMethod(shippingMethod) {\r\n    this.setState('cart.shippingMethod', shippingMethod);\r\n    this.#logger.info(`Shipping method set: ${shippingMethod.code}`);\r\n    this.#app.triggerEvent('cart.updated', { cart: this.getState('cart') });\r\n    return this.getState('cart');\r\n  }\r\n\r\n  applyCoupon(couponCode) {\r\n    this.setState('cart.couponCode', couponCode);\r\n    this.#logger.info(`Coupon applied: ${couponCode}`);\r\n    this.#app.triggerEvent('cart.updated', { cart: this.getState('cart') });\r\n    return this.getState('cart');\r\n  }\r\n\r\n  removeCoupon() {\r\n    this.setState('cart.couponCode', null);\r\n    this.#logger.info('Coupon removed');\r\n    this.#app.triggerEvent('cart.updated', { cart: this.getState('cart') });\r\n    return this.getState('cart');\r\n  }\r\n\r\n  #calculateCartTotals() {\r\n    const { items, shippingMethod } = this.#state.cart;\r\n    \r\n    // Use price_total if available, otherwise calculate from price * quantity\r\n    const subtotal = items.reduce((acc, item) => \r\n      acc + (item.price_total ?? (item.price * (item.quantity || 1))), 0);\r\n    \r\n    // Use retail_price_total if available, otherwise calculate from retail_price * quantity\r\n    const retailSubtotal = items.reduce((acc, item) => \r\n      acc + (item.retail_price_total ?? ((item.retail_price ?? item.price) * (item.quantity || 1))), 0);\r\n      \r\n    const savings = retailSubtotal - subtotal;\r\n    const savingsPercentage = retailSubtotal > 0 ? (savings / retailSubtotal) * 100 : 0;\r\n    const recurringTotal = items.reduce((acc, item) => \r\n      acc + (item.is_recurring && item.price_recurring ? item.price_recurring * (item.quantity || 1) : 0), 0);\r\n    const shipping = shippingMethod?.price ? Number.parseFloat(shippingMethod.price) : 0;\r\n    const tax = 0; // Placeholder for real tax logic\r\n    const total = subtotal + shipping + tax;\r\n\r\n    const currency = this.#app.campaignData?.currency ?? 'USD';\r\n    const currencySymbol = { USD: '$', EUR: '€', GBP: '£' }[currency] ?? '$';\r\n\r\n    return {\r\n      subtotal,\r\n      retail_subtotal: retailSubtotal,\r\n      savings,\r\n      savings_percentage: savingsPercentage,\r\n      shipping,\r\n      tax,\r\n      total,\r\n      recurring_total: recurringTotal,\r\n      currency,\r\n      currency_symbol: currencySymbol\r\n    };\r\n  }\r\n\r\n  #recalculateCart(notify = true) {\r\n    const totals = this.#calculateCartTotals();\r\n    this.#state.cart.totals = totals;\r\n    this.#logger.debug('Cart totals recalculated');\r\n    if (notify) {\r\n      this.#notifySubscribers('cart.totals', totals);\r\n      this.#notifySubscribers('cart', this.getState('cart'));\r\n    }\r\n    return totals;\r\n  }\r\n\r\n  isItemInCart(itemId) {\r\n    return this.#state.cart.items.some(item => item.id === itemId);\r\n  }\r\n\r\n  getCartForApi() {\r\n    const { items, shippingMethod, couponCode, attribution } = this.getState('cart');\r\n    const { email, firstName, lastName, phone } = this.getState('user');\r\n    return {\r\n      lines: items.map(item => ({ product_id: item.id, quantity: item.quantity || 1, price: item.price })),\r\n      shipping_method: shippingMethod?.code ?? null,\r\n      coupon_code: couponCode,\r\n      user: { email, first_name: firstName, last_name: lastName, phone },\r\n      attribution: attribution || {}\r\n    };\r\n  }\r\n\r\n  async syncCartWithApi() {\r\n    try {\r\n      this.setState('ui.loading', true);\r\n      const apiCart = this.getCartForApi();\r\n      const response = await this.#app.api.createCart(apiCart);\r\n      this.#logger.info('Cart synced with API');\r\n      this.#app.triggerEvent('cart.synced', { cart: response });\r\n      return response;\r\n    } catch (error) {\r\n      this.#logger.error('Error syncing cart with API:', error);\r\n      this.setState('ui.errors.cart', error.message);\r\n      throw error;\r\n    } finally {\r\n      this.setState('ui.loading', false);\r\n    }\r\n  }\r\n}", "/**\r\n * CartManager - Manages cart operations\r\n * \r\n * This class provides a simplified interface for cart operations,\r\n * using the StateManager for state management.\r\n */\r\n\r\nexport class CartManager {\r\n  #app;\r\n  #stateManager;\r\n  #logger;\r\n  #cartElements;\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#stateManager = app.state;\r\n    this.#logger = app.logger.createModuleLogger('CART');\r\n    this.#initCartUI();\r\n    this.#logger.info('CartManager initialized');\r\n  }\r\n\r\n  #initCartUI() {\r\n    this.#cartElements = {\r\n      addToCartButtons: document.querySelectorAll('[data-os-add-to-cart]'),\r\n      cartCount: document.querySelectorAll('[data-os-cart-count]'),\r\n      cartTotal: document.querySelectorAll('[data-os-cart-total]'),\r\n      cartItems: document.querySelector('[data-os-cart-items]'),\r\n      cartEmpty: document.querySelector('[data-os-cart-empty]'),\r\n      cartContainer: document.querySelector('[data-os-cart-container]')\r\n    };\r\n\r\n    this.#cartElements.addToCartButtons.forEach(button => {\r\n      button.addEventListener('click', event => {\r\n        event.preventDefault();\r\n        const item = {\r\n          id: button.getAttribute('data-os-product-id'),\r\n          name: button.getAttribute('data-os-product-name'),\r\n          price: Number.parseFloat(button.getAttribute('data-os-product-price')),\r\n          quantity: Number.parseInt(button.getAttribute('data-os-product-quantity') ?? '1', 10)\r\n        };\r\n        if (item.id && item.name && item.price) this.#addToCart(item);\r\n        else this.#logger.error('Invalid product data for add to cart button');\r\n      });\r\n    });\r\n\r\n    this.#stateManager.subscribe('cart', () => this.#updateCartUI());\r\n    this.#updateCartUI();\r\n  }\r\n\r\n  #updateCartUI() {\r\n    const cart = this.#stateManager.getState('cart');\r\n\r\n    this.#cartElements.cartCount.forEach(element => {\r\n      const itemCount = cart.items.reduce((count, item) => count + (item.quantity || 1), 0);\r\n      element.textContent = itemCount.toString();\r\n      element.classList.toggle('hidden', itemCount === 0);\r\n    });\r\n\r\n    const formatPrice = price => this.#app.campaign?.formatPrice(price) ?? price.toFixed(2);\r\n    this.#cartElements.cartTotal.forEach(element => element.textContent = formatPrice(cart.totals.total));\r\n\r\n    const updateElement = (selector, value, hideIfZero = false) => {\r\n      const element = document.querySelector(selector);\r\n      if (element) {\r\n        element.textContent = hideIfZero ? `${Math.round(value)}%` : formatPrice(value);\r\n        if (hideIfZero && value === 0) element.parentElement?.classList.add('hidden');\r\n        else element.parentElement?.classList.remove('hidden');\r\n      }\r\n    };\r\n\r\n    updateElement('[data-os-cart-retail-subtotal]', cart.totals.retail_subtotal);\r\n    updateElement('[data-os-cart-savings]', cart.totals.savings, true);\r\n    updateElement('[data-os-cart-savings-percentage]', cart.totals.savings_percentage, true);\r\n    updateElement('[data-os-cart-recurring-total]', cart.totals.recurring_total, true);\r\n    updateElement('[data-os-cart-subtotal]', cart.totals.subtotal);\r\n    updateElement('[data-os-cart-shipping]', cart.totals.shipping);\r\n\r\n    if (this.#cartElements.cartItems) {\r\n      this.#cartElements.cartItems.innerHTML = '';\r\n      cart.items.forEach(item => this.#cartElements.cartItems.appendChild(this.#createCartItemElement(item)));\r\n    }\r\n\r\n    if (this.#cartElements.cartEmpty && this.#cartElements.cartContainer) {\r\n      const isEmpty = cart.items.length === 0;\r\n      this.#cartElements.cartEmpty.classList.toggle('hidden', !isEmpty);\r\n      this.#cartElements.cartContainer.classList.toggle('hidden', isEmpty);\r\n    }\r\n  }\r\n\r\n  #createCartItemElement(item) {\r\n    const formatPrice = price => this.#app.campaign?.formatPrice(price) ?? price.toFixed(2);\r\n    const itemElement = document.createElement('div');\r\n    itemElement.className = 'os-cart-item';\r\n    itemElement.setAttribute('data-os-cart-item-id', item.id);\r\n\r\n    const price = formatPrice(item.price);\r\n    const retailPrice = item.retail_price ? formatPrice(item.retail_price) : '';\r\n    const total = formatPrice(item.price * (item.quantity || 1));\r\n    const savings = item.retail_price ? (item.retail_price - item.price) * (item.quantity || 1) : 0;\r\n    const savingsHtml = savings ? `\r\n      <div class=\"os-cart-item-savings\">\r\n        <span class=\"os-cart-item-savings-label\">You save:</span>\r\n        <span class=\"os-cart-item-savings-value\">${formatPrice(savings)} (${Math.round(savings / (item.retail_price * (item.quantity || 1)) * 100)}%)</span>\r\n      </div>\r\n    ` : '';\r\n    const recurringHtml = item.is_recurring && item.price_recurring ? `\r\n      <div class=\"os-cart-item-recurring\">\r\n        <span class=\"os-cart-item-recurring-label\">Recurring:</span>\r\n        <span class=\"os-cart-item-recurring-value\">${formatPrice(item.price_recurring)} ${item.interval_count > 1 ? `every ${item.interval_count} ${item.interval}s` : `per ${item.interval}`}</span>\r\n      </div>\r\n    ` : '';\r\n    const imageHtml = item.image ? `\r\n      <div class=\"os-cart-item-image\">\r\n        <img src=\"${item.image}\" alt=\"${item.name}\" />\r\n      </div>\r\n    ` : '';\r\n\r\n    itemElement.innerHTML = `\r\n      ${imageHtml}\r\n      <div class=\"os-cart-item-details\">\r\n        <div class=\"os-cart-item-name\">${item.name}</div>\r\n        <div class=\"os-cart-item-price-container\">\r\n          <div class=\"os-cart-item-price\">${price}</div>\r\n          ${retailPrice ? `<div class=\"os-cart-item-retail-price\">${retailPrice}</div>` : ''}\r\n        </div>\r\n        ${savingsHtml}\r\n        ${recurringHtml}\r\n      </div>\r\n      <div class=\"os-cart-item-quantity\">\r\n        <button class=\"os-cart-item-decrease\" data-os-cart-decrease=\"${item.id}\">-</button>\r\n        <span class=\"os-cart-item-quantity-value\">${item.quantity || 1}</span>\r\n        <button class=\"os-cart-item-increase\" data-os-cart-increase=\"${item.id}\">+</button>\r\n      </div>\r\n      <div class=\"os-cart-item-total\">${total}</div>\r\n      <button class=\"os-cart-item-remove\" data-os-cart-remove=\"${item.id}\">×</button>\r\n    `;\r\n\r\n    itemElement.querySelector(`[data-os-cart-decrease=\"${item.id}\"]`)?.addEventListener('click', () => this.#updateCartItemQuantity(item.id, (item.quantity || 1) - 1));\r\n    itemElement.querySelector(`[data-os-cart-increase=\"${item.id}\"]`)?.addEventListener('click', () => this.#updateCartItemQuantity(item.id, (item.quantity || 1) + 1));\r\n    itemElement.querySelector(`[data-os-cart-remove=\"${item.id}\"]`)?.addEventListener('click', () => this.#removeFromCart(item.id));\r\n\r\n    return itemElement;\r\n  }\r\n\r\n  #addToCart(item) {\r\n    try {\r\n      const result = this.#stateManager.addToCart(item);\r\n      // this.#showMessage(`${item.name} added to cart`);\r\n      return result;\r\n    } catch (error) {\r\n      this.#logger.error('Error adding item to cart:', error);\r\n      // this.#showMessage('Error adding item to cart', 'error');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  #updateCartItemQuantity(itemId, quantity) {\r\n    try {\r\n      return quantity <= 0 ? this.#removeFromCart(itemId) : this.#stateManager.updateCartItem(itemId, { quantity });\r\n    } catch (error) {\r\n      this.#logger.error('Error updating cart item quantity:', error);\r\n      // this.#showMessage('Error updating cart', 'error');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  #removeFromCart(itemId) {\r\n    try {\r\n      return this.#stateManager.removeFromCart(itemId);\r\n    } catch (error) {\r\n      this.#logger.error('Error removing item from cart:', error);\r\n      // this.#showMessage('Error removing item from cart', 'error');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  clearCart() {\r\n    try {\r\n      return this.#stateManager.clearCart();\r\n    } catch (error) {\r\n      this.#logger.error('Error clearing cart:', error);\r\n      // this.#showMessage('Error clearing cart', 'error');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  addToCart(item) {\r\n    return this.#addToCart(item);\r\n  }\r\n\r\n  removeFromCart(itemId) {\r\n    return this.#removeFromCart(itemId);\r\n  }\r\n\r\n  setShippingMethod(shippingMethod) {\r\n    try {\r\n      return this.#stateManager.setShippingMethod(shippingMethod);\r\n    } catch (error) {\r\n      this.#logger.error('Error setting shipping method:', error);\r\n      // this.#showMessage('Error setting shipping method', 'error');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  applyCoupon(couponCode) {\r\n    try {\r\n      return this.#stateManager.applyCoupon(couponCode);\r\n    } catch (error) {\r\n      this.#logger.error('Error applying coupon:', error);\r\n      // this.#showMessage('Error applying coupon', 'error');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  removeCoupon() {\r\n    try {\r\n      return this.#stateManager.removeCoupon();\r\n    } catch (error) {\r\n      this.#logger.error('Error removing coupon:', error);\r\n      // this.#showMessage('Error removing coupon', 'error');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  async syncCartWithApi() {\r\n    try {\r\n      return await this.#stateManager.syncCartWithApi();\r\n    } catch (error) {\r\n      this.#logger.error('Error syncing cart with API:', error);\r\n      // this.#showMessage('Error syncing cart with server', 'error');\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  isItemInCart(itemId) {\r\n    return this.#stateManager.isItemInCart?.(itemId) ?? this.#stateManager.getState('cart').items.some(item => item.id === itemId);\r\n  }\r\n\r\n  // #showMessage(message, type = 'success') {\r\n  //   const messageElement = document.createElement('div');\r\n  //   messageElement.className = `os-message os-message-${type}`;\r\n  //   messageElement.textContent = message;\r\n  //   document.body.appendChild(messageElement);\r\n  //   setTimeout(() => {\r\n  //     messageElement.classList.add('os-message-hide');\r\n  //     setTimeout(() => document.body.removeChild(messageElement), 300);\r\n  //   }, 3000);\r\n  // }\r\n}", "/**\n * DebugUtils - Utilities for debugging components\n */\n\nexport class DebugUtils {\n  static #debugStylesInjected = false;\n  static #isDebugMode = false;\n  static #xrayEnabled = false;\n  static #overlays = [];\n\n  /**\n   * Initialize debug mode by checking URL parameters\n   * @returns {boolean} Whether debug mode is enabled\n   */\n  static initDebugMode() {\n    const urlParams = new URLSearchParams(window.location.search);\n    this.#isDebugMode = urlParams.get('debugger') === 'true';\n    \n    if (this.#isDebugMode && !this.#debugStylesInjected) {\n      this.injectDebugStyles();\n      this.#xrayEnabled = localStorage.getItem('os_debug_xray_enabled') === 'true';\n    }\n    \n    return this.#isDebugMode;\n  }\n\n  /**\n   * Check if debug mode is enabled\n   * @returns {boolean} Whether debug mode is enabled\n   */\n  static isDebugMode() {\n    return this.#isDebugMode;\n  }\n\n  /**\n   * Check if X-ray mode is enabled\n   * @returns {boolean} Whether X-ray mode is enabled\n   */\n  static isXrayEnabled() {\n    return this.#xrayEnabled;\n  }\n\n  /**\n   * Toggle X-ray mode on or off\n   * @param {boolean} enabled - Whether to enable X-ray mode\n   * @returns {boolean} The new state of X-ray mode\n   */\n  static toggleXray(enabled = !this.#xrayEnabled) {\n    if (!this.#isDebugMode) return false;\n    \n    this.#xrayEnabled = enabled;\n    localStorage.setItem('os_debug_xray_enabled', this.#xrayEnabled.toString());\n    \n    // Toggle visibility of all overlays\n    this.#overlays.forEach(overlay => {\n      overlay.style.display = this.#xrayEnabled ? 'block' : 'none';\n    });\n    \n    return this.#xrayEnabled;\n  }\n\n  /**\n   * Inject debug styles into the document head\n   */\n  static injectDebugStyles() {\n    if (this.#debugStylesInjected) return;\n    \n    const styleElement = document.createElement('style');\n    styleElement.id = 'os-debug-styles';\n    styleElement.textContent = `\n      /* Common debug styles */\n      .os-debug-overlay {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        pointer-events: none;\n        z-index: 9999;\n        border: 2px dashed rgba(255, 0, 0, 0.7);\n        box-sizing: border-box;\n      }\n      .os-debug-label {\n        position: absolute;\n        top: 0;\n        right: 0;\n        background-color: rgba(0, 0, 0, 0.7);\n        color: white;\n        font-size: 12px;\n        padding: 2px 6px;\n        border-radius: 0 0 0 4px;\n        font-family: monospace;\n        z-index: 10000;\n      }\n      \n      /* Selector-specific styles */\n      .os-debug-card-overlay {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        pointer-events: none;\n        z-index: 9998;\n        border: 1px solid rgba(0, 255, 255, 0.7);\n        box-sizing: border-box;\n      }\n      .os-debug-card-label {\n        position: absolute;\n        top: 0;\n        right: 0;\n        background-color: rgba(0, 0, 0, 0.7);\n        color: white;\n        font-size: 10px;\n        padding: 1px 4px;\n        border-radius: 0 0 0 4px;\n        font-family: monospace;\n        z-index: 9999;\n      }\n      .os--selected .os-debug-card-overlay {\n        border: 2px solid rgba(0, 255, 0, 0.9);\n      }\n      .os--active .os-debug-card-overlay {\n        background-color: rgba(255, 255, 0, 0.2);\n      }\n      \n      /* Toggle-specific styles */\n      .os-debug-toggle-overlay {\n        position: absolute;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        pointer-events: none;\n        z-index: 9998;\n        border: 1px solid rgba(255, 165, 0, 0.7);\n        box-sizing: border-box;\n      }\n      .os-debug-toggle-label {\n        position: absolute;\n        top: 0;\n        right: 0;\n        background-color: rgba(0, 0, 0, 0.7);\n        color: white;\n        font-size: 10px;\n        padding: 1px 4px;\n        border-radius: 0 0 0 4px;\n        font-family: monospace;\n        z-index: 9999;\n      }\n      [data-os-active=\"true\"] .os-debug-toggle-overlay {\n        background-color: rgba(255, 165, 0, 0.3);\n        border: 2px solid rgba(255, 165, 0, 0.9);\n      }\n      \n      /* Upsell styles */\n      .os-debug-upsell-overlay {\n        border: 2px dashed rgba(76, 175, 80, 0.9) !important;\n      }\n      .os-debug-upsell-label {\n        background-color: rgba(76, 175, 80, 0.9) !important;\n      }\n      .os-debug-upsell-badge {\n        display: inline-block;\n        background-color: rgba(76, 175, 80, 0.9);\n        color: white;\n        font-size: 9px;\n        padding: 1px 3px;\n        border-radius: 2px;\n        margin-left: 4px;\n        vertical-align: middle;\n      }\n      \n      /* Debug bar styles */\n      .os-debug-bar {\n        position: fixed;\n        bottom: 0;\n        left: 0;\n        width: 100%;\n        background-color: rgba(33, 33, 33, 0.9);\n        color: white;\n        font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n        font-size: 14px;\n        z-index: 10001;\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding: 8px 16px;\n        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);\n      }\n      \n      .os-debug-bar-title {\n        font-weight: 600;\n        margin-right: 20px;\n      }\n      \n      .os-debug-bar-controls {\n        display: flex;\n        align-items: center;\n      }\n      \n      .os-debug-bar-control {\n        margin: 0 10px;\n        display: flex;\n        align-items: center;\n      }\n      \n      .os-debug-bar-toggle {\n        position: relative;\n        display: inline-block;\n        width: 40px;\n        height: 20px;\n        margin-left: 8px;\n      }\n      \n      .os-debug-bar-toggle input {\n        opacity: 0;\n        width: 0;\n        height: 0;\n      }\n      \n      .os-debug-bar-slider {\n        position: absolute;\n        cursor: pointer;\n        top: 0;\n        left: 0;\n        right: 0;\n        bottom: 0;\n        background-color: #ccc;\n        transition: .4s;\n        border-radius: 20px;\n      }\n      \n      .os-debug-bar-slider:before {\n        position: absolute;\n        content: \"\";\n        height: 16px;\n        width: 16px;\n        left: 2px;\n        bottom: 2px;\n        background-color: white;\n        transition: .4s;\n        border-radius: 50%;\n      }\n      \n      input:checked + .os-debug-bar-slider {\n        background-color: #2196F3;\n      }\n      \n      input:checked + .os-debug-bar-slider:before {\n        transform: translateX(20px);\n      }\n      \n      .os-debug-bar-button {\n        background-color: #2196F3;\n        color: white;\n        border: none;\n        border-radius: 4px;\n        padding: 4px 10px;\n        font-size: 12px;\n        cursor: pointer;\n        margin-left: 10px;\n      }\n      \n      .os-debug-bar-button:hover {\n        background-color: #0b7dda;\n      }\n    `;\n    \n    document.head.appendChild(styleElement);\n    this.#debugStylesInjected = true;\n  }\n\n  /**\n   * Add a debug overlay to an element\n   * @param {HTMLElement} element - The element to add the overlay to\n   * @param {string} id - The ID to display\n   * @param {string} type - The type of element\n   * @param {Object} additionalInfo - Additional information to display\n   */\n  static addDebugOverlay(element, id, type, additionalInfo = {}) {\n    if (!this.#isDebugMode) return;\n    \n    // Make sure the element has position relative for absolute positioning of the overlay\n    const computedStyle = window.getComputedStyle(element);\n    if (computedStyle.position === 'static') {\n      element.style.position = 'relative';\n    }\n\n    const overlay = document.createElement('div');\n    overlay.className = `os-debug-${type}-overlay`;\n    \n    const label = document.createElement('div');\n    label.className = `os-debug-${type}-label`;\n    \n    // Check if this is an upsell element\n    const isUpsell = additionalInfo.Upsell === 'Yes';\n    if (isUpsell) {\n      overlay.classList.add('os-debug-upsell-overlay');\n      label.classList.add('os-debug-upsell-label');\n    }\n    \n    // Build label text\n    let labelText = `ID: ${id}`;\n    \n    // Add additional info\n    Object.entries(additionalInfo).forEach(([key, value]) => {\n      // Add upsell badge if this is the upsell property\n      if (key === 'Upsell' && value === 'Yes') {\n        labelText += ` | ${key}: <span class=\"os-debug-upsell-badge\">UPSELL</span>`;\n      } else {\n        labelText += ` | ${key}: ${value}`;\n      }\n    });\n    \n    label.innerHTML = labelText;\n    \n    // Set initial visibility based on X-ray mode\n    if (!this.#xrayEnabled) {\n      overlay.style.display = 'none';\n      label.style.display = 'none';\n    }\n    \n    element.appendChild(overlay);\n    element.appendChild(label);\n    \n    // Track overlays for toggling\n    this.#overlays.push(overlay);\n    this.#overlays.push(label);\n  }\n} ", "/**\n * SelectorManager - Manages selector components\n */\n\nimport { DebugUtils } from '../utils/DebugUtils.js';\n\nexport class SelectorManager {\n  #app;\n  #logger;\n  #selectors = {};\n  #selectedItems = {};\n  #isDebugMode = false;\n\n  constructor(app) {\n    this.#app = app;\n    this.#logger = app.logger.createModuleLogger('SELECTOR');\n    this.#isDebugMode = DebugUtils.initDebugMode();\n    this.#initSelectors();\n    this.#logger.info('SelectorManager initialized');\n    if (this.#isDebugMode) {\n      this.#logger.info('Debug mode enabled for selectors');\n    }\n  }\n\n  #initSelectors() {\n    document.querySelectorAll('[data-os-component=\"selector\"][data-os-selection-mode=\"swap\"]').forEach(selector => this.#initSelector(selector));\n    setTimeout(() => this.#syncWithCart(), 0);\n    this.#app.state?.subscribe('cart', () => this.#syncWithCart());\n    \n    // Initialize unit pricing for all selectors\n    this.initUnitPricing();\n    \n    // Trigger view_item_list event for visible packages after initialization\n    setTimeout(() => this.triggerViewItemList(), 100);\n  }\n\n  #initSelector(selectorElement) {\n    const selectorId = selectorElement.getAttribute('data-os-id');\n    if (!selectorId) {\n      this.#logger.warn('Selector missing data-os-id', selectorElement);\n      return;\n    }\n\n    const mode = selectorElement.getAttribute('data-os-selection-mode') || 'swap';\n    \n    this.#selectors[selectorId] = { \n      element: selectorElement, \n      items: [],\n      mode\n    };\n    \n    this.#selectedItems[selectorId] = null;\n    selectorElement.querySelectorAll('[data-os-element=\"card\"]').forEach(card => this.#initCard(selectorId, card));\n    \n    if (this.#isDebugMode) {\n      DebugUtils.addDebugOverlay(selectorElement, selectorId, 'overlay', { 'Mode': mode });\n    }\n  }\n\n  #initCard(selectorId, cardElement) {\n    const packageId = cardElement.getAttribute('data-os-package');\n    if (!packageId) {\n      this.#logger.warn('Card missing data-os-package', cardElement);\n      return;\n    }\n\n    const priceElement = cardElement.querySelector('.pb-quantity__price.pb--current');\n    const priceText = priceElement?.textContent.trim() ?? '$0.00 USD';\n    const price = Number.parseFloat(priceText.match(/\\$(\\d+\\.\\d+)/)?.[1] ?? '0');\n\n    const nameElement = cardElement.querySelector('.card-title');\n    const name = nameElement?.textContent.trim() ?? `Package ${packageId}`;\n\n    const quantity = Number.parseInt(cardElement.getAttribute('data-os-quantity') ?? '1', 10);\n    const isPreSelected = cardElement.getAttribute('data-os-selected') === 'true';\n\n    const item = {\n      element: cardElement,\n      packageId,\n      quantity,\n      price,\n      name,\n      isPreSelected\n    };\n\n    this.#selectors[selectorId].items.push(item);\n    cardElement.addEventListener('click', () => this.#handleClick(selectorId, item));\n    \n    if (this.#isDebugMode) {\n      DebugUtils.addDebugOverlay(cardElement, packageId, 'card', {\n        'Price': `$${price}`,\n        'Qty': quantity,\n        'PreSel': isPreSelected ? 'Yes' : 'No'\n      });\n    }\n  }\n\n  #handleClick(selectorId, item) {\n    const previous = this.#selectedItems[selectorId];\n    this.#selectItem(selectorId, item);\n    this.#updateCart(selectorId, previous);\n  }\n\n  #selectItem(selectorId, item) {\n    if (this.#selectedItems[selectorId] === item) return;\n\n    this.#selectors[selectorId].items.forEach(i => {\n      i.element.classList.remove('os--selected');\n      i.element.setAttribute('data-os-selected', 'false');\n      i.isSelected = false;\n    });\n\n    item.element.classList.add('os--selected');\n    item.element.setAttribute('data-os-selected', 'true');\n    item.isSelected = true;\n    this.#selectedItems[selectorId] = item;\n    this.#logger.debug(`Selected item ${item.packageId} in selector ${selectorId}`);\n  }\n\n  #updateCart(selectorId, previousItem) {\n    if (!this.#app.cart) {\n      this.#logger.error('Cart manager not available');\n      return;\n    }\n\n    const selected = this.#selectedItems[selectorId];\n    if (!selected) return;\n\n    if (previousItem && previousItem.packageId !== selected.packageId) {\n      this.#removeItemFromCart(previousItem);\n    }\n\n    if (!this.#app.cart.isItemInCart(selected.packageId)) {\n      this.#addItemToCart(selected);\n    }\n  }\n\n  #addItemToCart(item) {\n    if (!this.#app.cart) {\n      this.#logger.error('Cart manager not available in addItemToCart');\n      return;\n    }\n    if (typeof this.#app.cart.addToCart !== 'function') {\n      this.#logger.error('addToCart is not a function on this.#app.cart:', this.#app.cart);\n      return;\n    }\n\n    this.#logger.info(`Adding item ${item.packageId} to cart`);\n    this.#app.cart.addToCart({\n      id: item.packageId,\n      name: item.name,\n      price: item.price,\n      quantity: item.quantity,\n      type: 'package'\n    });\n\n    item.element.classList.add('os--active');\n    item.element.setAttribute('data-os-active', 'true');\n  }\n\n  #removeItemFromCart(item) {\n    if (!this.#app.cart) {\n      this.#logger.error('Cart manager not available in removeItemFromCart');\n      return;\n    }\n    if (typeof this.#app.cart.removeFromCart !== 'function') {\n      this.#logger.error('removeFromCart is not a function on this.#app.cart:', this.#app.cart);\n      return;\n    }\n\n    this.#logger.info(`Removing item ${item.packageId} from cart`);\n    this.#app.cart.removeFromCart(item.packageId);\n\n    item.element.classList.remove('os--active');\n    item.element.setAttribute('data-os-active', 'false');\n  }\n\n  #syncWithCart() {\n    if (!this.#app.cart) {\n      this.#logger.debug('Cart manager not available for sync');\n      return;\n    }\n\n    const cart = this.#app.state?.getState('cart');\n    if (!cart) {\n      this.#logger.debug('Cart state not available');\n      return;\n    }\n\n    this.#logger.debug('Syncing with cart, this.#app.cart:', this.#app.cart);\n\n    Object.keys(this.#selectors).forEach(selectorId => {\n      const items = this.#selectors[selectorId].items;\n      const cartItemsInSelector = items.filter(item => this.#app.cart.isItemInCart(item.packageId));\n\n      if (cartItemsInSelector.length > 0) {\n        const itemInCart = cartItemsInSelector[0];\n        this.#selectItem(selectorId, itemInCart);\n        cartItemsInSelector.forEach(item => {\n          if (item.packageId !== itemInCart.packageId) this.#removeItemFromCart(item);\n        });\n      } else if (!this.#selectedItems[selectorId]) {\n        const preSelected = items.find(item => item.isPreSelected);\n        if (preSelected) {\n          this.#selectItem(selectorId, preSelected);\n          this.#addItemToCart(preSelected);\n        }\n      }\n\n      items.forEach(item => {\n        const isInCart = this.#app.cart.isItemInCart(item.packageId);\n        item.element.classList.toggle('os--active', isInCart);\n        item.element.setAttribute('data-os-active', isInCart.toString());\n      });\n    });\n  }\n\n  /**\n   * Initialize unit pricing for all selectors\n   * This populates any elements with data-card-price attributes\n   */\n  initUnitPricing() {\n    this.#logger.info('Initializing unit pricing for selectors');\n    // Add a delay to ensure campaign data is loaded\n    setTimeout(() => {\n      Object.keys(this.#selectors).forEach(selectorId => {\n        this.#initUnitPricingForSelector(selectorId);\n      });\n    }, 100);\n  }\n\n  /**\n   * Initialize unit pricing for a specific selector\n   * @param {string} selectorId - The ID of the selector\n   */\n  #initUnitPricingForSelector(selectorId) {\n    const selector = this.#selectors[selectorId];\n    if (!selector) {\n      this.#logger.warn(`Selector ${selectorId} not found for unit pricing`);\n      return;\n    }\n\n    // Get package data from the campaign data\n    const campaignData = this.#app?.campaignData;\n    if (!campaignData || !campaignData.packages) {\n      this.#logger.warn('Campaign data not available for unit pricing');\n      return;\n    }\n\n    selector.items.forEach(item => {\n      this.#updateUnitPricingForCard(item, campaignData.packages);\n    });\n  }\n\n  /**\n   * Update unit pricing for a specific card\n   * @param {Object} item - The item object\n   * @param {Array} packages - The packages array from campaign data\n   */\n  #updateUnitPricingForCard(item, packages) {\n    // Find the package data for this card\n    const packageData = packages.find(pkg => \n      pkg.ref_id.toString() === item.packageId.toString() || \n      (pkg.external_id && pkg.external_id.toString() === item.packageId.toString())\n    );\n\n    if (!packageData) {\n      this.#logger.debug(`Package data not found for item ${item.packageId}`);\n      return;\n    }\n\n    const cardElement = item.element;\n    \n    // Log package data for debugging\n    this.#logger.debug(`Processing unit pricing for package ${item.packageId}:`, {\n      packageId: item.packageId,\n      name: packageData.name,\n      price: packageData.price,\n      price_total: packageData.price_total,\n      price_retail: packageData.price_retail,\n      price_retail_total: packageData.price_retail_total,\n      qty: packageData.qty\n    });\n    \n    // Calculate unit metrics\n    const totalUnits = packageData.qty || 1;\n    const totalPrice = Number.parseFloat(packageData.price_total) || Number.parseFloat(packageData.price) * totalUnits;\n    const totalRetailPrice = Number.parseFloat(packageData.price_retail_total) || \n                             (Number.parseFloat(packageData.price_retail) * totalUnits) || \n                             totalPrice;\n    \n    // Calculate unit prices\n    const unitPrice = totalPrice / totalUnits;\n    const unitRetailPrice = totalRetailPrice / totalUnits;\n    const unitSavings = unitRetailPrice - unitPrice;\n    const unitSavingsPercentage = unitRetailPrice > 0 ? (unitSavings / unitRetailPrice) * 100 : 0;\n    \n    // Calculate total savings\n    const totalSavings = totalRetailPrice - totalPrice;\n    const totalSavingsPercentage = totalRetailPrice > 0 ? (totalSavings / totalRetailPrice) * 100 : 0;\n    \n    // Log calculated values for debugging\n    this.#logger.debug(`Calculated prices for package ${item.packageId}:`, {\n      totalUnits,\n      totalPrice,\n      totalRetailPrice,\n      totalSavings,\n      totalSavingsPercentage,\n      unitPrice,\n      unitRetailPrice,\n      unitSavings,\n      unitSavingsPercentage\n    });\n    \n    // Format prices\n    const formatPrice = (price) => {\n      if (this.#app.campaign?.formatPrice) {\n        return this.#app.campaign.formatPrice(price);\n      }\n      return `$${price.toFixed(2)}`;\n    };\n    \n    // Track which elements have been processed with data-divide-by\n    const processedElements = new Set();\n    \n    // Look for any data-divide-by elements to calculate subunit pricing (e.g., price per facial)\n    const subunitElements = cardElement.querySelectorAll('[data-divide-by]');\n    if (subunitElements.length > 0) {\n      this.#logger.debug(`Found ${subunitElements.length} elements with data-divide-by in card ${item.packageId}`);\n      \n      subunitElements.forEach(element => {\n        const divisor = parseFloat(element.getAttribute('data-divide-by'));\n        if (!isNaN(divisor) && divisor > 0) {\n          const type = element.getAttribute('data-card-price');\n          \n          // Skip elements without a data-card-price attribute\n          if (!type) {\n            this.#logger.debug(`Skipping element with data-divide-by but no data-card-price attribute`);\n            return;\n          }\n          \n          let value;\n          \n          // Calculate the subunit value based on the type\n          switch (type) {\n            case 'each-sale':\n              value = unitPrice / divisor;\n              break;\n            case 'each-regular':\n              value = unitRetailPrice / divisor;\n              break;\n            case 'saving-amount':\n              value = unitSavings / divisor;\n              break;\n            case 'saving-percentage':\n              value = unitSavingsPercentage; // Percentage stays the same regardless of division\n              break;\n            case 'total-sale':\n              value = totalPrice / divisor;\n              break;\n            case 'total-regular':\n              value = totalRetailPrice / divisor;\n              break;\n            case 'total-saving-amount':\n              value = totalSavings / divisor;\n              break;\n            case 'total-saving-percentage':\n              value = totalSavingsPercentage; // Percentage stays the same\n              break;\n            default:\n              this.#logger.debug(`Unknown price type: ${type}`);\n              return;\n          }\n          \n          // Format the value\n          let formattedValue;\n          if (type.includes('percentage')) {\n            formattedValue = `${Math.round(value)}%`;\n          } else {\n            formattedValue = formatPrice(value);\n          }\n          \n          // Update the element\n          this.#logger.debug(`Setting price for element with data-divide-by=\"${divisor}\":`, {\n            attributeType: type,\n            originalValue: element.textContent,\n            calculatedValue: value,\n            formattedValue: formattedValue,\n            element: element.outerHTML\n          });\n          \n          element.textContent = formattedValue;\n          \n          // Mark this element as processed\n          processedElements.add(element);\n          \n          this.#logger.debug(`Updated element with data-divide-by=\"${divisor}\" for ${type}: ${formattedValue}`);\n        }\n      });\n    }\n\n    // UNIT PRICING - Update elements with data-card-price attribute (skip those already processed)\n    this.#updatePriceElement(cardElement, 'each-sale', formatPrice(unitPrice), processedElements);\n    this.#updatePriceElement(cardElement, 'each-regular', formatPrice(unitRetailPrice), processedElements);\n    this.#updatePriceElement(cardElement, 'saving-amount', formatPrice(unitSavings), processedElements);\n    this.#updatePriceElement(cardElement, 'saving-percentage', `${Math.round(unitSavingsPercentage)}%`, processedElements);\n    \n    // TOTAL PRICING - Add support for total package prices\n    this.#updatePriceElement(cardElement, 'total-sale', formatPrice(totalPrice), processedElements);\n    this.#updatePriceElement(cardElement, 'total-regular', formatPrice(totalRetailPrice), processedElements);\n    this.#updatePriceElement(cardElement, 'total-saving-amount', formatPrice(totalSavings), processedElements);\n    this.#updatePriceElement(cardElement, 'total-saving-percentage', `${Math.round(totalSavingsPercentage)}%`, processedElements);\n    \n    this.#logger.debug(`Updated pricing for card ${item.packageId}: ${formatPrice(unitPrice)} per unit, ${formatPrice(totalPrice)} total`);\n  }\n\n  /**\n   * Format a price with currency symbol\n   * @param {number} price - Price to format\n   * @returns {string} Formatted price\n   */\n  #formatPrice(price) {\n    // Use the campaign's formatPrice method if available\n    if (this.#app.campaign?.formatPrice) {\n      return this.#app.campaign.formatPrice(price);\n    }\n    \n    // Otherwise, use a simple formatter\n    return `$${price.toFixed(2)}`;\n  }\n\n  /**\n   * Update a price element with the calculated value\n   * @param {HTMLElement} cardElement - The card element\n   * @param {string} type - The price type\n   * @param {string} value - The formatted price value\n   * @param {Set} processedElements - Set of elements that have already been processed\n   */\n  #updatePriceElement(cardElement, type, value, processedElements = new Set()) {\n    const priceElements = cardElement.querySelectorAll(`[data-card-price=\"${type}\"]`);\n    \n    if (priceElements.length > 0) {\n      priceElements.forEach(element => {\n        // Skip elements that have already been processed with data-divide-by\n        if (processedElements.has(element)) {\n          return;\n        }\n        \n        element.textContent = value;\n        \n        // If the price is 0 or negative, optionally hide the element\n        const hideIfZero = element.getAttribute('data-hide-if-zero') === 'true';\n        const numericValue = parseFloat(value.replace(/[^0-9.-]+/g, ''));\n        \n        if (hideIfZero && (numericValue <= 0)) {\n          element.style.display = 'none';\n          // Also hide parent if it has data-container attribute\n          const container = element.closest('[data-container=\"true\"]');\n          if (container) container.style.display = 'none';\n        } else {\n          element.style.display = '';\n          // Show parent if it was hidden\n          const container = element.closest('[data-container=\"true\"]');\n          if (container) container.style.display = '';\n        }\n      });\n    }\n  }\n\n  /**\n   * Refresh unit pricing for all selectors\n   * This can be called after campaign data is updated\n   */\n  refreshUnitPricing() {\n    this.initUnitPricing();\n  }\n\n  /**\n   * Trigger view_item_list event for all visible packages on the page\n   * This method is public so it can be called from EventManager if needed\n   */\n  triggerViewItemList() {\n    const campaignData = this.#app.getCampaignData();\n    if (!campaignData || !campaignData.packages || campaignData.packages.length === 0) {\n      this.#logger.warn('Cannot trigger view_item_list: No packages in campaign data');\n      return;\n    }\n    \n    // Collect all package IDs present on the page\n    const visiblePackageIds = new Set();\n    const visiblePackages = [];\n    \n    // Iterate through all selectors to find visible packages\n    Object.values(this.#selectors).forEach(selector => {\n      selector.items.forEach(item => {\n        if (item.packageId) {\n          visiblePackageIds.add(item.packageId.toString());\n        }\n      });\n    });\n    \n    // For debugging, log the found packages\n    this.#logger.debug(`Found ${visiblePackageIds.size} unique package IDs in selectors`);\n    \n    // Find matching packages in campaign data\n    campaignData.packages.forEach(pkg => {\n      const refIdStr = pkg.ref_id?.toString();\n      const externalIdStr = pkg.external_id?.toString();\n      \n      if (visiblePackageIds.has(refIdStr) || visiblePackageIds.has(externalIdStr)) {\n        visiblePackages.push(pkg);\n      }\n    });\n    \n    // If we found matching packages, trigger the event\n    if (visiblePackages.length > 0) {\n      this.#logger.info(`Triggering view_item_list for ${visiblePackages.length} visible packages`);\n      \n      // Create a filtered version of campaign data\n      const filteredCampaignData = {\n        ...campaignData,\n        packages: visiblePackages\n      };\n      \n      // Check which method to use based on what's available\n      if (this.#app.eventManager?.viewItemList) {\n        // Use EventManager's viewItemList if available\n        this.#app.eventManager.viewItemList(filteredCampaignData);\n        this.#logger.debug('Used eventManager.viewItemList to fire event');\n      } else if (this.#app.events?.viewItemList) {\n        // Fall back to events system\n        this.#app.events.viewItemList(filteredCampaignData);\n        this.#logger.debug('Used events.viewItemList to fire event');\n      } else {\n        this.#logger.warn('No suitable method found to trigger view_item_list');\n      }\n    } else {\n      this.#logger.warn('No matching packages found between selectors and campaign data');\n    }\n  }\n}", "/**\r\n * ToggleManager - Manages toggle item buttons in the DOM\r\n * \r\n * This class handles toggle item buttons that can add/remove items from the cart.\r\n */\r\n\r\nimport { DebugUtils } from '../utils/DebugUtils.js';\r\n\r\nexport class ToggleManager {\r\n  #toggleItems = {};\r\n  #app;\r\n  #logger;\r\n  #isDebugMode = false;\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('TOGGLE');\r\n    this.#isDebugMode = DebugUtils.initDebugMode();\r\n    this.#initToggleItems();\r\n    this.#app.state.subscribe('cart', () => this.#updateAllToggleItemsUI());\r\n    this.#logger.info('ToggleManager initialized');\r\n    if (this.#isDebugMode) {\r\n      this.#logger.info('Debug mode enabled for toggle items');\r\n    }\r\n  }\r\n\r\n  #initToggleItems() {\r\n    const toggleElements = document.querySelectorAll('[data-os-action=\"toggle-item\"]');\r\n    \r\n    if (!toggleElements.length) {\r\n      this.#logger.debug('No toggle item buttons found in the DOM');\r\n      return;\r\n    }\r\n    \r\n    this.#logger.info(`Found ${toggleElements.length} toggle item buttons`);\r\n    toggleElements.forEach(element => this.#initToggleItem(element));\r\n  }\r\n\r\n  #initToggleItem(toggleElement) {\r\n    const packageId = toggleElement.getAttribute('data-os-package');\r\n    if (!packageId) {\r\n      this.#logger.warn('Toggle item missing data-os-package attribute', toggleElement);\r\n      return;\r\n    }\r\n\r\n    const quantity = Number.parseInt(toggleElement.getAttribute('data-os-quantity') ?? '1', 10);\r\n    const toggleId = toggleElement.getAttribute('data-os-id') ?? `toggle-${packageId}`;\r\n\r\n    this.#toggleItems[toggleId] = { element: toggleElement, packageId, quantity };\r\n    this.#updateToggleItemUI(toggleElement, packageId);\r\n\r\n    toggleElement.addEventListener('click', event => {\r\n      event.preventDefault();\r\n      this.#toggleItem(toggleId);\r\n    });\r\n\r\n    if (this.#isDebugMode) {\r\n      this.#addDebugOverlay(toggleElement, toggleId, packageId, quantity);\r\n    }\r\n\r\n    this.#logger.debug(`Initialized toggle item ${toggleId} for package ${packageId}`);\r\n  }\r\n\r\n  #addDebugOverlay(element, toggleId, packageId, quantity) {\r\n    const packageData = this.#getPackageDataFromCampaign(packageId);\r\n    const price = packageData ? packageData.price : 'N/A';\r\n    \r\n    // Check if this is an upsell toggle\r\n    const isUpsell = element.hasAttribute('data-os-upsell') ? \r\n      element.getAttribute('data-os-upsell') === 'true' : \r\n      (element.closest('[data-os-upsell-section]') !== null);\r\n    \r\n    DebugUtils.addDebugOverlay(element, toggleId, 'toggle', {\r\n      'Package': packageId,\r\n      'Qty': quantity,\r\n      'Price': price,\r\n      'Upsell': isUpsell ? 'Yes' : 'No'\r\n    });\r\n  }\r\n\r\n  #toggleItem(toggleId) {\r\n    const toggleItem = this.#toggleItems[toggleId];\r\n    if (!toggleItem) {\r\n      this.#logger.error(`Toggle item ${toggleId} not found`);\r\n      return;\r\n    }\r\n\r\n    const { packageId, quantity, element } = toggleItem;\r\n    const isInCart = this.#isItemInCart(packageId);\r\n\r\n    if (isInCart) {\r\n      this.#removeItemFromCart(packageId);\r\n      this.#logger.info(`Toggled OFF item ${packageId}`);\r\n    } else {\r\n      const packageData = this.#getPackageDataFromCampaign(packageId);\r\n      if (!packageData) {\r\n        this.#logger.error(`Package ${packageId} not found in campaign data`);\r\n        return;\r\n      }\r\n\r\n      // Check if this is an upsell toggle\r\n      const isUpsell = element.hasAttribute('data-os-upsell') ? \r\n        element.getAttribute('data-os-upsell') === 'true' : \r\n        (element.closest('[data-os-upsell-section]') !== null);\r\n\r\n      this.#addItemToCart({\r\n        id: packageId,\r\n        name: packageData.name,\r\n        price: Number.parseFloat(packageData.price),\r\n        quantity,\r\n        type: 'package',\r\n        is_upsell: isUpsell\r\n      });\r\n      \r\n      this.#logger.info(`Toggled ON item ${packageId}${isUpsell ? ' (upsell)' : ''}`);\r\n    }\r\n\r\n    this.#updateToggleItemUI(element, packageId);\r\n    this.#app.triggerEvent('toggle.changed', { toggleId, packageId, isActive: !isInCart });\r\n  }\r\n\r\n  #getPackageDataFromCampaign(packageId) {\r\n    if (!this.#app.campaignData?.packages) {\r\n      this.#logger.error('Campaign data not available');\r\n      return null;\r\n    }\r\n    \r\n    return this.#app.campaignData.packages.find(pkg => pkg.ref_id.toString() === packageId.toString()) ?? null;\r\n  }\r\n\r\n  #updateToggleItemUI(element, packageId) {\r\n    const isInCart = this.#isItemInCart(packageId);\r\n    element.classList.toggle('os--active', isInCart);\r\n    element.setAttribute('data-os-active', isInCart.toString());\r\n  }\r\n\r\n  #updateAllToggleItemsUI() {\r\n    Object.values(this.#toggleItems).forEach(({ element, packageId }) => \r\n      this.#updateToggleItemUI(element, packageId)\r\n    );\r\n  }\r\n\r\n  #isItemInCart(itemId) {\r\n    return this.#app.state.getState('cart').items.some(item => item.id === itemId);\r\n  }\r\n\r\n  #addItemToCart(item) {\r\n    if (!this.#app.cart) {\r\n      this.#logger.error('Cart manager not available');\r\n      return;\r\n    }\r\n    this.#app.cart.addToCart(item);\r\n  }\r\n\r\n  #removeItemFromCart(itemId) {\r\n    if (!this.#app.cart) {\r\n      this.#logger.error('Cart manager not available');\r\n      return;\r\n    }\r\n    this.#app.cart.removeFromCart(itemId);\r\n  }\r\n}", "/**\n * DebugManager - Provides debugging tools for developers\n * \n * This class provides debugging tools for developers, including a mini-cart widget\n * that can be toggled via console commands.\n */\n\nimport { DebugUtils } from '../utils/DebugUtils.js';\n\nexport class DebugManager {\n  #app;\n  #logger;\n  #miniCartVisible = false;\n  #miniCartElement = null;\n  #debugBarElement = null;\n  #isDebugMode = false;\n\n  constructor(app) {\n    this.#app = app;\n    this.#logger = app.logger.createModuleLogger('DEBUG');\n    this.#isDebugMode = DebugUtils.initDebugMode();\n    this.#init();\n    this.#logger.info('DebugManager initialized');\n  }\n\n  #init() {\n    // Expose debug methods to window object\n    window.showMiniCart = () => this.#showMiniCart();\n    window.hideMiniCart = () => this.#hideMiniCart();\n    window.toggleMiniCart = () => this.#toggleMiniCart();\n    window.toggleXray = (enabled) => this.#toggleXray(enabled);\n\n    // Check for URL parameter ?debugger=true\n    if (this.#isDebugMode) {\n      this.#logger.info('Debug mode activated via URL parameter');\n      this.#createDebugBar();\n      \n      // Show mini-cart if it was previously visible\n      if (localStorage.getItem('os_debug_mini_cart_visible') === 'true') {\n        this.#showMiniCart();\n      }\n    }\n\n    this.#app.state?.subscribe('cart', () => {\n      if (this.#miniCartVisible) this.#updateMiniCart();\n    });\n\n    this.#logger.debug('Debug methods exposed to window object');\n  }\n\n  #createDebugBar() {\n    if (this.#debugBarElement) return;\n\n    const debugBar = document.createElement('div');\n    debugBar.className = 'os-debug-bar';\n\n    // Left section with title\n    const leftSection = document.createElement('div');\n    leftSection.className = 'os-debug-bar-left';\n    \n    const title = document.createElement('span');\n    title.className = 'os-debug-bar-title';\n    title.textContent = '29next Debug Tools';\n    \n    leftSection.appendChild(title);\n\n    // Right section with controls\n    const rightSection = document.createElement('div');\n    rightSection.className = 'os-debug-bar-controls';\n\n    // X-ray toggle\n    const xrayControl = document.createElement('div');\n    xrayControl.className = 'os-debug-bar-control';\n    \n    const xrayLabel = document.createElement('span');\n    xrayLabel.textContent = 'X-ray View';\n    \n    const xrayToggle = document.createElement('label');\n    xrayToggle.className = 'os-debug-bar-toggle';\n    \n    const xrayCheckbox = document.createElement('input');\n    xrayCheckbox.type = 'checkbox';\n    xrayCheckbox.checked = DebugUtils.isXrayEnabled();\n    xrayCheckbox.addEventListener('change', () => this.#toggleXray(xrayCheckbox.checked));\n    \n    const xraySlider = document.createElement('span');\n    xraySlider.className = 'os-debug-bar-slider';\n    \n    xrayToggle.append(xrayCheckbox, xraySlider);\n    xrayControl.append(xrayLabel, xrayToggle);\n\n    // Mini-cart toggle\n    const cartControl = document.createElement('div');\n    cartControl.className = 'os-debug-bar-control';\n    \n    const cartButton = document.createElement('button');\n    cartButton.className = 'os-debug-bar-button';\n    cartButton.textContent = 'Toggle Mini-Cart';\n    cartButton.addEventListener('click', () => this.#toggleMiniCart());\n    \n    cartControl.appendChild(cartButton);\n\n    // Add controls to right section\n    rightSection.append(xrayControl, cartControl);\n\n    // Add sections to debug bar\n    debugBar.append(leftSection, rightSection);\n\n    // Add debug bar to document\n    document.body.appendChild(debugBar);\n    this.#debugBarElement = debugBar;\n  }\n\n  #toggleXray(enabled) {\n    const isEnabled = DebugUtils.toggleXray(enabled);\n    \n    // Update checkbox if it exists\n    if (this.#debugBarElement) {\n      const checkbox = this.#debugBarElement.querySelector('input[type=\"checkbox\"]');\n      if (checkbox) checkbox.checked = isEnabled;\n    }\n    \n    this.#logger.info(`X-ray view ${isEnabled ? 'enabled' : 'disabled'}`);\n    return isEnabled;\n  }\n\n  #showMiniCart() {\n    if (this.#miniCartVisible) {\n      this.#logger.debug('Mini-cart already visible');\n      return;\n    }\n\n    this.#logger.info('Showing mini-cart widget');\n    this.#miniCartElement ??= this.#createMiniCartElement();\n    this.#miniCartElement.style.display = 'block';\n    this.#miniCartVisible = true;\n    localStorage.setItem('os_debug_mini_cart_visible', 'true');\n    this.#updateMiniCart();\n  }\n\n  #hideMiniCart() {\n    if (!this.#miniCartVisible) {\n      this.#logger.debug('Mini-cart already hidden');\n      return;\n    }\n\n    this.#logger.info('Hiding mini-cart widget');\n    if (this.#miniCartElement) {\n      this.#miniCartElement.style.display = 'none';\n    }\n    this.#miniCartVisible = false;\n    localStorage.setItem('os_debug_mini_cart_visible', 'false');\n  }\n\n  #toggleMiniCart() {\n    this.#miniCartVisible ? this.#hideMiniCart() : this.#showMiniCart();\n  }\n\n  #createMiniCartElement() {\n    const miniCart = document.createElement('div');\n    miniCart.className = 'os-debug-mini-cart';\n    miniCart.style.cssText = `\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      width: 300px;\n      max-height: 400px;\n      overflow-y: auto;\n      background-color: white;\n      border: 1px solid #ccc;\n      border-radius: 4px;\n      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n      z-index: 9999;\n      font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif;\n      font-size: 14px;\n      display: none;\n    `;\n\n    const header = document.createElement('div');\n    header.className = 'os-debug-mini-cart-header';\n    header.style.cssText = `\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      padding: 10px 15px;\n      background-color: #f5f5f5;\n      border-bottom: 1px solid #eee;\n    `;\n\n    const title = document.createElement('div');\n    title.className = 'os-debug-mini-cart-title';\n    title.textContent = 'Debug Mini-Cart';\n    title.style.fontWeight = '600';\n\n    const buttonContainer = document.createElement('div');\n    buttonContainer.style.display = 'flex';\n    buttonContainer.style.alignItems = 'center';\n\n    const refreshButton = document.createElement('button');\n    refreshButton.className = 'os-debug-mini-cart-refresh';\n    refreshButton.textContent = '↻';\n    refreshButton.title = 'Refresh cart data';\n    refreshButton.style.cssText = `\n      background: none;\n      border: none;\n      font-size: 16px;\n      cursor: pointer;\n      padding: 0 8px;\n      line-height: 1;\n      color: #666;\n    `;\n    refreshButton.addEventListener('click', () => {\n      this.#updateMiniCart();\n      this.#logger.info('Mini-cart data refreshed manually');\n    });\n\n    const closeButton = document.createElement('button');\n    closeButton.className = 'os-debug-mini-cart-close';\n    closeButton.textContent = '×';\n    closeButton.style.cssText = `\n      background: none;\n      border: none;\n      font-size: 20px;\n      cursor: pointer;\n      padding: 0;\n      line-height: 1;\n    `;\n    closeButton.addEventListener('click', () => this.#hideMiniCart());\n\n    buttonContainer.append(refreshButton, closeButton);\n    header.append(title, buttonContainer);\n\n    const content = document.createElement('div');\n    content.className = 'os-debug-mini-cart-content';\n    content.style.padding = '15px';\n\n    const footer = document.createElement('div');\n    footer.className = 'os-debug-mini-cart-footer';\n    footer.style.cssText = `\n      padding: 10px 15px;\n      background-color: #f5f5f5;\n      border-top: 1px solid #eee;\n      font-size: 12px;\n      color: #666;\n      text-align: center;\n    `;\n    footer.textContent = 'Use window.hideMiniCart() to hide this widget';\n\n    miniCart.append(header, content, footer);\n    document.body.appendChild(miniCart);\n\n    return miniCart;\n  }\n\n  #updateMiniCart() {\n    if (!this.#miniCartElement) return;\n\n    const content = this.#miniCartElement.querySelector('.os-debug-mini-cart-content');\n    if (!content) return;\n\n    const cart = this.#app.state?.getState('cart');\n    if (!cart) {\n      content.innerHTML = '<div style=\"color: #999; text-align: center;\">Cart data not available</div>';\n      return;\n    }\n\n    this.#logger.debug('Updating mini-cart with cart data:', cart);\n\n    const formatPrice = price => this.#app.campaign?.formatPrice(price) ?? `$${price.toFixed(2)}`;\n    let html = '';\n\n    if (!cart.items?.length) {\n      html += '<div style=\"color: #999; text-align: center; margin-bottom: 15px;\">Cart is empty</div>';\n    } else {\n      html += '<div style=\"margin-bottom: 15px;\">';\n      html += '<div style=\"font-weight: 600; margin-bottom: 10px;\">Items:</div>';\n      html += '<ul style=\"list-style: none; padding: 0; margin: 0;\">';\n      cart.items.forEach(item => {\n        // Check if item is marked as an upsell\n        const isUpsell = !!item.is_upsell;\n        \n        // Create upsell badge if needed\n        const upsellBadge = isUpsell ? \n          `<span style=\"display: inline-block; background-color: #4CAF50; color: white; font-size: 10px; padding: 2px 5px; border-radius: 3px; margin-left: 5px;\">UPSELL</span>` : \n          '';\n        \n        html += `\n          <li style=\"padding: 5px 0; border-bottom: 1px solid #eee; ${isUpsell ? 'background-color: rgba(76, 175, 80, 0.1);' : ''}\">\n            <div style=\"display: flex; justify-content: space-between;\">\n              <div style=\"font-weight: 500;\">${item.name}${upsellBadge}</div>\n              <div>${item.quantity} × ${formatPrice(item.price)}</div>\n            </div>\n            <div style=\"display: flex; justify-content: space-between; margin-top: 5px;\">\n              <div style=\"color: #666; font-size: 12px;\">\n                ID: ${item.id}\n                ${isUpsell ? '<span style=\"color: #4CAF50; margin-left: 5px;\">✓ is_upsell=true</span>' : ''}\n              </div>\n              <div style=\"font-weight: 500;\">${formatPrice(item.price * item.quantity)}</div>\n            </div>\n          </li>\n        `;\n      });\n      html += '</ul></div>';\n    }\n\n    if (cart.totals) {\n      html += '<div>';\n      html += '<div style=\"font-weight: 600; margin-bottom: 10px;\">Totals:</div>';\n      html += '<ul style=\"list-style: none; padding: 0; margin: 0;\">';\n      html += `\n        <li style=\"display: flex; justify-content: space-between; padding: 3px 0;\">\n          <div>Subtotal:</div>\n          <div>${formatPrice(cart.totals.subtotal)}</div>\n        </li>\n      `;\n      if (cart.totals.retail_subtotal > cart.totals.subtotal) {\n        html += `\n          <li style=\"display: flex; justify-content: space-between; padding: 3px 0;\">\n            <div>Retail Subtotal:</div>\n            <div>${formatPrice(cart.totals.retail_subtotal)}</div>\n          </li>\n        `;\n        if (cart.totals.savings) {\n          html += `\n            <li style=\"display: flex; justify-content: space-between; padding: 3px 0; color: #e53935;\">\n              <div>Savings:</div>\n              <div>${formatPrice(cart.totals.savings)} (${Math.round(cart.totals.savings_percentage)}%)</div>\n            </li>\n          `;\n        }\n      }\n      if (cart.totals.shipping > 0) {\n        html += `\n          <li style=\"display: flex; justify-content: space-between; padding: 3px 0;\">\n            <div>Shipping:</div>\n            <div>${formatPrice(cart.totals.shipping)}</div>\n          </li>\n        `;\n      }\n      if (cart.totals.recurring_total > 0) {\n        html += `\n          <li style=\"display: flex; justify-content: space-between; padding: 3px 0; color: #2196f3;\">\n            <div>Recurring Total:</div>\n            <div>${formatPrice(cart.totals.recurring_total)}</div>\n          </li>\n        `;\n      }\n      html += `\n        <li style=\"display: flex; justify-content: space-between; padding: 3px 0; font-weight: 600; margin-top: 5px; border-top: 1px solid #eee;\">\n          <div>Total:</div>\n          <div>${formatPrice(cart.totals.total)}</div>\n        </li>\n      `;\n      html += '</ul></div>';\n    } else {\n      html += '<div style=\"color: #999; text-align: center; margin-bottom: 15px;\">Cart totals not available</div>';\n    }\n\n    content.innerHTML = html;\n  }\n}", "/**\r\n * TimerManager - Manages countdown timers\r\n * \r\n * This class handles countdown timers that can be added to the page\r\n * using data-os-element=\"timer\" attributes.\r\n */\r\n\r\nexport class TimerManager {\r\n  #app;\r\n  #logger;\r\n  #timers = new Map();\r\n  #storagePrefix = 'os-timer-';\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('TIMER');\r\n    this.#initTimers();\r\n    this.#logger.infoWithTime('TimerManager initialized');\r\n  }\r\n\r\n  /**\r\n   * Initialize all timers on the page\r\n   */\r\n  #initTimers() {\r\n    this.#logger.infoWithTime('Initializing timers');\r\n    const timerElements = document.querySelectorAll('[data-os-element=\"timer\"]');\r\n    \r\n    if (timerElements.length === 0) {\r\n      this.#logger.debugWithTime('No timer elements found on page');\r\n      return;\r\n    }\r\n    \r\n    this.#logger.debugWithTime(`Found ${timerElements.length} timer elements`);\r\n    \r\n    timerElements.forEach((timerElement) => {\r\n      this.#setupTimer(timerElement);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Set up a single timer element\r\n   * @param {HTMLElement} timerElement - The timer element to set up\r\n   */\r\n  #setupTimer(timerElement) {\r\n    // Get the parent element that may contain timer configuration\r\n    const parentElement = timerElement.closest('[data-os-element=\"timer-text\"]');\r\n    \r\n    if (!parentElement) {\r\n      this.#logger.warnWithTime(`Timer element has no parent with data-os-element=\"timer-text\", using default configuration`);\r\n    }\r\n    \r\n    // Get timer configuration\r\n    const timerConfig = this.#getTimerConfig(timerElement, parentElement);\r\n    \r\n    if (!timerConfig.duration) {\r\n      this.#logger.warnWithTime(`Timer element is missing duration, skipping: ${timerElement.outerHTML}`);\r\n      return;\r\n    }\r\n    \r\n    // Store the original content of the parent element for potential restoration\r\n    const originalParentContent = parentElement ? parentElement.innerHTML : null;\r\n    \r\n    // Set up the timer\r\n    let startTime = +new Date();\r\n    const timerPersistenceId = timerConfig.persistenceId;\r\n    \r\n    // If we have a persistence ID, try to load the start time from localStorage\r\n    if (timerPersistenceId) {\r\n      const storageKey = this.#storagePrefix + timerPersistenceId;\r\n      const cachedStartTime = parseInt(localStorage.getItem(storageKey) || \"\");\r\n      \r\n      if (cachedStartTime > 0) {\r\n        startTime = cachedStartTime;\r\n        this.#logger.debugWithTime(`Loaded persisted timer start time for ${timerPersistenceId}: ${new Date(startTime).toISOString()}`);\r\n      } else {\r\n        localStorage.setItem(storageKey, String(startTime));\r\n        this.#logger.debugWithTime(`Saved new timer start time for ${timerPersistenceId}: ${new Date(startTime).toISOString()}`);\r\n      }\r\n    } else {\r\n      this.#logger.debugWithTime(`Timer has no persistence ID, it will reset with every page load: ${timerElement.outerHTML}`);\r\n    }\r\n    \r\n    // Create a timer object to store the interval ID\r\n    const timer = {\r\n      element: timerElement,\r\n      parentElement,\r\n      config: timerConfig,\r\n      startTime,\r\n      intervalId: null,\r\n      originalParentContent\r\n    };\r\n    \r\n    // Store the timer information\r\n    this.#timers.set(timerElement, timer);\r\n    \r\n    // Create the timer update handler with access to the timer object\r\n    const updateHandler = () => {\r\n      const now = +new Date();\r\n      const elapsed = (now - startTime) / 1000;\r\n      let seconds = Math.round(timerConfig.duration - elapsed);\r\n      \r\n      if (seconds <= 0) {\r\n        seconds = 0;\r\n        \r\n        // Handle timer expiry\r\n        if (timerConfig.expiryText) {\r\n          // Check if we should replace the entire parent content or just the timer\r\n          if (parentElement && timerConfig.replaceEntireContent) {\r\n            parentElement.innerHTML = timerConfig.expiryText;\r\n          } else {\r\n            timerElement.innerText = timerConfig.expiryText;\r\n          }\r\n        } else {\r\n          timerElement.innerText = \"00:00\";\r\n        }\r\n        \r\n        // Clear the interval - now we can safely access the intervalId from the timer object\r\n        if (timer.intervalId) {\r\n          clearInterval(timer.intervalId);\r\n          timer.intervalId = null;\r\n        }\r\n        \r\n        this.#timers.delete(timerElement);\r\n        \r\n        // Trigger expiry event\r\n        this.#triggerTimerEvent('expired', timerElement, { \r\n          timerElement, \r\n          parentElement, \r\n          config: timerConfig \r\n        });\r\n        \r\n        return;\r\n      }\r\n      \r\n      // Format the time\r\n      const hours = Math.floor(seconds / 3600);\r\n      seconds -= hours * 3600;\r\n      const minutes = Math.floor(seconds / 60);\r\n      seconds -= minutes * 60;\r\n      \r\n      // Update the timer text\r\n      const formattedTime = this.#formatTime(hours, minutes, seconds, timerConfig.format);\r\n      timerElement.innerText = formattedTime;\r\n      \r\n      // Trigger update event\r\n      this.#triggerTimerEvent('updated', timerElement, { \r\n        timerElement, \r\n        parentElement, \r\n        config: timerConfig,\r\n        remaining: { hours, minutes, seconds },\r\n        formattedTime\r\n      });\r\n    };\r\n    \r\n    // Run the handler immediately to set the initial value\r\n    updateHandler();\r\n    \r\n    // Set up the interval and store the ID in the timer object\r\n    timer.intervalId = setInterval(updateHandler, 1000);\r\n    \r\n    this.#logger.debugWithTime(`Timer initialized: ${timerConfig.duration} seconds, persistence ID: ${timerConfig.persistenceId || 'none'}`);\r\n  }\r\n\r\n  /**\r\n   * Get timer configuration from element attributes\r\n   * @param {HTMLElement} timerElement - The timer element\r\n   * @param {HTMLElement|null} parentElement - The parent element with timer configuration\r\n   * @returns {Object} Timer configuration\r\n   */\r\n  #getTimerConfig(timerElement, parentElement) {\r\n    const config = {\r\n      duration: 0,\r\n      persistenceId: null,\r\n      expiryText: null,\r\n      format: 'auto', // 'auto', 'hh:mm:ss', 'mm:ss', 'ss'\r\n      replaceEntireContent: false // Whether to replace the entire parent content on expiry\r\n    };\r\n    \r\n    // Try to get duration from data attributes\r\n    if (timerElement.dataset.osDuration) {\r\n      config.duration = parseInt(timerElement.dataset.osDuration);\r\n    } else if (parentElement?.dataset.osTimerDuration) {\r\n      config.duration = parseInt(parentElement.dataset.osTimerDuration);\r\n    }\r\n    \r\n    // Try to get persistence ID from data attributes\r\n    if (timerElement.dataset.osPersistenceId) {\r\n      config.persistenceId = timerElement.dataset.osPersistenceId;\r\n    } else if (parentElement?.dataset.osTimerPersistenceId) {\r\n      config.persistenceId = parentElement.dataset.osTimerPersistenceId;\r\n    }\r\n    \r\n    // Try to get expiry text from data attributes\r\n    if (timerElement.dataset.osExpiryText) {\r\n      config.expiryText = timerElement.dataset.osExpiryText;\r\n    } else if (parentElement?.dataset.osTimerExpiryText) {\r\n      config.expiryText = parentElement.dataset.osTimerExpiryText;\r\n    }\r\n    \r\n    // Try to get format from data attributes\r\n    if (timerElement.dataset.osFormat) {\r\n      config.format = timerElement.dataset.osFormat;\r\n    } else if (parentElement?.dataset.osTimerFormat) {\r\n      config.format = parentElement.dataset.osTimerFormat;\r\n    }\r\n    \r\n    // Check if we should replace the entire content\r\n    if (timerElement.dataset.osReplaceEntireContent === 'true') {\r\n      config.replaceEntireContent = true;\r\n    } else if (parentElement?.dataset.osTimerReplaceEntireContent === 'true') {\r\n      config.replaceEntireContent = true;\r\n    }\r\n    \r\n    // If the expiry text contains HTML tags, we should replace the entire content\r\n    if (config.expiryText && (config.expiryText.includes('<') || config.expiryText.includes('>'))) {\r\n      config.replaceEntireContent = true;\r\n    }\r\n    \r\n    return config;\r\n  }\r\n\r\n  /**\r\n   * Format time according to the specified format\r\n   * @param {number} hours - Hours\r\n   * @param {number} minutes - Minutes\r\n   * @param {number} seconds - Seconds\r\n   * @param {string} format - Format string ('auto', 'hh:mm:ss', 'mm:ss', 'ss')\r\n   * @returns {string} Formatted time\r\n   */\r\n  #formatTime(hours, minutes, seconds, format) {\r\n    const padded = (num) => num.toString().padStart(2, '0');\r\n    \r\n    if (format === 'hh:mm:ss' || (format === 'auto' && hours > 0)) {\r\n      return `${padded(hours)}:${padded(minutes)}:${padded(seconds)}`;\r\n    } else if (format === 'mm:ss' || (format === 'auto' && minutes > 0)) {\r\n      return `${padded(minutes)}:${padded(seconds)}`;\r\n    } else if (format === 'ss') {\r\n      return padded(seconds);\r\n    }\r\n    \r\n    // Default format (auto with no significant time)\r\n    return `${padded(minutes)}:${padded(seconds)}`;\r\n  }\r\n\r\n  /**\r\n   * Trigger a timer event\r\n   * @param {string} eventName - Name of the event\r\n   * @param {HTMLElement} element - Element that triggered the event\r\n   * @param {Object} detail - Event details\r\n   */\r\n  #triggerTimerEvent(eventName, element, detail = {}) {\r\n    const event = new CustomEvent(`os:timer.${eventName}`, {\r\n      bubbles: true,\r\n      cancelable: true,\r\n      detail: { ...detail, manager: this }\r\n    });\r\n    \r\n    element.dispatchEvent(event);\r\n    document.dispatchEvent(event);\r\n    this.#logger.debugWithTime(`Timer event triggered: ${eventName}`);\r\n  }\r\n\r\n  /**\r\n   * Refresh all timers on the page\r\n   * This can be called after dynamic content is loaded\r\n   */\r\n  refreshTimers() {\r\n    this.#logger.infoWithTime('Refreshing timers');\r\n    \r\n    // Clear existing timers\r\n    this.#timers.forEach((timer) => {\r\n      if (timer.intervalId) {\r\n        clearInterval(timer.intervalId);\r\n        timer.intervalId = null;\r\n      }\r\n    });\r\n    \r\n    this.#timers.clear();\r\n    \r\n    // Re-initialize timers\r\n    this.#initTimers();\r\n  }\r\n\r\n  /**\r\n   * Get all active timers\r\n   * @returns {Map} Map of active timers\r\n   */\r\n  getTimers() {\r\n    return this.#timers;\r\n  }\r\n} ", "/**\r\n * DisplayManager - Manages conditional display of elements based on cart contents\r\n * \r\n * This class handles showing/hiding elements based on what's in the cart,\r\n * using data-os-in-cart attributes.\r\n */\r\n\r\nexport class DisplayManager {\r\n  #app;\r\n  #logger;\r\n  #displayElements = new Map();\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('DISPLAY');\r\n    this.#initDisplayElements();\r\n    \r\n    // Subscribe to cart updates to refresh display elements\r\n    this.#app.state.subscribe('cart', () => this.refreshDisplayElements());\r\n    \r\n    this.#logger.infoWithTime('DisplayManager initialized');\r\n  }\r\n\r\n  /**\r\n   * Initialize all display elements on the page\r\n   */\r\n  #initDisplayElements() {\r\n    this.#logger.infoWithTime('Initializing display elements');\r\n    \r\n    // Find all swap display containers\r\n    const swapContainers = document.querySelectorAll('[data-os-cart=\"swap-display\"]');\r\n    \r\n    if (swapContainers.length === 0) {\r\n      this.#logger.debugWithTime('No swap display containers found on page');\r\n      return;\r\n    }\r\n    \r\n    this.#logger.debugWithTime(`Found ${swapContainers.length} swap display containers`);\r\n    \r\n    // Process each container\r\n    swapContainers.forEach((container, index) => {\r\n      const containerId = container.dataset.osId || `auto-container-${index}`;\r\n      \r\n      // Find all display elements within this container\r\n      const displayElements = container.querySelectorAll('[data-os-in-cart=\"display\"]');\r\n      \r\n      if (displayElements.length === 0) {\r\n        this.#logger.warnWithTime(`Container ${containerId} has no display elements`);\r\n        return;\r\n      }\r\n      \r\n      // Store the container and its display elements\r\n      this.#displayElements.set(container, {\r\n        id: containerId,\r\n        elements: Array.from(displayElements).map(element => ({\r\n          element,\r\n          packageId: element.dataset.osPackage\r\n        }))\r\n      });\r\n      \r\n      this.#logger.debugWithTime(`Initialized container ${containerId} with ${displayElements.length} display elements`);\r\n    });\r\n    \r\n    // Initial update of all display elements\r\n    this.refreshDisplayElements();\r\n  }\r\n\r\n  /**\r\n   * Refresh all display elements based on current cart contents\r\n   */\r\n  refreshDisplayElements() {\r\n    this.#logger.debugWithTime('Refreshing display elements');\r\n    \r\n    // Get current cart items\r\n    const cart = this.#app.state.getState('cart');\r\n    const cartItemIds = cart.items.map(item => item.id.toString());\r\n    \r\n    // Update each container\r\n    this.#displayElements.forEach((containerData, container) => {\r\n      this.#updateContainerDisplay(container, containerData, cartItemIds);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update the display of elements within a container based on cart contents\r\n   * @param {HTMLElement} container - The container element\r\n   * @param {Object} containerData - Data about the container and its elements\r\n   * @param {Array<string>} cartItemIds - IDs of items currently in the cart\r\n   */\r\n  #updateContainerDisplay(container, containerData, cartItemIds) {\r\n    const { id, elements } = containerData;\r\n    let hasVisibleElement = false;\r\n    \r\n    // First pass: check if any element should be visible\r\n    for (const { element, packageId } of elements) {\r\n      if (packageId && cartItemIds.includes(packageId)) {\r\n        // Show this element\r\n        element.style.display = 'block';\r\n        hasVisibleElement = true;\r\n        this.#logger.debugWithTime(`Showing element for package ${packageId} in container ${id}`);\r\n      } else {\r\n        // Hide this element\r\n        element.style.display = 'none';\r\n      }\r\n    }\r\n    \r\n    // If no elements are visible, show the first one as fallback (optional)\r\n    if (!hasVisibleElement && elements.length > 0) {\r\n      // Option 1: Show nothing (current behavior)\r\n      // Option 2: Show the first element as fallback\r\n      // elements[0].element.style.display = 'block';\r\n      // this.#logger.debugWithTime(`No matching packages in cart, showing first element as fallback in container ${id}`);\r\n    }\r\n    \r\n    // Trigger a custom event\r\n    this.#triggerDisplayEvent('updated', container, {\r\n      containerId: id,\r\n      hasVisibleElement,\r\n      visiblePackageIds: elements\r\n        .filter(({ element }) => element.style.display === 'block')\r\n        .map(({ packageId }) => packageId)\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Trigger a display event\r\n   * @param {string} eventName - Name of the event\r\n   * @param {HTMLElement} element - Element that triggered the event\r\n   * @param {Object} detail - Event details\r\n   */\r\n  #triggerDisplayEvent(eventName, element, detail = {}) {\r\n    const event = new CustomEvent(`os:display.${eventName}`, {\r\n      bubbles: true,\r\n      cancelable: true,\r\n      detail: { ...detail, manager: this }\r\n    });\r\n    \r\n    element.dispatchEvent(event);\r\n    document.dispatchEvent(event);\r\n    this.#logger.debugWithTime(`Display event triggered: ${eventName}`);\r\n  }\r\n\r\n  /**\r\n   * Manually refresh display elements\r\n   * This can be called after dynamic content is loaded\r\n   */\r\n  refresh() {\r\n    this.#logger.infoWithTime('Manually refreshing display elements');\r\n    this.#displayElements.clear();\r\n    this.#initDisplayElements();\r\n  }\r\n} ", "/**\r\n * CartDisplayManager - Manages cart display in the checkout page\r\n * \r\n * This class handles updating the cart summary display based on cart contents,\r\n * including line items, totals, savings, and shipping information.\r\n */\r\n\r\nexport class CartDisplayManager {\r\n  #app;\r\n  #logger;\r\n  #elements = {\r\n    lineDisplays: [], // Changed to array to support multiple displays\r\n    summaryContainers: [], // Changed to array to support multiple containers\r\n    savingsBars: [], // Changed to array\r\n    shippingBars: [], // Changed to array\r\n    grandTotals: [], // Changed to array\r\n    subtotals: [], // Added for subtotal elements\r\n    // Summary toggle elements\r\n    summaryBars: [], // Changed to array\r\n    summaryPanels: [], // Changed to array\r\n    summaryTexts: [], // Changed to array\r\n    summaryIcons: [], // Changed to array\r\n    // Compare total elements\r\n    compareTotalElements: []\r\n  };\r\n  #config = {\r\n    currencySymbol: '$',\r\n    showComparePricing: true,\r\n    showProductImages: true,\r\n    showTaxPendingMessage: true\r\n  };\r\n  #lineItemTemplate = null;\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('CART_DISPLAY');\r\n    this.#initCartDisplay();\r\n    \r\n    // Subscribe to cart updates\r\n    this.#app.state.subscribe('cart', () => this.updateCartDisplay());\r\n    \r\n    this.#logger.infoWithTime('CartDisplayManager initialized');\r\n  }\r\n\r\n  /**\r\n   * Initialize the cart display elements\r\n   */\r\n  #initCartDisplay() {\r\n    this.#logger.infoWithTime('Initializing cart display');\r\n    \r\n    // Find all cart display elements using querySelectorAll for everything\r\n    this.#elements.lineDisplays = document.querySelectorAll('[data-os-cart-summary=\"line-display\"]');\r\n    this.#elements.summaryContainers = document.querySelectorAll('[data-os-cart=\"summary\"]');\r\n    this.#elements.savingsBars = document.querySelectorAll('[data-os-cart-summary=\"savings\"]');\r\n    this.#elements.shippingBars = document.querySelectorAll('[data-os-cart-summary=\"shipping-bar\"]');\r\n    this.#elements.grandTotals = document.querySelectorAll('[data-os-cart-summary=\"grand-total\"]');\r\n    this.#elements.subtotals = document.querySelectorAll('[data-os-cart-summary=\"subtotal\"]');\r\n    \r\n    // Find all summary toggle elements\r\n    this.#elements.summaryBars = document.querySelectorAll('[os-checkout-element=\"summary-bar\"]');\r\n    this.#elements.summaryPanels = document.querySelectorAll('[os-checkout-element=\"summary-mobile\"]');\r\n    this.#elements.summaryTexts = document.querySelectorAll('[os-checkout-element=\"summary-text\"]');\r\n    this.#elements.summaryIcons = document.querySelectorAll('[os-summary-icon]');\r\n    \r\n    // Find all compare-total elements across all containers\r\n    this.#elements.compareTotalElements = document.querySelectorAll('[data-os-cart-summary=\"compare-total\"]');\r\n    \r\n    // Log what elements were found for debugging\r\n    this.#logger.debugWithTime(`Line displays found: ${this.#elements.lineDisplays.length}`);\r\n    this.#logger.debugWithTime(`Summary containers found: ${this.#elements.summaryContainers.length}`);\r\n    this.#logger.debugWithTime(`Savings bars found: ${this.#elements.savingsBars.length}`);\r\n    this.#logger.debugWithTime(`Shipping bars found: ${this.#elements.shippingBars.length}`);\r\n    this.#logger.debugWithTime(`Grand total elements found: ${this.#elements.grandTotals.length}`);\r\n    this.#logger.debugWithTime(`Subtotal elements found: ${this.#elements.subtotals.length}`);\r\n    this.#logger.debugWithTime(`Summary bars found: ${this.#elements.summaryBars.length}`);\r\n    this.#logger.debugWithTime(`Summary panels found: ${this.#elements.summaryPanels.length}`);\r\n    this.#logger.debugWithTime(`Summary texts found: ${this.#elements.summaryTexts.length}`);\r\n    this.#logger.debugWithTime(`Summary icons found: ${this.#elements.summaryIcons.length}`);\r\n    this.#logger.debugWithTime(`Compare total elements found: ${this.#elements.compareTotalElements.length}`);\r\n    \r\n    // Get configuration from attributes if available\r\n    // Use the first summary container for configuration, but apply to all\r\n    if (this.#elements.summaryContainers.length > 0) {\r\n      const firstContainer = this.#elements.summaryContainers[0];\r\n      this.#config.showComparePricing = firstContainer.dataset.showComparePricing !== 'false';\r\n      this.#config.showProductImages = firstContainer.dataset.showProductImages !== 'false';\r\n      this.#config.showTaxPendingMessage = firstContainer.dataset.showTaxPendingMessage !== 'false';\r\n      this.#config.currencySymbol = firstContainer.dataset.currencySymbol || '$';\r\n    }\r\n    \r\n    // Store a template of the line item if available\r\n    const existingLineItem = document.querySelector('[data-os-cart-summary=\"line-item\"]');\r\n    if (existingLineItem) {\r\n      this.#lineItemTemplate = existingLineItem.cloneNode(true);\r\n    }\r\n    \r\n    // Initialize summary toggle functionality\r\n    this.#initSummaryToggle();\r\n    \r\n    this.#logger.debugWithTime('Cart display elements initialized');\r\n    \r\n    // Initial update\r\n    this.updateCartDisplay();\r\n  }\r\n\r\n  /**\r\n   * Initialize the summary toggle functionality\r\n   */\r\n  #initSummaryToggle() {\r\n    const { summaryBars, summaryPanels, summaryTexts, summaryIcons } = this.#elements;\r\n    \r\n    if (!summaryBars.length || !summaryPanels.length) {\r\n      this.#logger.debugWithTime('Summary toggle elements not found, skipping initialization');\r\n      return;\r\n    }\r\n    \r\n    this.#logger.debugWithTime('Initializing summary toggle');\r\n    \r\n    // Initialize each summary panel\r\n    summaryPanels.forEach((panel, index) => {\r\n      // Add a class to prevent transitions during initialization\r\n      panel.classList.add('no-transition');\r\n      \r\n      // Set initial styles if not already expanded\r\n      if (!panel.classList.contains('cc-expanded')) {\r\n        panel.style.height = '0';\r\n        panel.style.opacity = '0';\r\n        panel.style.overflow = 'hidden';\r\n        \r\n        // Set initial text content for corresponding text element\r\n        const textElement = summaryTexts[index];\r\n        if (textElement) {\r\n          textElement.textContent = 'Show Order Summary';\r\n        }\r\n      }\r\n      \r\n      // Force reflow and remove no-transition class\r\n      requestAnimationFrame(() => {\r\n        panel.classList.remove('no-transition');\r\n        panel.style.transition = 'height 0.3s ease-out, opacity 0.25s ease-out';\r\n      });\r\n    });\r\n    \r\n    // Add click event listener to each summary bar\r\n    summaryBars.forEach((bar, index) => {\r\n      bar.addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        this.#toggleSummary(index);\r\n      });\r\n    });\r\n    \r\n    // Add resize listener to handle window size changes\r\n    window.addEventListener('resize', this.#debounce(() => {\r\n      summaryPanels.forEach(panel => {\r\n        if (panel.classList.contains('cc-expanded')) {\r\n          panel.style.height = 'auto';\r\n        }\r\n      });\r\n    }, 250));\r\n    \r\n    this.#logger.debugWithTime('Summary toggle initialized');\r\n  }\r\n\r\n  /**\r\n   * Toggle the summary panel between expanded and collapsed states\r\n   * @param {number} index - Index of the summary panel to toggle\r\n   */\r\n  #toggleSummary(index = 0) {\r\n    const { summaryPanels, summaryTexts, summaryIcons } = this.#elements;\r\n    \r\n    const panel = summaryPanels[index];\r\n    const text = summaryTexts[index];\r\n    const icon = summaryIcons[index];\r\n    \r\n    if (!panel) return;\r\n    \r\n    const isExpanded = panel.classList.contains('cc-expanded');\r\n    \r\n    if (!isExpanded) {\r\n      // Expanding\r\n      panel.classList.add('cc-expanded');\r\n      panel.style.height = `${panel.scrollHeight}px`;\r\n      panel.style.opacity = '1';\r\n      \r\n      if (text) {\r\n        text.textContent = 'Hide Order Summary';\r\n      }\r\n      \r\n      if (icon) {\r\n        icon.style.transform = 'rotate(180deg)';\r\n      }\r\n      \r\n      panel.addEventListener('transitionend', () => {\r\n        if (panel.classList.contains('cc-expanded')) {\r\n          panel.style.height = 'auto';\r\n        }\r\n      }, { once: true });\r\n      \r\n      this.#logger.debugWithTime('Summary panel expanded');\r\n    } else {\r\n      // Collapsing\r\n      const currentHeight = panel.scrollHeight;\r\n      panel.style.height = `${currentHeight}px`;\r\n      panel.offsetHeight; // Force reflow\r\n      \r\n      panel.style.height = '0';\r\n      panel.style.opacity = '0';\r\n      \r\n      if (text) {\r\n        text.textContent = 'Show Order Summary';\r\n      }\r\n      \r\n      if (icon) {\r\n        icon.style.transform = 'rotate(0deg)';\r\n      }\r\n      \r\n      panel.addEventListener('transitionend', () => {\r\n        if (panel.style.height === '0px') {\r\n          panel.classList.remove('cc-expanded');\r\n        }\r\n      }, { once: true });\r\n      \r\n      this.#logger.debugWithTime('Summary panel collapsed');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the cart display with current cart data\r\n   */\r\n  updateCartDisplay() {\r\n    this.#logger.debugWithTime('Updating cart display');\r\n    \r\n    const cart = this.#app.state.getState('cart');\r\n    if (!cart) {\r\n      this.#logger.warnWithTime('Cart data not available');\r\n      return;\r\n    }\r\n    \r\n    this.#logger.debugWithTime(`Cart data: ${JSON.stringify(cart)}`);\r\n    \r\n    // Update line items\r\n    this.#updateLineItems(cart.items);\r\n    \r\n    // Update summary\r\n    this.#updateSummary(cart.totals);\r\n    \r\n    // Update shipping\r\n    this.#updateShipping(cart.totals.shipping, cart.shippingMethod);\r\n    \r\n    // Update savings\r\n    this.#updateSavings(cart.totals);\r\n    \r\n    // Update grand total\r\n    this.#updateGrandTotal(cart.totals.total);\r\n    \r\n    // Update compare total elements\r\n    this.#updateCompareTotals(cart.totals);\r\n    \r\n    this.#logger.debugWithTime('Cart display updated');\r\n  }\r\n\r\n  /**\r\n   * Update the line items display\r\n   * @param {Array} items - Cart items\r\n   */\r\n  #updateLineItems(items) {\r\n    if (!this.#elements.lineDisplays.length || !this.#lineItemTemplate) {\r\n      this.#logger.warnWithTime('Line displays or template not found');\r\n      return;\r\n    }\r\n    \r\n    if (!items || items.length === 0) {\r\n      this.#logger.debugWithTime('No items in cart');\r\n      return;\r\n    }\r\n    \r\n    // Update each line display container\r\n    this.#elements.lineDisplays.forEach(lineDisplay => {\r\n      // Clear existing line items\r\n      lineDisplay.innerHTML = '';\r\n      \r\n      // Add each item to the display\r\n      items.forEach(item => {\r\n        const lineItemElement = this.#createLineItemElement(item);\r\n        lineDisplay.appendChild(lineItemElement);\r\n      });\r\n    });\r\n    \r\n    // Check if we need to show the scroll indicator\r\n    const scrollIndicators = document.querySelectorAll('[data-os-cart-summary=\"summary-scroll\"]');\r\n    if (scrollIndicators.length) {\r\n      const shouldShowScroll = items.length > 2;\r\n      scrollIndicators.forEach(indicator => {\r\n        indicator.classList.toggle('hide', !shouldShowScroll);\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create a line item element\r\n   * @param {Object} item - Cart item\r\n   * @returns {HTMLElement} Line item element\r\n   */\r\n  #createLineItemElement(item) {\r\n    const lineItem = this.#lineItemTemplate.cloneNode(true);\r\n    \r\n    // Set item title\r\n    const titleElement = lineItem.querySelector('[data-os-cart-summary=\"line-title\"]');\r\n    if (titleElement) {\r\n      titleElement.textContent = item.name;\r\n    }\r\n    \r\n    // Set item image if available\r\n    if (this.#config.showProductImages) {\r\n      const imageElement = lineItem.querySelector('[data-os-cart-summary=\"line-image\"]');\r\n      if (imageElement && item.image) {\r\n        imageElement.src = item.image;\r\n        imageElement.alt = item.name;\r\n      }\r\n    }\r\n    \r\n    // Set item quantity\r\n    const qtyElement = lineItem.querySelector('[os-cart=\"line_item-qty\"]');\r\n    if (qtyElement) {\r\n      qtyElement.textContent = item.quantity || 1;\r\n    }\r\n    \r\n    // Set item prices\r\n    const comparePrice = lineItem.querySelector('[data-os-cart-summary=\"line-compare\"]');\r\n    const salePrice = lineItem.querySelector('[data-os-cart-summary=\"line-sale\"]');\r\n    \r\n    if (comparePrice && item.retail_price && this.#config.showComparePricing) {\r\n      comparePrice.textContent = this.#formatPrice(item.retail_price * (item.quantity || 1));\r\n      comparePrice.classList.remove('hide');\r\n    } else if (comparePrice) {\r\n      comparePrice.classList.add('hide');\r\n    }\r\n    \r\n    if (salePrice) {\r\n      salePrice.textContent = this.#formatPrice(item.price * (item.quantity || 1));\r\n    }\r\n    \r\n    // Set savings percentage\r\n    const savingsPercentElement = lineItem.querySelector('[data-os-cart-summary=\"line-saving-percent\"]');\r\n    if (savingsPercentElement && item.retail_price) {\r\n      const savingsPercent = Math.round((1 - (item.price / item.retail_price)) * 100);\r\n      if (savingsPercent > 0) {\r\n        const format = savingsPercentElement.dataset.osFormat || 'default';\r\n        let savingsText = `${savingsPercent}% OFF`;\r\n        \r\n        if (format === 'parenthesis') {\r\n          savingsText = `(${savingsPercent}% OFF)`;\r\n        }\r\n        \r\n        savingsPercentElement.textContent = savingsText;\r\n        savingsPercentElement.classList.remove('hide');\r\n      } else {\r\n        savingsPercentElement.classList.add('hide');\r\n      }\r\n    } else if (savingsPercentElement) {\r\n      savingsPercentElement.classList.add('hide');\r\n    }\r\n    \r\n    return lineItem;\r\n  }\r\n\r\n  /**\r\n   * Update the summary section\r\n   * @param {Object} totals - Cart totals\r\n   */\r\n  #updateSummary(totals) {\r\n    if (!totals) return;\r\n    \r\n    // Update subtotal elements\r\n    if (this.#elements.subtotals.length) {\r\n      this.#elements.subtotals.forEach(element => {\r\n        element.textContent = this.#formatPrice(totals.subtotal);\r\n      });\r\n      this.#logger.debugWithTime(`Updated subtotal to: ${this.#formatPrice(totals.subtotal)}`);\r\n    }\r\n    \r\n    // Update other summary elements if needed\r\n    // This would depend on your specific HTML structure\r\n  }\r\n\r\n  /**\r\n   * Update the shipping information\r\n   * @param {number} shippingCost - Shipping cost\r\n   * @param {Object} shippingMethod - Selected shipping method\r\n   */\r\n  #updateShipping(shippingCost, shippingMethod) {\r\n    if (!this.#elements.shippingBars.length) {\r\n      this.#logger.warnWithTime('Shipping bars not found');\r\n      return;\r\n    }\r\n    \r\n    // Update all shipping bars\r\n    this.#elements.shippingBars.forEach(shippingBar => {\r\n      const shippingCompare = shippingBar.querySelector('[data-os-cart-summary=\"shipping-compare\"]');\r\n      const shippingCurrent = shippingBar.querySelector('[data-os-cart-summary=\"shipping-current\"]');\r\n      \r\n      if (shippingCompare && shippingCurrent) {\r\n        // If shipping is free but there was a standard shipping cost\r\n        if (shippingCost === 0 && shippingMethod?.standard_cost > 0) {\r\n          shippingCompare.textContent = this.#formatPrice(shippingMethod.standard_cost);\r\n          shippingCurrent.textContent = 'FREE';\r\n          shippingCompare.classList.remove('hide');\r\n        } \r\n        // If shipping has a cost\r\n        else if (shippingCost > 0) {\r\n          shippingCurrent.textContent = this.#formatPrice(shippingCost);\r\n          shippingCompare.classList.add('hide');\r\n        } \r\n        // If shipping is just free\r\n        else {\r\n          shippingCurrent.textContent = 'FREE';\r\n          shippingCompare.classList.add('hide');\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update the savings information\r\n   * @param {Object} totals - Cart totals\r\n   */\r\n  #updateSavings(totals) {\r\n    if (!this.#elements.savingsBars.length) {\r\n      this.#logger.warnWithTime('Savings bars not found');\r\n      return;\r\n    }\r\n    \r\n    // Update all savings bars\r\n    this.#elements.savingsBars.forEach(savingsBar => {\r\n      // Find elements within this specific savings bar\r\n      const savingsAmount = savingsBar.querySelector('[data-os-cart-summary=\"savings-amount\"]');\r\n      const savingsPercentage = savingsBar.querySelector('[data-os-cart-summary=\"savings-percentage\"]');\r\n      \r\n      if (totals.savings > 0 && totals.savings_percentage > 0) {\r\n        if (savingsAmount) {\r\n          savingsAmount.textContent = this.#formatPrice(totals.savings);\r\n          this.#logger.debugWithTime(`Updated savings amount to: ${this.#formatPrice(totals.savings)}`);\r\n        }\r\n        \r\n        if (savingsPercentage) {\r\n          savingsPercentage.textContent = `${Math.round(totals.savings_percentage)}% OFF`;\r\n          this.#logger.debugWithTime(`Updated savings percentage to: ${Math.round(totals.savings_percentage)}% OFF`);\r\n        }\r\n        \r\n        savingsBar.classList.remove('hide');\r\n      } else {\r\n        savingsBar.classList.add('hide');\r\n      }\r\n    });\r\n    \r\n    // Also update any standalone savings elements that might be outside the savings bars\r\n    const allSavingsAmounts = document.querySelectorAll('[data-os-cart-summary=\"savings-amount\"]');\r\n    const allSavingsPercentages = document.querySelectorAll('[data-os-cart-summary=\"savings-percentage\"]');\r\n    \r\n    if (totals.savings > 0 && totals.savings_percentage > 0) {\r\n      allSavingsAmounts.forEach(element => {\r\n        element.textContent = this.#formatPrice(totals.savings);\r\n      });\r\n      \r\n      allSavingsPercentages.forEach(element => {\r\n        element.textContent = `${Math.round(totals.savings_percentage)}% OFF`;\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update the grand total\r\n   * @param {number} total - Cart total\r\n   */\r\n  #updateGrandTotal(total) {\r\n    if (!this.#elements.grandTotals.length) {\r\n      this.#logger.warnWithTime('Grand total elements not found');\r\n      return;\r\n    }\r\n    \r\n    // Update all grand total elements\r\n    this.#elements.grandTotals.forEach(element => {\r\n      element.textContent = this.#formatPrice(total);\r\n    });\r\n    \r\n    this.#logger.debugWithTime(`Updated grand total to: ${this.#formatPrice(total)}`);\r\n  }\r\n\r\n  /**\r\n   * Format a price with currency symbol\r\n   * @param {number} price - Price to format\r\n   * @returns {string} Formatted price\r\n   */\r\n  #formatPrice(price) {\r\n    // Use the campaign's formatPrice method if available\r\n    if (this.#app.campaign?.formatPrice) {\r\n      return this.#app.campaign.formatPrice(price);\r\n    }\r\n    \r\n    // Otherwise, use a simple formatter\r\n    return `${this.#config.currencySymbol}${price.toFixed(2)} USD`;\r\n  }\r\n\r\n  /**\r\n   * Simple debounce function for resize events\r\n   * @param {Function} func - Function to debounce\r\n   * @param {number} wait - Wait time in milliseconds\r\n   * @returns {Function} Debounced function\r\n   */\r\n  #debounce(func, wait) {\r\n    let timeout;\r\n    return function executedFunction(...args) {\r\n      const later = () => {\r\n        clearTimeout(timeout);\r\n        func(...args);\r\n      };\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(later, wait);\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Update the compare total elements\r\n   * @param {Object} totals - Cart totals\r\n   */\r\n  #updateCompareTotals(totals) {\r\n    if (!this.#elements.compareTotalElements.length) {\r\n      this.#logger.debugWithTime('No compare-total elements found');\r\n      return;\r\n    }\r\n    \r\n    this.#logger.debugWithTime('Updating compare-total elements');\r\n    this.#logger.debugWithTime(`Cart totals: ${JSON.stringify(totals)}`);\r\n    \r\n    this.#elements.compareTotalElements.forEach(element => {\r\n      // Get the data attribute that specifies which total to use\r\n      const totalType = element.dataset.totalType || 'retail';\r\n      let compareValue = null;\r\n      \r\n      // Determine which value to use based on the totalType\r\n      switch (totalType) {\r\n        case 'retail':\r\n          compareValue = totals.retail_subtotal;\r\n          break;\r\n        case 'recurring':\r\n          compareValue = totals.recurring_total;\r\n          break;\r\n        // Keep these as fallbacks in case they're added in the future\r\n        case 'subtotal_compare':\r\n        case 'original':\r\n        case 'msrp':\r\n          compareValue = totals[totalType] || null;\r\n          break;\r\n        default:\r\n          compareValue = totals.retail_subtotal;\r\n      }\r\n      \r\n      // If we have a valid compare value and it's different from the current total\r\n      if (compareValue && compareValue > totals.total) {\r\n        element.textContent = this.#formatPrice(compareValue);\r\n        element.classList.remove('hide');\r\n        this.#logger.debugWithTime(`Updated compare-total (${totalType}) to: ${this.#formatPrice(compareValue)}`);\r\n      } else {\r\n        // Hide the element if there's no compare value or it's not greater than the current total\r\n        element.classList.add('hide');\r\n        this.#logger.debugWithTime(`Hiding compare-total element (${totalType}): compareValue=${compareValue}, total=${totals.total}`);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Find all elements with a specific data attribute across all summary containers\r\n   * @param {string} attribute - The data attribute to search for\r\n   * @returns {NodeList} - All matching elements\r\n   */\r\n  #findAllSummaryElements(attribute) {\r\n    return document.querySelectorAll(`[${attribute}]`);\r\n  }\r\n\r\n  /**\r\n   * Refresh the cart display and re-find all elements\r\n   * This can be called after dynamic content is loaded or when the viewport changes\r\n   */\r\n  refresh() {\r\n    this.#logger.infoWithTime('Manually refreshing cart display');\r\n    this.#initCartDisplay();\r\n  }\r\n} ", "/**\r\n * AttributionManager - Manages attribution data for analytics and tracking\r\n * \r\n * This class is responsible for collecting, storing, and retrieving attribution data\r\n * from various sources (URL parameters, cookies, localStorage, etc.) and making it\r\n * available to the application through the state manager.\r\n */\r\n\r\nexport class AttributionManager {\r\n  #app;\r\n  #logger;\r\n  #attributionData = {};\r\n  #initialized = false;\r\n\r\n  /**\r\n   * Initialize the AttributionManager\r\n   * @param {Object} app - The main application instance\r\n   */\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('ATTRIBUTION');\r\n    this.#init();\r\n  }\r\n\r\n  /**\r\n   * Initialize the AttributionManager\r\n   */\r\n  #init() {\r\n    this.#logger.info('Initializing AttributionManager');\r\n    this.#collectAttributionData();\r\n    this.#storeAttributionData();\r\n    this.#setupEventListeners();\r\n    this.#initialized = true;\r\n    this.#logger.info('AttributionManager initialized successfully');\r\n  }\r\n\r\n  /**\r\n   * Collect attribution data from various sources\r\n   */\r\n  #collectAttributionData() {\r\n    // Build metadata object for additional tracking data\r\n    const metadata = {\r\n      landing_page: window.location.href || '',\r\n      referrer: document.referrer || '',\r\n      device: navigator.userAgent || '',\r\n      device_type: this.#getDeviceType(),\r\n      timestamp: Date.now(),\r\n      domain: window.location.hostname,\r\n      \r\n      // Facebook tracking data\r\n      fb_fbp: this.#getCookie('_fbp') || '',\r\n      fb_fbc: this.#getCookie('_fbc') || '',\r\n      fb_pixel_id: this.#getFacebookPixelId()\r\n    };\r\n    \r\n    // Add fbclid to metadata if it exists\r\n    const fbclid = this.#getStoredValue('fbclid') || '';\r\n    if (fbclid) {\r\n      metadata.fbclid = fbclid;\r\n    }\r\n    \r\n    // Handle Everflow click ID (evclid)\r\n    this.#handleEverflowClickId(metadata);\r\n    \r\n    // Collect all meta tracking tags and add them to metadata\r\n    this.#collectTrackingTags(metadata);\r\n\r\n    // Get the affiliate value from affid or aff parameters\r\n    const affiliate = this.#getStoredValue('affid') || this.#getStoredValue('aff') || '';\r\n\r\n    // Collect UTM parameters and other tracking data\r\n    this.#attributionData = {\r\n      // Attribution API compatible fields\r\n      affiliate: affiliate,\r\n      funnel: '', // Will be set later when campaign data is available\r\n      gclid: this.#getStoredValue('gclid') || '',\r\n      metadata: metadata,\r\n      \r\n      // Standard UTM parameters\r\n      utm_source: this.#getStoredValue('utm_source') || '',\r\n      utm_medium: this.#getStoredValue('utm_medium') || '',\r\n      utm_campaign: this.#getStoredValue('utm_campaign') || '',\r\n      utm_content: this.#getStoredValue('utm_content') || '',\r\n      utm_term: this.#getStoredValue('utm_term') || '',\r\n      \r\n      // Other tracking parameters\r\n      fbclid: fbclid,\r\n      \r\n      // Sub-affiliate parameters\r\n      subaffiliate1: this.#getStoredValue('subaffiliate1') || this.#getStoredValue('sub1') || '',\r\n      subaffiliate2: this.#getStoredValue('subaffiliate2') || this.#getStoredValue('sub2') || '',\r\n      subaffiliate3: this.#getStoredValue('subaffiliate3') || this.#getStoredValue('sub3') || '',\r\n      subaffiliate4: this.#getStoredValue('subaffiliate4') || this.#getStoredValue('sub4') || '',\r\n      subaffiliate5: this.#getStoredValue('subaffiliate5') || this.#getStoredValue('sub5') || '',\r\n      \r\n      // Time data\r\n      first_visit_timestamp: this.#getFirstVisitTimestamp(),\r\n      current_visit_timestamp: Date.now()\r\n    };\r\n\r\n    this.#logger.debug('Attribution data collected');\r\n  }\r\n\r\n  /**\r\n   * Handle Everflow click ID tracking\r\n   * @param {Object} metadata - The metadata object to update\r\n   */\r\n  #handleEverflowClickId(metadata) {\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    let evclid = localStorage.getItem(\"evclid\");\r\n    \r\n    // Check URL parameters first\r\n    if (urlParams.has(\"evclid\")) {\r\n      evclid = urlParams.get(\"evclid\");\r\n      localStorage.setItem(\"evclid\", evclid);\r\n      sessionStorage.setItem(\"evclid\", evclid);\r\n      this.#logger.debug(`Everflow click ID found in URL: ${evclid}`);\r\n    } \r\n    // Try sessionStorage as fallback\r\n    else if (!evclid && sessionStorage.getItem(\"evclid\")) {\r\n      evclid = sessionStorage.getItem(\"evclid\");\r\n      localStorage.setItem(\"evclid\", evclid);\r\n      this.#logger.debug(`Everflow click ID found in sessionStorage: ${evclid}`);\r\n    }\r\n    \r\n    // Handle sg_evclid separately\r\n    if (urlParams.has(\"sg_evclid\")) {\r\n      const sg_evclid = urlParams.get(\"sg_evclid\");\r\n      sessionStorage.setItem(\"sg_evclid\", sg_evclid);\r\n      localStorage.setItem(\"sg_evclid\", sg_evclid);\r\n      metadata.sg_evclid = sg_evclid;\r\n      this.#logger.debug(`SG Everflow click ID found: ${sg_evclid}`);\r\n    } else if (localStorage.getItem(\"sg_evclid\")) {\r\n      metadata.sg_evclid = localStorage.getItem(\"sg_evclid\");\r\n    }\r\n    \r\n    // Set the transaction ID in metadata if we have it\r\n    if (evclid) {\r\n      metadata.everflow_transaction_id = evclid;\r\n      this.#logger.debug(`Added Everflow transaction ID to metadata: ${evclid}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Collect all meta tracking tags and add them to metadata object\r\n   * @param {Object} metadata - The metadata object to update\r\n   */\r\n  #collectTrackingTags(metadata) {\r\n    const trackingTags = document.querySelectorAll('meta[name=\"os-tracking-tag\"]');\r\n    this.#logger.debug(`Found ${trackingTags.length} tracking tags`);\r\n    \r\n    trackingTags.forEach(tag => {\r\n      const tagName = tag.getAttribute('data-tag-name');\r\n      const tagValue = tag.getAttribute('data-tag-value');\r\n      const shouldPersist = tag.getAttribute('data-persist') === 'true';\r\n      \r\n      if (tagName && tagValue) {\r\n        metadata[tagName] = tagValue;\r\n        this.#logger.debug(`Added tracking tag: ${tagName} = ${tagValue}`);\r\n        \r\n        // Store in sessionStorage if it should persist\r\n        if (shouldPersist) {\r\n          try {\r\n            sessionStorage.setItem(`os_tag_${tagName}`, tagValue);\r\n            this.#logger.debug(`Persisted tracking tag: ${tagName} = ${tagValue}`);\r\n          } catch (error) {\r\n            this.#logger.error(`Error persisting tracking tag ${tagName}:`, error);\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Store attribution data in the state\r\n   */\r\n  #storeAttributionData() {\r\n    if (!this.#app.state) {\r\n      this.#logger.warn('State manager not available, attribution data will not be stored');\r\n      return;\r\n    }\r\n\r\n    // Store the complete attribution data in the cart attribution\r\n    this.#app.state.setState('cart.attribution', this.#attributionData);\r\n    \r\n    // Also store specific API-compatible attribution object for checkout\r\n    this.#app.state.setState('attribution', this.getAttributionForApi());\r\n    \r\n    // Store in localStorage for persistence across sessions\r\n    this.#persistAttributionData();\r\n    \r\n    // Trigger attribution updated event\r\n    if (this.#app.events) {\r\n      this.#app.events.trigger('attribution.updated', {\r\n        attribution: this.#attributionData\r\n      });\r\n    }\r\n    \r\n    this.#logger.debug('Attribution data stored in state');\r\n  }\r\n\r\n  /**\r\n   * Persist attribution data to localStorage\r\n   */\r\n  #persistAttributionData() {\r\n    try {\r\n      localStorage.setItem('os_attribution', JSON.stringify(this.#attributionData));\r\n      this.#logger.debug('Attribution data persisted to localStorage');\r\n    } catch (error) {\r\n      this.#logger.error('Error persisting attribution data to localStorage:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Load persisted attribution data from localStorage\r\n   * @returns {Object} The loaded attribution data\r\n   */\r\n  #loadPersistedAttributionData() {\r\n    try {\r\n      const persistedData = localStorage.getItem('os_attribution');\r\n      if (persistedData) {\r\n        return JSON.parse(persistedData);\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error loading attribution data from localStorage:', error);\r\n    }\r\n    return {};\r\n  }\r\n\r\n  /**\r\n   * Get the first visit timestamp\r\n   * @returns {number} The timestamp of the first visit\r\n   */\r\n  #getFirstVisitTimestamp() {\r\n    // Try to get from localStorage first\r\n    const persistedData = this.#loadPersistedAttributionData();\r\n    if (persistedData.first_visit_timestamp) {\r\n      return persistedData.first_visit_timestamp;\r\n    }\r\n    \r\n    // Otherwise, use the current timestamp\r\n    return Date.now();\r\n  }\r\n\r\n  /**\r\n   * Set up event listeners for page navigation\r\n   */\r\n  #setupEventListeners() {\r\n    // Listen for page changes to update landing page\r\n    window.addEventListener('popstate', () => {\r\n      const metadata = this.#attributionData.metadata || {};\r\n      metadata.landing_page = window.location.href;\r\n      \r\n      this.updateAttributionData({\r\n        metadata: metadata\r\n      });\r\n    });\r\n    \r\n    // Listen for campaign data loading\r\n    if (this.#app.events) {\r\n      this.#app.events.on('campaign.loaded', (data) => {\r\n        if (data && data.campaign && data.campaign.name && !this.#attributionData.funnel) {\r\n          // Set funnel name if not already set\r\n          // Check for meta tag first\r\n          const funnelMetaTag = document.querySelector('meta[name=\"os-tracking-tag\"][data-tag-name=\"funnel_name\"]');\r\n          const funnelName = funnelMetaTag?.getAttribute('data-tag-value') || data.campaign.name;\r\n          \r\n          // Set the funnel name\r\n          this.setFunnelName(funnelName);\r\n        }\r\n      });\r\n      \r\n      // Listen for cart creation events\r\n      this.#app.events.on('prospect.cartCreated', () => {\r\n        const metadata = this.#attributionData.metadata || {};\r\n        metadata.conversion_timestamp = Date.now();\r\n        \r\n        this.updateAttributionData({\r\n          metadata: metadata\r\n        });\r\n        \r\n        this.#logger.debug('Cart created, updated metadata with conversion timestamp');\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update attribution data with new values\r\n   * @param {Object} newData - New attribution data to merge\r\n   */\r\n  updateAttributionData(newData) {\r\n    // Handle metadata updates specially to merge them instead of replacing\r\n    if (newData.metadata && this.#attributionData.metadata) {\r\n      newData.metadata = {\r\n        ...this.#attributionData.metadata,\r\n        ...newData.metadata\r\n      };\r\n    }\r\n    \r\n    // Special case for funnel - use the new value and log it\r\n    if (newData.funnel) {\r\n      this.#logger.debug(`Updating funnel value to: ${newData.funnel}`);\r\n    }\r\n    \r\n    this.#attributionData = {\r\n      ...this.#attributionData,\r\n      ...newData\r\n    };\r\n    \r\n    this.#storeAttributionData();\r\n    this.#logger.debug('Attribution data updated', newData);\r\n    \r\n    // Trigger event\r\n    if (this.#app.events) {\r\n      this.#app.events.trigger('attribution.updated', {\r\n        attribution: this.#attributionData\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get attribution data\r\n   * @returns {Object} The current attribution data\r\n   */\r\n  getAttributionData() {\r\n    return { ...this.#attributionData };\r\n  }\r\n  \r\n  /**\r\n   * Get attribution data formatted for API\r\n   * @returns {Object} Attribution data formatted for API\r\n   */\r\n  getAttributionForApi() {\r\n    // Get Everflow transaction ID from metadata\r\n    const everflowTransactionId = this.#attributionData.metadata?.everflow_transaction_id || '';\r\n    \r\n    return {\r\n      // Core attribution fields\r\n      affiliate: this.#attributionData.affiliate,\r\n      funnel: this.#attributionData.funnel,\r\n      gclid: this.#attributionData.gclid,\r\n      metadata: this.#attributionData.metadata,\r\n      \r\n      // Everflow transaction ID at root level\r\n      everflow_transaction_id: everflowTransactionId,\r\n      \r\n      // UTM parameters at root level as required by API\r\n      utm_source: this.#attributionData.utm_source,\r\n      utm_medium: this.#attributionData.utm_medium,\r\n      utm_campaign: this.#attributionData.utm_campaign,\r\n      utm_content: this.#attributionData.utm_content,\r\n      utm_term: this.#attributionData.utm_term,\r\n      \r\n      // Subaffiliate parameters at root level as required by API\r\n      subaffiliate1: this.#attributionData.subaffiliate1,\r\n      subaffiliate2: this.#attributionData.subaffiliate2,\r\n      subaffiliate3: this.#attributionData.subaffiliate3,\r\n      subaffiliate4: this.#attributionData.subaffiliate4,\r\n      subaffiliate5: this.#attributionData.subaffiliate5\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Debug method to log attribution data to console\r\n   * Useful for troubleshooting attribution issues\r\n   */\r\n  debug() {\r\n    console.group('AttributionManager Debug Info');\r\n    \r\n    // Check sources for funnel value\r\n    const funnelMetaTag = document.querySelector('meta[name=\"os-tracking-tag\"][data-tag-name=\"funnel_name\"]');\r\n    const funnelFromTag = funnelMetaTag ? funnelMetaTag.getAttribute('data-tag-value') : '';\r\n    const campaignName = this.#app.campaign?.getCampaignName() || this.#app.campaignData?.name || '';\r\n    \r\n    // Show key attribution values first for quick reference\r\n    console.log('Key Attribution Values:');\r\n    console.log('- Affiliate:', this.#attributionData.affiliate);\r\n    console.log('- Funnel:', this.#attributionData.funnel);\r\n    console.log('  • Funnel from meta tag:', funnelFromTag || '(not set)');\r\n    console.log('  • Campaign name:', campaignName || '(not set)');\r\n    console.log('  • Source used:', funnelFromTag ? 'meta tag' : (campaignName ? 'campaign name' : 'none'));\r\n    \r\n    // Everflow information\r\n    console.log('Everflow Information:');\r\n    console.log('- localStorage evclid:', localStorage.getItem('evclid') || '(not set)');\r\n    console.log('- sessionStorage evclid:', sessionStorage.getItem('evclid') || '(not set)');\r\n    console.log('- metadata.everflow_transaction_id:', this.#attributionData.metadata?.everflow_transaction_id || '(not set)');\r\n    console.log('- Is EF object available:', typeof window.EF !== 'undefined' ? 'Yes' : 'No');\r\n    \r\n    // API formatted data\r\n    console.group('API Formatted Attribution Data (What gets sent to API)');\r\n    const apiData = this.getAttributionForApi();\r\n    \r\n    // Core fields\r\n    console.log('Core Fields:');\r\n    console.log('- affiliate:', apiData.affiliate);\r\n    console.log('- funnel:', apiData.funnel);\r\n    console.log('- gclid:', apiData.gclid);\r\n    \r\n    // UTM parameters\r\n    console.log('UTM Parameters:');\r\n    console.log('- utm_source:', apiData.utm_source);\r\n    console.log('- utm_medium:', apiData.utm_medium);\r\n    console.log('- utm_campaign:', apiData.utm_campaign);\r\n    console.log('- utm_content:', apiData.utm_content);\r\n    console.log('- utm_term:', apiData.utm_term);\r\n    \r\n    // Subaffiliate parameters\r\n    console.log('Subaffiliate Parameters:');\r\n    console.log('- subaffiliate1:', apiData.subaffiliate1);\r\n    console.log('- subaffiliate2:', apiData.subaffiliate2);\r\n    console.log('- subaffiliate3:', apiData.subaffiliate3);\r\n    console.log('- subaffiliate4:', apiData.subaffiliate4);\r\n    console.log('- subaffiliate5:', apiData.subaffiliate5);\r\n    \r\n    // Metadata\r\n    console.group('Metadata Object:');\r\n    console.log('- Domain:', apiData.metadata.domain);\r\n    console.log('- Device (User Agent):', apiData.metadata.device);\r\n    console.log('- Device Type:', apiData.metadata.device_type);\r\n    \r\n    // Facebook data in metadata\r\n    console.log('- Facebook Data:');\r\n    console.log('  - fb_fbp:', apiData.metadata.fb_fbp);\r\n    console.log('  - fb_fbc:', apiData.metadata.fb_fbc);\r\n    console.log('  - fb_pixel_id:', apiData.metadata.fb_pixel_id);\r\n    \r\n    console.log('- Full Metadata:', apiData.metadata);\r\n    console.groupEnd();\r\n    \r\n    console.groupEnd();\r\n    \r\n    // Raw attribution data\r\n    console.log('Raw Attribution Data:', this.#attributionData);\r\n    console.log('URL Parameters:', new URLSearchParams(window.location.search).toString());\r\n    \r\n    // Display tracking tags\r\n    console.group('Tracking Tags');\r\n    const trackingTags = document.querySelectorAll('meta[name=\"os-tracking-tag\"]');\r\n    if (trackingTags.length > 0) {\r\n      trackingTags.forEach(tag => {\r\n        console.log(`${tag.getAttribute('data-tag-name')}: ${tag.getAttribute('data-tag-value')}${tag.getAttribute('data-persist') === 'true' ? ' (persisted)' : ''}`);\r\n      });\r\n    } else {\r\n      console.log('No tracking tags found');\r\n    }\r\n    console.groupEnd();\r\n    \r\n    // Check for the funnel meta tag\r\n    console.log('Funnel Meta Tag:', funnelMetaTag ? {\r\n      exists: true,\r\n      value: funnelMetaTag.getAttribute('data-tag-value')\r\n    } : {\r\n      exists: false\r\n    });\r\n    \r\n    // Campaign data\r\n    console.log('Campaign Name:', this.#app.campaignData?.name || 'Not available');\r\n    \r\n    // Check state data\r\n    if (this.#app.state) {\r\n      console.log('API-formatted State Attribution:', this.#app.state.getState('attribution'));\r\n    }\r\n    \r\n    console.groupEnd();\r\n    \r\n    return 'Attribution debug info logged to console.';\r\n  }\r\n\r\n  /**\r\n   * Get a value from URL parameters, sessionStorage, or localStorage\r\n   * @param {string} key - The key to get\r\n   * @returns {string} The value\r\n   */\r\n  #getStoredValue(key) {\r\n    // Try to get from URL parameters first (highest priority)\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    if (urlParams.has(key)) {\r\n      const value = urlParams.get(key);\r\n      \r\n      // Store in sessionStorage for persistence during the session\r\n      try {\r\n        sessionStorage.setItem(key, value);\r\n      } catch (error) {\r\n        this.#logger.error(`Error storing ${key} in sessionStorage:`, error);\r\n      }\r\n      \r\n      return value;\r\n    }\r\n    \r\n    // Try to get from sessionStorage (second priority)\r\n    try {\r\n      if (sessionStorage.getItem(key)) {\r\n        return sessionStorage.getItem(key);\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error(`Error reading ${key} from sessionStorage:`, error);\r\n    }\r\n    \r\n    // Try to get from localStorage (third priority)\r\n    try {\r\n      if (localStorage.getItem(key)) {\r\n        return localStorage.getItem(key);\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error(`Error reading ${key} from localStorage:`, error);\r\n    }\r\n    \r\n    // Try to get from persisted attribution data (lowest priority)\r\n    const persistedData = this.#loadPersistedAttributionData();\r\n    if (persistedData[key]) {\r\n      return persistedData[key];\r\n    }\r\n    \r\n    return '';\r\n  }\r\n\r\n  /**\r\n   * Get a cookie value\r\n   * @param {string} name - The cookie name\r\n   * @returns {string} The cookie value\r\n   */\r\n  #getCookie(name) {\r\n    const value = `; ${document.cookie}`;\r\n    const parts = value.split(`; ${name}=`);\r\n    if (parts.length === 2) return parts.pop().split(';').shift();\r\n    return '';\r\n  }\r\n\r\n  /**\r\n   * Get the device type based on user agent\r\n   * @returns {string} The device type\r\n   */\r\n  #getDeviceType() {\r\n    const userAgent = navigator.userAgent;\r\n    \r\n    if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent)) {\r\n      return 'mobile';\r\n    }\r\n    \r\n    return 'desktop';\r\n  }\r\n\r\n  /**\r\n   * Try to detect Facebook Pixel ID from the page\r\n   * @returns {string} The Facebook Pixel ID or empty string if not found\r\n   */\r\n  #getFacebookPixelId() {\r\n    // First check for dedicated os-facebook-pixel meta tag (highest priority)\r\n    const osFbPixelMeta = document.querySelector('meta[name=\"os-facebook-pixel\"]');\r\n    if (osFbPixelMeta) {\r\n      const pixelId = osFbPixelMeta.getAttribute('content');\r\n      if (pixelId) {\r\n        this.#logger.debug(`Facebook Pixel ID found from os-facebook-pixel meta tag: ${pixelId}`);\r\n        return pixelId;\r\n      }\r\n    }\r\n    \r\n    // Try to find FB Pixel ID from script tags\r\n    const scripts = document.querySelectorAll('script');\r\n    for (const script of scripts) {\r\n      const content = script.textContent || '';\r\n      if (content.includes('fbq(') && content.includes('init')) {\r\n        const match = content.match(/fbq\\s*\\(\\s*['\"]init['\"],\\s*['\"](\\d+)['\"]/);\r\n        if (match && match[1]) {\r\n          return match[1];\r\n        }\r\n      }\r\n    }\r\n    \r\n    return '';\r\n  }\r\n\r\n  /**\r\n   * Set the funnel name in attribution data\r\n   * Simple method to set the funnel name\r\n   * @param {string} funnelName - The funnel name to set\r\n   */\r\n  setFunnelName(funnelName) {\r\n    if (!funnelName) {\r\n      this.#logger.warn('Cannot set empty funnel name');\r\n      return false;\r\n    }\r\n\r\n    // Update the funnel field in attribution data\r\n    this.#attributionData.funnel = funnelName;\r\n    \r\n    // Store in state manager - this will handle syncing with session storage\r\n    this.#storeAttributionData();\r\n    \r\n    this.#logger.info(`Funnel name set to: ${funnelName}`);\r\n    \r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Set the Everflow click ID (evclid) in attribution data\r\n   * @param {string} clickId - The Everflow click ID to set\r\n   * @returns {boolean} True if the ID was set successfully\r\n   */\r\n  setEverflowClickId(clickId) {\r\n    if (!clickId) {\r\n      this.#logger.warn('Cannot set empty Everflow click ID');\r\n      return false;\r\n    }\r\n\r\n    // Store in local/session storage\r\n    localStorage.setItem(\"evclid\", clickId);\r\n    sessionStorage.setItem(\"evclid\", clickId);\r\n\r\n    // Update the metadata with the transaction ID\r\n    const metadata = this.#attributionData.metadata || {};\r\n    metadata.everflow_transaction_id = clickId;\r\n    \r\n    // Update attribution data\r\n    this.updateAttributionData({\r\n      metadata: metadata\r\n    });\r\n    \r\n    this.#logger.info(`Everflow click ID set to: ${clickId}`);\r\n    \r\n    return true;\r\n  }\r\n} ", "/**\r\n * EventManager - Manages platform-specific events\r\n * \r\n * This class provides a centralized system for firing events to different platforms\r\n * such as Google Tag Manager, Facebook Pixel, etc. It handles ecommerce events\r\n * like view_item_list, add_to_cart, purchase, etc.\r\n */\r\n\r\nexport class EventManager {\r\n  #app;\r\n  #logger;\r\n  #isInitialized = false;\r\n  #platforms = {\r\n    gtm: { enabled: false, initialized: false },\r\n    fbPixel: { enabled: false, initialized: false },\r\n    ga4: { enabled: false, initialized: false }\r\n  };\r\n  #debugMode = false;\r\n  #processedOrderIds = new Set(); // Track processed order IDs to prevent duplicates\r\n  #viewItemListFired = false; // Track if view_item_list has been fired\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('EVENT');\r\n    this.#debugMode = app.options?.debug || false;\r\n    \r\n    // Initialize the event manager\r\n    this.init();\r\n  }\r\n\r\n  /**\r\n   * Initialize the event manager\r\n   */\r\n  init() {\r\n    this.#logger.info('Initializing EventManager');\r\n    \r\n    // Detect available platforms\r\n    this.#detectPlatforms();\r\n    \r\n    // Subscribe to relevant app events\r\n    this.#setupEventListeners();\r\n    \r\n    // Load processed order IDs from sessionStorage to prevent duplicates across page loads\r\n    this.#loadProcessedOrderIds();\r\n    \r\n    this.#isInitialized = true;\r\n    this.#logger.info('EventManager initialized');\r\n  }\r\n\r\n  /**\r\n   * Load processed order IDs from sessionStorage\r\n   */\r\n  #loadProcessedOrderIds() {\r\n    try {\r\n      const storedIds = sessionStorage.getItem('os_processed_order_ids');\r\n      if (storedIds) {\r\n        const parsedIds = JSON.parse(storedIds);\r\n        if (Array.isArray(parsedIds)) {\r\n          parsedIds.forEach(id => this.#processedOrderIds.add(id));\r\n          this.#logger.debug(`Loaded ${parsedIds.length} processed order IDs from sessionStorage`);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      this.#logger.error('Error loading processed order IDs from sessionStorage:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Save processed order IDs to sessionStorage\r\n   */\r\n  #saveProcessedOrderIds() {\r\n    try {\r\n      const idsArray = Array.from(this.#processedOrderIds);\r\n      sessionStorage.setItem('os_processed_order_ids', JSON.stringify(idsArray));\r\n      this.#logger.debug(`Saved ${idsArray.length} processed order IDs to sessionStorage`);\r\n    } catch (error) {\r\n      this.#logger.error('Error saving processed order IDs to sessionStorage:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Detect which platforms are available\r\n   */\r\n  #detectPlatforms() {\r\n    // Check for Google Tag Manager\r\n    if (typeof window.dataLayer !== 'undefined') {\r\n      this.#platforms.gtm.enabled = true;\r\n      this.#platforms.gtm.initialized = true;\r\n      this.#logger.info('Google Tag Manager detected');\r\n    } else {\r\n      this.#logger.info('Google Tag Manager not detected');\r\n    }\r\n\r\n    // Check for Facebook Pixel\r\n    if (typeof window.fbq !== 'undefined') {\r\n      this.#platforms.fbPixel.enabled = true;\r\n      this.#platforms.fbPixel.initialized = true;\r\n      this.#logger.info('Facebook Pixel detected');\r\n    } else {\r\n      this.#logger.info('Facebook Pixel not detected');\r\n    }\r\n\r\n    // Check for Google Analytics 4\r\n    if (typeof window.gtag !== 'undefined') {\r\n      this.#platforms.ga4.enabled = true;\r\n      this.#platforms.ga4.initialized = true;\r\n      this.#logger.info('Google Analytics 4 detected');\r\n    } else {\r\n      this.#logger.info('Google Analytics 4 not detected');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Setup event listeners for app events\r\n   */\r\n  #setupEventListeners() {\r\n    // Listen for campaign loaded event\r\n    this.#app.on('campaign.loaded', (data) => {\r\n      this.#logger.debug('Campaign loaded event received, triggering viewVisibleItemList');\r\n      this.viewVisibleItemList();\r\n    });\r\n\r\n    // Listen for cart updated event\r\n    this.#app.on('cart.updated', (data) => {\r\n      if (data.cart && data.cart.items && data.cart.items.length > 0) {\r\n        this.addToCart(data.cart);\r\n      }\r\n    });\r\n\r\n    // Listen for order created event\r\n    // commented to trigger only on first page they load.\r\n\r\n    // this.#app.on('order.created', (data) => {\r\n    //   this.purchase(data);\r\n    // });\r\n    \r\n    // Listen for order loaded event\r\n    this.#app.on('order.loaded', (data) => {\r\n      this.#logger.debug('Received order.loaded event with data:', JSON.stringify(data, null, 2));\r\n      \r\n      if (data.order) {\r\n        this.#logger.info('Order loaded on receipt page, checking if purchase event needed');\r\n        this.purchase(data.order);\r\n      } else {\r\n        this.#logger.warn('Order.loaded event received but no order data found', data);\r\n      }\r\n    });\r\n  }\r\n  \r\n\r\n  /**\r\n   * Fire a view_item_list event\r\n   * @param {Object} campaignData - The campaign data\r\n   */\r\n  viewItemList(campaignData) {\r\n    this.#logger.debug('viewItemList called with campaign data:', campaignData ? 'present' : 'missing');\r\n    \r\n    if (!campaignData || !campaignData.packages || campaignData.packages.length === 0) {\r\n      this.#logger.warn('Cannot fire view_item_list event: No packages found in campaign data');\r\n      return;\r\n    }\r\n\r\n    this.#logger.debug(`Found ${campaignData.packages.length} packages in campaign data`);\r\n    \r\n    const items = campaignData.packages.map(pkg => {\r\n      // Ensure price is a number\r\n      const price = typeof pkg.price === 'string' ? parseFloat(pkg.price) : (pkg.price || 0);\r\n      \r\n      return {\r\n        item_id: pkg.external_id || pkg.ref_id,\r\n        item_name: pkg.name,\r\n        price: price,\r\n        currency: campaignData.currency || 'USD',\r\n        quantity: pkg.qty || 1\r\n      };\r\n    });\r\n\r\n    const eventData = {\r\n      event: 'view_item_list',\r\n      ecommerce: {\r\n        currency: campaignData.currency || 'USD',\r\n        items: items\r\n      }\r\n    };\r\n\r\n    this.#logger.debug('Firing view_item_list event with data:', eventData);\r\n    this.#fireEvent('view_item_list', eventData);\r\n  }\r\n\r\n  /**\r\n   * Fire an add_to_cart event\r\n   * @param {Object} cartData - The cart data or a single package object\r\n   */\r\n  addToCart(cartData) {\r\n    // Check if this is a single package object rather than a cart\r\n    const isSinglePackage = !cartData.items && !cartData.totals;\r\n    \r\n    let items = [];\r\n    let currency = 'USD';\r\n    let value = 0;\r\n    \r\n    if (isSinglePackage) {\r\n      // Convert single package to cart format\r\n      this.#logger.debug('addToCart called with single package, converting to cart format');\r\n      \r\n      if (!cartData) {\r\n        this.#logger.warn('Cannot fire add_to_cart event: No package data provided');\r\n        return;\r\n      }\r\n      \r\n      // Extract package data\r\n      const pkg = cartData;\r\n      const item = {\r\n        item_id: pkg.external_id || pkg.ref_id || pkg.id,\r\n        item_name: pkg.name,\r\n        price: parseFloat(pkg.price) || 0,\r\n        currency: pkg.currency || this.#app.getCampaignData()?.currency || 'USD',\r\n        quantity: pkg.quantity || 1\r\n      };\r\n      \r\n      items = [item];\r\n      currency = item.currency;\r\n      value = item.price * item.quantity;\r\n    } else {\r\n      // Standard cart format\r\n      if (!cartData || !cartData.items || cartData.items.length === 0) {\r\n        this.#logger.warn('Cannot fire add_to_cart event: No items in cart');\r\n        return;\r\n      }\r\n      \r\n      items = cartData.items.map(item => ({\r\n        item_id: item.external_id || item.id,\r\n        item_name: item.name,\r\n        price: parseFloat(item.price) || 0,\r\n        currency: cartData.totals?.currency || 'USD',\r\n        quantity: item.quantity || 1\r\n      }));\r\n      \r\n      currency = cartData.totals?.currency || 'USD';\r\n      value = cartData.totals?.total || 0;\r\n    }\r\n\r\n    const eventData = {\r\n      event: 'add_to_cart',\r\n      ecommerce: {\r\n        currency: currency,\r\n        value: value,\r\n        items: items\r\n      }\r\n    };\r\n\r\n    this.#fireEvent('add_to_cart', eventData);\r\n  }\r\n\r\n  /**\r\n   * Fire a purchase event\r\n   * @param {Object} orderData - The order data\r\n   * @param {boolean} force - Whether to force firing the event even if the order ID has been processed\r\n   */\r\n  purchase(orderData, force = false) {\r\n    if (!orderData || !orderData.lines || orderData.lines.length === 0) {\r\n      this.#logger.warn('Cannot fire purchase event: No items in order');\r\n      return;\r\n    }\r\n\r\n    // Check if this order has already been processed\r\n    const orderId = orderData.number || orderData.ref_id;\r\n    this.#logger.debug(`Purchase method called for order ${orderId}, force=${force}, already processed=${this.#processedOrderIds.has(orderId)}`);\r\n    \r\n    if (!force && orderId && this.#processedOrderIds.has(orderId)) {\r\n      this.#logger.info(`Purchase event for order ${orderId} already fired, skipping`);\r\n      return;\r\n    }\r\n\r\n    this.#logger.info(`Preparing to fire purchase event for order ${orderId}`);\r\n    \r\n    const items = orderData.lines.map(line => ({\r\n      item_id: line.product_id || line.id,\r\n      item_name: line.product_title || line.name,\r\n      price: parseFloat(line.price_incl_tax || line.price) || 0,\r\n      currency: orderData.currency || 'USD',\r\n      quantity: line.quantity || 1\r\n    }));\r\n\r\n    // Get user data with privacy considerations\r\n    const userData = this.#getUserDataForTracking(orderData);\r\n\r\n    const eventData = {\r\n      event: 'purchase',\r\n      ecommerce: {\r\n        transaction_id: orderId,\r\n        value: parseFloat(orderData.total_incl_tax || orderData.total) || 0,\r\n        tax: parseFloat(orderData.total_tax) || 0,\r\n        shipping: parseFloat(orderData.shipping_incl_tax || orderData.shipping) || 0,\r\n        currency: orderData.currency || 'USD',\r\n        coupon: orderData.vouchers?.length > 0 ? orderData.vouchers[0].code : '',\r\n        ...userData,\r\n        items: items\r\n      }\r\n    };\r\n\r\n    this.#fireEvent('purchase', eventData);\r\n\r\n    // Mark this order as processed\r\n    if (orderId) {\r\n      this.#processedOrderIds.add(orderId);\r\n      this.#saveProcessedOrderIds();\r\n      this.#logger.debug(`Marked order ${orderId} as processed, total processed orders: ${this.#processedOrderIds.size}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get user data for tracking with privacy considerations\r\n   * @param {Object} orderData - The order data\r\n   * @returns {Object} - User data for tracking\r\n   */\r\n  #getUserDataForTracking(orderData) {\r\n    const userData = {};\r\n    \r\n    if (orderData.user) {\r\n      // Only include non-PII data or hashed values\r\n      if (orderData.user.first_name) userData.firstname = orderData.user.first_name;\r\n      if (orderData.user.last_name) userData.lastname = orderData.user.last_name;\r\n      \r\n      // Hash email for privacy\r\n      if (orderData.user.email) {\r\n        userData.email_hash = this.#hashString(orderData.user.email);\r\n      }\r\n    }\r\n    \r\n    if (orderData.shipping_address) {\r\n      userData.city = orderData.shipping_address.line4 || '';\r\n      userData.state = orderData.shipping_address.state || '';\r\n      userData.zipcode = orderData.shipping_address.postcode || '';\r\n      userData.country = orderData.shipping_address.country || '';\r\n    }\r\n    \r\n    return userData;\r\n  }\r\n\r\n  /**\r\n   * Hash a string for privacy\r\n   * @param {string} str - The string to hash\r\n   * @returns {string} - The hashed string\r\n   */\r\n  #hashString(str) {\r\n    let hash = 0;\r\n    if (str.length === 0) return hash.toString();\r\n    \r\n    for (let i = 0; i < str.length; i++) {\r\n      const char = str.charCodeAt(i);\r\n      hash = ((hash << 5) - hash) + char;\r\n      hash = hash & hash; // Convert to 32bit integer\r\n    }\r\n    \r\n    return hash.toString();\r\n  }\r\n\r\n  /**\r\n   * Fire an event to all enabled platforms\r\n   * @param {string} eventName - The name of the event\r\n   * @param {Object} eventData - The event data\r\n   */\r\n  #fireEvent(eventName, eventData) {\r\n    this.#logger.debug(`Firing ${eventName} event`, eventData);\r\n\r\n    // Clear previous ecommerce data for GTM\r\n    if (this.#platforms.gtm.enabled) {\r\n      window.dataLayer = window.dataLayer || [];\r\n      this.#logger.debug('Clearing previous ecommerce data in dataLayer');\r\n      window.dataLayer.push({ ecommerce: null });\r\n      \r\n      // Add a console log that's easy to spot\r\n      console.log(`🔥 Firing ${eventName} event to dataLayer`);\r\n      \r\n      // this.#logger.debug('Pushing event data to dataLayer');\r\n      window.dataLayer.push(eventData);\r\n      \r\n\r\n      this.#logger.debug(`${eventName} event fired to Google Tag Manager`);\r\n    } else {\r\n      this.#logger.warn(`Cannot fire ${eventName} event to GTM: GTM not enabled`);\r\n      \r\n      // Try to initialize dataLayer anyway\r\n      console.log('GTM not detected, initializing dataLayer and pushing event');\r\n      window.dataLayer = window.dataLayer || [];\r\n      window.dataLayer.push({ ecommerce: null });\r\n      window.dataLayer.push(eventData);\r\n    }\r\n\r\n    // Fire event to Facebook Pixel\r\n    if (this.#platforms.fbPixel.enabled) {\r\n      switch (eventName) {\r\n        case 'view_item_list':\r\n          window.fbq('track', 'ViewContent', {\r\n            content_type: 'product_group',\r\n            content_ids: eventData.ecommerce.items.map(item => item.item_id),\r\n            currency: eventData.ecommerce.currency\r\n          });\r\n          break;\r\n        case 'add_to_cart':\r\n          window.fbq('track', 'AddToCart', {\r\n            content_type: 'product_group',\r\n            content_ids: eventData.ecommerce.items.map(item => item.item_id),\r\n            currency: eventData.ecommerce.currency,\r\n            value: eventData.ecommerce.value\r\n          });\r\n          break;\r\n        case 'purchase':\r\n          window.fbq('track', 'Purchase', {\r\n            content_type: 'product_group',\r\n            content_ids: eventData.ecommerce.items.map(item => item.item_id),\r\n            currency: eventData.ecommerce.currency,\r\n            value: eventData.ecommerce.value\r\n          });\r\n          break;\r\n      }\r\n      this.#logger.debug(`${eventName} event fired to Facebook Pixel`);\r\n    }\r\n\r\n    // Fire event to Google Analytics 4\r\n    if (this.#platforms.ga4.enabled) {\r\n      window.gtag('event', eventName, {\r\n        currency: eventData.ecommerce.currency,\r\n        value: eventData.ecommerce.value,\r\n        items: eventData.ecommerce.items\r\n      });\r\n      this.#logger.debug(`${eventName} event fired to Google Analytics 4`);\r\n    }\r\n\r\n    // Dispatch a DOM event for custom handlers\r\n    const customEvent = new CustomEvent(`os:${eventName}`, {\r\n      bubbles: true,\r\n      detail: eventData\r\n    });\r\n    document.dispatchEvent(customEvent);\r\n  }\r\n\r\n  /**\r\n   * Manually fire a view_item event\r\n   * @param {Object} packageData - The package data\r\n   */\r\n  viewItem(packageData) {\r\n    if (!packageData) {\r\n      this.#logger.warn('Cannot fire view_item event: No package data provided');\r\n      return;\r\n    }\r\n\r\n    const item = {\r\n      item_id: packageData.ref_id || packageData.external_id || packageData.id,\r\n      item_name: packageData.name,\r\n      price: parseFloat(packageData.price) || 0,\r\n      currency: packageData.currency || this.#app.getCampaignData()?.currency || 'USD',\r\n      quantity: 1\r\n    };\r\n\r\n    const eventData = {\r\n      event: 'view_item',\r\n      ecommerce: {\r\n        currency: item.currency,\r\n        value: item.price,\r\n        items: [item]\r\n      }\r\n    };\r\n\r\n    this.#fireEvent('view_item', eventData);\r\n  }\r\n\r\n  /**\r\n   * Manually fire a begin_checkout event\r\n   */\r\n  beginCheckout() {\r\n    const cart = this.#app.state.getState('cart');\r\n    \r\n    if (!cart || !cart.items || cart.items.length === 0) {\r\n      this.#logger.warn('Cannot fire begin_checkout event: No items in cart');\r\n      return;\r\n    }\r\n\r\n    const items = cart.items.map(item => ({\r\n      item_id: item.external_id || item.id,\r\n      item_name: item.name,\r\n      price: parseFloat(item.price) || 0,\r\n      currency: cart.totals?.currency || 'USD',\r\n      quantity: item.quantity || 1\r\n    }));\r\n\r\n    const eventData = {\r\n      event: 'begin_checkout',\r\n      ecommerce: {\r\n        currency: cart.totals?.currency || 'USD',\r\n        value: cart.totals?.total || 0,\r\n        items: items\r\n      }\r\n    };\r\n\r\n    this.#fireEvent('begin_checkout', eventData);\r\n  }\r\n\r\n  /**\r\n   * Manually fire a custom event\r\n   * @param {string} eventName - The name of the event\r\n   * @param {Object} eventData - The event data\r\n   */\r\n  fireCustomEvent(eventName, eventData = {}) {\r\n    if (!eventName) {\r\n      this.#logger.warn('Cannot fire custom event: No event name provided');\r\n      return;\r\n    }\r\n\r\n    const formattedEventData = {\r\n      event: eventName,\r\n      ...eventData\r\n    };\r\n\r\n    this.#logger.debug(`Firing custom event: ${eventName}`, formattedEventData);\r\n\r\n    // Fire to Google Tag Manager\r\n    if (this.#platforms.gtm.enabled) {\r\n      window.dataLayer = window.dataLayer || [];\r\n      window.dataLayer.push(formattedEventData);\r\n      this.#logger.debug(`Custom event ${eventName} fired to Google Tag Manager`);\r\n    }\r\n\r\n    // Fire to Facebook Pixel\r\n    if (this.#platforms.fbPixel.enabled && typeof window.fbq === 'function') {\r\n      window.fbq('trackCustom', eventName, eventData);\r\n      this.#logger.debug(`Custom event ${eventName} fired to Facebook Pixel`);\r\n    }\r\n\r\n    // Fire to Google Analytics 4\r\n    if (this.#platforms.ga4.enabled && typeof window.gtag === 'function') {\r\n      window.gtag('event', eventName, eventData);\r\n      this.#logger.debug(`Custom event ${eventName} fired to Google Analytics 4`);\r\n    }\r\n\r\n    // Dispatch a DOM event for custom handlers\r\n    const customEvent = new CustomEvent(`os:${eventName}`, {\r\n      bubbles: true,\r\n      detail: formattedEventData\r\n    });\r\n    document.dispatchEvent(customEvent);\r\n  }\r\n\r\n  /**\r\n   * Enable or disable a platform\r\n   * @param {string} platform - The platform to enable/disable (gtm, fbPixel, ga4)\r\n   * @param {boolean} enabled - Whether to enable or disable the platform\r\n   */\r\n  setPlatformEnabled(platform, enabled) {\r\n    if (this.#platforms[platform]) {\r\n      this.#platforms[platform].enabled = enabled;\r\n      this.#logger.info(`${platform} ${enabled ? 'enabled' : 'disabled'}`);\r\n    } else {\r\n      this.#logger.warn(`Unknown platform: ${platform}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get the status of all platforms\r\n   * @returns {Object} - The status of all platforms\r\n   */\r\n  getPlatformStatus() {\r\n    return { ...this.#platforms };\r\n  }\r\n  \r\n  /**\r\n   * Check if the EventManager is fully initialized\r\n   * @returns {boolean} - Whether the EventManager is initialized\r\n   */\r\n  get isInitialized() {\r\n    return this.#isInitialized;\r\n  }\r\n\r\n} ", "/**\n * Custom positioning reference element.\n * @see https://floating-ui.com/docs/virtual-elements\n */\n\nconst sides = ['top', 'right', 'bottom', 'left'];\nconst alignments = ['start', 'end'];\nconst placements = /*#__PURE__*/sides.reduce((acc, side) => acc.concat(side, side + \"-\" + alignments[0], side + \"-\" + alignments[1]), []);\nconst min = Math.min;\nconst max = Math.max;\nconst round = Math.round;\nconst floor = Math.floor;\nconst createCoords = v => ({\n  x: v,\n  y: v\n});\nconst oppositeSideMap = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nconst oppositeAlignmentMap = {\n  start: 'end',\n  end: 'start'\n};\nfunction clamp(start, value, end) {\n  return max(start, min(value, end));\n}\nfunction evaluate(value, param) {\n  return typeof value === 'function' ? value(param) : value;\n}\nfunction getSide(placement) {\n  return placement.split('-')[0];\n}\nfunction getAlignment(placement) {\n  return placement.split('-')[1];\n}\nfunction getOppositeAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\nfunction getAxisLength(axis) {\n  return axis === 'y' ? 'height' : 'width';\n}\nfunction getSideAxis(placement) {\n  return ['top', 'bottom'].includes(getSide(placement)) ? 'y' : 'x';\n}\nfunction getAlignmentAxis(placement) {\n  return getOppositeAxis(getSideAxis(placement));\n}\nfunction getAlignmentSides(placement, rects, rtl) {\n  if (rtl === void 0) {\n    rtl = false;\n  }\n  const alignment = getAlignment(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const length = getAxisLength(alignmentAxis);\n  let mainAlignmentSide = alignmentAxis === 'x' ? alignment === (rtl ? 'end' : 'start') ? 'right' : 'left' : alignment === 'start' ? 'bottom' : 'top';\n  if (rects.reference[length] > rects.floating[length]) {\n    mainAlignmentSide = getOppositePlacement(mainAlignmentSide);\n  }\n  return [mainAlignmentSide, getOppositePlacement(mainAlignmentSide)];\n}\nfunction getExpandedPlacements(placement) {\n  const oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeAlignmentPlacement(placement), oppositePlacement, getOppositeAlignmentPlacement(oppositePlacement)];\n}\nfunction getOppositeAlignmentPlacement(placement) {\n  return placement.replace(/start|end/g, alignment => oppositeAlignmentMap[alignment]);\n}\nfunction getSideList(side, isStart, rtl) {\n  const lr = ['left', 'right'];\n  const rl = ['right', 'left'];\n  const tb = ['top', 'bottom'];\n  const bt = ['bottom', 'top'];\n  switch (side) {\n    case 'top':\n    case 'bottom':\n      if (rtl) return isStart ? rl : lr;\n      return isStart ? lr : rl;\n    case 'left':\n    case 'right':\n      return isStart ? tb : bt;\n    default:\n      return [];\n  }\n}\nfunction getOppositeAxisPlacements(placement, flipAlignment, direction, rtl) {\n  const alignment = getAlignment(placement);\n  let list = getSideList(getSide(placement), direction === 'start', rtl);\n  if (alignment) {\n    list = list.map(side => side + \"-\" + alignment);\n    if (flipAlignment) {\n      list = list.concat(list.map(getOppositeAlignmentPlacement));\n    }\n  }\n  return list;\n}\nfunction getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, side => oppositeSideMap[side]);\n}\nfunction expandPaddingObject(padding) {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    ...padding\n  };\n}\nfunction getPaddingObject(padding) {\n  return typeof padding !== 'number' ? expandPaddingObject(padding) : {\n    top: padding,\n    right: padding,\n    bottom: padding,\n    left: padding\n  };\n}\nfunction rectToClientRect(rect) {\n  const {\n    x,\n    y,\n    width,\n    height\n  } = rect;\n  return {\n    width,\n    height,\n    top: y,\n    left: x,\n    right: x + width,\n    bottom: y + height,\n    x,\n    y\n  };\n}\n\nexport { alignments, clamp, createCoords, evaluate, expandPaddingObject, floor, getAlignment, getAlignmentAxis, getAlignmentSides, getAxisLength, getExpandedPlacements, getOppositeAlignmentPlacement, getOppositeAxis, getOppositeAxisPlacements, getOppositePlacement, getPaddingObject, getSide, getSideAxis, max, min, placements, rectToClientRect, round, sides };\n", "import { getSideAxis, getAlignmentAxis, getAxisLength, getSide, getAlignment, evaluate, getPaddingObject, rectToClientRect, min, clamp, placements, getAlignmentSides, getOppositeAlignmentPlacement, getOppositePlacement, getExpandedPlacements, getOppositeAxisPlacements, sides, max, getOppositeAxis } from '@floating-ui/utils';\nexport { rectToClientRect } from '@floating-ui/utils';\n\nfunction computeCoordsFromPlacement(_ref, placement, rtl) {\n  let {\n    reference,\n    floating\n  } = _ref;\n  const sideAxis = getSideAxis(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const alignLength = getAxisLength(alignmentAxis);\n  const side = getSide(placement);\n  const isVertical = sideAxis === 'y';\n  const commonX = reference.x + reference.width / 2 - floating.width / 2;\n  const commonY = reference.y + reference.height / 2 - floating.height / 2;\n  const commonAlign = reference[alignLength] / 2 - floating[alignLength] / 2;\n  let coords;\n  switch (side) {\n    case 'top':\n      coords = {\n        x: commonX,\n        y: reference.y - floating.height\n      };\n      break;\n    case 'bottom':\n      coords = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n    case 'right':\n      coords = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n    case 'left':\n      coords = {\n        x: reference.x - floating.width,\n        y: commonY\n      };\n      break;\n    default:\n      coords = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n  switch (getAlignment(placement)) {\n    case 'start':\n      coords[alignmentAxis] -= commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n    case 'end':\n      coords[alignmentAxis] += commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n  }\n  return coords;\n}\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n *\n * This export does not have any `platform` interface logic. You will need to\n * write one for the platform you are using Floating UI with.\n */\nconst computePosition = async (reference, floating, config) => {\n  const {\n    placement = 'bottom',\n    strategy = 'absolute',\n    middleware = [],\n    platform\n  } = config;\n  const validMiddleware = middleware.filter(Boolean);\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(floating));\n  let rects = await platform.getElementRects({\n    reference,\n    floating,\n    strategy\n  });\n  let {\n    x,\n    y\n  } = computeCoordsFromPlacement(rects, placement, rtl);\n  let statefulPlacement = placement;\n  let middlewareData = {};\n  let resetCount = 0;\n  for (let i = 0; i < validMiddleware.length; i++) {\n    const {\n      name,\n      fn\n    } = validMiddleware[i];\n    const {\n      x: nextX,\n      y: nextY,\n      data,\n      reset\n    } = await fn({\n      x,\n      y,\n      initialPlacement: placement,\n      placement: statefulPlacement,\n      strategy,\n      middlewareData,\n      rects,\n      platform,\n      elements: {\n        reference,\n        floating\n      }\n    });\n    x = nextX != null ? nextX : x;\n    y = nextY != null ? nextY : y;\n    middlewareData = {\n      ...middlewareData,\n      [name]: {\n        ...middlewareData[name],\n        ...data\n      }\n    };\n    if (reset && resetCount <= 50) {\n      resetCount++;\n      if (typeof reset === 'object') {\n        if (reset.placement) {\n          statefulPlacement = reset.placement;\n        }\n        if (reset.rects) {\n          rects = reset.rects === true ? await platform.getElementRects({\n            reference,\n            floating,\n            strategy\n          }) : reset.rects;\n        }\n        ({\n          x,\n          y\n        } = computeCoordsFromPlacement(rects, statefulPlacement, rtl));\n      }\n      i = -1;\n    }\n  }\n  return {\n    x,\n    y,\n    placement: statefulPlacement,\n    strategy,\n    middlewareData\n  };\n};\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nasync function detectOverflow(state, options) {\n  var _await$platform$isEle;\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    x,\n    y,\n    platform,\n    rects,\n    elements,\n    strategy\n  } = state;\n  const {\n    boundary = 'clippingAncestors',\n    rootBoundary = 'viewport',\n    elementContext = 'floating',\n    altBoundary = false,\n    padding = 0\n  } = evaluate(options, state);\n  const paddingObject = getPaddingObject(padding);\n  const altContext = elementContext === 'floating' ? 'reference' : 'floating';\n  const element = elements[altBoundary ? altContext : elementContext];\n  const clippingClientRect = rectToClientRect(await platform.getClippingRect({\n    element: ((_await$platform$isEle = await (platform.isElement == null ? void 0 : platform.isElement(element))) != null ? _await$platform$isEle : true) ? element : element.contextElement || (await (platform.getDocumentElement == null ? void 0 : platform.getDocumentElement(elements.floating))),\n    boundary,\n    rootBoundary,\n    strategy\n  }));\n  const rect = elementContext === 'floating' ? {\n    x,\n    y,\n    width: rects.floating.width,\n    height: rects.floating.height\n  } : rects.reference;\n  const offsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(elements.floating));\n  const offsetScale = (await (platform.isElement == null ? void 0 : platform.isElement(offsetParent))) ? (await (platform.getScale == null ? void 0 : platform.getScale(offsetParent))) || {\n    x: 1,\n    y: 1\n  } : {\n    x: 1,\n    y: 1\n  };\n  const elementClientRect = rectToClientRect(platform.convertOffsetParentRelativeRectToViewportRelativeRect ? await platform.convertOffsetParentRelativeRectToViewportRelativeRect({\n    elements,\n    rect,\n    offsetParent,\n    strategy\n  }) : rect);\n  return {\n    top: (clippingClientRect.top - elementClientRect.top + paddingObject.top) / offsetScale.y,\n    bottom: (elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom) / offsetScale.y,\n    left: (clippingClientRect.left - elementClientRect.left + paddingObject.left) / offsetScale.x,\n    right: (elementClientRect.right - clippingClientRect.right + paddingObject.right) / offsetScale.x\n  };\n}\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = options => ({\n  name: 'arrow',\n  options,\n  async fn(state) {\n    const {\n      x,\n      y,\n      placement,\n      rects,\n      platform,\n      elements,\n      middlewareData\n    } = state;\n    // Since `element` is required, we don't Partial<> the type.\n    const {\n      element,\n      padding = 0\n    } = evaluate(options, state) || {};\n    if (element == null) {\n      return {};\n    }\n    const paddingObject = getPaddingObject(padding);\n    const coords = {\n      x,\n      y\n    };\n    const axis = getAlignmentAxis(placement);\n    const length = getAxisLength(axis);\n    const arrowDimensions = await platform.getDimensions(element);\n    const isYAxis = axis === 'y';\n    const minProp = isYAxis ? 'top' : 'left';\n    const maxProp = isYAxis ? 'bottom' : 'right';\n    const clientProp = isYAxis ? 'clientHeight' : 'clientWidth';\n    const endDiff = rects.reference[length] + rects.reference[axis] - coords[axis] - rects.floating[length];\n    const startDiff = coords[axis] - rects.reference[axis];\n    const arrowOffsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(element));\n    let clientSize = arrowOffsetParent ? arrowOffsetParent[clientProp] : 0;\n\n    // DOM platform can return `window` as the `offsetParent`.\n    if (!clientSize || !(await (platform.isElement == null ? void 0 : platform.isElement(arrowOffsetParent)))) {\n      clientSize = elements.floating[clientProp] || rects.floating[length];\n    }\n    const centerToReference = endDiff / 2 - startDiff / 2;\n\n    // If the padding is large enough that it causes the arrow to no longer be\n    // centered, modify the padding so that it is centered.\n    const largestPossiblePadding = clientSize / 2 - arrowDimensions[length] / 2 - 1;\n    const minPadding = min(paddingObject[minProp], largestPossiblePadding);\n    const maxPadding = min(paddingObject[maxProp], largestPossiblePadding);\n\n    // Make sure the arrow doesn't overflow the floating element if the center\n    // point is outside the floating element's bounds.\n    const min$1 = minPadding;\n    const max = clientSize - arrowDimensions[length] - maxPadding;\n    const center = clientSize / 2 - arrowDimensions[length] / 2 + centerToReference;\n    const offset = clamp(min$1, center, max);\n\n    // If the reference is small enough that the arrow's padding causes it to\n    // to point to nothing for an aligned placement, adjust the offset of the\n    // floating element itself. To ensure `shift()` continues to take action,\n    // a single reset is performed when this is true.\n    const shouldAddOffset = !middlewareData.arrow && getAlignment(placement) != null && center !== offset && rects.reference[length] / 2 - (center < min$1 ? minPadding : maxPadding) - arrowDimensions[length] / 2 < 0;\n    const alignmentOffset = shouldAddOffset ? center < min$1 ? center - min$1 : center - max : 0;\n    return {\n      [axis]: coords[axis] + alignmentOffset,\n      data: {\n        [axis]: offset,\n        centerOffset: center - offset - alignmentOffset,\n        ...(shouldAddOffset && {\n          alignmentOffset\n        })\n      },\n      reset: shouldAddOffset\n    };\n  }\n});\n\nfunction getPlacementList(alignment, autoAlignment, allowedPlacements) {\n  const allowedPlacementsSortedByAlignment = alignment ? [...allowedPlacements.filter(placement => getAlignment(placement) === alignment), ...allowedPlacements.filter(placement => getAlignment(placement) !== alignment)] : allowedPlacements.filter(placement => getSide(placement) === placement);\n  return allowedPlacementsSortedByAlignment.filter(placement => {\n    if (alignment) {\n      return getAlignment(placement) === alignment || (autoAlignment ? getOppositeAlignmentPlacement(placement) !== placement : false);\n    }\n    return true;\n  });\n}\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'autoPlacement',\n    options,\n    async fn(state) {\n      var _middlewareData$autoP, _middlewareData$autoP2, _placementsThatFitOnE;\n      const {\n        rects,\n        middlewareData,\n        placement,\n        platform,\n        elements\n      } = state;\n      const {\n        crossAxis = false,\n        alignment,\n        allowedPlacements = placements,\n        autoAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const placements$1 = alignment !== undefined || allowedPlacements === placements ? getPlacementList(alignment || null, autoAlignment, allowedPlacements) : allowedPlacements;\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const currentIndex = ((_middlewareData$autoP = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP.index) || 0;\n      const currentPlacement = placements$1[currentIndex];\n      if (currentPlacement == null) {\n        return {};\n      }\n      const alignmentSides = getAlignmentSides(currentPlacement, rects, await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating)));\n\n      // Make `computeCoords` start from the right place.\n      if (placement !== currentPlacement) {\n        return {\n          reset: {\n            placement: placements$1[0]\n          }\n        };\n      }\n      const currentOverflows = [overflow[getSide(currentPlacement)], overflow[alignmentSides[0]], overflow[alignmentSides[1]]];\n      const allOverflows = [...(((_middlewareData$autoP2 = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP2.overflows) || []), {\n        placement: currentPlacement,\n        overflows: currentOverflows\n      }];\n      const nextPlacement = placements$1[currentIndex + 1];\n\n      // There are more placements to check.\n      if (nextPlacement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: nextPlacement\n          }\n        };\n      }\n      const placementsSortedByMostSpace = allOverflows.map(d => {\n        const alignment = getAlignment(d.placement);\n        return [d.placement, alignment && crossAxis ?\n        // Check along the mainAxis and main crossAxis side.\n        d.overflows.slice(0, 2).reduce((acc, v) => acc + v, 0) :\n        // Check only the mainAxis.\n        d.overflows[0], d.overflows];\n      }).sort((a, b) => a[1] - b[1]);\n      const placementsThatFitOnEachSide = placementsSortedByMostSpace.filter(d => d[2].slice(0,\n      // Aligned placements should not check their opposite crossAxis\n      // side.\n      getAlignment(d[0]) ? 2 : 3).every(v => v <= 0));\n      const resetPlacement = ((_placementsThatFitOnE = placementsThatFitOnEachSide[0]) == null ? void 0 : _placementsThatFitOnE[0]) || placementsSortedByMostSpace[0][0];\n      if (resetPlacement !== placement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: resetPlacement\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'flip',\n    options,\n    async fn(state) {\n      var _middlewareData$arrow, _middlewareData$flip;\n      const {\n        placement,\n        middlewareData,\n        rects,\n        initialPlacement,\n        platform,\n        elements\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true,\n        fallbackPlacements: specifiedFallbackPlacements,\n        fallbackStrategy = 'bestFit',\n        fallbackAxisSideDirection = 'none',\n        flipAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n\n      // If a reset by the arrow was caused due to an alignment offset being\n      // added, we should skip any logic now since `flip()` has already done its\n      // work.\n      // https://github.com/floating-ui/floating-ui/issues/2549#issuecomment-1719601643\n      if ((_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      const side = getSide(placement);\n      const initialSideAxis = getSideAxis(initialPlacement);\n      const isBasePlacement = getSide(initialPlacement) === initialPlacement;\n      const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n      const fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipAlignment ? [getOppositePlacement(initialPlacement)] : getExpandedPlacements(initialPlacement));\n      const hasFallbackAxisSideDirection = fallbackAxisSideDirection !== 'none';\n      if (!specifiedFallbackPlacements && hasFallbackAxisSideDirection) {\n        fallbackPlacements.push(...getOppositeAxisPlacements(initialPlacement, flipAlignment, fallbackAxisSideDirection, rtl));\n      }\n      const placements = [initialPlacement, ...fallbackPlacements];\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const overflows = [];\n      let overflowsData = ((_middlewareData$flip = middlewareData.flip) == null ? void 0 : _middlewareData$flip.overflows) || [];\n      if (checkMainAxis) {\n        overflows.push(overflow[side]);\n      }\n      if (checkCrossAxis) {\n        const sides = getAlignmentSides(placement, rects, rtl);\n        overflows.push(overflow[sides[0]], overflow[sides[1]]);\n      }\n      overflowsData = [...overflowsData, {\n        placement,\n        overflows\n      }];\n\n      // One or more sides is overflowing.\n      if (!overflows.every(side => side <= 0)) {\n        var _middlewareData$flip2, _overflowsData$filter;\n        const nextIndex = (((_middlewareData$flip2 = middlewareData.flip) == null ? void 0 : _middlewareData$flip2.index) || 0) + 1;\n        const nextPlacement = placements[nextIndex];\n        if (nextPlacement) {\n          // Try next placement and re-run the lifecycle.\n          return {\n            data: {\n              index: nextIndex,\n              overflows: overflowsData\n            },\n            reset: {\n              placement: nextPlacement\n            }\n          };\n        }\n\n        // First, find the candidates that fit on the mainAxis side of overflow,\n        // then find the placement that fits the best on the main crossAxis side.\n        let resetPlacement = (_overflowsData$filter = overflowsData.filter(d => d.overflows[0] <= 0).sort((a, b) => a.overflows[1] - b.overflows[1])[0]) == null ? void 0 : _overflowsData$filter.placement;\n\n        // Otherwise fallback.\n        if (!resetPlacement) {\n          switch (fallbackStrategy) {\n            case 'bestFit':\n              {\n                var _overflowsData$filter2;\n                const placement = (_overflowsData$filter2 = overflowsData.filter(d => {\n                  if (hasFallbackAxisSideDirection) {\n                    const currentSideAxis = getSideAxis(d.placement);\n                    return currentSideAxis === initialSideAxis ||\n                    // Create a bias to the `y` side axis due to horizontal\n                    // reading directions favoring greater width.\n                    currentSideAxis === 'y';\n                  }\n                  return true;\n                }).map(d => [d.placement, d.overflows.filter(overflow => overflow > 0).reduce((acc, overflow) => acc + overflow, 0)]).sort((a, b) => a[1] - b[1])[0]) == null ? void 0 : _overflowsData$filter2[0];\n                if (placement) {\n                  resetPlacement = placement;\n                }\n                break;\n              }\n            case 'initialPlacement':\n              resetPlacement = initialPlacement;\n              break;\n          }\n        }\n        if (placement !== resetPlacement) {\n          return {\n            reset: {\n              placement: resetPlacement\n            }\n          };\n        }\n      }\n      return {};\n    }\n  };\n};\n\nfunction getSideOffsets(overflow, rect) {\n  return {\n    top: overflow.top - rect.height,\n    right: overflow.right - rect.width,\n    bottom: overflow.bottom - rect.height,\n    left: overflow.left - rect.width\n  };\n}\nfunction isAnySideFullyClipped(overflow) {\n  return sides.some(side => overflow[side] >= 0);\n}\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'hide',\n    options,\n    async fn(state) {\n      const {\n        rects\n      } = state;\n      const {\n        strategy = 'referenceHidden',\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      switch (strategy) {\n        case 'referenceHidden':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              elementContext: 'reference'\n            });\n            const offsets = getSideOffsets(overflow, rects.reference);\n            return {\n              data: {\n                referenceHiddenOffsets: offsets,\n                referenceHidden: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        case 'escaped':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              altBoundary: true\n            });\n            const offsets = getSideOffsets(overflow, rects.floating);\n            return {\n              data: {\n                escapedOffsets: offsets,\n                escaped: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        default:\n          {\n            return {};\n          }\n      }\n    }\n  };\n};\n\nfunction getBoundingRect(rects) {\n  const minX = min(...rects.map(rect => rect.left));\n  const minY = min(...rects.map(rect => rect.top));\n  const maxX = max(...rects.map(rect => rect.right));\n  const maxY = max(...rects.map(rect => rect.bottom));\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction getRectsByLine(rects) {\n  const sortedRects = rects.slice().sort((a, b) => a.y - b.y);\n  const groups = [];\n  let prevRect = null;\n  for (let i = 0; i < sortedRects.length; i++) {\n    const rect = sortedRects[i];\n    if (!prevRect || rect.y - prevRect.y > prevRect.height / 2) {\n      groups.push([rect]);\n    } else {\n      groups[groups.length - 1].push(rect);\n    }\n    prevRect = rect;\n  }\n  return groups.map(rect => rectToClientRect(getBoundingRect(rect)));\n}\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'inline',\n    options,\n    async fn(state) {\n      const {\n        placement,\n        elements,\n        rects,\n        platform,\n        strategy\n      } = state;\n      // A MouseEvent's client{X,Y} coords can be up to 2 pixels off a\n      // ClientRect's bounds, despite the event listener being triggered. A\n      // padding of 2 seems to handle this issue.\n      const {\n        padding = 2,\n        x,\n        y\n      } = evaluate(options, state);\n      const nativeClientRects = Array.from((await (platform.getClientRects == null ? void 0 : platform.getClientRects(elements.reference))) || []);\n      const clientRects = getRectsByLine(nativeClientRects);\n      const fallback = rectToClientRect(getBoundingRect(nativeClientRects));\n      const paddingObject = getPaddingObject(padding);\n      function getBoundingClientRect() {\n        // There are two rects and they are disjoined.\n        if (clientRects.length === 2 && clientRects[0].left > clientRects[1].right && x != null && y != null) {\n          // Find the first rect in which the point is fully inside.\n          return clientRects.find(rect => x > rect.left - paddingObject.left && x < rect.right + paddingObject.right && y > rect.top - paddingObject.top && y < rect.bottom + paddingObject.bottom) || fallback;\n        }\n\n        // There are 2 or more connected rects.\n        if (clientRects.length >= 2) {\n          if (getSideAxis(placement) === 'y') {\n            const firstRect = clientRects[0];\n            const lastRect = clientRects[clientRects.length - 1];\n            const isTop = getSide(placement) === 'top';\n            const top = firstRect.top;\n            const bottom = lastRect.bottom;\n            const left = isTop ? firstRect.left : lastRect.left;\n            const right = isTop ? firstRect.right : lastRect.right;\n            const width = right - left;\n            const height = bottom - top;\n            return {\n              top,\n              bottom,\n              left,\n              right,\n              width,\n              height,\n              x: left,\n              y: top\n            };\n          }\n          const isLeftSide = getSide(placement) === 'left';\n          const maxRight = max(...clientRects.map(rect => rect.right));\n          const minLeft = min(...clientRects.map(rect => rect.left));\n          const measureRects = clientRects.filter(rect => isLeftSide ? rect.left === minLeft : rect.right === maxRight);\n          const top = measureRects[0].top;\n          const bottom = measureRects[measureRects.length - 1].bottom;\n          const left = minLeft;\n          const right = maxRight;\n          const width = right - left;\n          const height = bottom - top;\n          return {\n            top,\n            bottom,\n            left,\n            right,\n            width,\n            height,\n            x: left,\n            y: top\n          };\n        }\n        return fallback;\n      }\n      const resetRects = await platform.getElementRects({\n        reference: {\n          getBoundingClientRect\n        },\n        floating: elements.floating,\n        strategy\n      });\n      if (rects.reference.x !== resetRects.reference.x || rects.reference.y !== resetRects.reference.y || rects.reference.width !== resetRects.reference.width || rects.reference.height !== resetRects.reference.height) {\n        return {\n          reset: {\n            rects: resetRects\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\n// For type backwards-compatibility, the `OffsetOptions` type was also\n// Derivable.\n\nasync function convertValueToCoords(state, options) {\n  const {\n    placement,\n    platform,\n    elements\n  } = state;\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n  const side = getSide(placement);\n  const alignment = getAlignment(placement);\n  const isVertical = getSideAxis(placement) === 'y';\n  const mainAxisMulti = ['left', 'top'].includes(side) ? -1 : 1;\n  const crossAxisMulti = rtl && isVertical ? -1 : 1;\n  const rawValue = evaluate(options, state);\n\n  // eslint-disable-next-line prefer-const\n  let {\n    mainAxis,\n    crossAxis,\n    alignmentAxis\n  } = typeof rawValue === 'number' ? {\n    mainAxis: rawValue,\n    crossAxis: 0,\n    alignmentAxis: null\n  } : {\n    mainAxis: rawValue.mainAxis || 0,\n    crossAxis: rawValue.crossAxis || 0,\n    alignmentAxis: rawValue.alignmentAxis\n  };\n  if (alignment && typeof alignmentAxis === 'number') {\n    crossAxis = alignment === 'end' ? alignmentAxis * -1 : alignmentAxis;\n  }\n  return isVertical ? {\n    x: crossAxis * crossAxisMulti,\n    y: mainAxis * mainAxisMulti\n  } : {\n    x: mainAxis * mainAxisMulti,\n    y: crossAxis * crossAxisMulti\n  };\n}\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = function (options) {\n  if (options === void 0) {\n    options = 0;\n  }\n  return {\n    name: 'offset',\n    options,\n    async fn(state) {\n      var _middlewareData$offse, _middlewareData$arrow;\n      const {\n        x,\n        y,\n        placement,\n        middlewareData\n      } = state;\n      const diffCoords = await convertValueToCoords(state, options);\n\n      // If the placement is the same and the arrow caused an alignment offset\n      // then we don't need to change the positioning coordinates.\n      if (placement === ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse.placement) && (_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      return {\n        x: x + diffCoords.x,\n        y: y + diffCoords.y,\n        data: {\n          ...diffCoords,\n          placement\n        }\n      };\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'shift',\n    options,\n    async fn(state) {\n      const {\n        x,\n        y,\n        placement\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = false,\n        limiter = {\n          fn: _ref => {\n            let {\n              x,\n              y\n            } = _ref;\n            return {\n              x,\n              y\n            };\n          }\n        },\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const crossAxis = getSideAxis(getSide(placement));\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      if (checkMainAxis) {\n        const minSide = mainAxis === 'y' ? 'top' : 'left';\n        const maxSide = mainAxis === 'y' ? 'bottom' : 'right';\n        const min = mainAxisCoord + overflow[minSide];\n        const max = mainAxisCoord - overflow[maxSide];\n        mainAxisCoord = clamp(min, mainAxisCoord, max);\n      }\n      if (checkCrossAxis) {\n        const minSide = crossAxis === 'y' ? 'top' : 'left';\n        const maxSide = crossAxis === 'y' ? 'bottom' : 'right';\n        const min = crossAxisCoord + overflow[minSide];\n        const max = crossAxisCoord - overflow[maxSide];\n        crossAxisCoord = clamp(min, crossAxisCoord, max);\n      }\n      const limitedCoords = limiter.fn({\n        ...state,\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      });\n      return {\n        ...limitedCoords,\n        data: {\n          x: limitedCoords.x - x,\n          y: limitedCoords.y - y,\n          enabled: {\n            [mainAxis]: checkMainAxis,\n            [crossAxis]: checkCrossAxis\n          }\n        }\n      };\n    }\n  };\n};\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    options,\n    fn(state) {\n      const {\n        x,\n        y,\n        placement,\n        rects,\n        middlewareData\n      } = state;\n      const {\n        offset = 0,\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const crossAxis = getSideAxis(placement);\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      const rawOffset = evaluate(offset, state);\n      const computedOffset = typeof rawOffset === 'number' ? {\n        mainAxis: rawOffset,\n        crossAxis: 0\n      } : {\n        mainAxis: 0,\n        crossAxis: 0,\n        ...rawOffset\n      };\n      if (checkMainAxis) {\n        const len = mainAxis === 'y' ? 'height' : 'width';\n        const limitMin = rects.reference[mainAxis] - rects.floating[len] + computedOffset.mainAxis;\n        const limitMax = rects.reference[mainAxis] + rects.reference[len] - computedOffset.mainAxis;\n        if (mainAxisCoord < limitMin) {\n          mainAxisCoord = limitMin;\n        } else if (mainAxisCoord > limitMax) {\n          mainAxisCoord = limitMax;\n        }\n      }\n      if (checkCrossAxis) {\n        var _middlewareData$offse, _middlewareData$offse2;\n        const len = mainAxis === 'y' ? 'width' : 'height';\n        const isOriginSide = ['top', 'left'].includes(getSide(placement));\n        const limitMin = rects.reference[crossAxis] - rects.floating[len] + (isOriginSide ? ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse[crossAxis]) || 0 : 0) + (isOriginSide ? 0 : computedOffset.crossAxis);\n        const limitMax = rects.reference[crossAxis] + rects.reference[len] + (isOriginSide ? 0 : ((_middlewareData$offse2 = middlewareData.offset) == null ? void 0 : _middlewareData$offse2[crossAxis]) || 0) - (isOriginSide ? computedOffset.crossAxis : 0);\n        if (crossAxisCoord < limitMin) {\n          crossAxisCoord = limitMin;\n        } else if (crossAxisCoord > limitMax) {\n          crossAxisCoord = limitMax;\n        }\n      }\n      return {\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      };\n    }\n  };\n};\n\n/**\n * Provides data that allows you to change the size of the floating element —\n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'size',\n    options,\n    async fn(state) {\n      var _state$middlewareData, _state$middlewareData2;\n      const {\n        placement,\n        rects,\n        platform,\n        elements\n      } = state;\n      const {\n        apply = () => {},\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const side = getSide(placement);\n      const alignment = getAlignment(placement);\n      const isYAxis = getSideAxis(placement) === 'y';\n      const {\n        width,\n        height\n      } = rects.floating;\n      let heightSide;\n      let widthSide;\n      if (side === 'top' || side === 'bottom') {\n        heightSide = side;\n        widthSide = alignment === ((await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating))) ? 'start' : 'end') ? 'left' : 'right';\n      } else {\n        widthSide = side;\n        heightSide = alignment === 'end' ? 'top' : 'bottom';\n      }\n      const maximumClippingHeight = height - overflow.top - overflow.bottom;\n      const maximumClippingWidth = width - overflow.left - overflow.right;\n      const overflowAvailableHeight = min(height - overflow[heightSide], maximumClippingHeight);\n      const overflowAvailableWidth = min(width - overflow[widthSide], maximumClippingWidth);\n      const noShift = !state.middlewareData.shift;\n      let availableHeight = overflowAvailableHeight;\n      let availableWidth = overflowAvailableWidth;\n      if ((_state$middlewareData = state.middlewareData.shift) != null && _state$middlewareData.enabled.x) {\n        availableWidth = maximumClippingWidth;\n      }\n      if ((_state$middlewareData2 = state.middlewareData.shift) != null && _state$middlewareData2.enabled.y) {\n        availableHeight = maximumClippingHeight;\n      }\n      if (noShift && !alignment) {\n        const xMin = max(overflow.left, 0);\n        const xMax = max(overflow.right, 0);\n        const yMin = max(overflow.top, 0);\n        const yMax = max(overflow.bottom, 0);\n        if (isYAxis) {\n          availableWidth = width - 2 * (xMin !== 0 || xMax !== 0 ? xMin + xMax : max(overflow.left, overflow.right));\n        } else {\n          availableHeight = height - 2 * (yMin !== 0 || yMax !== 0 ? yMin + yMax : max(overflow.top, overflow.bottom));\n        }\n      }\n      await apply({\n        ...state,\n        availableWidth,\n        availableHeight\n      });\n      const nextDimensions = await platform.getDimensions(elements.floating);\n      if (width !== nextDimensions.width || height !== nextDimensions.height) {\n        return {\n          reset: {\n            rects: true\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\nexport { arrow, autoPlacement, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, shift, size };\n", "function hasWindow() {\n  return typeof window !== 'undefined';\n}\nfunction getNodeName(node) {\n  if (isNode(node)) {\n    return (node.nodeName || '').toLowerCase();\n  }\n  // Mocked nodes in testing environments may not be instances of Node. By\n  // returning `#document` an infinite loop won't occur.\n  // https://github.com/floating-ui/floating-ui/issues/2317\n  return '#document';\n}\nfunction getWindow(node) {\n  var _node$ownerDocument;\n  return (node == null || (_node$ownerDocument = node.ownerDocument) == null ? void 0 : _node$ownerDocument.defaultView) || window;\n}\nfunction getDocumentElement(node) {\n  var _ref;\n  return (_ref = (isNode(node) ? node.ownerDocument : node.document) || window.document) == null ? void 0 : _ref.documentElement;\n}\nfunction isNode(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof Node || value instanceof getWindow(value).Node;\n}\nfunction isElement(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof Element || value instanceof getWindow(value).Element;\n}\nfunction isHTMLElement(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof HTMLElement || value instanceof getWindow(value).HTMLElement;\n}\nfunction isShadowRoot(value) {\n  if (!hasWindow() || typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n  return value instanceof ShadowRoot || value instanceof getWindow(value).ShadowRoot;\n}\nfunction isOverflowElement(element) {\n  const {\n    overflow,\n    overflowX,\n    overflowY,\n    display\n  } = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden|clip/.test(overflow + overflowY + overflowX) && !['inline', 'contents'].includes(display);\n}\nfunction isTableElement(element) {\n  return ['table', 'td', 'th'].includes(getNodeName(element));\n}\nfunction isTopLayer(element) {\n  return [':popover-open', ':modal'].some(selector => {\n    try {\n      return element.matches(selector);\n    } catch (e) {\n      return false;\n    }\n  });\n}\nfunction isContainingBlock(elementOrCss) {\n  const webkit = isWebKit();\n  const css = isElement(elementOrCss) ? getComputedStyle(elementOrCss) : elementOrCss;\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  // https://drafts.csswg.org/css-transforms-2/#individual-transforms\n  return ['transform', 'translate', 'scale', 'rotate', 'perspective'].some(value => css[value] ? css[value] !== 'none' : false) || (css.containerType ? css.containerType !== 'normal' : false) || !webkit && (css.backdropFilter ? css.backdropFilter !== 'none' : false) || !webkit && (css.filter ? css.filter !== 'none' : false) || ['transform', 'translate', 'scale', 'rotate', 'perspective', 'filter'].some(value => (css.willChange || '').includes(value)) || ['paint', 'layout', 'strict', 'content'].some(value => (css.contain || '').includes(value));\n}\nfunction getContainingBlock(element) {\n  let currentNode = getParentNode(element);\n  while (isHTMLElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    if (isContainingBlock(currentNode)) {\n      return currentNode;\n    } else if (isTopLayer(currentNode)) {\n      return null;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  return null;\n}\nfunction isWebKit() {\n  if (typeof CSS === 'undefined' || !CSS.supports) return false;\n  return CSS.supports('-webkit-backdrop-filter', 'none');\n}\nfunction isLastTraversableNode(node) {\n  return ['html', 'body', '#document'].includes(getNodeName(node));\n}\nfunction getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}\nfunction getNodeScroll(element) {\n  if (isElement(element)) {\n    return {\n      scrollLeft: element.scrollLeft,\n      scrollTop: element.scrollTop\n    };\n  }\n  return {\n    scrollLeft: element.scrollX,\n    scrollTop: element.scrollY\n  };\n}\nfunction getParentNode(node) {\n  if (getNodeName(node) === 'html') {\n    return node;\n  }\n  const result =\n  // Step into the shadow DOM of the parent of a slotted node.\n  node.assignedSlot ||\n  // DOM Element detected.\n  node.parentNode ||\n  // ShadowRoot detected.\n  isShadowRoot(node) && node.host ||\n  // Fallback.\n  getDocumentElement(node);\n  return isShadowRoot(result) ? result.host : result;\n}\nfunction getNearestOverflowAncestor(node) {\n  const parentNode = getParentNode(node);\n  if (isLastTraversableNode(parentNode)) {\n    return node.ownerDocument ? node.ownerDocument.body : node.body;\n  }\n  if (isHTMLElement(parentNode) && isOverflowElement(parentNode)) {\n    return parentNode;\n  }\n  return getNearestOverflowAncestor(parentNode);\n}\nfunction getOverflowAncestors(node, list, traverseIframes) {\n  var _node$ownerDocument2;\n  if (list === void 0) {\n    list = [];\n  }\n  if (traverseIframes === void 0) {\n    traverseIframes = true;\n  }\n  const scrollableAncestor = getNearestOverflowAncestor(node);\n  const isBody = scrollableAncestor === ((_node$ownerDocument2 = node.ownerDocument) == null ? void 0 : _node$ownerDocument2.body);\n  const win = getWindow(scrollableAncestor);\n  if (isBody) {\n    const frameElement = getFrameElement(win);\n    return list.concat(win, win.visualViewport || [], isOverflowElement(scrollableAncestor) ? scrollableAncestor : [], frameElement && traverseIframes ? getOverflowAncestors(frameElement) : []);\n  }\n  return list.concat(scrollableAncestor, getOverflowAncestors(scrollableAncestor, [], traverseIframes));\n}\nfunction getFrameElement(win) {\n  return win.parent && Object.getPrototypeOf(win.parent) ? win.frameElement : null;\n}\n\nexport { getComputedStyle, getContainingBlock, getDocumentElement, getFrameElement, getNearestOverflowAncestor, getNodeName, getNodeScroll, getOverflowAncestors, getParentNode, getWindow, isContainingBlock, isElement, isHTMLElement, isLastTraversableNode, isNode, isOverflowElement, isShadowRoot, isTableElement, isTopLayer, isWebKit };\n", "import { rectToClientRect, detectOverflow as detectOverflow$1, offset as offset$1, autoPlacement as autoPlacement$1, shift as shift$1, flip as flip$1, size as size$1, hide as hide$1, arrow as arrow$1, inline as inline$1, limitShift as limitShift$1, computePosition as computePosition$1 } from '@floating-ui/core';\nimport { round, createCoords, max, min, floor } from '@floating-ui/utils';\nimport { getComputedStyle, isHTMLElement, isElement, getWindow, isWebKit, getFrameElement, getNodeScroll, getDocumentElement, isTopLayer, getNodeName, isOverflowElement, getOverflowAncestors, getParentNode, isLastTraversableNode, isContainingBlock, isTableElement, getContainingBlock } from '@floating-ui/utils/dom';\nexport { getOverflowAncestors } from '@floating-ui/utils/dom';\n\nfunction getCssDimensions(element) {\n  const css = getComputedStyle(element);\n  // In testing environments, the `width` and `height` properties are empty\n  // strings for SVG elements, returning NaN. Fallback to `0` in this case.\n  let width = parseFloat(css.width) || 0;\n  let height = parseFloat(css.height) || 0;\n  const hasOffset = isHTMLElement(element);\n  const offsetWidth = hasOffset ? element.offsetWidth : width;\n  const offsetHeight = hasOffset ? element.offsetHeight : height;\n  const shouldFallback = round(width) !== offsetWidth || round(height) !== offsetHeight;\n  if (shouldFallback) {\n    width = offsetWidth;\n    height = offsetHeight;\n  }\n  return {\n    width,\n    height,\n    $: shouldFallback\n  };\n}\n\nfunction unwrapElement(element) {\n  return !isElement(element) ? element.contextElement : element;\n}\n\nfunction getScale(element) {\n  const domElement = unwrapElement(element);\n  if (!isHTMLElement(domElement)) {\n    return createCoords(1);\n  }\n  const rect = domElement.getBoundingClientRect();\n  const {\n    width,\n    height,\n    $\n  } = getCssDimensions(domElement);\n  let x = ($ ? round(rect.width) : rect.width) / width;\n  let y = ($ ? round(rect.height) : rect.height) / height;\n\n  // 0, NaN, or Infinity should always fallback to 1.\n\n  if (!x || !Number.isFinite(x)) {\n    x = 1;\n  }\n  if (!y || !Number.isFinite(y)) {\n    y = 1;\n  }\n  return {\n    x,\n    y\n  };\n}\n\nconst noOffsets = /*#__PURE__*/createCoords(0);\nfunction getVisualOffsets(element) {\n  const win = getWindow(element);\n  if (!isWebKit() || !win.visualViewport) {\n    return noOffsets;\n  }\n  return {\n    x: win.visualViewport.offsetLeft,\n    y: win.visualViewport.offsetTop\n  };\n}\nfunction shouldAddVisualOffsets(element, isFixed, floatingOffsetParent) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n  if (!floatingOffsetParent || isFixed && floatingOffsetParent !== getWindow(element)) {\n    return false;\n  }\n  return isFixed;\n}\n\nfunction getBoundingClientRect(element, includeScale, isFixedStrategy, offsetParent) {\n  if (includeScale === void 0) {\n    includeScale = false;\n  }\n  if (isFixedStrategy === void 0) {\n    isFixedStrategy = false;\n  }\n  const clientRect = element.getBoundingClientRect();\n  const domElement = unwrapElement(element);\n  let scale = createCoords(1);\n  if (includeScale) {\n    if (offsetParent) {\n      if (isElement(offsetParent)) {\n        scale = getScale(offsetParent);\n      }\n    } else {\n      scale = getScale(element);\n    }\n  }\n  const visualOffsets = shouldAddVisualOffsets(domElement, isFixedStrategy, offsetParent) ? getVisualOffsets(domElement) : createCoords(0);\n  let x = (clientRect.left + visualOffsets.x) / scale.x;\n  let y = (clientRect.top + visualOffsets.y) / scale.y;\n  let width = clientRect.width / scale.x;\n  let height = clientRect.height / scale.y;\n  if (domElement) {\n    const win = getWindow(domElement);\n    const offsetWin = offsetParent && isElement(offsetParent) ? getWindow(offsetParent) : offsetParent;\n    let currentWin = win;\n    let currentIFrame = getFrameElement(currentWin);\n    while (currentIFrame && offsetParent && offsetWin !== currentWin) {\n      const iframeScale = getScale(currentIFrame);\n      const iframeRect = currentIFrame.getBoundingClientRect();\n      const css = getComputedStyle(currentIFrame);\n      const left = iframeRect.left + (currentIFrame.clientLeft + parseFloat(css.paddingLeft)) * iframeScale.x;\n      const top = iframeRect.top + (currentIFrame.clientTop + parseFloat(css.paddingTop)) * iframeScale.y;\n      x *= iframeScale.x;\n      y *= iframeScale.y;\n      width *= iframeScale.x;\n      height *= iframeScale.y;\n      x += left;\n      y += top;\n      currentWin = getWindow(currentIFrame);\n      currentIFrame = getFrameElement(currentWin);\n    }\n  }\n  return rectToClientRect({\n    width,\n    height,\n    x,\n    y\n  });\n}\n\n// If <html> has a CSS width greater than the viewport, then this will be\n// incorrect for RTL.\nfunction getWindowScrollBarX(element, rect) {\n  const leftScroll = getNodeScroll(element).scrollLeft;\n  if (!rect) {\n    return getBoundingClientRect(getDocumentElement(element)).left + leftScroll;\n  }\n  return rect.left + leftScroll;\n}\n\nfunction getHTMLOffset(documentElement, scroll, ignoreScrollbarX) {\n  if (ignoreScrollbarX === void 0) {\n    ignoreScrollbarX = false;\n  }\n  const htmlRect = documentElement.getBoundingClientRect();\n  const x = htmlRect.left + scroll.scrollLeft - (ignoreScrollbarX ? 0 :\n  // RTL <body> scrollbar.\n  getWindowScrollBarX(documentElement, htmlRect));\n  const y = htmlRect.top + scroll.scrollTop;\n  return {\n    x,\n    y\n  };\n}\n\nfunction convertOffsetParentRelativeRectToViewportRelativeRect(_ref) {\n  let {\n    elements,\n    rect,\n    offsetParent,\n    strategy\n  } = _ref;\n  const isFixed = strategy === 'fixed';\n  const documentElement = getDocumentElement(offsetParent);\n  const topLayer = elements ? isTopLayer(elements.floating) : false;\n  if (offsetParent === documentElement || topLayer && isFixed) {\n    return rect;\n  }\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  let scale = createCoords(1);\n  const offsets = createCoords(0);\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isHTMLElement(offsetParent)) {\n      const offsetRect = getBoundingClientRect(offsetParent);\n      scale = getScale(offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    }\n  }\n  const htmlOffset = documentElement && !isOffsetParentAnElement && !isFixed ? getHTMLOffset(documentElement, scroll, true) : createCoords(0);\n  return {\n    width: rect.width * scale.x,\n    height: rect.height * scale.y,\n    x: rect.x * scale.x - scroll.scrollLeft * scale.x + offsets.x + htmlOffset.x,\n    y: rect.y * scale.y - scroll.scrollTop * scale.y + offsets.y + htmlOffset.y\n  };\n}\n\nfunction getClientRects(element) {\n  return Array.from(element.getClientRects());\n}\n\n// Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable.\nfunction getDocumentRect(element) {\n  const html = getDocumentElement(element);\n  const scroll = getNodeScroll(element);\n  const body = element.ownerDocument.body;\n  const width = max(html.scrollWidth, html.clientWidth, body.scrollWidth, body.clientWidth);\n  const height = max(html.scrollHeight, html.clientHeight, body.scrollHeight, body.clientHeight);\n  let x = -scroll.scrollLeft + getWindowScrollBarX(element);\n  const y = -scroll.scrollTop;\n  if (getComputedStyle(body).direction === 'rtl') {\n    x += max(html.clientWidth, body.clientWidth) - width;\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\nfunction getViewportRect(element, strategy) {\n  const win = getWindow(element);\n  const html = getDocumentElement(element);\n  const visualViewport = win.visualViewport;\n  let width = html.clientWidth;\n  let height = html.clientHeight;\n  let x = 0;\n  let y = 0;\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height;\n    const visualViewportBased = isWebKit();\n    if (!visualViewportBased || visualViewportBased && strategy === 'fixed') {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\n// Returns the inner client rect, subtracting scrollbars if present.\nfunction getInnerBoundingClientRect(element, strategy) {\n  const clientRect = getBoundingClientRect(element, true, strategy === 'fixed');\n  const top = clientRect.top + element.clientTop;\n  const left = clientRect.left + element.clientLeft;\n  const scale = isHTMLElement(element) ? getScale(element) : createCoords(1);\n  const width = element.clientWidth * scale.x;\n  const height = element.clientHeight * scale.y;\n  const x = left * scale.x;\n  const y = top * scale.y;\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\nfunction getClientRectFromClippingAncestor(element, clippingAncestor, strategy) {\n  let rect;\n  if (clippingAncestor === 'viewport') {\n    rect = getViewportRect(element, strategy);\n  } else if (clippingAncestor === 'document') {\n    rect = getDocumentRect(getDocumentElement(element));\n  } else if (isElement(clippingAncestor)) {\n    rect = getInnerBoundingClientRect(clippingAncestor, strategy);\n  } else {\n    const visualOffsets = getVisualOffsets(element);\n    rect = {\n      x: clippingAncestor.x - visualOffsets.x,\n      y: clippingAncestor.y - visualOffsets.y,\n      width: clippingAncestor.width,\n      height: clippingAncestor.height\n    };\n  }\n  return rectToClientRect(rect);\n}\nfunction hasFixedPositionAncestor(element, stopNode) {\n  const parentNode = getParentNode(element);\n  if (parentNode === stopNode || !isElement(parentNode) || isLastTraversableNode(parentNode)) {\n    return false;\n  }\n  return getComputedStyle(parentNode).position === 'fixed' || hasFixedPositionAncestor(parentNode, stopNode);\n}\n\n// A \"clipping ancestor\" is an `overflow` element with the characteristic of\n// clipping (or hiding) child elements. This returns all clipping ancestors\n// of the given element up the tree.\nfunction getClippingElementAncestors(element, cache) {\n  const cachedResult = cache.get(element);\n  if (cachedResult) {\n    return cachedResult;\n  }\n  let result = getOverflowAncestors(element, [], false).filter(el => isElement(el) && getNodeName(el) !== 'body');\n  let currentContainingBlockComputedStyle = null;\n  const elementIsFixed = getComputedStyle(element).position === 'fixed';\n  let currentNode = elementIsFixed ? getParentNode(element) : element;\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  while (isElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    const computedStyle = getComputedStyle(currentNode);\n    const currentNodeIsContaining = isContainingBlock(currentNode);\n    if (!currentNodeIsContaining && computedStyle.position === 'fixed') {\n      currentContainingBlockComputedStyle = null;\n    }\n    const shouldDropCurrentNode = elementIsFixed ? !currentNodeIsContaining && !currentContainingBlockComputedStyle : !currentNodeIsContaining && computedStyle.position === 'static' && !!currentContainingBlockComputedStyle && ['absolute', 'fixed'].includes(currentContainingBlockComputedStyle.position) || isOverflowElement(currentNode) && !currentNodeIsContaining && hasFixedPositionAncestor(element, currentNode);\n    if (shouldDropCurrentNode) {\n      // Drop non-containing blocks.\n      result = result.filter(ancestor => ancestor !== currentNode);\n    } else {\n      // Record last containing block for next iteration.\n      currentContainingBlockComputedStyle = computedStyle;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  cache.set(element, result);\n  return result;\n}\n\n// Gets the maximum area that the element is visible in due to any number of\n// clipping ancestors.\nfunction getClippingRect(_ref) {\n  let {\n    element,\n    boundary,\n    rootBoundary,\n    strategy\n  } = _ref;\n  const elementClippingAncestors = boundary === 'clippingAncestors' ? isTopLayer(element) ? [] : getClippingElementAncestors(element, this._c) : [].concat(boundary);\n  const clippingAncestors = [...elementClippingAncestors, rootBoundary];\n  const firstClippingAncestor = clippingAncestors[0];\n  const clippingRect = clippingAncestors.reduce((accRect, clippingAncestor) => {\n    const rect = getClientRectFromClippingAncestor(element, clippingAncestor, strategy);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromClippingAncestor(element, firstClippingAncestor, strategy));\n  return {\n    width: clippingRect.right - clippingRect.left,\n    height: clippingRect.bottom - clippingRect.top,\n    x: clippingRect.left,\n    y: clippingRect.top\n  };\n}\n\nfunction getDimensions(element) {\n  const {\n    width,\n    height\n  } = getCssDimensions(element);\n  return {\n    width,\n    height\n  };\n}\n\nfunction getRectRelativeToOffsetParent(element, offsetParent, strategy) {\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  const documentElement = getDocumentElement(offsetParent);\n  const isFixed = strategy === 'fixed';\n  const rect = getBoundingClientRect(element, true, isFixed, offsetParent);\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  const offsets = createCoords(0);\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isOffsetParentAnElement) {\n      const offsetRect = getBoundingClientRect(offsetParent, true, isFixed, offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    } else if (documentElement) {\n      // If the <body> scrollbar appears on the left (e.g. RTL systems). Use\n      // Firefox with layout.scrollbar.side = 3 in about:config to test this.\n      offsets.x = getWindowScrollBarX(documentElement);\n    }\n  }\n  const htmlOffset = documentElement && !isOffsetParentAnElement && !isFixed ? getHTMLOffset(documentElement, scroll) : createCoords(0);\n  const x = rect.left + scroll.scrollLeft - offsets.x - htmlOffset.x;\n  const y = rect.top + scroll.scrollTop - offsets.y - htmlOffset.y;\n  return {\n    x,\n    y,\n    width: rect.width,\n    height: rect.height\n  };\n}\n\nfunction isStaticPositioned(element) {\n  return getComputedStyle(element).position === 'static';\n}\n\nfunction getTrueOffsetParent(element, polyfill) {\n  if (!isHTMLElement(element) || getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n  if (polyfill) {\n    return polyfill(element);\n  }\n  let rawOffsetParent = element.offsetParent;\n\n  // Firefox returns the <html> element as the offsetParent if it's non-static,\n  // while Chrome and Safari return the <body> element. The <body> element must\n  // be used to perform the correct calculations even if the <html> element is\n  // non-static.\n  if (getDocumentElement(element) === rawOffsetParent) {\n    rawOffsetParent = rawOffsetParent.ownerDocument.body;\n  }\n  return rawOffsetParent;\n}\n\n// Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\nfunction getOffsetParent(element, polyfill) {\n  const win = getWindow(element);\n  if (isTopLayer(element)) {\n    return win;\n  }\n  if (!isHTMLElement(element)) {\n    let svgOffsetParent = getParentNode(element);\n    while (svgOffsetParent && !isLastTraversableNode(svgOffsetParent)) {\n      if (isElement(svgOffsetParent) && !isStaticPositioned(svgOffsetParent)) {\n        return svgOffsetParent;\n      }\n      svgOffsetParent = getParentNode(svgOffsetParent);\n    }\n    return win;\n  }\n  let offsetParent = getTrueOffsetParent(element, polyfill);\n  while (offsetParent && isTableElement(offsetParent) && isStaticPositioned(offsetParent)) {\n    offsetParent = getTrueOffsetParent(offsetParent, polyfill);\n  }\n  if (offsetParent && isLastTraversableNode(offsetParent) && isStaticPositioned(offsetParent) && !isContainingBlock(offsetParent)) {\n    return win;\n  }\n  return offsetParent || getContainingBlock(element) || win;\n}\n\nconst getElementRects = async function (data) {\n  const getOffsetParentFn = this.getOffsetParent || getOffsetParent;\n  const getDimensionsFn = this.getDimensions;\n  const floatingDimensions = await getDimensionsFn(data.floating);\n  return {\n    reference: getRectRelativeToOffsetParent(data.reference, await getOffsetParentFn(data.floating), data.strategy),\n    floating: {\n      x: 0,\n      y: 0,\n      width: floatingDimensions.width,\n      height: floatingDimensions.height\n    }\n  };\n};\n\nfunction isRTL(element) {\n  return getComputedStyle(element).direction === 'rtl';\n}\n\nconst platform = {\n  convertOffsetParentRelativeRectToViewportRelativeRect,\n  getDocumentElement,\n  getClippingRect,\n  getOffsetParent,\n  getElementRects,\n  getClientRects,\n  getDimensions,\n  getScale,\n  isElement,\n  isRTL\n};\n\nfunction rectsAreEqual(a, b) {\n  return a.x === b.x && a.y === b.y && a.width === b.width && a.height === b.height;\n}\n\n// https://samthor.au/2021/observing-dom/\nfunction observeMove(element, onMove) {\n  let io = null;\n  let timeoutId;\n  const root = getDocumentElement(element);\n  function cleanup() {\n    var _io;\n    clearTimeout(timeoutId);\n    (_io = io) == null || _io.disconnect();\n    io = null;\n  }\n  function refresh(skip, threshold) {\n    if (skip === void 0) {\n      skip = false;\n    }\n    if (threshold === void 0) {\n      threshold = 1;\n    }\n    cleanup();\n    const elementRectForRootMargin = element.getBoundingClientRect();\n    const {\n      left,\n      top,\n      width,\n      height\n    } = elementRectForRootMargin;\n    if (!skip) {\n      onMove();\n    }\n    if (!width || !height) {\n      return;\n    }\n    const insetTop = floor(top);\n    const insetRight = floor(root.clientWidth - (left + width));\n    const insetBottom = floor(root.clientHeight - (top + height));\n    const insetLeft = floor(left);\n    const rootMargin = -insetTop + \"px \" + -insetRight + \"px \" + -insetBottom + \"px \" + -insetLeft + \"px\";\n    const options = {\n      rootMargin,\n      threshold: max(0, min(1, threshold)) || 1\n    };\n    let isFirstUpdate = true;\n    function handleObserve(entries) {\n      const ratio = entries[0].intersectionRatio;\n      if (ratio !== threshold) {\n        if (!isFirstUpdate) {\n          return refresh();\n        }\n        if (!ratio) {\n          // If the reference is clipped, the ratio is 0. Throttle the refresh\n          // to prevent an infinite loop of updates.\n          timeoutId = setTimeout(() => {\n            refresh(false, 1e-7);\n          }, 1000);\n        } else {\n          refresh(false, ratio);\n        }\n      }\n      if (ratio === 1 && !rectsAreEqual(elementRectForRootMargin, element.getBoundingClientRect())) {\n        // It's possible that even though the ratio is reported as 1, the\n        // element is not actually fully within the IntersectionObserver's root\n        // area anymore. This can happen under performance constraints. This may\n        // be a bug in the browser's IntersectionObserver implementation. To\n        // work around this, we compare the element's bounding rect now with\n        // what it was at the time we created the IntersectionObserver. If they\n        // are not equal then the element moved, so we refresh.\n        refresh();\n      }\n      isFirstUpdate = false;\n    }\n\n    // Older browsers don't support a `document` as the root and will throw an\n    // error.\n    try {\n      io = new IntersectionObserver(handleObserve, {\n        ...options,\n        // Handle <iframe>s\n        root: root.ownerDocument\n      });\n    } catch (e) {\n      io = new IntersectionObserver(handleObserve, options);\n    }\n    io.observe(element);\n  }\n  refresh(true);\n  return cleanup;\n}\n\n/**\n * Automatically updates the position of the floating element when necessary.\n * Should only be called when the floating element is mounted on the DOM or\n * visible on the screen.\n * @returns cleanup function that should be invoked when the floating element is\n * removed from the DOM or hidden from the screen.\n * @see https://floating-ui.com/docs/autoUpdate\n */\nfunction autoUpdate(reference, floating, update, options) {\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    ancestorScroll = true,\n    ancestorResize = true,\n    elementResize = typeof ResizeObserver === 'function',\n    layoutShift = typeof IntersectionObserver === 'function',\n    animationFrame = false\n  } = options;\n  const referenceEl = unwrapElement(reference);\n  const ancestors = ancestorScroll || ancestorResize ? [...(referenceEl ? getOverflowAncestors(referenceEl) : []), ...getOverflowAncestors(floating)] : [];\n  ancestors.forEach(ancestor => {\n    ancestorScroll && ancestor.addEventListener('scroll', update, {\n      passive: true\n    });\n    ancestorResize && ancestor.addEventListener('resize', update);\n  });\n  const cleanupIo = referenceEl && layoutShift ? observeMove(referenceEl, update) : null;\n  let reobserveFrame = -1;\n  let resizeObserver = null;\n  if (elementResize) {\n    resizeObserver = new ResizeObserver(_ref => {\n      let [firstEntry] = _ref;\n      if (firstEntry && firstEntry.target === referenceEl && resizeObserver) {\n        // Prevent update loops when using the `size` middleware.\n        // https://github.com/floating-ui/floating-ui/issues/1740\n        resizeObserver.unobserve(floating);\n        cancelAnimationFrame(reobserveFrame);\n        reobserveFrame = requestAnimationFrame(() => {\n          var _resizeObserver;\n          (_resizeObserver = resizeObserver) == null || _resizeObserver.observe(floating);\n        });\n      }\n      update();\n    });\n    if (referenceEl && !animationFrame) {\n      resizeObserver.observe(referenceEl);\n    }\n    resizeObserver.observe(floating);\n  }\n  let frameId;\n  let prevRefRect = animationFrame ? getBoundingClientRect(reference) : null;\n  if (animationFrame) {\n    frameLoop();\n  }\n  function frameLoop() {\n    const nextRefRect = getBoundingClientRect(reference);\n    if (prevRefRect && !rectsAreEqual(prevRefRect, nextRefRect)) {\n      update();\n    }\n    prevRefRect = nextRefRect;\n    frameId = requestAnimationFrame(frameLoop);\n  }\n  update();\n  return () => {\n    var _resizeObserver2;\n    ancestors.forEach(ancestor => {\n      ancestorScroll && ancestor.removeEventListener('scroll', update);\n      ancestorResize && ancestor.removeEventListener('resize', update);\n    });\n    cleanupIo == null || cleanupIo();\n    (_resizeObserver2 = resizeObserver) == null || _resizeObserver2.disconnect();\n    resizeObserver = null;\n    if (animationFrame) {\n      cancelAnimationFrame(frameId);\n    }\n  };\n}\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nconst detectOverflow = detectOverflow$1;\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = offset$1;\n\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = autoPlacement$1;\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = shift$1;\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = flip$1;\n\n/**\n * Provides data that allows you to change the size of the floating element —\n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = size$1;\n\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = hide$1;\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = arrow$1;\n\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = inline$1;\n\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = limitShift$1;\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n */\nconst computePosition = (reference, floating, options) => {\n  // This caches the expensive `getClippingElementAncestors` function so that\n  // multiple lifecycle resets re-use the same result. It only lives for a\n  // single call. If other functions become expensive, we can add them as well.\n  const cache = new Map();\n  const mergedOptions = {\n    platform,\n    ...options\n  };\n  const platformWithCache = {\n    ...mergedOptions.platform,\n    _c: cache\n  };\n  return computePosition$1(reference, floating, {\n    ...mergedOptions,\n    platform: platformWithCache\n  });\n};\n\nexport { arrow, autoPlacement, autoUpdate, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, platform, shift, size };\n", "/**\r\n * TooltipManager - Manages tooltips for checkout elements\r\n * \r\n * This class provides a tooltip system using the floating-ui library.\r\n * It dynamically loads required dependencies and handles tooltip positioning and display.\r\n */\r\n\r\nimport { computePosition, flip, shift, offset, arrow } from '@floating-ui/dom';\r\n\r\nexport class TooltipManager {\r\n  #app;\r\n  #logger;\r\n  #tooltip;\r\n  #arrowElement;\r\n  #textContainer;\r\n  #currentElement = null;\r\n  #showTimeout = null;\r\n  #hideTimeout = null;\r\n  #initialized = false;\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('TOOLTIP');\r\n    \r\n    this.#init();\r\n    this.#logger.info('TooltipManager initialized');\r\n  }\r\n\r\n  /**\r\n   * Initialize the tooltip system\r\n   */\r\n  #init() {\r\n    if (this.#initialized) return;\r\n    \r\n    this.#tooltip = this.#createTooltip();\r\n    this.#arrowElement = this.#tooltip.querySelector('#checkout-tooltip-arrow');\r\n    this.#textContainer = this.#tooltip.querySelector('#checkout-tooltip-text');\r\n    \r\n    this.#setupEventListeners();\r\n    this.#initialized = true;\r\n    this.#logger.info('Tooltip system initialized with floating-ui');\r\n  }\r\n\r\n  /**\r\n   * Create the tooltip element\r\n   */\r\n  #createTooltip() {\r\n    // Check if tooltip already exists\r\n    const existingTooltip = document.getElementById('checkout-tooltip');\r\n    if (existingTooltip) return existingTooltip;\r\n    \r\n    const tooltip = document.createElement('div');\r\n    tooltip.setAttribute('role', 'tooltip');\r\n    tooltip.id = 'checkout-tooltip';\r\n    tooltip.style.display = 'none';\r\n    \r\n    // Create text container\r\n    const textContainer = document.createElement('div');\r\n    textContainer.id = 'checkout-tooltip-text';\r\n    tooltip.appendChild(textContainer);\r\n    \r\n    // Create arrow element\r\n    const arrowElement = document.createElement('div');\r\n    arrowElement.id = 'checkout-tooltip-arrow';\r\n    tooltip.appendChild(arrowElement);\r\n    \r\n    document.body.appendChild(tooltip);\r\n    return tooltip;\r\n  }\r\n\r\n  /**\r\n   * Set up event listeners for tooltips\r\n   */\r\n  #setupEventListeners() {\r\n    // Event delegation for better performance\r\n    document.addEventListener('mouseover', (e) => {\r\n      const element = e.target.closest('[data-os-tooltip]');\r\n      if (!element) return;\r\n\r\n      clearTimeout(this.#showTimeout);\r\n      this.#showTimeout = setTimeout(() => {\r\n        this.#showTooltip(element);\r\n      }, 200);\r\n    });\r\n\r\n    document.addEventListener('mouseout', (e) => {\r\n      const element = e.target.closest('[data-os-tooltip]');\r\n      if (!element) return;\r\n\r\n      clearTimeout(this.#showTimeout);\r\n      this.#hideTooltip();\r\n    });\r\n\r\n    // Handle focus events for accessibility\r\n    document.addEventListener('focus', (e) => {\r\n      const element = e.target.closest('[data-os-tooltip]');\r\n      if (!element) return;\r\n      this.#showTooltip(element);\r\n    }, true);\r\n\r\n    document.addEventListener('blur', (e) => {\r\n      const element = e.target.closest('[data-os-tooltip]');\r\n      if (!element) return;\r\n      this.#hideTooltip();\r\n    }, true);\r\n\r\n    // Handle escape key\r\n    document.addEventListener('keydown', (e) => {\r\n      if (e.key === 'Escape' && this.#currentElement) {\r\n        this.#hideTooltip();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Show the tooltip for a specific element\r\n   */\r\n  #showTooltip(element) {\r\n    if (!this.#initialized) {\r\n      this.#logger.warn('Cannot show tooltip: system not initialized');\r\n      return;\r\n    }\r\n    \r\n    clearTimeout(this.#hideTimeout);\r\n    this.#currentElement = element;\r\n    \r\n    const text = element.getAttribute('data-os-tooltip');\r\n    const position = element.getAttribute('data-os-tooltip-position') || 'top';\r\n    \r\n    this.#textContainer.textContent = text;\r\n    this.#tooltip.style.display = 'block';\r\n\r\n    computePosition(element, this.#tooltip, {\r\n      placement: position,\r\n      middleware: [\r\n        offset(8),\r\n        flip({\r\n          fallbackPlacements: ['top', 'right', 'bottom', 'left'],\r\n        }),\r\n        shift({ padding: 5 }),\r\n        arrow({ element: this.#arrowElement }),\r\n      ],\r\n    }).then(({ x, y, placement, middlewareData }) => {\r\n      Object.assign(this.#tooltip.style, {\r\n        left: `${x}px`,\r\n        top: `${y}px`,\r\n      });\r\n\r\n      // Arrow positioning\r\n      const { x: arrowX, y: arrowY } = middlewareData.arrow;\r\n      const staticSide = {\r\n        top: 'bottom',\r\n        right: 'left',\r\n        bottom: 'top',\r\n        left: 'right',\r\n      }[placement.split('-')[0]];\r\n\r\n      Object.assign(this.#arrowElement.style, {\r\n        left: arrowX != null ? `${arrowX}px` : '',\r\n        top: arrowY != null ? `${arrowY}px` : '',\r\n        right: '',\r\n        bottom: '',\r\n        [staticSide]: '-4px',\r\n      });\r\n\r\n      requestAnimationFrame(() => {\r\n        this.#tooltip.classList.add('checkout-tooltip-visible');\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Hide the tooltip\r\n   */\r\n  #hideTooltip() {\r\n    if (!this.#tooltip) return;\r\n    \r\n    this.#tooltip.classList.remove('checkout-tooltip-visible');\r\n    this.#hideTimeout = setTimeout(() => {\r\n      if (!this.#tooltip.classList.contains('checkout-tooltip-visible')) {\r\n        this.#tooltip.style.display = 'none';\r\n      }\r\n      this.#currentElement = null;\r\n    }, 200);\r\n  }\r\n} ", "/**\r\n * UpsellManager - Manages post-purchase upsell operations\r\n * \r\n * This class provides functionality for handling post-purchase upsells,\r\n * allowing customers to add additional products to their order.\r\n */\r\n\r\nexport class UpsellManager {\r\n  #app;\r\n  #logger;\r\n  #stateManager;\r\n  #api;\r\n  #upsellElements = {};\r\n  #orderRef = null;\r\n\r\n  constructor(app) {\r\n    this.#app = app;\r\n    this.#logger = app.logger.createModuleLogger('UPSELL');\r\n    this.#stateManager = app.state;\r\n    this.#api = app.api;\r\n    \r\n    this.#init();\r\n    this.#logger.info('UpsellManager initialized');\r\n  }\r\n\r\n  #init() {\r\n    // Check for order reference in URL or sessionStorage\r\n    this.#orderRef = this.#getOrderReferenceId();\r\n    \r\n    if (this.#orderRef) {\r\n      this.#logger.info(`Order reference ID found: ${this.#orderRef}`);\r\n      this.#stateManager.setState('order.ref_id', this.#orderRef);\r\n    } else {\r\n      this.#logger.warn('No order reference ID found, upsell functionality will be limited');\r\n    }\r\n    \r\n    this.#initUpsellElements();\r\n    this.#bindEvents();\r\n  }\r\n  \r\n  /**\r\n   * Get the order reference ID from URL parameters or sessionStorage\r\n   * @returns {string|null} The order reference ID or null if not found\r\n   */\r\n  #getOrderReferenceId() {\r\n    // Try to get from URL parameters first\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    let refId = urlParams.get('ref_id');\r\n    \r\n    // If not in URL, try sessionStorage\r\n    if (!refId) {\r\n      refId = sessionStorage.getItem('order_ref_id');\r\n      this.#logger.debug('Getting order ref_id from sessionStorage:', refId);\r\n    } else {\r\n      this.#logger.debug('Getting order ref_id from URL parameters:', refId);\r\n      // Save to sessionStorage for future use\r\n      sessionStorage.setItem('order_ref_id', refId);\r\n    }\r\n    \r\n    return refId;\r\n  }\r\n  \r\n  /**\r\n   * Initialize upsell UI elements\r\n   */\r\n  #initUpsellElements() {\r\n    this.#upsellElements = {\r\n      acceptButtons: document.querySelectorAll('[data-os-upsell=\"accept\"]'),\r\n      declineButtons: document.querySelectorAll('[data-os-upsell=\"decline\"]'),\r\n    };\r\n    \r\n    this.#logger.debug(`Found ${this.#upsellElements.acceptButtons.length} accept buttons and ${this.#upsellElements.declineButtons.length} decline buttons`);\r\n  }\r\n  \r\n  /**\r\n   * Bind events to upsell elements\r\n   */\r\n  #bindEvents() {\r\n    // Bind click events to accept buttons\r\n    this.#upsellElements.acceptButtons.forEach(button => {\r\n      button.addEventListener('click', event => {\r\n        event.preventDefault();\r\n        \r\n        const packageId = button.getAttribute('data-os-package-id');\r\n        const quantity = parseInt(button.getAttribute('data-os-quantity') || '1', 10);\r\n        const nextUrl = button.getAttribute('data-os-next-url');\r\n        \r\n        if (!packageId) {\r\n          this.#logger.error('No package ID specified for upsell accept button');\r\n          return;\r\n        }\r\n        \r\n        this.acceptUpsell(packageId, quantity, nextUrl);\r\n      });\r\n    });\r\n    \r\n    // Bind click events to decline buttons\r\n    this.#upsellElements.declineButtons.forEach(button => {\r\n      button.addEventListener('click', event => {\r\n        event.preventDefault();\r\n        \r\n        const nextUrl = button.getAttribute('data-os-next-url');\r\n        if (nextUrl) {\r\n          this.declineUpsell(nextUrl);\r\n        } else {\r\n          this.#logger.error('No next URL specified for upsell decline button');\r\n        }\r\n      });\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Accept an upsell offer by adding the product to the order\r\n   * @param {string|number} packageId - The package ID to add to the order\r\n   * @param {number} quantity - The quantity to add (default: 1)\r\n   * @param {string} nextUrl - The URL to redirect to after adding the upsell\r\n   */\r\n  async acceptUpsell(packageId, quantity = 1, nextUrl) {\r\n    if (!this.#orderRef) {\r\n      this.#logger.error('Cannot accept upsell: No order reference ID found');\r\n      return;\r\n    }\r\n    \r\n    this.#logger.info(`Accepting upsell: Package ${packageId}, Quantity ${quantity}`);\r\n    \r\n    // Disable all upsell buttons to prevent multiple clicks\r\n    this.#disableUpsellButtons();\r\n    \r\n    try {\r\n      // Show loading state\r\n      document.body.classList.add('os-loading');\r\n      \r\n      // Create the upsell data\r\n      const upsellData = {\r\n        lines: [{\r\n          package_id: Number(packageId),\r\n          quantity: Number(quantity),\r\n          is_upsell: true\r\n        }]\r\n      };\r\n      \r\n      // Call the API to add the upsell\r\n      const response = await this.#api.createOrderUpsell(this.#orderRef, upsellData);\r\n      this.#logger.info('Upsell successfully added to order', response);\r\n      \r\n      // Store upsell information in sessionStorage for tracking on the next page\r\n      this.#storeUpsellPurchaseData(response, packageId, quantity);\r\n      \r\n      // Redirect to the next page\r\n      this.#redirect(nextUrl);\r\n    } catch (error) {\r\n      this.#logger.error('Error accepting upsell:', error);\r\n      document.body.classList.remove('os-loading');\r\n      \r\n      // Re-enable buttons in case of error\r\n      this.#enableUpsellButtons();\r\n      \r\n      // Display error to user\r\n      this.#displayError('There was an error processing your upsell. Please try again.');\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Store upsell data in sessionStorage to track as a purchase event on next page load\r\n   * @param {Object} response - API response from createOrderUpsell\r\n   * @param {string|number} packageId - The package ID added to the order\r\n   * @param {number} quantity - The quantity added\r\n   */\r\n  #storeUpsellPurchaseData(response, packageId, quantity) {\r\n    try {\r\n      // Get the campaign data to find the package details\r\n      const campaignData = this.#app.getCampaignData();\r\n      if (!campaignData || !campaignData.packages) {\r\n        this.#logger.warn('Campaign data not available for upsell tracking');\r\n        return;\r\n      }\r\n      \r\n      // Find the package that was added as an upsell\r\n      const packageData = campaignData.packages.find(pkg => \r\n        pkg.ref_id.toString() === packageId.toString() || \r\n        pkg.external_id?.toString() === packageId.toString()\r\n      );\r\n      \r\n      if (!packageData) {\r\n        this.#logger.warn(`Package data not found for upsell tracking: ${packageId}`);\r\n        return;\r\n      }\r\n      \r\n      // Store minimal order data needed for the purchase event\r\n      const upsellPurchaseData = {\r\n        number: response.number || response.ref_id,\r\n        ref_id: response.ref_id,\r\n        total: parseFloat(packageData.price) * quantity,\r\n        currency: campaignData.currency || 'USD',\r\n        lines: [{\r\n          product_id: packageData.external_id || packageData.ref_id,\r\n          product_title: packageData.name,\r\n          price: parseFloat(packageData.price),\r\n          quantity: quantity,\r\n          is_upsell: true\r\n        }]\r\n      };\r\n      \r\n      // Store data in sessionStorage with a flag indicating it's an upsell purchase\r\n      sessionStorage.setItem('pending_upsell_purchase', 'true');\r\n      sessionStorage.setItem('upsell_purchase_data', JSON.stringify(upsellPurchaseData));\r\n      \r\n      this.#logger.info('Stored upsell purchase data for tracking on next page load', upsellPurchaseData);\r\n    } catch (error) {\r\n      this.#logger.error('Error storing upsell purchase data:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Decline an upsell offer and redirect to the next URL\r\n   * @param {string} nextUrl - The URL to redirect to\r\n   */\r\n  declineUpsell(nextUrl) {\r\n    this.#logger.info('Declining upsell offer');\r\n    \r\n    // Disable all upsell buttons to prevent multiple clicks\r\n    this.#disableUpsellButtons();\r\n    \r\n    this.#redirect(nextUrl);\r\n  }\r\n  \r\n  /**\r\n   * Disable all upsell buttons to prevent multiple clicks\r\n   */\r\n  #disableUpsellButtons() {\r\n    this.#logger.debug('Disabling upsell buttons');\r\n    \r\n    // Disable all accept buttons\r\n    this.#upsellElements.acceptButtons.forEach(button => {\r\n      button.style.pointerEvents = 'none';\r\n      button.classList.add('os-button-disabled');\r\n    });\r\n    \r\n    // Disable all decline buttons\r\n    this.#upsellElements.declineButtons.forEach(button => {\r\n      button.style.pointerEvents = 'none';\r\n      button.classList.add('os-button-disabled');\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Re-enable all upsell buttons (used in case of error)\r\n   */\r\n  #enableUpsellButtons() {\r\n    this.#logger.debug('Re-enabling upsell buttons');\r\n    \r\n    // Re-enable all accept buttons\r\n    this.#upsellElements.acceptButtons.forEach(button => {\r\n      button.style.pointerEvents = '';\r\n      button.classList.remove('os-button-disabled');\r\n    });\r\n    \r\n    // Re-enable all decline buttons\r\n    this.#upsellElements.declineButtons.forEach(button => {\r\n      button.style.pointerEvents = '';\r\n      button.classList.remove('os-button-disabled');\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Redirect to a URL, appending the order reference ID if needed\r\n   * @param {string} url - The URL to redirect to\r\n   */\r\n  #redirect(url) {\r\n    if (!url) {\r\n      this.#logger.warn('No URL provided for redirect');\r\n      return;\r\n    }\r\n    \r\n    const redirectUrl = new URL(url, window.location.origin);\r\n    \r\n    // Append the order reference ID if not already in the URL\r\n    if (this.#orderRef && !redirectUrl.searchParams.has('ref_id')) {\r\n      redirectUrl.searchParams.append('ref_id', this.#orderRef);\r\n    }\r\n    \r\n    this.#logger.info(`Redirecting to ${redirectUrl.href}`);\r\n    window.location.href = redirectUrl.href;\r\n  }\r\n  \r\n  /**\r\n   * Display an error message to the user\r\n   * @param {string} message - The error message to display\r\n   */\r\n  #displayError(message) {\r\n    const errorContainer = document.querySelector('[data-os-error-container]');\r\n    if (errorContainer) {\r\n      errorContainer.textContent = message;\r\n      errorContainer.style.display = 'block';\r\n    } else {\r\n      alert(message);\r\n    }\r\n  }\r\n} ", "/**\r\n * PBAccordion utility\r\n * \r\n * Handles accordion UI components marked with pb-component=\"accordion\"\r\n */\r\n\r\nexport class PBAccordion {\r\n  constructor() {\r\n    this.cleanupInitialState();\r\n    this.init();\r\n  }\r\n\r\n  cleanupInitialState() {\r\n    document.querySelectorAll('[pb-component=\"accordion\"]').forEach(accordion => {\r\n      const group = accordion.querySelector('[pb-accordion-element=\"group\"]');\r\n      if (!group) return;\r\n\r\n      const items = group.querySelectorAll('[pb-accordion-element=\"accordion\"]');\r\n      items.forEach(item => {\r\n        const content = item.querySelector('[pb-accordion-element=\"content\"]');\r\n        const trigger = item.querySelector('[pb-accordion-element=\"trigger\"]');\r\n        const arrow = item.querySelector('[pb-accordion-element=\"arrow\"]');\r\n        const plus = item.querySelector('[pb-accordion-element=\"plus\"]');\r\n        \r\n        if (content) {\r\n          content.style.maxHeight = '0';\r\n          content.style.opacity = '0';\r\n          content.style.visibility = 'hidden';\r\n          content.style.display = 'none';\r\n        }\r\n        if (trigger) trigger.setAttribute('aria-expanded', 'false');\r\n        \r\n        item.classList.remove('is-active-accordion');\r\n        content?.classList.remove('is-active-accordion');\r\n        if (arrow) arrow.classList.remove('is-active-accordion');\r\n        if (plus) plus.classList.remove('is-active-accordion');\r\n      });\r\n\r\n      const initial = group.getAttribute('pb-accordion-initial');\r\n      if (initial && initial !== 'none') {\r\n        const initialItem = items[parseInt(initial) - 1];\r\n        if (initialItem) {\r\n          this.openAccordion(initialItem);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  init() {\r\n    document.querySelectorAll('[pb-component=\"accordion\"]').forEach(accordion => {\r\n      const group = accordion.querySelector('[pb-accordion-element=\"group\"]');\r\n      if (!group) return;\r\n      group.addEventListener('click', (e) => this.handleClick(e, group));\r\n    });\r\n  }\r\n\r\n  handleClick(event, group) {\r\n    const accordionItem = event.target.closest('[pb-accordion-element=\"accordion\"]');\r\n    if (!accordionItem) return;\r\n\r\n    const isOpen = accordionItem.classList.contains('is-active-accordion');\r\n    const isSingle = group.getAttribute('pb-accordion-single') === 'true';\r\n\r\n    if (isSingle) {\r\n      group.querySelectorAll('[pb-accordion-element=\"accordion\"]').forEach(item => {\r\n        if (item !== accordionItem && item.classList.contains('is-active-accordion')) {\r\n          this.closeAccordion(item);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (isOpen) {\r\n      this.closeAccordion(accordionItem);\r\n    } else {\r\n      this.openAccordion(accordionItem);\r\n    }\r\n  }\r\n\r\n  openAccordion(item) {\r\n    const trigger = item.querySelector('[pb-accordion-element=\"trigger\"]');\r\n    const content = item.querySelector('[pb-accordion-element=\"content\"]');\r\n    const arrow = item.querySelector('[pb-accordion-element=\"arrow\"]');\r\n    const plus = item.querySelector('[pb-accordion-element=\"plus\"]');\r\n\r\n    content.style.visibility = 'visible';\r\n    content.style.display = 'block';\r\n    \r\n    content.offsetHeight;\r\n\r\n    const contentHeight = content.scrollHeight;\r\n    \r\n    requestAnimationFrame(() => {\r\n      content.style.maxHeight = `${contentHeight}px`;\r\n      content.style.opacity = '1';\r\n      trigger.setAttribute('aria-expanded', 'true');\r\n      item.classList.add('is-active-accordion');\r\n      content.classList.add('is-active-accordion');\r\n      if (arrow) arrow.classList.add('is-active-accordion');\r\n      if (plus) plus.classList.add('is-active-accordion');\r\n    });\r\n\r\n    content.addEventListener('transitionend', () => {\r\n      if (item.classList.contains('is-active-accordion')) {\r\n        content.style.maxHeight = 'none';\r\n      }\r\n    }, { once: true });\r\n  }\r\n\r\n  closeAccordion(item) {\r\n    const trigger = item.querySelector('[pb-accordion-element=\"trigger\"]');\r\n    const content = item.querySelector('[pb-accordion-element=\"content\"]');\r\n    const arrow = item.querySelector('[pb-accordion-element=\"arrow\"]');\r\n    const plus = item.querySelector('[pb-accordion-element=\"plus\"]');\r\n\r\n    content.style.maxHeight = `${content.scrollHeight}px`;\r\n    content.style.display = 'block';\r\n\r\n    content.offsetHeight;\r\n\r\n    requestAnimationFrame(() => {\r\n      content.style.maxHeight = '0';\r\n      content.style.opacity = '0';\r\n      trigger.setAttribute('aria-expanded', 'false');\r\n      item.classList.remove('is-active-accordion');\r\n      content.classList.remove('is-active-accordion');\r\n      if (arrow) arrow.classList.remove('is-active-accordion');\r\n      if (plus) plus.classList.remove('is-active-accordion');\r\n    });\r\n\r\n    content.addEventListener('transitionend', () => {\r\n      if (!item.classList.contains('is-active-accordion')) {\r\n        content.style.visibility = 'hidden';\r\n        content.style.display = 'none';\r\n      }\r\n    }, { once: true });\r\n  }\r\n}\r\n\r\n/**\r\n * Initialize PBAccordion if accordion elements exist on the page\r\n */\r\nexport const initPBAccordion = () => {\r\n  if (document.querySelector('[pb-component=\"accordion\"]')) {\r\n    return new PBAccordion();\r\n  }\r\n  return null;\r\n}; ", "/**\r\n * UTM Parameter Transfer Utility\r\n * \r\n * This utility automatically adds the current URL's query parameters (UTM and others)\r\n * to all links on a page when they are clicked.\r\n * \r\n * Configuration via window.osConfig.utmTransfer = {\r\n *   enabled: true,                 // Whether to enable UTM transfer\r\n *   applyToExternalLinks: false,   // Whether to apply to external links\r\n *   excludedDomains: [],           // Domains to exclude from parameter transfer\r\n *   paramsToCopy: []               // Specific params to copy (empty = all params)\r\n * }\r\n */\r\n\r\nclass UtmTransfer {\r\n  constructor() {\r\n    this.config = {\r\n      enabled: true,\r\n      applyToExternalLinks: false,\r\n      excludedDomains: [],\r\n      paramsToCopy: []\r\n    };\r\n    \r\n    // Load configuration\r\n    this.loadConfig();\r\n  }\r\n  \r\n  loadConfig() {\r\n    if (window.osConfig && window.osConfig.utmTransfer) {\r\n      this.config = {\r\n        ...this.config,\r\n        ...window.osConfig.utmTransfer\r\n      };\r\n    }\r\n    \r\n    // Ensure paramsToCopy is valid\r\n    if (this.config.paramsToCopy === null || this.config.paramsToCopy === undefined) {\r\n      this.config.paramsToCopy = [];\r\n    }\r\n    \r\n    console.log('UTM Transfer: Initialized with config', JSON.stringify(this.config));\r\n  }\r\n  \r\n  // Initialize the UTM transfer feature\r\n  init() {\r\n    if (!this.config.enabled) {\r\n      console.log('UTM Transfer: Disabled by configuration');\r\n      return;\r\n    }\r\n    \r\n    // Get current URL search parameters\r\n    const currentParams = new URLSearchParams(window.location.search);\r\n    \r\n    // Skip if no parameters exist\r\n    if (currentParams.toString() === '') {\r\n      console.log('UTM Transfer: No URL parameters to transfer');\r\n      return;\r\n    }\r\n    \r\n    // Log all available parameters\r\n    const availableParams = [];\r\n    currentParams.forEach((value, key) => {\r\n      availableParams.push(`${key}=${value}`);\r\n    });\r\n    console.log(`UTM Transfer: Available parameters: ${availableParams.join(', ')}`);\r\n    \r\n    // Filter parameters if specific ones are specified\r\n    let paramsToApply = currentParams;\r\n    \r\n    // Only filter if paramsToCopy is explicitly provided and has items\r\n    if (Array.isArray(this.config.paramsToCopy) && this.config.paramsToCopy.length > 0) {\r\n      console.log(`UTM Transfer: Filtering to specific parameters: ${this.config.paramsToCopy.join(', ')}`);\r\n      \r\n      paramsToApply = new URLSearchParams();\r\n      this.config.paramsToCopy.forEach(param => {\r\n        if (currentParams.has(param)) {\r\n          paramsToApply.append(param, currentParams.get(param));\r\n          console.log(`UTM Transfer: Found parameter to copy: ${param}=${currentParams.get(param)}`);\r\n        }\r\n      });\r\n      \r\n      // Skip if no matching parameters\r\n      if (paramsToApply.toString() === '') {\r\n        console.log('UTM Transfer: No matching parameters to transfer');\r\n        return;\r\n      }\r\n    } else {\r\n      console.log('UTM Transfer: No specific parameters configured, will copy all parameters');\r\n    }\r\n    \r\n    // Get all anchor elements on the page\r\n    const links = document.querySelectorAll('a');\r\n    console.log(`UTM Transfer: Found ${links.length} links on the page`);\r\n    \r\n    // For each link\r\n    links.forEach(link => {\r\n      // Add click event listener\r\n      link.addEventListener('click', event => {\r\n        this.applyParamsToLink(link, paramsToApply);\r\n      });\r\n    });\r\n    \r\n    console.log('UTM Transfer: Event listeners attached to links');\r\n  }\r\n  \r\n  // Apply parameters to a specific link\r\n  applyParamsToLink(linkElement, params = null) {\r\n    if (!linkElement || !linkElement.getAttribute) {\r\n      console.error('UTM Transfer: Invalid link element provided');\r\n      return;\r\n    }\r\n    \r\n    // Get the href attribute\r\n    let href = linkElement.getAttribute('href');\r\n    if (!href) return;\r\n    \r\n    // Skip special links\r\n    if (href.startsWith('#') || \r\n        href.startsWith('javascript:') || \r\n        href.startsWith('mailto:') || \r\n        href.startsWith('tel:')) {\r\n      return;\r\n    }\r\n    \r\n    // Handle external links\r\n    const isExternalLink = href.includes('://') && !href.includes(window.location.hostname);\r\n    if (isExternalLink) {\r\n      // Skip external links if not configured to apply to them\r\n      if (!this.config.applyToExternalLinks) {\r\n        return;\r\n      }\r\n      \r\n      // Check excluded domains\r\n      if (this.config.excludedDomains && this.config.excludedDomains.length > 0) {\r\n        for (const domain of this.config.excludedDomains) {\r\n          if (href.includes(domain)) {\r\n            return; // Skip excluded domains\r\n          }\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Use provided params or get current ones\r\n    const paramsToApply = params || new URLSearchParams(window.location.search);\r\n    if (paramsToApply.toString() === '') {\r\n      return; // No parameters to apply\r\n    }\r\n    \r\n    // Parse the link's URL\r\n    let url;\r\n    try {\r\n      // Handle relative URLs\r\n      url = new URL(href, window.location.origin);\r\n    } catch (e) {\r\n      console.error('UTM Transfer: Invalid URL:', href);\r\n      return;\r\n    }\r\n    \r\n    // Get existing parameters in the link\r\n    const linkParams = new URLSearchParams(url.search);\r\n    \r\n    // Add current page parameters, without overriding existing ones\r\n    paramsToApply.forEach((value, key) => {\r\n      if (!linkParams.has(key)) {\r\n        linkParams.append(key, value);\r\n      }\r\n    });\r\n    \r\n    // Update the link's search parameters\r\n    url.search = linkParams.toString();\r\n    \r\n    // Update the href attribute\r\n    linkElement.setAttribute('href', url.toString());\r\n    \r\n    // Log if in debug mode\r\n    if (this.config.debug) {\r\n      console.log(`UTM Transfer: Updated link ${href} to ${url.toString()}`);\r\n    }\r\n  }\r\n}\r\n\r\n// Export a function to initialize the UTM transfer\r\nexport const initUtmTransfer = () => {\r\n  const utmTransfer = new UtmTransfer();\r\n  utmTransfer.init();\r\n  \r\n  // Also expose for manual use\r\n  return utmTransfer;\r\n}; ", "/**\r\n * TwentyNineNext - Core class for 29next client\r\n * \r\n * This is a streamlined version focused primarily on checkout functionality.\r\n */\r\n\r\nimport { ApiClient } from '../api/ApiClient.js';\r\nimport { Logger } from '../utils/Logger.js';\r\nimport { CheckoutPage } from '../managers/CheckoutManager.js';\r\nimport { CampaignHelper } from '../helpers/CampaignHelper.js';\r\nimport { StateManager } from '../managers/StateManager.js';\r\nimport { CartManager } from '../managers/CartManager.js';\r\nimport { SelectorManager } from '../managers/SelectorManager.js';\r\nimport { ToggleManager } from '../managers/ToggleManager.js';\r\nimport { DebugManager } from '../managers/DebugManager.js';\r\nimport { TimerManager } from '../managers/TimerManager.js';\r\nimport { DisplayManager } from '../managers/DisplayManager.js';\r\nimport { CartDisplayManager } from '../managers/CartDisplayManager.js';\r\nimport { AttributionManager } from '../managers/AttributionManager.js';\r\nimport { EventManager } from '../managers/EventManager.js';\r\nimport { TooltipManager } from '../managers/TooltipManager.js';\r\nimport { UpsellManager } from '../managers/UpsellManager.js';\r\nimport { initPBAccordion } from '../utils/PBAccordion.js';\r\nimport { initUtmTransfer } from '../utils/UtmTransfer.js';\r\n\r\nexport class TwentyNineNext {\r\n  #isInitialized = false;\r\n  #isCheckoutPage = false;\r\n  #campaignData = null;\r\n\r\n  constructor(options = {}) {\r\n    // Get Google Maps config from window.osConfig if available\r\n    const googleMapsConfig = window.osConfig?.googleMaps || {};\r\n    \r\n    this.options = {\r\n      debug: false,\r\n      autoInit: true,\r\n      googleMapsApiKey: googleMapsConfig.apiKey || 'YOUR_API_KEY_HERE',\r\n      googleMapsRegion: googleMapsConfig.region || 'US',\r\n      enableGoogleMapsAutocomplete: googleMapsConfig.enableAutocomplete !== false,\r\n      ...options\r\n    };\r\n    this.logger = new Logger(this.options.debug);\r\n    this.coreLogger = this.logger.createModuleLogger('CORE');\r\n    this.api = new ApiClient(this);\r\n    this.config = this.#loadConfig();\r\n    this.state = new StateManager(this);\r\n    this.attribution = new AttributionManager(this);\r\n    this.cart = new CartManager(this);\r\n    this.campaign = new CampaignHelper(this);\r\n    this.upsell = new UpsellManager(this);\r\n\r\n    // Unified event system\r\n    this.events = {\r\n      on: (event, callback) => this.on(event, callback),\r\n      once: (event, callback) => this.once(event, callback),\r\n      off: (event, callback) => this.off(event, callback),\r\n      trigger: (event, data) => this.triggerEvent(event, data),\r\n    };\r\n\r\n    if (this.options.autoInit) this.init();\r\n  }\r\n\r\n  // Event Listeners using DOM events\r\n  on(event, callback) {\r\n    const wrappedCallback = (e) => {\r\n      try {\r\n        callback(e.detail);\r\n      } catch (error) {\r\n        this.coreLogger.error(`Error in event callback for \"${event}\":`, error);\r\n      }\r\n    };\r\n    document.addEventListener(`os:${event}`, wrappedCallback);\r\n    this.coreLogger.debug(`Event listener registered for \"${event}\"`);\r\n    return this;\r\n  }\r\n\r\n  once(event, callback) {\r\n    const wrappedCallback = (e) => {\r\n      try {\r\n        callback(e.detail);\r\n      } catch (error) {\r\n        this.coreLogger.error(`Error in one-time event callback for \"${event}\":`, error);\r\n      }\r\n      document.removeEventListener(`os:${event}`, wrappedCallback);\r\n    };\r\n    document.addEventListener(`os:${event}`, wrappedCallback);\r\n    this.coreLogger.debug(`One-time event listener registered for \"${event}\"`);\r\n    return this;\r\n  }\r\n\r\n  off(event, callback) {\r\n    document.removeEventListener(`os:${event}`, callback);\r\n    return this;\r\n  }\r\n\r\n  #loadConfig() {\r\n    const config = { apiKey: null, campaignId: null, debug: this.options.debug };\r\n    const apiKeyMeta = document.querySelector('meta[name=\"os-api-key\"]');\r\n    config.apiKey = apiKeyMeta?.getAttribute('content') ?? null;\r\n    this.coreLogger.info(`API key: ${config.apiKey ? '✓ Set' : '✗ Not set'}`);\r\n\r\n    const campaignIdMeta = document.querySelector('meta[name=\"os-campaign-id\"]');\r\n    config.campaignId = campaignIdMeta?.getAttribute('content') ?? null;\r\n    this.coreLogger.info(`Campaign ID: ${config.campaignId ? '✓ Set' : '✗ Not set'}`);\r\n\r\n    const debugMeta = document.querySelector('meta[name=\"os-debug\"]');\r\n    if (debugMeta?.getAttribute('content') === 'true') {\r\n      config.debug = true;\r\n      this.logger.setDebug(true);\r\n      this.coreLogger.info('Debug mode: ✓ Enabled');\r\n    }\r\n    \r\n    // Initialize the spreedly configuration if present\r\n    this.#initSpreedlyConfig();\r\n    \r\n    return config;\r\n  }\r\n  \r\n  /**\r\n   * Initialize Spreedly configuration from global config\r\n   * This allows users to customize Spreedly iframe behavior\r\n   */\r\n  #initSpreedlyConfig() {\r\n    // Ensure osConfig exists\r\n    window.osConfig = window.osConfig || {};\r\n    \r\n    // If spreedlyConfig doesn't exist, create it with defaults\r\n    if (!window.osConfig.spreedlyConfig) {\r\n      this.coreLogger.debug('Initializing default Spreedly configuration');\r\n      window.osConfig.spreedlyConfig = {\r\n        fieldType: {\r\n          number: 'text',\r\n          cvv: 'text'\r\n        },\r\n        numberFormat: 'prettyFormat',\r\n        placeholder: {\r\n          number: 'Credit Card Number',\r\n          cvv: 'CVV *'\r\n        },\r\n        labels: {\r\n          number: 'Card Number',\r\n          cvv: 'CVV'\r\n        }\r\n        // Other properties will use defaults from SpreedlyManager\r\n      };\r\n    } else {\r\n      this.coreLogger.info('Found custom Spreedly configuration');\r\n    }\r\n  }\r\n\r\n  async #loadGoogleMapsApi() {\r\n    // Skip loading if autocomplete is disabled\r\n    if (!this.options.enableGoogleMapsAutocomplete) {\r\n      this.coreLogger.debug('Google Maps Autocomplete is disabled in configuration');\r\n      return;\r\n    }\r\n    \r\n    if (typeof google !== 'undefined' && typeof google.maps !== 'undefined') {\r\n      this.coreLogger.debug('Google Maps API already loaded');\r\n      return;\r\n    }\r\n\r\n    this.coreLogger.debug('Loading Google Maps API...');\r\n    return new Promise((resolve) => {\r\n      const script = document.createElement('script');\r\n      const regionParam = this.options.googleMapsRegion ? `&region=${this.options.googleMapsRegion}` : '';\r\n      script.src = `https://maps.googleapis.com/maps/api/js?key=${this.options.googleMapsApiKey}&libraries=places${regionParam}`;\r\n      script.async = true;\r\n      script.defer = true;\r\n      script.onload = () => {\r\n        this.coreLogger.debug('Google Maps API loaded successfully');\r\n        resolve();\r\n      };\r\n      script.onerror = () => {\r\n        this.coreLogger.error('Failed to load Google Maps API');\r\n        resolve(); // Resolve to continue initialization\r\n      };\r\n      document.head.appendChild(script);\r\n    });\r\n  }\r\n\r\n  async init() {\r\n    this.coreLogger.info('Initializing 29next client');\r\n    this.api.init();\r\n\r\n    // Ensure window.on29NextReady is an array\r\n    if (typeof window.on29NextReady !== 'undefined' && !Array.isArray(window.on29NextReady)) {\r\n      this.coreLogger.warn('window.on29NextReady is not an array, resetting it');\r\n      window.on29NextReady = [];\r\n    }\r\n\r\n    await this.#fetchCampaignData();\r\n    await this.#loadGoogleMapsApi();\r\n    \r\n    // Initialize managers early\r\n    this.#initializeManagers();\r\n    \r\n    // Check for pending upsell purchases - needs to happen after EventManager is initialized\r\n    await this.#checkForPendingUpsellPurchase();\r\n    \r\n    this.#isCheckoutPage = this.#detectCheckoutPage();\r\n    if (this.#isCheckoutPage) this.#initCheckoutPage();\r\n\r\n    this.#initUIUtilities();\r\n    \r\n    // Check for pending purchase events AFTER EventManager is initialized\r\n    await this.#checkForPendingPurchaseEvents();\r\n\r\n    this.#isInitialized = true;\r\n    this.triggerEvent('initialized', { client: this });\r\n    await this.#finalizeInitialization();\r\n  }\r\n\r\n  async #fetchCampaignData() {\r\n    try {\r\n      this.coreLogger.info('Fetching campaign data...');\r\n      this.#campaignData = await this.api.getCampaign();\r\n      this.#campaignData = this.#campaignData || { packages: [] }; // Ensure packages array\r\n      this.#campaignData.packages = this.#campaignData.packages || [];\r\n      this.campaignData = this.#campaignData;\r\n\r\n      this.coreLogger.info('Campaign data retrieved successfully');\r\n      window.osConfig = window.osConfig || {};\r\n      window.osConfig.campaign = this.#campaignData;\r\n      window.dataLayer = window.dataLayer || [];\r\n      \r\n      // Set the funnel name using campaign data\r\n      if (this.#campaignData.name && this.attribution) {\r\n        // First check for meta tag (higher priority)\r\n        const funnelMetaTag = document.querySelector('meta[name=\"os-tracking-tag\"][data-tag-name=\"funnel_name\"]');\r\n        const funnelName = funnelMetaTag?.getAttribute('data-tag-value') || this.#campaignData.name;\r\n        \r\n        // Use our simplified method to set the funnel name\r\n        this.attribution.setFunnelName(funnelName);\r\n      }\r\n      \r\n      this.triggerEvent('campaign.loaded', { campaign: this.#campaignData });\r\n    } catch (error) {\r\n      this.coreLogger.error('Failed to retrieve campaign data:', error);\r\n      this.#campaignData = {\r\n        name: 'Default Campaign',\r\n        packages: [],\r\n        currency: 'USD',\r\n        locale: 'en-US',\r\n      };\r\n      this.campaignData = this.#campaignData;\r\n    }\r\n  }\r\n\r\n  #initializeManagers() {\r\n    this.selector = new SelectorManager(this);\r\n    this.toggle = new ToggleManager(this);\r\n    this.timer = new TimerManager(this);\r\n    this.display = new DisplayManager(this);\r\n    this.eventManager = new EventManager(this);\r\n    this.tooltip = new TooltipManager(this);\r\n\r\n    if (\r\n      this.#isCheckoutPage ||\r\n      document.querySelector('[data-os-cart=\"line-display\"]') ||\r\n      document.querySelector('[os-cart=\"checkout-summary\"]') ||\r\n      document.querySelector('[data-os-cart-summary=\"grand-total\"]')\r\n    ) {\r\n      this.coreLogger.info('Cart display elements detected, initializing CartDisplayManager');\r\n      this.cartDisplay = new CartDisplayManager(this);\r\n    }\r\n\r\n    this.debug = new DebugManager(this);\r\n\r\n    // Extend events with EventManager methods\r\n    Object.assign(this.events, {\r\n      emit: (event, data) => this.triggerEvent(event, data),\r\n      viewItemList: (data) => this.eventManager.viewItemList(data || this.#campaignData),\r\n      viewItem: (packageData) => this.eventManager.viewItem(packageData),\r\n      addToCart: (cartData) => this.eventManager.addToCart(cartData),\r\n      beginCheckout: () => this.eventManager.beginCheckout(),\r\n      purchase: (orderData, force) => this.eventManager.purchase(orderData, force),\r\n      fireCustomEvent: (eventName, eventData) => this.eventManager.fireCustomEvent(eventName, eventData),\r\n    });\r\n  }\r\n\r\n  async #finalizeInitialization() {\r\n    // Let SelectorManager handle view_item_list event\r\n    // The #triggerViewItemList method in SelectorManager is now responsible for this\r\n    await new Promise((resolve) => setTimeout(resolve, 800)); // Single delay for rendering\r\n    this.#hidePreloader();\r\n  }\r\n\r\n  #hidePreloader() {\r\n    const preloader = document.querySelector('div[os-element=\"preloader\"]');\r\n    if (preloader) {\r\n      this.coreLogger.info('Hiding preloader element');\r\n      preloader.style.transition = 'opacity 0.5s ease';\r\n      preloader.style.opacity = '0';\r\n      preloader.style.pointerEvents = 'none';\r\n      this.coreLogger.debug('Preloader hidden');\r\n    }\r\n  }\r\n\r\n  #detectCheckoutPage() {\r\n    const pageTypeMeta = document.querySelector('meta[name=\"os-page-type\"]');\r\n    const pageType = pageTypeMeta?.getAttribute('content');\r\n    if (pageType === 'checkout' || (!pageType && document.querySelector('form[os-checkout=\"form\"]'))) {\r\n      this.coreLogger.info('Checkout page detected');\r\n      return true;\r\n    }\r\n    if (pageType === 'receipt') {\r\n      this.coreLogger.info('Receipt page detected');\r\n      this.#initReceiptPage();\r\n    }\r\n    if (pageType === 'upsell' || document.querySelector('[data-os-upsell]')) {\r\n      this.coreLogger.info('Upsell page detected');\r\n      this.#initUpsellPage();\r\n    }\r\n    return false;\r\n  }\r\n\r\n  #initCheckoutPage() {\r\n    this.checkout = new CheckoutPage(this.api, this.coreLogger, this);\r\n  }\r\n\r\n  #initReceiptPage() {\r\n    import('../managers/ReceiptManager.js')\r\n      .then((module) => {\r\n        const ReceiptPage = module.ReceiptPage;\r\n        this.receipt = new ReceiptPage(this.api, this.coreLogger, this);\r\n        this.coreLogger.info('Receipt page initialized');\r\n        \r\n        // No need to trigger order.loaded here anymore as it's handled globally\r\n        // by the checkForPendingPurchaseEvents method\r\n      })\r\n      .catch((error) => this.coreLogger.error('Failed to load ReceiptPage module:', error));\r\n  }\r\n\r\n  #initUpsellPage() {\r\n    this.coreLogger.info('Initializing upsell page');\r\n    \r\n    // Make sure the UpsellManager is initialized and available\r\n    if (!this.upsell) {\r\n      this.upsell = new UpsellManager(this);\r\n      this.coreLogger.info('UpsellManager initialized for upsell page');\r\n    }\r\n    \r\n    // Trigger upsell page events\r\n    this.triggerEvent('upsell.pageview', {\r\n      ref_id: new URLSearchParams(window.location.search).get('ref_id') || sessionStorage.getItem('order_ref_id')\r\n    });\r\n    \r\n    // Check if we have a pending upsell purchase from previous page\r\n    const hasPendingUpsell = sessionStorage.getItem('pending_upsell_purchase') === 'true';\r\n    if (hasPendingUpsell) {\r\n      this.coreLogger.info('Found pending upsell purchase, will be tracked by UpsellManager');\r\n    }\r\n  }\r\n\r\n  #initUIUtilities() {\r\n    this.coreLogger.info('Initializing UI utilities');\r\n    try {\r\n      const accordion = initPBAccordion();\r\n      if (accordion) {\r\n        this.pbAccordion = accordion;\r\n        this.coreLogger.info('PBAccordion initialized');\r\n      }\r\n    } catch (error) {\r\n      this.coreLogger.error('Failed to initialize PBAccordion:', error);\r\n    }\r\n    try {\r\n      const utmTransfer = initUtmTransfer();\r\n      if (utmTransfer) {\r\n        this.utmTransfer = utmTransfer;\r\n        this.coreLogger.info('UTM parameter transfer initialized');\r\n      }\r\n    } catch (error) {\r\n      this.coreLogger.error('Failed to initialize UTM transfer:', error);\r\n    }\r\n  }\r\n\r\n  triggerEvent(eventName, detail = {}) {\r\n    this.coreLogger.debug(`Triggering event: ${eventName}`);\r\n    const eventData = { ...detail, timestamp: Date.now(), client: this };\r\n    \r\n    // Debug log to see exact content of event data\r\n    if (eventName === 'order.loaded') {\r\n      this.coreLogger.debug('Event data for order.loaded:', JSON.stringify(eventData, null, 2));\r\n    }\r\n    \r\n    const event = new CustomEvent(`os:${eventName}`, { bubbles: true, cancelable: true, detail: eventData });\r\n    document.dispatchEvent(event);\r\n    return event;\r\n  }\r\n\r\n  getCampaignData() {\r\n    return this.#campaignData;\r\n  }\r\n\r\n  get isInitialized() {\r\n    return this.#isInitialized;\r\n  }\r\n\r\n  get isCheckoutPage() {\r\n    return this.#isCheckoutPage;\r\n  }\r\n\r\n  debugTriggerViewItemList() {\r\n    console.log('🛠️ Manually triggering view_item_list event');\r\n    if (!this.#campaignData) {\r\n      console.error('❌ No campaign data available');\r\n      return { success: false, message: 'No campaign data' };\r\n    }\r\n    if (!this.events.viewItemList) {\r\n      console.error('❌ events.viewItemList not available');\r\n      return { success: false, message: 'Event manager not initialized' };\r\n    }\r\n    window.dataLayer = window.dataLayer || [];\r\n    window.dataLayer.push({ ecommerce: null });\r\n    this.events.viewItemList(this.#campaignData);\r\n    console.log('✅ view_item_list manually triggered');\r\n    return { success: true, message: 'view_item_list event triggered', campaignData: this.#campaignData };\r\n  }\r\n\r\n  isReady() {\r\n    return this.#isInitialized && this.#campaignData !== null && Array.isArray(this.#campaignData.packages);\r\n  }\r\n\r\n  onReady(callback) {\r\n    if (!callback || typeof callback !== 'function') return this;\r\n    if (this.isReady()) {\r\n      try {\r\n        callback(this);\r\n      } catch (error) {\r\n        this.coreLogger.error('Error in onReady callback:', error);\r\n      }\r\n    } else {\r\n      this.once('initialized', () => {\r\n        if (this.isReady()) callback(this);\r\n      });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Check for pending purchase events for orders with ref_id in URL\r\n   */\r\n  async #checkForPendingPurchaseEvents() {\r\n    const refId = new URLSearchParams(window.location.search).get('ref_id');\r\n    if (!refId) return;\r\n    \r\n    this.coreLogger.debug(`Checking for pending purchase events for ref_id: ${refId}`);\r\n    \r\n    // Check if this order has a pending purchase event\r\n    const hasPendingEvent = sessionStorage.getItem(`pending_purchase_event_${refId}`) === 'true';\r\n    \r\n    if (hasPendingEvent) {\r\n      this.coreLogger.info(`Found pending purchase event for order ${refId}`);\r\n      \r\n      // Check if EventManager is initialized before proceeding\r\n      const isEventManagerReady = this.eventManager && this.eventManager.isInitialized;\r\n      this.coreLogger.debug(`EventManager ready: ${isEventManagerReady}`);\r\n      \r\n      if (!isEventManagerReady) {\r\n        this.coreLogger.warn('EventManager not ready yet, will not trigger order.loaded event');\r\n        return;\r\n      }\r\n      \r\n      try {\r\n        const orderData = await this.api.getOrder(refId);\r\n        if (orderData) {\r\n          // Fix: Use the proper data structure expected by EventManager\r\n          // EventManager expects data.order, not data.detail.order\r\n          this.coreLogger.info(`Triggering order.loaded event for pending purchase ${refId}`);\r\n          this.triggerEvent('order.loaded', { order: orderData });\r\n          this.coreLogger.info(`Triggered order.loaded event for pending purchase ${refId}`);\r\n          \r\n          // Clear the pending flag\r\n          sessionStorage.removeItem(`pending_purchase_event_${refId}`);\r\n          this.coreLogger.debug(`Removed pending purchase flag for order ${refId}`);\r\n        } else {\r\n          this.coreLogger.warn(`Could not fetch order data for pending purchase ${refId}`);\r\n        }\r\n      } catch (error) {\r\n        this.coreLogger.error(`Failed to load order data for pending purchase ${refId}:`, error);\r\n      }\r\n    } else {\r\n      this.coreLogger.debug(`No pending purchase event for order ${refId}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check for pending upsell purchases and track them\r\n   * This runs on EVERY page load regardless of page type\r\n   */\r\n  async #checkForPendingUpsellPurchase() {\r\n    try {\r\n      const hasPendingUpsell = sessionStorage.getItem('pending_upsell_purchase') === 'true';\r\n      \r\n      if (hasPendingUpsell) {\r\n        this.coreLogger.info('Found pending upsell purchase, processing tracking event');\r\n        \r\n        const upsellPurchaseData = sessionStorage.getItem('upsell_purchase_data');\r\n        if (upsellPurchaseData) {\r\n          // Parse the stored upsell purchase data\r\n          const purchaseData = JSON.parse(upsellPurchaseData);\r\n          \r\n          // Send the purchase event through EventManager\r\n          if (this.eventManager && typeof this.eventManager.purchase === 'function') {\r\n            this.coreLogger.info('Triggering purchase event for upsell', purchaseData);\r\n            // Force the purchase event to ensure it's tracked even if the main order was already tracked\r\n            this.eventManager.purchase(purchaseData, true);\r\n            \r\n            // Also fire a custom os_accepted_upsell event for additional tracking\r\n            if (typeof this.eventManager.fireCustomEvent === 'function') {\r\n              // Create the custom event data\r\n              const customEventData = {\r\n                transaction_id: purchaseData.number,\r\n                ref_id: purchaseData.ref_id,\r\n                product_id: purchaseData.lines[0]?.product_id,\r\n                product_name: purchaseData.lines[0]?.product_title,\r\n                price: purchaseData.lines[0]?.price,\r\n                quantity: purchaseData.lines[0]?.quantity,\r\n                total: purchaseData.total,\r\n                currency: purchaseData.currency\r\n              };\r\n              \r\n              this.coreLogger.info('Triggering os_accepted_upsell custom event', customEventData);\r\n              this.eventManager.fireCustomEvent('os_accepted_upsell', customEventData);\r\n            }\r\n          } else if (this.events && typeof this.events.purchase === 'function') {\r\n            this.coreLogger.info('Triggering purchase event for upsell via events API', purchaseData);\r\n            this.events.purchase(purchaseData, true);\r\n            \r\n            // Also fire a custom os_accepted_upsell event\r\n            if (typeof this.events.fireCustomEvent === 'function') {\r\n              // Create the custom event data\r\n              const customEventData = {\r\n                transaction_id: purchaseData.number,\r\n                ref_id: purchaseData.ref_id,\r\n                product_id: purchaseData.lines[0]?.product_id,\r\n                product_name: purchaseData.lines[0]?.product_title,\r\n                price: purchaseData.lines[0]?.price,\r\n                quantity: purchaseData.lines[0]?.quantity,\r\n                total: purchaseData.total,\r\n                currency: purchaseData.currency\r\n              };\r\n              \r\n              this.coreLogger.info('Triggering os_accepted_upsell custom event via events API', customEventData);\r\n              this.events.fireCustomEvent('os_accepted_upsell', customEventData);\r\n            }\r\n          } else {\r\n            this.coreLogger.warn('No method available to track upsell purchase');\r\n          }\r\n        }\r\n        \r\n        // Clear the pending upsell purchase flag regardless of tracking success\r\n        sessionStorage.removeItem('pending_upsell_purchase');\r\n        sessionStorage.removeItem('upsell_purchase_data');\r\n        this.coreLogger.debug('Cleared pending upsell purchase data');\r\n      }\r\n    } catch (error) {\r\n      this.coreLogger.error('Error checking for pending upsell purchase:', error);\r\n    }\r\n  }\r\n}"],
  "mappings": "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",
  "names": ["_apiClient", "_logger", "_app", "_initialized", "_debugMode", "_safeLog", "safeLog_fn", "_formatAddress", "formatAddress_fn", "_showError", "showError_fn", "_logger", "_logger", "_form", "_debugMode", "_app", "_logger", "_logger", "_app", "_form", "_debugMode", "_safeLog", "safeLog_fn", "orderData", "_app", "_logger", "_init", "init_fn", "_setupEventListeners", "setupEventListeners_fn", "_logger", "_init", "init_fn", "_logger", "_elements", "_init", "init_fn", "_logger", "_showError", "showError_fn", "_app", "_logger", "_init", "init_fn", "_apiClient", "_logger", "_form", "_app", "_setupEventListeners", "setupEventListeners_fn", "_handleSubmit", "handleSubmit_fn", "_app", "_logger", "_app", "_logger", "_app", "_logger", "price", "_app", "_logger", "_selectors", "_isDebugMode", "_app", "_logger", "_isDebugMode", "_addItemToCart", "addItemToCart_fn", "_removeItemFromCart", "removeItemFromCart_fn", "_app", "_logger", "_isDebugMode", "_init", "init_fn", "_app", "_logger", "_app", "_logger", "_app", "_logger", "_elements", "_config", "_formatPrice", "formatPrice_fn", "_app", "_logger", "_initialized", "_init", "init_fn", "_setupEventListeners", "setupEventListeners_fn", "_app", "_logger", "_debugMode", "_viewItemListFired", "_setupEventListeners", "setupEventListeners_fn", "platform", "platform", "max", "offset", "platform", "placements", "sides", "side", "placement", "overflow", "platform", "x", "y", "min", "max", "offset", "shift", "flip", "arrow", "computePosition", "_app", "_logger", "_initialized", "_init", "init_fn", "_setupEventListeners", "setupEventListeners_fn", "computePosition", "offset", "flip", "shift", "arrow", "_app", "_logger", "_stateManager", "_init", "init_fn", "arrow", "_isInitialized", "_loadConfig", "loadConfig_fn", "ReceiptPage"]
}
