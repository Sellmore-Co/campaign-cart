"use strict";var TwentyNineNext=(()=>{var Wl=Object.defineProperty;var gp=Object.getOwnPropertyDescriptor;var mp=Object.getOwnPropertyNames;var pp=Object.prototype.hasOwnProperty;var fp=(l,t)=>()=>(l&&(t=l(l=0)),t);var ru=(l,t)=>{for(var i in t)Wl(l,i,{get:t[i],enumerable:!0})},yp=(l,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of mp(t))!pp.call(l,r)&&r!==i&&Wl(l,r,{get:()=>t[r],enumerable:!(s=gp(t,r))||s.enumerable});return l};var bp=l=>yp(Wl({},"__esModule",{value:!0}),l);var Hl=(l,t,i)=>{if(!t.has(l))throw TypeError("Cannot "+i)};var e=(l,t,i)=>(Hl(l,t,"read from private field"),i?i.call(l):t.get(l)),o=(l,t,i)=>{if(t.has(l))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(l):t.set(l,i)},u=(l,t,i,s)=>(Hl(l,t,"write to private field"),s?s.call(l,i):t.set(l,i),i);var nu=(l,t,i,s)=>({set _(r){u(l,t,r,i)},get _(){return e(l,t,s)}}),n=(l,t,i)=>(Hl(l,t,"access private method"),i);var Zm={};ru(Zm,{ReceiptPage:()=>Xd});var ks,Ci,Al,T,Zr,Xr,kl,W,J,Tl,Gm,$l,Km,Ll,Ym,Pl,Jm,dt,vt,_i,Jr,Qr,Qd,tn,tu,en,eu,sn,iu,Ts,El,rn,su,Xd,Xm=fp(()=>{"use strict";Xd=class{constructor(t,i,s){o(this,W);o(this,Tl);o(this,$l);o(this,Ll);o(this,Pl);o(this,dt);o(this,_i);o(this,Qr);o(this,tn);o(this,en);o(this,sn);o(this,Ts);o(this,rn);o(this,ks,void 0);o(this,Ci,void 0);o(this,Al,void 0);o(this,T,null);o(this,Zr,!1);o(this,Xr,!1);o(this,kl,!1);u(this,ks,t),u(this,Ci,i),u(this,Al,s);let r=document.querySelector('meta[name="os-debug"]');u(this,kl,r?.getAttribute("content")==="true"),n(this,W,J).call(this,"info","ReceiptPage component created"),this.init()}async init(){if(e(this,Xr)){n(this,W,J).call(this,"info","Receipt page already initialized, skipping");return}n(this,W,J).call(this,"info","Initializing Receipt Page"),u(this,Xr,!0);let i=new URLSearchParams(window.location.search).get("ref_id");if(!i){n(this,W,J).call(this,"error","No ref_id found in URL parameters"),n(this,rn,su).call(this,"Order reference not found. Please check your URL.");return}n(this,W,J).call(this,"info",`Found ref_id in URL: ${i}`);try{await n(this,Tl,Gm).call(this,i),n(this,$l,Km).call(this)}catch(s){n(this,W,J).call(this,"error","Error initializing receipt page:",s),n(this,rn,su).call(this,"Failed to load order details. Please try again later.")}}};ks=new WeakMap,Ci=new WeakMap,Al=new WeakMap,T=new WeakMap,Zr=new WeakMap,Xr=new WeakMap,kl=new WeakMap,W=new WeakSet,J=function(t,i,...s){try{e(this,Ci)&&typeof e(this,Ci)[t]=="function"?e(this,Ci)[t](i,...s):console[t]?console[t](i,...s):(`${t.toUpperCase()}${i}`,[...s])}catch(r){console.error("Error logging message:",r)}},Tl=new WeakSet,Gm=async function(t){if(n(this,W,J).call(this,"info",`Fetching order details for ref_id: ${t}`),e(this,Zr)&&e(this,T))return n(this,W,J).call(this,"info","Order already fetched, using cached data"),e(this,T);try{if(!e(this,ks))throw new Error("API client not available");return n(this,W,J).call(this,"debug","Making API request to fetch order details"),u(this,T,await e(this,ks).getOrder(t)),u(this,Zr,!0),n(this,W,J).call(this,"info","Order details fetched successfully"),n(this,W,J).call(this,"debug","Order data:",e(this,T)),e(this,T)}catch(i){throw n(this,W,J).call(this,"error",`Error fetching order details for ref_id ${t}:`,i),i}},$l=new WeakSet,Km=function(){if(!e(this,T)){n(this,W,J).call(this,"error","No order data available to update receipt content");return}n(this,W,J).call(this,"info","Updating receipt content with order details"),n(this,dt,vt).call(this,"fname",e(this,T).user?.first_name||""),e(this,T).billing_address&&(n(this,dt,vt).call(this,"billing_fname",`${e(this,T).billing_address.first_name} ${e(this,T).billing_address.last_name}`),n(this,dt,vt).call(this,"billing_address",n(this,Qr,Qd).call(this,e(this,T).billing_address)),n(this,dt,vt).call(this,"billing_location",n(this,tn,tu).call(this,e(this,T).billing_address)),n(this,dt,vt).call(this,"billing_country",n(this,en,eu).call(this,e(this,T).billing_address.country)||"")),e(this,T).shipping_address&&(n(this,dt,vt).call(this,"shipping_fname",`${e(this,T).shipping_address.first_name} ${e(this,T).shipping_address.last_name}`),n(this,dt,vt).call(this,"shipping_address",n(this,Qr,Qd).call(this,e(this,T).shipping_address)),n(this,dt,vt).call(this,"shipping_location",n(this,tn,tu).call(this,e(this,T).shipping_address)),n(this,dt,vt).call(this,"shipping_country",n(this,en,eu).call(this,e(this,T).shipping_address.country)||""));let t=n(this,Ll,Ym).call(this);n(this,dt,vt).call(this,"payment_method",t),n(this,Pl,Jm).call(this);let i=e(this,T).shipping_method||"Standard Shipping";n(this,dt,vt).call(this,"shipping-method",i),n(this,dt,vt).call(this,"shipping_method",i);let s=n(this,Ts,El).call(this,parseFloat(e(this,T).total_incl_tax)||0);n(this,dt,vt).call(this,"total",s),n(this,dt,vt).call(this,"order_number",e(this,T).number||""),n(this,dt,vt).call(this,"order_reference",e(this,T).ref_id||""),n(this,W,J).call(this,"info","Receipt content updated successfully")},Ll=new WeakSet,Ym=function(){return e(this,T).payment_detail&&e(this,T).payment_detail.payment_method?n(this,sn,iu).call(this,e(this,T).payment_detail.payment_method):e(this,T).payment_method?n(this,sn,iu).call(this,e(this,T).payment_method):"Credit Card"},Pl=new WeakSet,Jm=function(){if(!e(this,T).lines||!Array.isArray(e(this,T).lines)){n(this,W,J).call(this,"warn","No order lines available");return}let t=document.querySelector('[data-os-receipt="order-lines"]');if(!t){n(this,W,J).call(this,"warn","Order lines container not found in DOM");return}t.innerHTML="";let i=document.querySelector('[data-os-receipt="product-line"]'),s=i?i.outerHTML:`
      <div data-os-receipt="product-line" class="cart-summary__line">
        <div class="cart-summary__line-item">
          <div data-os-receipt="line-title" class="cart-line__title"></div>
          <div data-os-receipt="line-saving" class="cart-line__discount"></div>
        </div>
        <div class="cart-summary__line-item">
          <p data-os-receipt="line-compare" class="pb-cart__line-price pb--compare"></p>
          <p data-os-receipt="line-subtotal" class="pb-cart__line-price"></p>
        </div>
      </div>
    `;e(this,T).lines.forEach(r=>{let a=document.createElement("div");a.innerHTML=s;let c=a.firstElementChild,d=r.product_title||r.title||r.package_title||"Product";if(n(this,_i,Jr).call(this,c,"line-title",d),r.price_excl_tax_excl_discounts&&parseFloat(r.price_excl_tax_excl_discounts)>parseFloat(r.price_excl_tax)){let g=parseFloat(r.price_excl_tax_excl_discounts),m=parseFloat(r.price_excl_tax),p=Math.round((1-m/g)*100);n(this,_i,Jr).call(this,c,"line-saving",`(${p}% OFF)`),n(this,_i,Jr).call(this,c,"line-compare",n(this,Ts,El).call(this,g))}else{let g=c.querySelector('[data-os-receipt="line-saving"]'),m=c.querySelector('[data-os-receipt="line-compare"]');g&&(g.style.display="none"),m&&(m.style.display="none")}let h=parseFloat(r.price_incl_tax)||parseFloat(r.price_excl_tax)||0;n(this,_i,Jr).call(this,c,"line-subtotal",n(this,Ts,El).call(this,h)),t.appendChild(c)})},dt=new WeakSet,vt=function(t,i){let s=document.querySelectorAll(`[data-os-receipt="${t}"]`);if(s.length===0){n(this,W,J).call(this,"debug",`No elements found with data-os-receipt="${t}"`);return}s.forEach(r=>{r.textContent=i})},_i=new WeakSet,Jr=function(t,i,s){let r=t.querySelector(`[data-os-receipt="${i}"]`);if(!r){n(this,W,J).call(this,"debug",`No element found with data-os-receipt="${i}" in node`);return}r.textContent=s},Qr=new WeakSet,Qd=function(t){let i="";return t.line1&&(i+=t.line1),t.line2&&(i+=i?`, ${t.line2}`:t.line2),i},tn=new WeakSet,tu=function(t){let i=[];return t.line4&&i.push(t.line4),t.state&&i.push(t.state),t.postcode&&i.push(t.postcode),i.join(", ")},en=new WeakSet,eu=function(t){return{US:"United States",CA:"Canada",GB:"United Kingdom",AU:"Australia",NZ:"New Zealand"}[t]||t},sn=new WeakSet,iu=function(t){return{card_token:"Credit Card",paypal:"PayPal",apple_pay:"Apple Pay",google_pay:"Google Pay",credit:"Credit Card",card:"Credit Card"}[t]||t},Ts=new WeakSet,El=function(t){let i=e(this,T).currency||"USD",s=parseFloat(t);if(isNaN(s))return n(this,W,J).call(this,"warn",`Invalid amount for currency formatting: ${t}`),`$0.00 ${i}`;try{return new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(s)}catch(r){return n(this,W,J).call(this,"error",`Error formatting currency: ${r}`),`$${s.toFixed(2)} ${i}`}},rn=new WeakSet,su=function(t){n(this,W,J).call(this,"error",`Displaying error message: ${t}`);let i=document.querySelector(".receipt-content")||document.body,s=document.createElement("div");s.className="receipt-error",s.style.color="red",s.style.padding="20px",s.style.margin="20px 0",s.style.border="1px solid red",s.style.borderRadius="5px",s.style.backgroundColor="rgba(255, 0, 0, 0.1)",s.textContent=t,i.prepend(s)}});var Bp={};ru(Bp,{TwentyNineNext:()=>nn});var Ot,me,qs,E,an,ou,Ie,Ti,Fs,jl,on=class{constructor(t){o(this,an);o(this,Ie);o(this,Fs);o(this,Ot,void 0);o(this,me,void 0);o(this,qs,"https://campaigns.apps.29next.com/api/v1");o(this,E,void 0);u(this,Ot,t),u(this,E,t.logger.createModuleLogger("API"))}init(){if(e(this,E).info("Initializing ApiClient"),u(this,me,e(this,Ot).config.apiKey),e(this,me))e(this,E).info("API key is set");else{let s=document.querySelector('meta[name="os-api-key"]');u(this,me,s?.getAttribute("content")),e(this,E).info(e(this,me)?"API key retrieved from meta tag":"API key is not set")}let i=document.querySelector('meta[name="os-proxy-url"]')?.getAttribute("content");i&&(u(this,qs,i),e(this,E).info(`Using proxy URL: ${i}`))}async getCampaign(){try{let t=await n(this,Ie,Ti).call(this,"campaigns/");if(e(this,E).debug("Campaign data received"),Array.isArray(t)&&t.length>0)return t[0];if(t?.name)return t;throw new Error("No valid campaign data found")}catch(t){return e(this,E).error("Error fetching campaign:",t),e(this,E).warn("Using fallback empty campaign object"),{name:"Default Campaign",currency:"USD",packages:[],formatPrice:i=>`$${Number.parseFloat(i).toFixed(2)}`}}}async createCart(t){e(this,E).debug("Creating cart",t),t.attribution?e(this,E).debug("Cart already has attribution data:",t.attribution):(t.attribution=n(this,Fs,jl).call(this),e(this,E).debug("Added attribution data to cart:",t.attribution));try{let i=await n(this,Ie,Ti).call(this,"carts/","POST",t);return e(this,E).info("Cart created successfully",i),i}catch(i){throw e(this,E).error("Error creating cart",i),i}}async createOrder(t){e(this,E).debug("Creating order",t),t.attribution?e(this,E).debug("Order already has attribution data:",t.attribution):(t.attribution=n(this,Fs,jl).call(this),e(this,E).debug("Added attribution data to order:",t.attribution)),(t.payment_token==="test_card"||t.payment_detail&&t.payment_detail.card_token==="test_card")&&(e(this,E).debug("Using test card token for order"),t.payment_detail=t.payment_detail||{},t.payment_detail.payment_method="card_token",t.payment_detail.card_token="test_card",t.payment_token&&delete t.payment_token);try{let i=await n(this,Ie,Ti).call(this,"orders/","POST",t);return e(this,E).info("Order created successfully",i),i.ref_id&&(sessionStorage.setItem("order_ref_id",i.ref_id),e(this,E).debug(`Order reference ID stored: ${i.ref_id}`)),i}catch(i){throw e(this,E).error("Error creating order",i),i}}async getOrder(t){if(!t)throw new Error("Order reference is required");return e(this,E).debug(`Fetching order with ref: ${t}`),n(this,Ie,Ti).call(this,`orders/${t}/`)}async createOrderUpsell(t,i){if(!t)throw new Error("Order reference is required");e(this,E).debug(`Adding upsell to order ref: ${t}`,i);let s={lines:Array.isArray(i.lines)?i.lines:[{package_id:i.package_id,quantity:i.quantity||1}]};i.payment_detail&&(s.payment_detail=i.payment_detail);try{let r=await n(this,Ie,Ti).call(this,`orders/${t}/upsells/`,"POST",s);return e(this,E).info("Upsell added successfully",r),r}catch(r){throw e(this,E).error("Error adding upsell to order",r),r}}async processPayment(t,i){e(this,E).debug(`Processing ${i} payment for order`);let s={credit:"card_token",paypal:"paypal",apple_pay:"apple_pay",google_pay:"google_pay"};if(t.payment_detail=t.payment_detail??{},t.payment_detail.payment_method=s[i]??i,i==="credit"&&!t.payment_detail.card_token)throw new Error("Credit card payment requires a card token");return i!=="credit"&&delete t.payment_detail.card_token,this.createOrder(t)}getNextUrlFromOrderResponse(t,i="/checkout/complete"){e(this,E).debug("Getting next URL for redirect");let s=t.ref_id,r=document.querySelector('meta[name="os-next-page"]'),a=i;if(r?.getAttribute("content")){let g=r.getAttribute("content");e(this,E).debug(`Found meta tag with next page URL: ${g}`);let m=g.startsWith("http")?new URL(g):new URL(g,`${location.protocol}//${location.host}`);return s&&m.searchParams.append("ref_id",s),m.href}if(t.payment_complete_url)return t.payment_complete_url;if(t.order_status_url)return t.order_status_url;let d=location.pathname.split("/").slice(0,-1).join("/"),h=new URL(`${d}${a}`,`${location.protocol}//${location.host}`);return s&&h.searchParams.append("ref_id",s),h.href}};Ot=new WeakMap,me=new WeakMap,qs=new WeakMap,E=new WeakMap,an=new WeakSet,ou=function(t){let i=t.startsWith("/")?t.slice(1):t;return`${e(this,qs)}/${i}`},Ie=new WeakSet,Ti=async function(t,i="GET",s=null){if(!e(this,me)){if(e(this,E).warn("API key is not set"),t==="campaigns/")return e(this,E).info("Returning mock campaign data since API key is not set"),[{name:"Mock Campaign",id:"mock-campaign",currency:"USD",locale:"en-US",packages:[],products:[]}];throw new Error("API key is required")}let r=n(this,an,ou).call(this,t),a={method:i,mode:"cors",credentials:"same-origin",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:e(this,me)}};i!=="GET"&&s&&(a.body=JSON.stringify(s)),e(this,E).debug(`Making ${i} request to ${r}`,i!=="GET"?{requestData:s}:{});try{let c=await fetch(r,a);if(e(this,E).debug(`Received response from ${r} with status ${c.status}`),!c.ok){let h=await c.json().catch(()=>({}));throw e(this,E).error(`API error response from ${r}:`,h),new Error(JSON.stringify(h))}let d=await c.json();return e(this,E).debug(`Successfully processed response from ${r}`),d}catch(c){throw e(this,E).error(`API request failed: ${t}`,c),c.message?.match(/NetworkError|Failed to fetch|Network request failed/)&&e(this,E).warn("This appears to be a CORS issue. Make sure the API endpoint allows cross-origin requests."),c}},Fs=new WeakSet,jl=function(){if(e(this,Ot).attribution)return typeof e(this,Ot).attribution.getAttributionForApi=="function"?e(this,Ot).attribution.getAttributionForApi():e(this,Ot).attribution.getAttributionData();if(e(this,Ot).state){let t=e(this,Ot).state.getState("attribution");return t||e(this,Ot).state.getState("cart.attribution")||{}}return{}};var qe,Fe,$i,ln,au,dn,cu,un,lu,hn,du,gn,uu,mn,hu,pn,gu,fn,mu,cn=class{constructor(t=!1){o(this,ln);o(this,dn);o(this,un);o(this,hn);o(this,gn);o(this,mn);o(this,pn);o(this,fn);o(this,qe,void 0);o(this,Fe,"29next");o(this,$i,0);u(this,qe,t),this.setStartupTime()}setDebug(t){u(this,qe,t)}setStartupTime(){u(this,$i,+new Date),window.twentyNineNextStartupTime=e(this,$i)}getElapsedTime(){return+new Date-e(this,$i)}createModuleLogger(t){let i=`${e(this,Fe)} [${t}]`;return{debug:(...s)=>n(this,hn,du).call(this,i,...s),info:(...s)=>n(this,ln,au).call(this,i,...s),warn:(...s)=>n(this,dn,cu).call(this,i,...s),error:(...s)=>n(this,un,lu).call(this,i,...s),debugWithTime:(...s)=>n(this,fn,mu).call(this,i,...s),infoWithTime:(...s)=>n(this,gn,uu).call(this,i,...s),warnWithTime:(...s)=>n(this,mn,hu).call(this,i,...s),errorWithTime:(...s)=>n(this,pn,gu).call(this,i,...s)}}logWithTime(t,...i){let s=this.getElapsedTime();`${e(this,Fe)}${s}${t}`,[...i]}warnWithTime(t,...i){let s=this.getElapsedTime();console.warn(`%c${e(this,Fe)} +${s}ms%c ${t}`,"color: #ff9900; font-weight: bold;","color: inherit;",...i)}errorWithTime(t,...i){let s=this.getElapsedTime();console.error(`%c${e(this,Fe)} +${s}ms%c ${t}`,"color: #cc0000; font-weight: bold;","color: inherit;",...i)}debugWithTime(t,...i){if(e(this,qe)){let s=this.getElapsedTime();console.debug(`%c${e(this,Fe)}:debug +${s}ms%c ${t}`,"color: #666666; font-weight: bold;","color: inherit;",...i)}}};qe=new WeakMap,Fe=new WeakMap,$i=new WeakMap,ln=new WeakSet,au=function(t,i,...s){`${t}${i}`,[...s]},dn=new WeakSet,cu=function(t,i,...s){console.warn(`%c${t}%c ${i}`,"color: #ff9900; font-weight: bold;","color: inherit;",...s)},un=new WeakSet,lu=function(t,i,...s){console.error(`%c${t}%c ${i}`,"color: #cc0000; font-weight: bold;","color: inherit;",...s)},hn=new WeakSet,du=function(t,i,...s){e(this,qe)&&console.debug(`%c${t}:debug%c ${i}`,"color: #666666; font-weight: bold;","color: inherit;",...s)},gn=new WeakSet,uu=function(t,i,...s){let r=this.getElapsedTime();`${t}${r}${i}`,[...s]},mn=new WeakSet,hu=function(t,i,...s){let r=this.getElapsedTime();console.warn(`%c${t} +${r}ms%c ${i}`,"color: #ff9900; font-weight: bold;","color: inherit;",...s)},pn=new WeakSet,gu=function(t,i,...s){let r=this.getElapsedTime();console.error(`%c${t} +${r}ms%c ${i}`,"color: #cc0000; font-weight: bold;","color: inherit;",...s)},fn=new WeakSet,mu=function(t,i,...s){if(e(this,qe)){let r=this.getElapsedTime();console.debug(`%c${t}:debug +${r}ms%c ${i}`,"color: #666666; font-weight: bold;","color: inherit;",...s)}};var vn,ut,ht,_t,qt,j,wn,pu,Sn,fu,Ms,Gl,xn,yu,Li,yn,Cn,bu,_n,vu,Ns,Kl,En,wu,Os,Yl,An,Su,kn,xu,Tn,Cu,bn=class{constructor(t,i){o(this,wn);o(this,Sn);o(this,Ms);o(this,xn);o(this,Li);o(this,Cn);o(this,_n);o(this,Ns);o(this,En);o(this,Os);o(this,An);o(this,kn);o(this,Tn);o(this,vn,void 0);o(this,ut,void 0);o(this,ht,void 0);o(this,_t,[]);o(this,qt,{});o(this,j,void 0);u(this,vn,t),u(this,ut,i),u(this,ht,n(this,Sn,fu).call(this)),u(this,j,{shippingCountry:document.querySelector('[os-checkout-field="country"]'),shippingState:document.querySelector('[os-checkout-field="province"]'),billingCountry:document.querySelector('[os-checkout-field="billing-country"]'),billingState:document.querySelector('[os-checkout-field="billing-province"]')}),n(this,_n,vu).call(this),e(this,j).shippingCountry||e(this,j).billingCountry?(e(this,ut).info("AddressHandler initialized"),n(this,wn,pu).call(this)):e(this,ut).warn("No country selects found")}};vn=new WeakMap,ut=new WeakMap,ht=new WeakMap,_t=new WeakMap,qt=new WeakMap,j=new WeakMap,wn=new WeakSet,pu=async function(){await n(this,En,wu).call(this),await Promise.all([e(this,j).shippingCountry&&n(this,Ms,Gl).call(this,e(this,j).shippingCountry,e(this,j).shippingState),e(this,j).billingCountry&&n(this,Ms,Gl).call(this,e(this,j).billingCountry,e(this,j).billingState)]),n(this,xn,yu).call(this),n(this,An,Su).call(this),n(this,kn,xu).call(this)},Sn=new WeakSet,fu=function(){return{defaultCountry:window.osConfig?.addressConfig?.defaultCountry??document.querySelector('meta[name="os-address-default-country"]')?.content??"US",showCountries:window.osConfig?.addressConfig?.showCountries??document.querySelector('meta[name="os-address-show-countries"]')?.content?.split(",").map(t=>t.trim())??[],dontShowStates:window.osConfig?.addressConfig?.dontShowStates??document.querySelector('meta[name="os-address-dont-show-states"]')?.content?.split(",").map(t=>t.trim())??[],countries:window.osConfig?.addressConfig?.countries??[]}},Ms=new WeakSet,Gl=async function(t,i){t.innerHTML='<option value="">Select Country</option>'+e(this,_t).map(s=>`<option value="${s.iso2}">${s.name}</option>`).join(""),t.value=e(this,ht).defaultCountry,i&&t.value&&await n(this,Li,yn).call(this,i,t.value),e(this,ut).debug(`Country select initialized with default ${e(this,ht).defaultCountry}`)},xn=new WeakSet,yu=function(){[[e(this,j).shippingCountry,e(this,j).shippingState],[e(this,j).billingCountry,e(this,j).billingState]].forEach(([i,s])=>{i?.addEventListener("change",()=>s&&n(this,Li,yn).call(this,s,i.value))})},Li=new WeakSet,yn=async function(t,i,s=!1){if(!i)return t.innerHTML='<option value="">Select State/Province</option>';let r=e(this,qt)[i]||await n(this,Os,Yl).call(this,i);s&&await r,n(this,Cn,bu).call(this,t,r),e(this,ut).debug(`State select updated for ${i}`)},Cn=new WeakSet,bu=function(t,i){let s=t.value||t.getAttribute("data-pending-state")||"";t.innerHTML='<option value="">Select State/Province</option>'+i.map(r=>`<option value="${r.iso2}">${r.name}</option>`).join(""),t.parentElement.style.display=i.length?"":"none",s&&Array.from(t.options).some(r=>r.value===s)&&(t.value=s)},_n=new WeakSet,vu=function(){let t=i=>{let s=JSON.parse(localStorage.getItem(i)??"{}");return Date.now()-(s.timestamp??0)<864e5?s:{}};u(this,_t,t("os_countries_cache").countries??[]),e(this,_t).length&&e(this,ht).showCountries.length&&(u(this,_t,e(this,_t).filter(i=>e(this,ht).showCountries.includes(i.iso2))),e(this,ut).debug(`Filtered cached countries to: ${e(this,ht).showCountries.join(", ")}`)),u(this,qt,t("os_states_cache").states??{}),e(this,ut).debug(`Loaded cached data: ${e(this,_t).length} countries, ${Object.keys(e(this,qt)).length} state sets`)},Ns=new WeakSet,Kl=function(t,i){localStorage.setItem(t,JSON.stringify({...i,timestamp:Date.now()}))},En=new WeakSet,wu=async function(){e(this,_t).length||(u(this,_t,e(this,ht).countries.length?e(this,ht).countries.map(t=>({iso2:t.iso2||t.code,name:t.name})):(await(await fetch("https://api.countrystatecity.in/v1/countries",{headers:{"X-CSCAPI-KEY":"c2R3MzNhYmpvYUJPdmhkUlE5TUJWYUtJUGs2TTlNU3cyRmxmVW9wVQ=="}})).json()).filter(t=>!e(this,ht).showCountries.length||e(this,ht).showCountries.includes(t.iso2))),e(this,_t).sort((t,i)=>t.name.localeCompare(i.name)),n(this,Ns,Kl).call(this,"os_countries_cache",{countries:e(this,_t)}),e(this,ut).info(`Loaded ${e(this,_t).length} countries`))},Os=new WeakSet,Yl=async function(t){if(e(this,qt)[t])return e(this,qt)[t];try{let i=(await(await fetch(`https://api.countrystatecity.in/v1/countries/${t}/states`,{headers:{"X-CSCAPI-KEY":"c2R3MzNhYmpvYUJPdmhkUlE5TUJWYUtJUGs2TTlNU3cyRmxmVW9wVQ=="}})).json()).filter(s=>!e(this,ht).dontShowStates.includes(s.iso2));return e(this,qt)[t]=i,n(this,Ns,Kl).call(this,"os_states_cache",{states:e(this,qt)}),e(this,ut).debug(`Loaded ${i.length} states for ${t}`),i}catch(i){return e(this,ut).error(`Failed to load states for ${t}:`,i),e(this,qt)[t]=t==="US"?[]:[],e(this,qt)[t]}},An=new WeakSet,Su=async function(){if(e(this,j).shippingCountry?.value||e(this,j).billingCountry?.value)return;let t=e(this,ht).defaultCountry||(await Promise.any(["https://ipapi.co/json/","https://ipinfo.io/json"].map(i=>fetch(i).then(s=>s.json()))))?.country_code;[e(this,j).shippingCountry,e(this,j).billingCountry].forEach(i=>{i&&(i.value=t,i.dispatchEvent(new Event("change")))}),e(this,ut).debug(`User country detected/set to ${t}`)},kn=new WeakSet,xu=function(){let t=Object.values(e(this,j)).filter(Boolean),i=new MutationObserver(s=>{s.forEach(r=>{if(r.attributeName==="value"&&r.target.value){let a=r.target===e(this,j).shippingCountry?e(this,j).shippingState:e(this,j).billingState;a&&n(this,Li,yn).call(this,a,r.target.value,!0),e(this,ut).debug(`Autocomplete detected on ${r.target.getAttribute("os-checkout-field")}`)}})});t.forEach(s=>i.observe(s,{attributes:!0,attributeFilter:["value"]})),n(this,Tn,Cu).call(this),e(this,ut).debug("Autocomplete detection set up")},Tn=new WeakSet,Cu=function(){let t=e(this,ht).showCountries.length?e(this,ht).showCountries:["US","CA","GB","AU"];t.forEach(i=>!e(this,qt)[i]&&n(this,Os,Yl).call(this,i)),e(this,ut).debug(`Preloading states for ${t.join(", ")}`)};var Pi,Me,$n,Rs,ti,zs,Ds,Ln,_u,Et,Ut,Pn,Eu,In,Au,Bs,Jl,Vs,Zl,qn,ku,Fn,Tu,Mn,$u,Nn,Lu,ed,vp,Ws,Xl,ei,Us,Hs,Ql,On,Pu,Un,Iu,Rn,qu,zn,Fu,Dn,Mu,Rt,re,Bn,Nu,js,td,Vn,Ou,Wn,Uu,Hn,Ru,jn,zu,Ii=class{constructor(t={}){o(this,Ln);o(this,Et);o(this,Pn);o(this,In);o(this,Bs);o(this,Vs);o(this,qn);o(this,Fn);o(this,Mn);o(this,Nn);o(this,ed);o(this,Ws);o(this,ei);o(this,Hs);o(this,On);o(this,Un);o(this,Rn);o(this,zn);o(this,Dn);o(this,Rt);o(this,Bn);o(this,js);o(this,Vn);o(this,Wn);o(this,Hn);o(this,jn);o(this,Pi,void 0);o(this,Me,void 0);o(this,$n,{});o(this,Rs,!1);o(this,ti,!1);o(this,zs,!1);o(this,Ds,!1);u(this,Rs,t.debugMode||!1),u(this,Pi,t.logger||console),u(this,Me,n(this,Ln,_u).call(this)),u(this,ti,typeof Spreedly<"u"),e(this,Me)&&n(this,Pn,Eu).call(this)}validateAllFields(t=this.getSelectedPaymentMethod()){e(this,Rs)&&n(this,Fn,Tu).call(this,t);let i=["credit","credit-card"].includes(t),s=!0,r=Array.from(document.querySelectorAll('[os-checkout-validate="required"]')),a=n(this,Mn,$u).call(this,r,i),c=!0;i&&(c=this.validateCreditCard());let d=n(this,Wn,Uu).call(this);return a?(n(this,js,td).call(this,a),s=!1):d?s=!1:c||(s=!1),s}clearErrorForField(t){if(!t)return;t.classList.remove("error"),(t.closest(".frm-flds")||t.closest(".form-group")||t.parentElement)?.querySelector(".pb-input-error")?.remove();let s=t.getAttribute("os-checkout-field");if(["cc-number","cvv"].includes(s)){let r=`spreedly-${s==="cc-number"?"number":"cvv"}`,a=document.getElementById(r);a&&(a.classList.remove("error"),a.closest(".frm-flds")?.querySelector(".pb-input-error")?.remove())}}clearAllErrors(){u(this,$n,{}),document.querySelectorAll(".error").forEach(t=>t.classList.remove("error")),document.querySelectorAll(".pb-input-error").forEach(t=>t.remove()),n(this,Hs,Ql).call(this)}isSameAsShipping(){let t=document.querySelector('[os-checkout-field="same-as-shipping"] input[type="checkbox"]')||document.querySelector('[os-input-field="use-shipping-address"] input[type="checkbox"]')||document.querySelector("#use_shipping_address");return t?t.checked:!0}getSelectedPaymentMethod(){return document.querySelector('input[name="payment_method"]:checked')?.value||document.querySelector('input[name="combo_mode"]:checked')?.value||"credit"}getFormValues(){let t={};return e(this,Me).querySelectorAll("input, select, textarea").forEach(i=>{if(["button","submit"].includes(i.type)||i.disabled||!i.name)return;let s=i.getAttribute("os-checkout-field")||i.name;if(i.type==="checkbox")t[s]=i.checked;else if(i.type==="radio")i.checked&&(t[s]=i.value);else if(s.includes(".")){let[r,a]=s.split(".");t[r]=t[r]||{},t[r][a]=i.value}else t[s]=i.value}),t}validateCreditCard(){let t=!0,[i,s]=n(this,Ws,Xl).call(this);if(n(this,ei,Us).call(this,i,"month")||(t=!1),n(this,ei,Us).call(this,s,"year")||(t=!1),e(this,ti)&&typeof Spreedly.validate=="function"){let r=document.getElementById("spreedly-number"),a=document.getElementById("spreedly-cvv"),c=r?.classList.contains("spreedly-valid"),d=a?.classList.contains("spreedly-valid");Spreedly.validate(),!c&&r&&(n(this,Rt,re).call(this,r,"Please enter a valid credit card number"),t=!1),!d&&a&&(n(this,Rt,re).call(this,a,"Please enter a valid security code (CVV)"),t=!1)}else{let r=document.querySelector('[os-checkout-field="cc-number"]'),a=document.querySelector('[os-checkout-field="cvv"]');r?.value.trim()||(n(this,Rt,re).call(this,r,"Please enter a credit card number"),t=!1),a?.value.trim()||(n(this,Rt,re).call(this,a,"Please enter a security code (CVV)"),t=!1)}return t}};Pi=new WeakMap,Me=new WeakMap,$n=new WeakMap,Rs=new WeakMap,ti=new WeakMap,zs=new WeakMap,Ds=new WeakMap,Ln=new WeakSet,_u=function(){let t=document.querySelector('form[os-checkout="form"]')||document.querySelector("form#combo_form");return t||n(this,Et,Ut).call(this,"warn","No checkout form found"),t},Et=new WeakSet,Ut=function(t,i,...s){try{(e(this,Pi)?.[t]||console[t]||console.log).call(console,`[${t.toUpperCase()}] ${i}`,...s)}catch(r){console.error("Error logging:",r)}},Pn=new WeakSet,Eu=function(){e(this,Me).addEventListener("submit",t=>n(this,qn,ku).call(this,t)),document.querySelector('[os-checkout-payment="combo"]')?.addEventListener("click",()=>{this.validateAllFields()&&e(this,Me).submit()}),document.addEventListener("payment-method-changed",()=>this.clearAllErrors()),e(this,ti)&&typeof Spreedly.on=="function"&&n(this,In,Au).call(this),n(this,Hn,Ru).call(this)},In=new WeakSet,Au=function(){Object.entries({ready:()=>{u(this,Ds,!0),n(this,Et,Ut).call(this,"debug","Spreedly is ready")},paymentMethod:(i,s)=>{u(this,zs,!0),n(this,Et,Ut).call(this,"debug","Spreedly payment method created"),n(this,Hs,Ql).call(this)},validation:i=>{n(this,Et,Ut).call(this,"debug",`Spreedly field validation: ${i.fieldType} ${i.valid?"valid":"invalid"}`);let s=document.getElementById(`spreedly-${i.fieldType}`);if(s&&(s.classList.toggle("spreedly-valid",i.valid),s.classList.toggle("error",!i.valid)),i.valid)this.clearErrorForField(s);else{let r=n(this,Bs,Jl).call(this,i.fieldType);n(this,Vs,Zl).call(this,{attribute:i.fieldType,message:r})}},errors:i=>{u(this,zs,!1),n(this,Et,Ut).call(this,"debug","Spreedly validation errors:",i),i.forEach(s=>n(this,Vs,Zl).call(this,s))},fieldEvent:(i,s,r,a)=>{let c=document.getElementById(`spreedly-${i}`);if(s==="input"&&c){let d=i==="number"?a.validNumber:a.validCvv;if(c.classList.toggle("spreedly-valid",d),c.classList.toggle("error",!d),d)this.clearErrorForField(c);else{let h=n(this,Bs,Jl).call(this,i);n(this,Rt,re).call(this,c,h)}}}}).forEach(([i,s])=>Spreedly.on(i,s))},Bs=new WeakSet,Jl=function(t){return{number:"Please enter a valid credit card number",cvv:"Please enter a valid security code (CVV)"}[t]||`Invalid ${t}`},Vs=new WeakSet,Zl=function(t){let i={number:"spreedly-number",card_number:"spreedly-number",cvv:"spreedly-cvv",month:"cc-month",year:"cc-year",full_name:"cc-name",first_name:"cc-name",last_name:"cc-name"},s=document.getElementById(i[t.attribute])||document.querySelector(`[os-checkout-field="${i[t.attribute]}"]`);s&&n(this,Rt,re).call(this,s,t.message)},qn=new WeakSet,ku=function(t){this.validateAllFields()||(t.preventDefault(),n(this,Et,Ut).call(this,"warn","Form validation failed"))},Fn=new WeakSet,Tu=function(t){n(this,Et,Ut).call(this,"debug","Starting field validation for payment method:",t),n(this,Et,Ut).call(this,"debug","Same as shipping:",this.isSameAsShipping()),n(this,Et,Ut).call(this,"debug","Spreedly enabled:",e(this,ti)),n(this,Et,Ut).call(this,"debug","Spreedly ready:",e(this,Ds))},Mn=new WeakSet,$u=function(t,i){let s=null;for(let r of t){let a=r.getAttribute("os-checkout-field");if(n(this,Nn,Lu).call(this,a,i)){this.clearErrorForField(r);continue}let c=r.previousElementSibling?.textContent||a||r.placeholder;n(this,On,Pu).call(this,r,c)||(s=s||r)}return s},Nn=new WeakSet,Lu=function(t,i){return this.isSameAsShipping()&&t?.startsWith("billing-")||i&&["cc-number","cvv"].includes(t)},ed=new WeakSet,vp=function(){let[t,i]=n(this,Ws,Xl).call(this);return n(this,ei,Us).call(this,t,"month")&&n(this,ei,Us).call(this,i,"year")},Ws=new WeakSet,Xl=function(){let t=['[os-checkout-field="cc-month"]','[os-checkout-field="exp-month"]',"#credit_card_exp_month"],i=['[os-checkout-field="cc-year"]','[os-checkout-field="exp-year"]',"#credit_card_exp_year"];return[t.map(s=>document.querySelector(s)).find(Boolean),i.map(s=>document.querySelector(s)).find(Boolean)]},ei=new WeakSet,Us=function(t,i){return!t||!t.value?(n(this,Et,Ut).call(this,"error",`${i} field is empty`),n(this,Rt,re).call(this,t,`Please select an expiration ${i}`),!1):!0},Hs=new WeakSet,Ql=function(){["cc-number","cvv"].forEach(t=>this.clearErrorForField(document.querySelector(`[os-checkout-field="${t}"]`))),["spreedly-number","spreedly-cvv"].forEach(t=>this.clearErrorForField(document.getElementById(t)))},On=new WeakSet,Pu=function(t,i){if(!t)return!0;let s=t.value.trim(),r=n(this,Rn,qu).call(this,t,s,n(this,Un,Iu).call(this,t,i));return r.isValid?this.clearErrorForField(t):n(this,Rt,re).call(this,t,r.errorMessage),r.isValid},Un=new WeakSet,Iu=function(t,i){let s=t.getAttribute("os-checkout-field")||t.name;return{fname:"First Name",lname:"Last Name",email:"Email",phone:"Phone Number",address1:"Address",address2:"Apartment or Suite",city:"City",province:"State/Province",postal:"ZIP/Postal Code",country:"Country","cc-number":"Credit Card Number",cvv:"Security Code","cc-month":"Expiration Month","cc-year":"Expiration Year","cc-name":"Name on Card","exp-month":"Expiration Month","exp-year":"Expiration Year","billing-fname":"Billing First Name","billing-lname":"Billing Last Name","billing-address1":"Billing Address","billing-address2":"Billing Apartment or Suite","billing-city":"Billing City","billing-province":"Billing State/Province","billing-postal":"Billing ZIP/Postal Code","billing-country":"Billing Country","billing-phone":"Billing Phone Number"}[s]||i||s},Rn=new WeakSet,qu=function(t,i,s){let r=t.tagName.toLowerCase(),a=t.getAttribute("os-checkout-field")||t.name;return r==="select"?{isValid:!!i,errorMessage:`Please select a ${s}`}:t.type==="tel"&&t.iti?i.trim()?{isValid:t.iti.isValidNumber(),errorMessage:"Please enter a valid US phone number (e.g. 555-555-5555)"}:{isValid:!0,errorMessage:""}:i?a&&(a.includes("city")||a.endsWith("-city"))?n(this,zn,Fu).call(this,i,s):a&&(a.includes("zip")||a.includes("postal")||a.endsWith("-zip"))?n(this,Dn,Mu).call(this,i,a):t.type==="email"?{isValid:n(this,Vn,Ou).call(this,i),errorMessage:"Please enter a valid email address"}:{isValid:!0,errorMessage:""}:{isValid:!1,errorMessage:`Please enter your ${s}`}},zn=new WeakSet,Fu=function(t,i){return{isValid:/^[a-zA-Z\s]{2,24}$/.test(t),errorMessage:"Please enter a valid city name (2-24 letters, no numbers or special characters)"}},Dn=new WeakSet,Mu=function(t,i="Zip"){let r=/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(t);return{isValid:r,errorMessage:r?"":"Field must be a valid US Zip code."}},Rt=new WeakSet,re=function(t,i){if(!t)return;t.classList.add("error");let s=t.closest(".frm-flds")||t.closest(".form-group")||t.parentElement,r=n(this,Bn,Nu).call(this,s);r.textContent=i,Object.assign(r.style,{color:"red",fontSize:"0.875rem",marginTop:"0.25rem"}),t.hasErrorListener||(t.hasErrorListener=!0,["input","change"].forEach(a=>t.addEventListener(a,()=>this.clearErrorForField(t))),t.type==="tel"&&t.iti&&t.addEventListener("countrychange",()=>this.clearErrorForField(t)))},Bn=new WeakSet,Nu=function(t){let i=t.querySelector(".pb-input-error");return i||(i=document.createElement("div"),i.className="pb-input-error",t.appendChild(i)),i},js=new WeakSet,td=function(t){t&&(window.scrollTo({top:t.getBoundingClientRect().top+window.pageYOffset-100,behavior:"smooth"}),setTimeout(()=>t.focus(),500))},Vn=new WeakSet,Ou=function(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)},Wn=new WeakSet,Uu=function(){let t=Array.from(document.querySelectorAll('input[type="tel"]')),i=!1;for(let s of t){if(!s.value.trim()||!s.iti)continue;if(s.iti.isValidNumber())this.clearErrorForField(s);else{let a=s.iti.getValidationError(),d={0:"Please enter a valid US phone number (e.g. 555-555-5555)",1:"Invalid country code",2:"Phone number is too short",3:"Phone number is too long",4:"Please enter a valid phone number",5:"Invalid phone number format"}[a]||"Please enter a valid US phone number";n(this,Rt,re).call(this,s,d),i||(n(this,js,td).call(this,s),i=!0)}}return i},Hn=new WeakSet,Ru=function(){[...document.querySelectorAll('[os-checkout-field="postal"]'),...document.querySelectorAll('[os-checkout-field="billing-postal"]'),...document.querySelectorAll('[os-checkout-field="zip"]')].forEach(i=>{i&&(i.addEventListener("input",s=>n(this,jn,zu).call(this,s)),e(this,Pi).debug(`ZIP code formatting setup for: ${i.getAttribute("os-checkout-field")||i.name||"unknown"}`))})},jn=new WeakSet,zu=function(t){let i=t.target,s=i.selectionStart,r=i.value,a=r.replace(/[^\d-]/g,"");if(a.length>5){let c=a.slice(0,5);if(a.charAt(5)!=="-"){let d=a.slice(5).replace(/-/g,"");a=`${c}-${d}`}else{let d=a.slice(6).replace(/-/g,"");a=`${c}-${d}`}}if(a.includes("-")){let[c,d]=a.split("-");a=`${c.slice(0,5)}-${d.slice(0,4)}`}else a=a.slice(0,5);if(a!==r){i.value=a;let c=a.length-r.length;i.setSelectionRange(s+c,s+c)}};var Gs,Ks,qi,Fi,pt,Mi,Ni,k,Yn,Jn,Du,Zn,Bu,Xn,Vu,Ys,id,Qn,Wu,to,Hu,eo,ju,Js,sd,Oi,Gn,F,U,Kn=class{constructor(t,i={}){o(this,Jn);o(this,Zn);o(this,Xn);o(this,Ys);o(this,Qn);o(this,to);o(this,eo);o(this,Js);o(this,Oi);o(this,F);o(this,Gs,void 0);o(this,Ks,!1);o(this,qi,!1);o(this,Fi,null);o(this,pt,null);o(this,Mi,null);o(this,Ni,null);o(this,k,null);o(this,Yn,null);if(u(this,Gs,t),u(this,Ks,i.debug||!1),u(this,Yn,i.app||null),n(this,Jn,Du).call(this),!t){n(this,F,U).call(this,"error","No environment key provided to SpreedlyManager");return}n(this,F,U).call(this,"debug",`SpreedlyManager initialized with environment key: ${t}`),n(this,Zn,Bu).call(this)}clearAllErrors(){n(this,Oi,Gn).call(this,"number"),n(this,Oi,Gn).call(this,"cvv");let t=document.querySelector('[os-checkout-field="cc-month"]')||document.querySelector('[os-checkout-field="exp-month"]')||document.querySelector("#credit_card_exp_month"),i=document.querySelector('[os-checkout-field="cc-year"]')||document.querySelector('[os-checkout-field="exp-year"]')||document.querySelector("#credit_card_exp_year");if(t){t.classList.remove("error");let r=(t.closest(".frm-flds")||t.parentElement).querySelector(".pb-input-error");r&&r.remove()}if(i){i.classList.remove("error");let r=(i.closest(".frm-flds")||i.parentElement).querySelector(".pb-input-error");r&&r.remove()}}tokenizeCard(t){if(n(this,F,U).call(this,"debug","Tokenizing card with data:",{...t,full_name:t.full_name,month:t.month,year:t.year}),this.clearAllErrors(),!t.full_name||!t.month||!t.year){n(this,F,U).call(this,"error","Missing required card data");let i=[];t.full_name||i.push({attribute:"full_name",message:"Cardholder name is required"}),t.month||i.push({attribute:"month",message:"Expiration month is required"}),t.year||i.push({attribute:"year",message:"Expiration year is required"}),n(this,Js,sd).call(this,i),e(this,pt)&&e(this,pt).call(this,i.map(s=>s.message));return}if(!e(this,qi)){n(this,F,U).call(this,"error","Spreedly is not ready yet"),e(this,pt)&&e(this,pt).call(this,["Payment system is not ready yet. Please try again in a moment."]);return}try{Spreedly.tokenizeCreditCard(t),n(this,F,U).call(this,"debug","Card tokenization initiated")}catch(i){n(this,F,U).call(this,"error","Error tokenizing card",i),e(this,pt)&&e(this,pt).call(this,["An error occurred while processing your card. Please try again."])}}setOnReady(t){u(this,Fi,t),e(this,qi)&&t&&t()}setOnError(t){u(this,pt,t)}setOnPaymentMethod(t){u(this,Mi,t)}setOnValidation(t){u(this,Ni,t)}};Gs=new WeakMap,Ks=new WeakMap,qi=new WeakMap,Fi=new WeakMap,pt=new WeakMap,Mi=new WeakMap,Ni=new WeakMap,k=new WeakMap,Yn=new WeakMap,Jn=new WeakSet,Du=function(){u(this,k,{fieldType:{number:"text",cvv:"text"},numberFormat:"prettyFormat",placeholder:{number:"Credit Card Number",cvv:"CVV *"},labels:{number:"Card Number",cvv:"CVV"},titles:{number:"Credit card number",cvv:"Card verification value"},styling:{number:'color: #212529; font-size: .925rem; font-weight: 400; width: 100%; height:100%; font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue","Noto Sans","Liberation Sans",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";',cvv:'color: #212529; font-size: .925rem; font-weight: 400; width: 100%; height: 100%; font-family: system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue","Noto Sans","Liberation Sans",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";'},placeholder_styling:"",required:{number:!0,cvv:!0},autocomplete:!0}),window.osConfig&&window.osConfig.spreedlyConfig&&(n(this,F,U).call(this,"debug","Found global Spreedly configuration",window.osConfig.spreedlyConfig),window.osConfig.spreedlyConfig.fieldType&&(e(this,k).fieldType={...e(this,k).fieldType,...window.osConfig.spreedlyConfig.fieldType}),window.osConfig.spreedlyConfig.numberFormat&&(e(this,k).numberFormat=window.osConfig.spreedlyConfig.numberFormat),window.osConfig.spreedlyConfig.placeholder&&(e(this,k).placeholder={...e(this,k).placeholder,...window.osConfig.spreedlyConfig.placeholder}),window.osConfig.spreedlyConfig.labels&&(e(this,k).labels={...e(this,k).labels,...window.osConfig.spreedlyConfig.labels}),window.osConfig.spreedlyConfig.titles&&(e(this,k).titles={...e(this,k).titles,...window.osConfig.spreedlyConfig.titles}),window.osConfig.spreedlyConfig.styling&&(e(this,k).styling={...e(this,k).styling,...window.osConfig.spreedlyConfig.styling}),window.osConfig.spreedlyConfig.placeholder_styling&&(e(this,k).placeholder_styling=window.osConfig.spreedlyConfig.placeholder_styling),window.osConfig.spreedlyConfig.required&&(e(this,k).required={...e(this,k).required,...window.osConfig.spreedlyConfig.required}),window.osConfig.spreedlyConfig.hasOwnProperty("autocomplete")&&(e(this,k).autocomplete=window.osConfig.spreedlyConfig.autocomplete)),n(this,F,U).call(this,"debug","Spreedly configuration initialized",e(this,k))},Zn=new WeakSet,Bu=function(){typeof Spreedly>"u"?(n(this,F,U).call(this,"debug","Spreedly not loaded, loading script..."),n(this,Xn,Vu).call(this).then(()=>{n(this,F,U).call(this,"debug","Spreedly script loaded"),n(this,Ys,id).call(this)}).catch(t=>{n(this,F,U).call(this,"error","Failed to load Spreedly script",t),e(this,pt)&&e(this,pt).call(this,["Failed to load Spreedly. Please refresh the page and try again."])})):(n(this,F,U).call(this,"debug","Spreedly already loaded"),n(this,Ys,id).call(this))},Xn=new WeakSet,Vu=function(){return new Promise((t,i)=>{let s=document.createElement("script");s.src="https://core.spreedly.com/iframe/iframe-v1.min.js",s.async=!0,s.onload=t,s.onerror=i,document.head.appendChild(s)})},Ys=new WeakSet,id=function(){try{n(this,F,U).call(this,"debug","Setting up Spreedly..."),n(this,to,Hu).call(this),Spreedly.init(e(this,Gs),{numberEl:"spreedly-number",cvvEl:"spreedly-cvv"}),Spreedly.on("ready",()=>{n(this,F,U).call(this,"debug","Spreedly iframe ready"),n(this,Qn,Wu).call(this),u(this,qi,!0),e(this,Fi)&&e(this,Fi).call(this)}),n(this,eo,ju).call(this),n(this,F,U).call(this,"debug","Spreedly setup complete")}catch(t){n(this,F,U).call(this,"error","Error setting up Spreedly",t),e(this,pt)&&e(this,pt).call(this,["Failed to set up Spreedly. Please refresh the page and try again."])}},Qn=new WeakSet,Wu=function(){try{n(this,F,U).call(this,"debug","Applying Spreedly configuration..."),Spreedly.setFieldType("number",e(this,k).fieldType.number),Spreedly.setFieldType("cvv",e(this,k).fieldType.cvv),Spreedly.setNumberFormat(e(this,k).numberFormat),Spreedly.setPlaceholder("number",e(this,k).placeholder.number),Spreedly.setPlaceholder("cvv",e(this,k).placeholder.cvv),Spreedly.setLabel("number",e(this,k).labels.number),Spreedly.setLabel("cvv",e(this,k).labels.cvv),Spreedly.setTitle("number",e(this,k).titles.number),Spreedly.setTitle("cvv",e(this,k).titles.cvv),Spreedly.setStyle("number",e(this,k).styling.number),Spreedly.setStyle("cvv",e(this,k).styling.cvv),e(this,k).placeholder_styling&&Spreedly.setStyle("placeholder",e(this,k).placeholder_styling),e(this,k).required.number&&Spreedly.setRequiredAttribute("number"),e(this,k).required.cvv&&Spreedly.setRequiredAttribute("cvv"),e(this,k).autocomplete||Spreedly.toggleAutoComplete(),n(this,F,U).call(this,"debug","Spreedly configuration applied")}catch(t){n(this,F,U).call(this,"error","Error applying Spreedly configuration",t)}},to=new WeakSet,Hu=function(){try{n(this,F,U).call(this,"debug","Preparing HTML structure for Spreedly iframe fields");let t=document.querySelector('[os-checkout-field="cc-number"]'),i=document.querySelector('[os-checkout-field="cvv"]');if(!t||!i){n(this,F,U).call(this,"error","Could not find credit card fields");return}t.id="spreedly-number",i.id="spreedly-cvv",t.setAttribute("data-spreedly","number"),i.setAttribute("data-spreedly","cvv"),n(this,F,U).call(this,"debug","HTML structure prepared for Spreedly iframe fields - using existing DOM elements")}catch(t){n(this,F,U).call(this,"error","Error preparing HTML structure for Spreedly iframe fields",t)}},eo=new WeakSet,ju=function(){Spreedly.on("errors",t=>{n(this,F,U).call(this,"error","Spreedly validation errors:",t);let i=t.map(s=>s.message);e(this,pt)&&e(this,pt).call(this,i),n(this,Js,sd).call(this,t)}),Spreedly.on("paymentMethod",(t,i)=>{n(this,F,U).call(this,"debug","Spreedly payment method created:",t),this.clearAllErrors(),e(this,Mi)&&e(this,Mi).call(this,t,i)}),Spreedly.on("validation",t=>{n(this,F,U).call(this,"debug","Spreedly field validation:",t),n(this,Oi,Gn).call(this,t.fieldType),e(this,Ni)&&e(this,Ni).call(this,t)})},Js=new WeakSet,sd=function(t){t.forEach(i=>{let s=i.attribute,r=null;if(s==="number"||s==="card_number"?r=document.getElementById("spreedly-number"):s==="cvv"?r=document.getElementById("spreedly-cvv"):s==="month"||s==="year"?r=document.querySelector(`[os-checkout-field="cc-${s}"]`)||document.querySelector(`[os-checkout-field="exp-${s}"]`)||document.querySelector(`#credit_card_exp_${s}`):(s==="full_name"||s==="first_name"||s==="last_name")&&(r=document.querySelector('[os-checkout-field="cc-name"]')),r){r.classList.add("error");let a=r.closest(".frm-flds")||r.parentElement,c=a.querySelector(".pb-input-error");c||(c=document.createElement("div"),c.className="pb-input-error",a.appendChild(c)),c.textContent=i.message,c.style.color="red",c.style.fontSize="0.875rem",c.style.marginTop="0.25rem"}})},Oi=new WeakSet,Gn=function(t){let i=null;if(t==="number"||t==="card_number"?i=document.getElementById("spreedly-number"):t==="cvv"&&(i=document.getElementById("spreedly-cvv")),i){i.classList.remove("error");let r=(i.closest(".frm-flds")||i.parentElement).querySelector(".pb-input-error");r&&r.remove()}},F=new WeakSet,U=function(t,i,s){if(e(this,Ks)||t==="error"){let r="[SpreedlyManager]";s?console[t](`${r} ${i}`,s):console[t](`${r} ${i}`)}};var Ne,zt,ii,G,Ui,Ri,io,Gu,so,Ku,Dt=class{constructor({callback:t,logger:i}={}){o(this,io);o(this,so);o(this,Ne,["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a"]);o(this,zt,0);o(this,ii,void 0);o(this,G,void 0);o(this,Ui,void 0);o(this,Ri,void 0);u(this,Ui,i),u(this,Ri,t),n(this,io,Gu).call(this),n(this,so,Ku).call(this),e(this,Ui)&&e(this,Ui).debug("KonamiCodeHandler initialized")}static setTestMode(){return sessionStorage.setItem("konami_test_mode","true"),!0}static isTestMode(){return sessionStorage.getItem("konami_test_mode")==="true"}static clearTestMode(){sessionStorage.removeItem("konami_test_mode")}static getTestOrderData(t,i,s){try{let r=t?.cart?.items||[],a=i?i():1,c=r.length>0&&s?s(r):[{package_id:a||1,quantity:1}];return{user:{email:"test@test.com",first_name:"Test",last_name:"Order"},shipping_address:{first_name:"Test",last_name:"Order",line1:"Test Address 123",line2:"",line3:"",line4:"Tempe",state:"AZ",postcode:"85281",country:"US",phone_number:"+14807581224"},billing_address:{first_name:"Test",last_name:"Order",line1:"Test Address 123",line2:"",line3:"",line4:"Tempe",state:"AZ",postcode:"85281",country:"US",phone_number:"+14807581224"},shipping_method:1,attribution:t?.cart?.attribution||{},lines:c,success_url:window.location.origin+"/checkout/confirmation/"}}catch(r){return console.error("Error getting Konami test order data:",r),null}}static showActivationMessage(){let t=document.createElement("div");return t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.style.background="rgba(0, 0, 0, 0.8)",t.style.color="#fff",t.style.padding="20px",t.style.borderRadius="10px",t.style.zIndex="9999",t.style.textAlign="center",t.style.fontFamily="monospace",t.style.fontSize="18px",t.innerHTML=`
      <h3>ðŸŽ® KONAMI CODE ACTIVATED! ðŸŽ®</h3>
      <p>Creating test order with predefined data:</p>
      <p style="font-size: 14px; margin-top: 10px; text-align: left;">
        Email: test@test.com<br>
        Name: Test Order<br>
        Address: Test Address 123<br>
        City: Tempe, AZ 85281<br>
        Country: US<br>
        Phone: +14807581224<br>
        Card: 4111111111111111 (test mode)
      </p>
    `,document.body.appendChild(t),t}};Ne=new WeakMap,zt=new WeakMap,ii=new WeakMap,G=new WeakMap,Ui=new WeakMap,Ri=new WeakMap,io=new WeakSet,Gu=function(){u(this,G,document.createElement("div")),e(this,G).style.position="fixed",e(this,G).style.bottom="10px",e(this,G).style.right="10px",e(this,G).style.background="rgba(0, 0, 0, 0.7)",e(this,G).style.color="#fff",e(this,G).style.padding="5px 10px",e(this,G).style.borderRadius="5px",e(this,G).style.fontFamily="monospace",e(this,G).style.fontSize="12px",e(this,G).style.zIndex="9999",e(this,G).style.display="none",e(this,G).textContent="Konami: 0/"+e(this,Ne).length,document.body.appendChild(e(this,G))},so=new WeakSet,Ku=function(){document.addEventListener("keydown",t=>{t.key===e(this,Ne)[e(this,zt)]?(nu(this,zt)._++,e(this,zt)>=4&&(e(this,G).style.display="block",e(this,G).textContent=`Konami: ${e(this,zt)}/${e(this,Ne).length}`),e(this,zt)===e(this,Ne).length&&(e(this,Ri)&&e(this,Ri).call(this),u(this,zt,0),setTimeout(()=>{e(this,G).style.display="none"},500)),e(this,zt)>=4&&(clearTimeout(e(this,ii)),u(this,ii,setTimeout(()=>{e(this,G).style.display="none"},3e3)))):e(this,zt)>0&&(u(this,zt,0),e(this,G).style.display==="block"&&(e(this,G).textContent=`Konami: 0/${e(this,Ne).length}`,clearTimeout(e(this,ii)),u(this,ii,setTimeout(()=>{e(this,G).style.display="none"},1500))))})};var Di,Bi,fe,et,ne,ye,Bt,be,Vi,hd,no,Yu,oo,Ju,ri,Zs,ao,Zu,co,Xu,R,K,lo,Qu,uo,th,ho,eh,go,ih,mo,sh,po,rh,fo,nh,yo,oh,Xs,rd,Qs,nd,tr,od,Gt,pe,bo,ah,vo,ch,wo,lh,So,dh,xo,uh,er,ad,Oe,zi,ir,cd,sr,ld,Co,hh,rr,dd,ve,si,_o,gh,Eo,mh,Ao,ph,Ft,jt,ko,fh,nr,ud,To,yh,$o,bh,ro=class{constructor(t,i,s){o(this,no);o(this,oo);o(this,ri);o(this,ao);o(this,co);o(this,R);o(this,lo);o(this,uo);o(this,ho);o(this,go);o(this,mo);o(this,po);o(this,fo);o(this,yo);o(this,Xs);o(this,Qs);o(this,tr);o(this,Gt);o(this,bo);o(this,vo);o(this,wo);o(this,So);o(this,xo);o(this,er);o(this,Oe);o(this,ir);o(this,sr);o(this,Co);o(this,rr);o(this,ve);o(this,_o);o(this,Eo);o(this,Ao);o(this,Ft);o(this,ko);o(this,nr);o(this,To);o(this,$o);o(this,Di,void 0);o(this,Bi,void 0);o(this,fe,void 0);o(this,et,void 0);o(this,ne,null);o(this,ye,null);o(this,Bt,"credit-card");o(this,be,!1);o(this,Vi,!1);o(this,hd,{visa:"4111111111111111",mastercard:"5555555555554444",amex:"378282246310005",discover:"6011111111111117"});u(this,Di,t),u(this,Bi,i),u(this,fe,s),u(this,et,n(this,no,Yu).call(this)),e(this,et)&&(n(this,oo,Ju).call(this),n(this,co,Xu).call(this),u(this,ye,new Ii({debugMode:e(this,Vi),logger:e(this,Bi)})),e(this,et).__formValidator=e(this,ye),n(this,lo,Qu).call(this),n(this,ho,eh).call(this))}setKonamiTestMode(){return Dt.setTestMode(),n(this,R,K).call(this,"info","ðŸŽ® Konami code test mode activated"),!0}processPayment(){let t=Dt.isTestMode();if(t&&(Dt.clearTestMode(),n(this,R,K).call(this,"info","ðŸŽ® Processing payment in Konami test mode")),e(this,be)){n(this,R,K).call(this,"warn","Payment already processing");return}n(this,nr,ud).call(this),n(this,Qs,nd).call(this),u(this,be,!0),n(this,R,K).call(this,"debug",`Processing payment with method: ${e(this,Bt)}`);try{if(t){n(this,tr,od).call(this);let s=Dt.getTestOrderData(e(this,fe)?.state?.getState(),n(this,er,ad).bind(this),n(this,rr,dd).bind(this));if(!s){n(this,Gt,pe).call(this);return}n(this,ve,si).call(this,{...s,payment_detail:{payment_method:"card_token",card_token:"test_card",test_card_number:"6011111111111117"}});return}if(!e(this,ye).validateAllFields(e(this,Bt))){u(this,be,!1),n(this,Gt,pe).call(this);return}n(this,tr,od).call(this);let i=n(this,Oe,zi).call(this);if(!i)return;if(n(this,Xs,rd).call(this)){n(this,ve,si).call(this,{...i,payment_detail:{payment_method:"card_token",card_token:"test_card"}});return}switch(e(this,Bt)){case"credit-card":case"credit":n(this,bo,ah).call(this);break;case"paypal":n(this,xo,uh).call(this);break;default:n(this,Ft,jt).call(this,`Unknown payment method: ${e(this,Bt)}`)}}catch(i){n(this,R,K).call(this,"error","Error processing payment:",i),n(this,Ft,jt).call(this,"Unexpected error occurred"),n(this,Gt,pe).call(this)}}};Di=new WeakMap,Bi=new WeakMap,fe=new WeakMap,et=new WeakMap,ne=new WeakMap,ye=new WeakMap,Bt=new WeakMap,be=new WeakMap,Vi=new WeakMap,hd=new WeakMap,no=new WeakSet,Yu=function(){let t=document.querySelector('form[os-checkout="form"]')||document.querySelector("form#combo_form");return t||n(this,R,K).call(this,"warn","No checkout form found"),t},oo=new WeakSet,Ju=function(){e(this,et).removeAttribute("action"),e(this,et).setAttribute("method","post");let t=document.createElement("input");t.type="hidden",t.name="prevent_serialization",t.value="true",e(this,et).appendChild(t),e(this,et).addEventListener("submit",n(this,ri,Zs).bind(this),!0),e(this,et).onsubmit=n(this,ri,Zs).bind(this),n(this,ao,Zu).call(this)},ri=new WeakSet,Zs=function(t){return t&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()),e(this,et).removeAttribute("action"),e(this,et).setAttribute("method","post"),window.stop?.(),n(this,R,K).call(this,"debug","Form submission prevented"),!1},ao=new WeakSet,Zu=function(){try{e(this,et).querySelectorAll('button[type="submit"], input[type="submit"]').forEach((i,s)=>{i.setAttribute("type","button"),i.addEventListener("click",r=>{r.preventDefault(),n(this,R,K).call(this,"debug",`Submit button ${s+1} clicked`),this.processPayment()})})}catch(t){n(this,R,K).call(this,"error","Error converting submit buttons:",t)}},co=new WeakSet,Xu=function(){let t=document.querySelector('[os-checkout-payment="combo"]');if(!t){n(this,R,K).call(this,"warn","Checkout button not found");return}let i=t.cloneNode(!0);t.parentNode.replaceChild(i,t),i.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),s.stopImmediatePropagation(),e(this,et).onsubmit=n(this,ri,Zs).bind(this),e(this,et).removeAttribute("action"),e(this,et).setAttribute("method","post"),n(this,R,K).call(this,"debug","Checkout button clicked"),setTimeout(()=>this.processPayment(),0)})},R=new WeakSet,K=function(t,i,...s){try{(e(this,Bi)?.[t]||console[t]||console.log).call(console,`[${t.toUpperCase()}] ${i}`,...s)}catch(r){console.error("Error logging:",r)}},lo=new WeakSet,Qu=function(){try{let t=document.querySelector('[os-checkout-field="payment-method"]')||document.querySelector('input[name="combo_mode"]:checked');if(!t){n(this,R,K).call(this,"warn","Payment method selector not found");return}u(this,Bt,t.value||"credit-card"),n(this,uo,th).call(this)}catch(t){n(this,R,K).call(this,"error","Error initializing payment methods:",t)}},uo=new WeakSet,th=function(){let t=document.querySelectorAll('input[name="combo_mode"]'),i=s=>{u(this,Bt,s.target.value),n(this,R,K).call(this,"debug",`Payment method changed to: ${e(this,Bt)}`),document.dispatchEvent(new CustomEvent("payment-method-changed",{detail:{mode:e(this,Bt)}}))};t.length>0?t.forEach(s=>s.addEventListener("change",i)):document.querySelector('[os-checkout-field="payment-method"]')?.addEventListener("change",i)},ho=new WeakSet,eh=function(){try{let t=document.querySelector('meta[name="spreedly-environment-key"]')?.content||document.querySelector('meta[name="os-payment-env-key"]')?.content;if(!t){n(this,R,K).call(this,"warn","Spreedly environment key not found");return}u(this,ne,new Kn(t,{debug:e(this,Vi),app:e(this,fe)})),n(this,go,ih).call(this),n(this,po,rh).call(this)}catch(t){n(this,R,K).call(this,"error","Error initializing Spreedly:",t)}},go=new WeakSet,ih=function(){e(this,ne).setOnReady(()=>n(this,R,K).call(this,"debug","Spreedly ready")),e(this,ne).setOnError(t=>{n(this,R,K).call(this,"error","Spreedly errors:",t),u(this,be,!1),n(this,Gt,pe).call(this);let i=n(this,mo,sh).call(this,t);n(this,Ft,jt).call(this,i)}),e(this,ne).setOnPaymentMethod((t,i)=>{n(this,R,K).call(this,"debug","Spreedly payment method token received:",t),n(this,ve,si).call(this,{payment_token:t,payment_method:"credit-card",...n(this,Oe,zi).call(this)})})},mo=new WeakSet,sh=function(t){if(!t||t.length===0)return"An unknown error occurred with your payment method";let i={"The card number is not a valid credit card number":"Please enter a valid credit card number","Credit card number entered is not valid":"Please enter a valid credit card number","The card number is too short":"The card number you entered is too short","The card number is too long":"The card number you entered is too long","The card security code is invalid":"Please enter a valid security code (CVV)","The card security code is too short":"The security code (CVV) is too short","The card security code is too long":"The security code (CVV) is too long","The card has expired":"This card has expired. Please use a different card","The card expiration month is invalid":"Please select a valid expiration month","The card expiration year is invalid":"Please select a valid expiration year"};for(let s of t)for(let[r,a]of Object.entries(i))if(s.includes(r))return a;return t[0]},po=new WeakSet,rh=function(){try{let[t,i]=n(this,fo,nh).call(this);n(this,yo,oh).call(this,t,i)}catch(t){n(this,R,K).call(this,"error","Error initializing expiration fields:",t)}},fo=new WeakSet,nh=function(){let t=['[os-checkout-field="cc-month"]','[os-checkout-field="exp-month"]',"#credit_card_exp_month"],i=['[os-checkout-field="cc-year"]','[os-checkout-field="exp-year"]',"#credit_card_exp_year"];return[t.map(s=>document.querySelector(s)).find(Boolean),i.map(s=>document.querySelector(s)).find(Boolean)]},yo=new WeakSet,oh=function(t,i){if(t){t.innerHTML='<option value="">Month</option>';for(let s=1;s<=12;s++){let r=s.toString().padStart(2,"0");t.appendChild(new Option(r,r))}}if(i){i.innerHTML='<option value="">Year</option>';let s=new Date().getFullYear();for(let r=0;r<20;r++){let a=s+r;i.appendChild(new Option(a,a))}}},Xs=new WeakSet,rd=function(){return new URLSearchParams(window.location.search).get("test")==="true"||Dt.isTestMode()},Qs=new WeakSet,nd=function(){e(this,et)?.removeAttribute("action"),e(this,et)?.setAttribute("method","post"),e(this,et).onsubmit=n(this,ri,Zs).bind(this),e(this,et)?.querySelectorAll('button[type="submit"], input[type="submit"]').forEach(t=>{t.disabled=!0,t.setAttribute("type","button")})},tr=new WeakSet,od=function(){let t=document.querySelector('[os-checkout-payment="combo"]');t&&(t.disabled=!0,t.classList.add("is-submitting"))},Gt=new WeakSet,pe=function(){let t=document.querySelector('[os-checkout-payment="combo"]');t&&(t.disabled=!1,t.classList.remove("is-submitting")),u(this,be,!1)},bo=new WeakSet,ah=function(){if(!e(this,ne)){n(this,Ft,jt).call(this,"Credit card processing unavailable");return}let[t,i,s]=n(this,vo,ch).call(this);if(n(this,wo,lh).call(this)||n(this,Xs,rd).call(this)){n(this,So,dh).call(this,t,i,s);return}if(!e(this,ye).validateCreditCard()&&(n(this,R,K).call(this,"debug","Credit card validation failed on initial check"),!i||!s)){u(this,be,!1),n(this,Gt,pe).call(this);return}e(this,ne).tokenizeCard({full_name:t||"",month:i,year:s}),e(this,ne).setOnPaymentMethod((r,a)=>{n(this,ve,si).call(this,{payment_token:r,payment_method:"credit-card",...n(this,Oe,zi).call(this)})})},vo=new WeakSet,ch=function(){let t=!e(this,ye).isSameAsShipping(),i=document.querySelector(`[os-checkout-field="${t?"billing-fname":"fname"}"]`)?.value||"",s=document.querySelector(`[os-checkout-field="${t?"billing-lname":"lname"}"]`)?.value||"",r=c=>c.charAt(0).toUpperCase()+c.slice(1).toLowerCase();return[`${r(i)} ${r(s)}`.trim(),document.querySelector('[os-checkout-field="cc-month"]')?.value||document.querySelector('[os-checkout-field="exp-month"]')?.value||document.querySelector("#credit_card_exp_month")?.value||"",document.querySelector('[os-checkout-field="cc-year"]')?.value||document.querySelector('[os-checkout-field="exp-year"]')?.value||document.querySelector("#credit_card_exp_year")?.value||""]},wo=new WeakSet,lh=function(){let t=new URLSearchParams(window.location.search);return(e(this,Vi)||t.get("debug")==="true")&&t.has("test-card")},So=new WeakSet,dh=function(t,i,s){let r=document.querySelector('[os-checkout-field="cc-number"]')?.value||document.querySelector("#credit_card_number")?.value;if(!r){n(this,Ft,jt).call(this,"Please enter a credit card number");return}n(this,ve,si).call(this,{payment_token:`test_card_token_${Date.now()}`,payment_method:"credit-card",test_card_number:r,...n(this,Oe,zi).call(this)})},xo=new WeakSet,uh=function(){n(this,ve,si).call(this,{payment_method:"paypal",...n(this,Oe,zi).call(this)})},er=new WeakSet,ad=function(){let t=new URLSearchParams(window.location.search),i=t.get("package_id")||t.get("pid");return i&&parseInt(i,10)||null},Oe=new WeakSet,zi=function(){try{let t=n(this,ir,cd).call(this,["fname","lname","address1","address2","city","province","postal","country","phone"]),i=e(this,ye).isSameAsShipping()?null:n(this,ir,cd).call(this,["billing-fname","billing-lname","billing-address1","billing-address2","billing-city","billing-province","billing-postal","billing-country","billing-phone"]),s=n(this,sr,ld).call(this,t),r=i?n(this,sr,ld).call(this,i):{...s};if(!e(this,fe)?.state)return n(this,Ft,jt).call(this,"Cart data missing"),null;let a=e(this,fe).state.getState();return a.cart?.items?.length?{user:{email:a.user?.email||"",first_name:a.user?.firstName||s.first_name,last_name:a.user?.lastName||s.last_name},shipping_address:s,billing_address:r,shipping_method:n(this,Co,hh).call(this,a),attribution:a.cart.attribution||{},lines:n(this,rr,dd).call(this,a.cart.items)}:(n(this,Ft,jt).call(this,"Cart is empty"),null)}catch(t){return n(this,R,K).call(this,"error","Error getting order data:",t),n(this,Ft,jt).call(this,"Error preparing order"),null}},ir=new WeakSet,cd=function(t){let i={};return t.forEach(s=>{let r=document.querySelector(`[os-checkout-field="${s}"]`)?.value;r&&(i[s.replace("billing-","")]=r)}),i},sr=new WeakSet,ld=function(t){return{first_name:t.fname||"",last_name:t.lname||"",line1:t.address1||"",line2:t.address2||"",line3:"",line4:t.city||"",state:t.province||"",postcode:t.postal||"",country:t.country||"",phone_number:t.phone||""}},Co=new WeakSet,hh=function(t){let i=t.cart?.shippingMethod;return typeof i=="number"?i:parseInt(i,10)||1},rr=new WeakSet,dd=function(t){return t.map(i=>{let s=parseInt(i.id||i.external_id,10)||n(this,er,ad).call(this);if(!s)throw new Error(`Invalid package ID for item: ${i.name}`);let r={package_id:s,quantity:i.quantity||1};return i.is_upsell===!0&&(r.is_upsell=!0,n(this,R,K).call(this,"debug",`Adding line item with is_upsell=true: ${s}`)),r})},ve=new WeakSet,si=function(t){if(!t||!e(this,Di)){n(this,Ft,jt).call(this,"Cannot create order"),n(this,Gt,pe).call(this);return}n(this,Qs,nd).call(this);let i=n(this,_o,gh).call(this,t);e(this,Di).createOrder(i).then(s=>n(this,To,yh).call(this,s)).catch(s=>n(this,Ft,jt).call(this,n(this,Eo,mh).call(this,s))).finally(()=>n(this,Gt,pe).call(this))},_o=new WeakSet,gh=function(t){let i={...t,success_url:t.success_url||window.location.origin+"/checkout/confirmation/"};return t.payment_token&&(i.payment_detail={card_token:t.payment_token},delete i.payment_token),t.payment_method&&(i.payment_detail=i.payment_detail||{},i.payment_detail.payment_method={"credit-card":"card_token",credit:"card_token",paypal:"paypal"}[t.payment_method]||t.payment_method,delete i.payment_method),i.shipping_method=parseInt(i.shipping_method,10)||1,i.billing_address=i.billing_address||i.shipping_address,i},Eo=new WeakSet,mh=function(t){try{let i=JSON.parse(t.message);if(i?.payment_details)return n(this,Ao,ph).call(this,i);if(i?.message)return`Order creation failed: ${Array.isArray(i.message)?i.message.map(s=>Object.entries(s).map(([r,a])=>`${r}: ${a}`).join(", ")).join(", "):Object.entries(i.message).map(([s,r])=>`${s}: ${r}`).join(", ")}`}catch{return t.message||"Unknown error"}return"Order creation failed"},Ao=new WeakSet,ph=function(t){let i=t.payment_response_code,s=t.payment_details;return{3005:"The card number you entered is invalid. Please check and try again.",3006:"The card expiration date is invalid. Please check and try again.",3007:"The card security code (CVV) is invalid. Please check and try again.",3008:"The card has been declined. Please try another payment method.",3009:"This card has expired. Please use a different card.",3010:"The card has insufficient funds. Please try another payment method."}[i]||s||"There was a problem processing your payment. Please try again."},Ft=new WeakSet,jt=function(t){n(this,Gt,pe).call(this),n(this,nr,ud).call(this),e(this,Bt)==="credit-card"&&(t.includes("card")||t.includes("Card")||t.includes("CVV"))&&n(this,ko,fh).call(this,t);let s=document.querySelector('[os-checkout-element="spreedly-error"]');if(s){let r=s.querySelector('[data-os-message="error"]');r&&(r.textContent=t,s.style.display="flex")}else{let r=document.querySelector('[os-checkout-element="payment-error"]');r?(r.textContent=t,r.style.display="block",r.scrollIntoView({behavior:"smooth",block:"center"})):alert(`Payment Error: ${t}`)}},ko=new WeakSet,fh=function(t){let i='[os-checkout-field="cc-number"]',s="#credit_card_number";t.toLowerCase().includes("cvv")||t.toLowerCase().includes("security code")?(i='[os-checkout-field="cc-cvv"]',s="#credit_card_cvv"):(t.toLowerCase().includes("expiration")||t.toLowerCase().includes("expired"))&&(i='[os-checkout-field="cc-month"], [os-checkout-field="cc-year"]',s="#credit_card_exp_month, #credit_card_exp_year");let r=i.split(",").map(d=>d.trim()),a=s.split(",").map(d=>d.trim());[...r,...a].forEach(d=>{let h=document.querySelector(d);if(!h)return;let g=h.closest(".form-group")||h.parentElement;if(!g)return;h.classList.add("is-invalid");let m=g.querySelector(".invalid-feedback");m||(m=document.createElement("div"),m.className="invalid-feedback",g.appendChild(m)),m.textContent=t,m.style.display="block"});let c=document.querySelector(r[0])||document.querySelector(a[0]);c&&(c.focus(),c.scrollIntoView({behavior:"smooth",block:"center"}))},nr=new WeakSet,ud=function(){['[os-checkout-field="cc-number"]',"#credit_card_number",'[os-checkout-field="cc-cvv"]',"#credit_card_cvv",'[os-checkout-field="cc-month"]',"#credit_card_exp_month",'[os-checkout-field="cc-year"]',"#credit_card_exp_year"].forEach(s=>{let r=document.querySelector(s);if(!r)return;r.classList.remove("is-invalid");let a=r.closest(".form-group")||r.parentElement;if(a){let c=a.querySelector(".invalid-feedback");c&&(c.style.display="none")}});let i=document.querySelector('[os-checkout-element="payment-error"]');i&&(i.style.display="none")},To=new WeakSet,yh=function(t){sessionStorage.setItem("order_reference",t.ref_id),e(this,fe)?.triggerEvent?.("order.created",t);let i=n(this,$o,bh).call(this,t);window.location.href=i},$o=new WeakSet,bh=function(t){let i=document.querySelector('meta[name="os-next-page"]')?.content;return i?`${i}${i.includes("?")?"&":"?"}ref_id=${t.ref_id}`:t.confirmation_url||t.order_status_url||`/checkout/confirmation/?ref_id=${t.ref_id}`};var Po,Z,Mt,P,ni,Kt,oi,we,Se,Yt,oe,Io,vh,X,rt,qo,wh,ai,or,cr,gd,Fo,Sh,Mo,xh,No,Ch,Oo,_h,Ue,Wi,ci,ar,md,wp,Lo=class{constructor(t){o(this,Io);o(this,X);o(this,qo);o(this,ai);o(this,cr);o(this,Fo);o(this,Mo);o(this,No);o(this,Oo);o(this,Ue);o(this,ci);o(this,md);o(this,Po,void 0);o(this,Z,void 0);o(this,Mt,void 0);o(this,P,void 0);o(this,ni,{});o(this,Kt,{});o(this,oi,{fname:"billing-fname",lname:"billing-lname",address1:"billing-address1",address2:"billing-address2",city:"billing-city",province:"billing-province",postal:"billing-postal",country:"billing-country",phone:"billing-phone"});o(this,we,!1);o(this,Se,null);o(this,Yt,null);o(this,oe,null);u(this,Po,t),t?.logger?typeof t.logger.debug=="function"&&typeof t.logger.info=="function"&&typeof t.logger.warn=="function"&&typeof t.logger.error=="function"?u(this,Z,t.logger):u(this,Z,t.logger.createModuleLogger?t.logger.createModuleLogger("BILLING"):console):u(this,Z,console),n(this,Io,vh).call(this)}copyShippingToBilling(){try{Object.entries(e(this,ni)).forEach(([t,i])=>{let s=e(this,oi)[t],r=e(this,Kt)[s];r&&i&&(r.value=i.value,r.dispatchEvent(new Event("change",{bubbles:!0})))}),e(this,Kt)["billing-address1"]&&e(this,Kt)["billing-address1"].value&&e(this,Kt)["billing-address1"].value.length>0&&n(this,Ue,Wi).call(this),n(this,X,rt).call(this,"Copied shipping address to billing address")}catch(t){n(this,cr,gd).call(this,"Error copying shipping to billing:",t)}}getBillingAddressData(){if(e(this,Mt)&&e(this,Mt).checked)return null;let t={};return Object.entries(e(this,Kt)).forEach(([i,s])=>{let r=i.replace("billing-","");t[r]=s.value}),t}isSameAsShipping(){let t=e(this,Mt)?e(this,Mt).checked:!0;return n(this,X,rt).call(this,`Billing address is ${t?"same as":"different from"} shipping`),t}};Po=new WeakMap,Z=new WeakMap,Mt=new WeakMap,P=new WeakMap,ni=new WeakMap,Kt=new WeakMap,oi=new WeakMap,we=new WeakMap,Se=new WeakMap,Yt=new WeakMap,oe=new WeakMap,Io=new WeakSet,vh=function(){try{if(u(this,Mt,document.querySelector('[os-checkout-field="same-as-shipping"]')||document.querySelector('[name="use_shipping_address"]')||document.querySelector("#use_shipping_address")),u(this,P,document.querySelector('[os-checkout-element="different-billing-address"]')),u(this,Yt,document.querySelector('[data-os-component="billing-location"]')),u(this,oe,document.querySelector('[os-checkout-field="billing-address1"]')),!e(this,Mt)){n(this,ai,or).call(this,'Same as shipping checkbox not found. Tried multiple selectors including [name="use_shipping_address"] and #use_shipping_address');let t=document.querySelectorAll('input[type="checkbox"]');n(this,X,rt).call(this,`Found ${t.length} checkboxes on the page:`),t.forEach((i,s)=>{n(this,X,rt).call(this,`Checkbox ${s+1}: id=${i.id}, name=${i.name}, class=${i.className}`)});return}if(!e(this,P))if(n(this,ai,or).call(this,'Billing form container not found with selector [os-checkout-element="different-billing-address"]'),u(this,P,document.querySelector(".billing_form-container")),e(this,P))n(this,qo,wh).call(this,"Found billing form container with alternative selector .billing_form-container");else return;n(this,X,rt).call(this,"BillingAddressHandler initialized"),n(this,Mo,xh).call(this),u(this,Se,e(this,Mt).checked),n(this,ci,ar).call(this,e(this,Se),!1),n(this,Fo,Sh).call(this),n(this,No,Ch).call(this)}catch(t){n(this,cr,gd).call(this,"Error initializing BillingAddressHandler:",t)}},X=new WeakSet,rt=function(t,...i){typeof e(this,Z).debug=="function"?e(this,Z).debug(t,...i):typeof e(this,Z).log=="function"&&e(this,Z).log(t,...i)},qo=new WeakSet,wh=function(t,...i){typeof e(this,Z).info=="function"?e(this,Z).info(t,...i):typeof e(this,Z).log=="function"&&e(this,Z).log(t,...i)},ai=new WeakSet,or=function(t,...i){typeof e(this,Z).warn=="function"?e(this,Z).warn(t,...i):typeof e(this,Z).log=="function"&&e(this,Z).log(`WARNING: ${t}`,...i)},cr=new WeakSet,gd=function(t,i){typeof e(this,Z).error=="function"?e(this,Z).error(t,i):typeof e(this,Z).log=="function"?e(this,Z).log(`ERROR: ${t}`,i):console.error(t,i)},Fo=new WeakSet,Sh=function(){if(!e(this,Yt)){n(this,ai,or).call(this,'Billing location component not found with selector [data-os-component="billing-location"]');return}if(!e(this,oe)){n(this,ai,or).call(this,'Billing address1 field not found with selector [os-checkout-field="billing-address1"]');return}e(this,Yt).classList.add("cc-hidden"),n(this,X,rt).call(this,"Billing location component initially hidden")},Mo=new WeakSet,xh=function(){Object.keys(e(this,oi)).forEach(t=>{let i=document.querySelector(`[os-checkout-field="${t}"]`);i&&(e(this,ni)[t]=i)}),Object.values(e(this,oi)).forEach(t=>{let i=document.querySelector(`[os-checkout-field="${t}"]`);i&&(e(this,Kt)[t]=i)}),n(this,X,rt).call(this,`Cached ${Object.keys(e(this,ni)).length} shipping fields and ${Object.keys(e(this,Kt)).length} billing fields`)},No=new WeakSet,Ch=function(){e(this,Mt).addEventListener("change",t=>{e(this,we)||(u(this,Se,t.target.checked),n(this,ci,ar).call(this,t.target.checked,!0),t.target.checked&&this.copyShippingToBilling(),n(this,X,rt).call(this,`Billing address changed: ${t.target.checked?"Same as shipping":"Different from shipping"}`))}),document.addEventListener("payment-method-changed",()=>{e(this,Se)!==null&&!e(this,we)&&(n(this,ci,ar).call(this,e(this,Se),!1),n(this,X,rt).call(this,`Payment method changed, billing address state: ${e(this,Se)?"Same as shipping":"Different from shipping"}`))}),document.addEventListener("location-fields-shown",()=>{e(this,Yt)&&(n(this,Ue,Wi).call(this),n(this,X,rt).call(this,"Location fields shown by AddressAutocomplete, showing billing location component as well"))}),Object.entries(e(this,ni)).forEach(([t,i])=>{i.addEventListener("change",()=>{if(e(this,Mt).checked){let s=e(this,oi)[t],r=e(this,Kt)[s];r&&(r.value=i.value,r.dispatchEvent(new Event("change",{bubbles:!0})))}})}),e(this,oe)&&e(this,Yt)&&(e(this,oe).addEventListener("input",()=>{e(this,oe).value.length>=3&&n(this,Ue,Wi).call(this)}),n(this,Oo,_h).call(this))},Oo=new WeakSet,_h=function(){new MutationObserver(i=>{i.forEach(s=>{s.type==="attributes"&&(s.attributeName==="value"||s.attributeName==="autocomplete-value")&&e(this,oe).value.length>0&&(n(this,Ue,Wi).call(this),n(this,X,rt).call(this,"Autocomplete detected on billing address field"))})}).observe(e(this,oe),{attributes:!0,attributeFilter:["value","autocomplete-value"]}),document.addEventListener("google-places-autocomplete-filled",i=>{i.detail&&i.detail.field==="billing-address1"&&(n(this,Ue,Wi).call(this),n(this,X,rt).call(this,"Google Places autocomplete detected on billing address field"))}),n(this,X,rt).call(this,"Billing address autocomplete detection set up")},Ue=new WeakSet,Wi=function(){e(this,Yt)&&e(this,Yt).classList.contains("cc-hidden")&&(e(this,Yt).classList.remove("cc-hidden"),n(this,X,rt).call(this,"Billing location component shown"))},ci=new WeakSet,ar=function(t,i=!0){if(!e(this,P)||e(this,we))return;u(this,we,!0),e(this,P).style.transition||(e(this,P).style.transition="height 0.3s ease-out, opacity 0.3s ease-out");let s=r=>{r.propertyName==="height"&&(t||(e(this,P).style.height="auto"),e(this,P).style.overflow="",u(this,we,!1),e(this,P).removeEventListener("transitionend",s),n(this,X,rt).call(this,`Billing form transition completed: ${t?"collapsed":"expanded"}`))};i?(e(this,P).removeEventListener("transitionend",s),t?(e(this,P).style.height=`${e(this,P).scrollHeight}px`,e(this,P).style.overflow="hidden",requestAnimationFrame(()=>{e(this,P).style.height="0px",e(this,P).style.opacity="0",n(this,X,rt).call(this,"Collapsing billing form")}),e(this,P).addEventListener("transitionend",s),e(this,P).addEventListener("transitionend",r=>{r.propertyName==="height"&&t&&(e(this,P).style.display="none",n(this,X,rt).call(this,"Billing form hidden after collapse"))},{once:!0})):(e(this,P).style.display="flex",e(this,P).style.height="0px",e(this,P).style.overflow="hidden",requestAnimationFrame(()=>{let r=e(this,P).scrollHeight;e(this,P).style.height=`${r}px`,e(this,P).style.opacity="1",n(this,X,rt).call(this,`Expanding billing form to height: ${r}px`)}),e(this,P).addEventListener("transitionend",s))):(e(this,P).style.display=t?"none":"flex",e(this,P).style.height=t?"0":"auto",e(this,P).style.opacity=t?"0":"1",e(this,P).style.overflow="",u(this,we,!1),n(this,X,rt).call(this,`Set billing form without animation: ${t?"hidden":"visible"}`))},md=new WeakSet,wp=function(){n(this,ci,ar).call(this,e(this,Mt).checked,!1)};var Re,li,Hi,ji,ze,Ro,zo,Eh,lr,pd,Uo=class{constructor(t){o(this,zo);o(this,lr);o(this,Re,void 0);o(this,li,void 0);o(this,Hi,void 0);o(this,ji,void 0);o(this,ze,new Map);o(this,Ro,null);u(this,Re,t),u(this,li,document.querySelector("[os-payment-mode]")),u(this,Hi,document.querySelectorAll('input[name="combo_mode"]')),u(this,ji,document.querySelectorAll('[os-checkout-element$="-form"]')),e(this,li)&&e(this,Hi).length>0?(e(this,Re).debug("PaymentSelector initialized with elements found"),n(this,zo,Eh).call(this)):e(this,Re).warn("PaymentSelector elements not found")}};Re=new WeakMap,li=new WeakMap,Hi=new WeakMap,ji=new WeakMap,ze=new WeakMap,Ro=new WeakMap,zo=new WeakSet,Eh=function(){let t=document.querySelector('input[name="combo_mode"]:checked');t&&e(this,li)&&n(this,lr,pd).call(this,t.value,!1),e(this,Hi).forEach(i=>i.addEventListener("change",s=>n(this,lr,pd).call(this,s.target.value,!0))),e(this,Re).debug("PaymentSelector event listeners attached")},lr=new WeakSet,pd=function(t,i=!0){e(this,Re).debug(`Setting payment mode to: ${t}, animate: ${i}`),e(this,li)?.setAttribute("os-payment-mode",t),u(this,Ro,t),e(this,ji).forEach(s=>{s.style.transition="none",s.offsetHeight,s.style.transition=""}),e(this,ji).forEach(s=>{let a=s.getAttribute("os-checkout-element")===`${t}-form`;if(e(this,ze).has(s)){let c=e(this,ze).get(s);s.removeEventListener("transitionend",c),e(this,ze).delete(s)}if(i){s.style.display="block",s.style.overflow="hidden";let c=s.scrollHeight;s.style.height=`${c}px`,s.offsetHeight;let d=h=>{h.propertyName==="height"&&(a?(s.style.height="auto",s.style.overflow=""):s.style.display="none",e(this,ze).delete(s))};e(this,ze).set(s,d),s.addEventListener("transitionend",d,{once:!0}),requestAnimationFrame(()=>{s.style.height=a?`${s.scrollHeight}px`:"0",s.style.opacity=a?"1":"0"})}else s.style.transition="none",Object.assign(s.style,{display:a?"block":"none",height:a?"auto":"0",opacity:a?"1":"0",overflow:""}),s.offsetHeight,s.style.transition=""}),document.dispatchEvent(new CustomEvent("payment-method-changed",{detail:{mode:t}}))};var at,Gi,Jt,ui,Bo,Ah,Vo,kh,xe,di,Wo,Th,ur,fd,Ho,$h,jo,Lh,hr,yd,hi,dr,Go,Ph,Do=class{constructor(t,i={}){o(this,Bo);o(this,Vo);o(this,xe);o(this,Wo);o(this,ur);o(this,Ho);o(this,jo);o(this,hr);o(this,hi);o(this,Go);o(this,at,void 0);o(this,Gi,!1);o(this,Jt,void 0);o(this,ui,void 0);u(this,at,t),u(this,ui,i.enableGoogleMapsAutocomplete!==!1),u(this,Jt,{shipping:{address:document.querySelector('[os-checkout-field="address1"]'),city:document.querySelector('[os-checkout-field="city"]'),state:document.querySelector('[os-checkout-field="province"]'),zip:document.querySelector('[os-checkout-field="postal"]'),country:document.querySelector('[os-checkout-field="country"]')},billing:{address:document.querySelector('[os-checkout-field="billing-address1"]'),city:document.querySelector('[os-checkout-field="billing-city"]'),state:document.querySelector('[os-checkout-field="billing-province"]'),zip:document.querySelector('[os-checkout-field="billing-postal"]'),country:document.querySelector('[os-checkout-field="billing-country"]')},locations:document.querySelectorAll('[data-os-component="location"]')}),e(this,at).info(`AddressAutocomplete initialized (autocomplete ${e(this,ui)?"enabled":"disabled"})`),n(this,Vo,kh).call(this),n(this,Bo,Ah).call(this)}};at=new WeakMap,Gi=new WeakMap,Jt=new WeakMap,ui=new WeakMap,Bo=new WeakSet,Ah=async function(){if(n(this,Go,Ph).call(this),!e(this,ui))return e(this,at).debug("Google Maps autocomplete disabled, using basic field listeners"),n(this,hi,dr).call(this);await n(this,ur,fd).call(this)},Vo=new WeakSet,kh=function(){e(this,Gi)||(e(this,Jt).locations.forEach(t=>t.classList.add("cc-hidden")),e(this,at).debug("Location fields hidden"))},xe=new WeakSet,di=function(){e(this,Gi)||(e(this,Jt).locations.forEach(t=>t.classList.remove("cc-hidden")),u(this,Gi,!0),document.dispatchEvent(new CustomEvent("location-fields-shown")),e(this,at).debug("Location fields shown"))},Wo=new WeakSet,Th=function(){return!!window.google?.maps?.places},ur=new WeakSet,fd=async function(t=0){return e(this,ui)?n(this,Wo,Th).call(this)?(e(this,at).debug("Google Maps API available"),n(this,Ho,$h).call(this)):t>=3?(e(this,at).warn("Google Maps API unavailable after 3 attempts"),n(this,hi,dr).call(this)):(e(this,at).debug(`Retrying Google Maps check, attempt ${t+1}`),await new Promise(i=>setTimeout(i,1e3*1.5**t)),n(this,ur,fd).call(this,t+1)):n(this,hi,dr).call(this)},Ho=new WeakSet,$h=function(){let{shipping:t,billing:i}=e(this,Jt);[t,i].forEach(s=>{s.address&&(n(this,jo,Lh).call(this,s.address,s),e(this,at).debug(`Autocomplete set up for ${s.address.getAttribute("os-checkout-field")}`))})},jo=new WeakSet,Lh=function(t,i){try{let s=new google.maps.places.Autocomplete(t,{types:["address"],fields:["address_components","formatted_address"]});s.addListener("place_changed",()=>{let r=s.getPlace();if(!r.address_components)return;n(this,xe,di).call(this);let a=Object.fromEntries(r.address_components.map(c=>[c.types[0],{long:c.long_name,short:c.short_name}]));if(i.address.value=[a.street_number?.long,a.route?.long].filter(Boolean).join(" "),i.city&&(i.city.value=a.locality?.long??""),i.zip&&(i.zip.value=a.postal_code?.long??""),i.country&&a.country){let c=a.country.short;i.country.value!==c&&(i.country.value=c,i.country.dispatchEvent(new Event("change",{bubbles:!0})),e(this,at).debug(`Country set to ${c}`)),i.state&&a.administrative_area_level_1&&n(this,hr,yd).call(this,i.state,a.administrative_area_level_1.short)}[i.address,i.city,i.zip].forEach(c=>c?.dispatchEvent(new Event("change",{bubbles:!0})))}),t.addEventListener("blur",()=>t.value.length>10&&n(this,xe,di).call(this)),t.addEventListener("keydown",r=>r.key==="Enter"&&r.preventDefault())}catch(s){e(this,at).error("Autocomplete setup failed:",s),n(this,hi,dr).call(this)}},hr=new WeakSet,yd=async function(t,i,s=0){if(s>=5){e(this,at).warn(`Failed to set state ${i} after 5 attempts`);return}await new Promise(a=>setTimeout(a,300*1.5**s)),Array.from(t.options).some(a=>a.value===i)?(t.value=i,t.dispatchEvent(new Event("change",{bubbles:!0})),e(this,at).debug(`State set to ${i}`)):n(this,hr,yd).call(this,t,i,s+1)},hi=new WeakSet,dr=function(){[e(this,Jt).shipping.address,e(this,Jt).billing.address].forEach(t=>{t?.addEventListener("blur",()=>t.value.length>10&&n(this,xe,di).call(this))}),e(this,at).debug("Basic field listeners set up")},Go=new WeakSet,Ph=function(){let t=document.createElement("style");t.textContent=`
        @keyframes onAutoFillStart { from { opacity: 0.99; } to { opacity: 1; } }
        input:-webkit-autofill { animation-name: onAutoFillStart; }
      `,document.head.appendChild(t),[e(this,Jt).shipping.address,e(this,Jt).billing.address].filter(Boolean).forEach(s=>{s.addEventListener("input",()=>s.value.length>10&&n(this,xe,di).call(this)),s.addEventListener("change",()=>s.value.length>0&&n(this,xe,di).call(this)),s.addEventListener("animationstart",r=>{r.animationName==="onAutoFillStart"&&(e(this,at).debug(`Autofill detected on ${s.getAttribute("os-checkout-field")}`),n(this,xe,di).call(this))})}),e(this,at).debug("Autofill detection initialized")};var St,Ki,Yo,Ih,gr,bd,Jo,qh,Zo,Fh,mr,vd,pr,wd,Xo,Mh,Qo,Nh,Ko=class{constructor(t){o(this,Yo);o(this,gr);o(this,Jo);o(this,Zo);o(this,mr);o(this,pr);o(this,Xo);o(this,Qo);o(this,St,void 0);o(this,Ki,!!window.intlTelInput);u(this,St,t),e(this,Ki)?(e(this,St).info("intlTelInput available, initializing phone inputs"),n(this,gr,bd).call(this)):(e(this,St).warn("intlTelInput not found, loading dynamically"),n(this,Yo,Ih).call(this).then(()=>n(this,gr,bd).call(this)))}};St=new WeakMap,Ki=new WeakMap,Yo=new WeakSet,Ih=async function(){let t=[{tag:"link",rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.min.css"},{tag:"script",src:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js",async:!0},{tag:"script",src:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",async:!0}];await Promise.all(t.map(({tag:i,...s})=>{let r=document.createElement(i);return Object.assign(r,s),document.head.appendChild(r),i==="link"?Promise.resolve():new Promise(a=>r.onload=a)})),u(this,Ki,!0),e(this,St).debug("intlTelInput and utils loaded")},gr=new WeakSet,bd=function(){if(!e(this,Ki))return;let t=document.querySelectorAll('input[type="tel"]');e(this,St).info(`Found ${t.length} phone inputs`),t.forEach((i,s)=>n(this,Jo,qh).call(this,i,s+1))},Jo=new WeakSet,qh=function(t,i){try{let s=window.intlTelInput(t,{utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",separateDialCode:!0,onlyCountries:["us"],initialCountry:"us",allowDropdown:!1,dropdownContainer:document.body,useFullscreenPopup:!0,formatOnDisplay:!0,autoPlaceholder:"aggressive",customContainer:"iti-tel-input",autoFormat:!0,nationalMode:!0});t.iti=s,e(this,St).debug(`Phone input ${i} (${t.getAttribute("os-checkout-field")??"unknown"}) initialized`),n(this,Xo,Mh).call(this,t,s),n(this,Qo,Nh).call(this,t,s),t.addEventListener("input",()=>{let r=t.value.trim();if(r){let h=r.replace(/\D/g,""),g="";if(h.length>0&&(h.length<=3?g=`(${h}`:h.length<=6?g=`(${h.slice(0,3)}) ${h.slice(3)}`:g=`(${h.slice(0,3)}) ${h.slice(3,6)}-${h.slice(6,10)}`),t.value!==g){let m=t.selectionStart,p=t.value.length;if(t.value=g,m!==null){let b=g.length-p;t.setSelectionRange(m+b,m+b)}}}let a=s.isValidNumber(),c=s.getNumberType(),d=s.getValidationError();if(!r){n(this,mr,vd).call(this,t);return}console.group("Phone Number Validation"),s.getNumber(),n(this,pr,wd).call(this,c),console.groupEnd(),e(this,St).debug("Phone validation:",{number:r,isValid:a,formattedNumber:s.getNumber(),type:n(this,pr,wd).call(this,c),error:d})}),t.addEventListener("blur",()=>{let r=t.value.trim();if(r){let a=s.isValidNumber();a&&(t.value=s.getNumber(intlTelInputUtils.numberFormat.NATIONAL)),s.getNumber(),a?n(this,mr,vd).call(this,t):n(this,Zo,Fh).call(this,t,"Please enter a valid US phone number (e.g. 555-555-5555)")}})}catch(s){e(this,St).error(`Error initializing phone input ${i}:`,s)}},Zo=new WeakSet,Fh=function(t,i){t.classList.add("error");let s=t.closest(".iti");s&&(s.classList.add("error"),s.style.border="1px solid red");let r=t.closest(".frm-flds")||t.closest(".form-group"),a=r.querySelector(".pb-input-error");a||(a=document.createElement("div"),a.className="pb-input-error",r.appendChild(a)),a.textContent=i,Object.assign(a.style,{color:"red",fontSize:"0.875rem",marginTop:"0.25rem",display:"block",position:"relative",clear:"both"})},mr=new WeakSet,vd=function(t){t.classList.remove("error");let i=t.closest(".iti");i&&(i.classList.remove("error"),i.style.border="");let r=(t.closest(".frm-flds")||t.closest(".form-group")).querySelector(".pb-input-error");r&&r.remove()},pr=new WeakSet,wd=function(t){return{0:"FIXED_LINE",1:"MOBILE",2:"FIXED_LINE_OR_MOBILE",3:"TOLL_FREE",4:"PREMIUM_RATE",5:"SHARED_COST",6:"VOIP",7:"PERSONAL_NUMBER",8:"PAGER",9:"UAN",10:"UNKNOWN"}[t]||"UNKNOWN"},Xo=new WeakSet,Mh=function(t,i){let s=t.getAttribute("os-checkout-field");if(!s){e(this,St).warn("Phone input missing os-checkout-field attribute");return}let r=document.querySelector(s==="phone"?'[os-checkout-field="country"]':'[os-checkout-field="billing-country"]');if(!r){e(this,St).warn(`Country select not found for ${s}`);return}r.value!=="US"&&(r.value="US",r.dispatchEvent(new Event("change",{bubbles:!0})),e(this,St).debug("Country select updated to US"))},Qo=new WeakSet,Nh=function(t,i){t.validatePhone=()=>t.value.trim()?i.isValidNumber():!t.hasAttribute("required"),t.getFormattedNumber=()=>i.getNumber(),t.closest("form")?.addEventListener("submit",()=>{t.value.trim()&&i.isValidNumber()&&(t.value=i.getNumber(),e(this,St).debug(`Formatted phone number set to ${t.value} on submit`))})};var Q,x,sa,Yi,ae,ce,De,ra,Ji,Zi,f,na,oa,Oh,aa,Uh,ca,Rh,Xi,ta,la,zh,da,Dh,ua,Bh,ha,Vh,ga,Wh,ma,Hh,pa,jh,fa,Gh,ya,Kh,Qi,ea,fr,Sd,ba,Yh,ia=class{constructor(t){o(this,oa);o(this,aa);o(this,ca);o(this,Xi);o(this,la);o(this,da);o(this,ua);o(this,ha);o(this,ga);o(this,ma);o(this,pa);o(this,fa);o(this,ya);o(this,Qi);o(this,fr);o(this,ba);o(this,Q,void 0);o(this,x,void 0);o(this,sa,!1);o(this,Yi,!1);o(this,ae,!1);o(this,ce,!1);o(this,De,null);o(this,ra,3e3);o(this,Ji,null);o(this,Zi,{firstName:'[os-checkout-field="fname"]',lastName:'[os-checkout-field="lname"]',email:'[os-checkout-field="email"]',phone:'[os-checkout-field="phone"]',address1:'[os-checkout-field="address1"]',address2:'[os-checkout-field="address2"]',city:'[os-checkout-field="city"]',province:'[os-checkout-field="province"]',postal:'[os-checkout-field="postal"]',country:'[os-checkout-field="country"]'});o(this,f,{firstName:null,lastName:null,email:null,phone:null,address1:null,address2:null,city:null,province:null,postal:null,country:null});o(this,na,/^[^\s@]+@[^\s@]+\.[^\s@]+$/);u(this,Q,t),e(this,Q)&&e(this,Q).logger?u(this,x,e(this,Q).logger.createModuleLogger("PROSPECT")):u(this,x,{debug:(i,s)=>console.log(`[PROSPECT DEBUG] ${i}`,s!==void 0?s:""),info:(i,s)=>console.info(`[PROSPECT INFO] ${i}`,s!==void 0?s:""),warn:(i,s)=>console.warn(`[PROSPECT WARN] ${i}`,s!==void 0?s:""),error:(i,s)=>console.error(`[PROSPECT ERROR] ${i}`,s!==void 0?s:"")}),n(this,oa,Oh).call(this)}triggerBeginCheckout(){return e(this,Q)&&e(this,Q).events?e(this,ce)?(e(this,x).debug("beginCheckout event already fired, skipping"),!1):(e(this,x).info("Manually triggering beginCheckout event"),e(this,Q).events.beginCheckout(),u(this,ce,!0),!0):(e(this,x).warn("Cannot trigger beginCheckout event: Events manager not available"),!1)}resetBeginCheckoutFlag(){return u(this,ce,!1),e(this,x).debug("Reset beginCheckout flag"),!0}};Q=new WeakMap,x=new WeakMap,sa=new WeakMap,Yi=new WeakMap,ae=new WeakMap,ce=new WeakMap,De=new WeakMap,ra=new WeakMap,Ji=new WeakMap,Zi=new WeakMap,f=new WeakMap,na=new WeakMap,oa=new WeakSet,Oh=function(){e(this,x).info("Initializing ProspectCartHandler"),n(this,aa,Uh).call(this),e(this,f).email&&(e(this,f).firstName||e(this,f).lastName)?(n(this,ca,Rh).call(this),u(this,sa,!0),e(this,x).info("ProspectCartHandler initialized successfully")):e(this,x).warn("Required form fields not found, ProspectCartHandler not initialized")},aa=new WeakSet,Uh=function(){Object.keys(e(this,Zi)).forEach(t=>{if(e(this,f)[t]=document.querySelector(e(this,Zi)[t]),!e(this,f)[t]){let i=e(this,Zi)[t].replace("os-checkout-field","data-os-field");e(this,f)[t]=document.querySelector(i)}e(this,f)[t]?e(this,x).debug(`Found ${t} field`):e(this,x).debug(`${t} field not found`)})},ca=new WeakSet,Rh=function(){e(this,f).email&&e(this,f).email.addEventListener("blur",()=>n(this,Xi,ta).call(this)),e(this,f).firstName&&e(this,f).firstName.addEventListener("blur",()=>n(this,Xi,ta).call(this)),e(this,f).lastName&&e(this,f).lastName.addEventListener("blur",()=>n(this,Xi,ta).call(this));let t=document.querySelector('form[os-checkout="form"]');t&&t.addEventListener("submit",()=>{u(this,ae,!0),e(this,De)&&clearTimeout(e(this,De))}),e(this,x).debug("Event listeners attached to form fields")},Xi=new WeakSet,ta=function(){e(this,Yi)||e(this,ae)||(e(this,De)&&clearTimeout(e(this,De)),n(this,la,zh).call(this),u(this,De,setTimeout(()=>{n(this,da,Dh).call(this)},e(this,ra))))},la=new WeakSet,zh=function(){if(e(this,ce))return;let t=e(this,f).email&&e(this,f).email.value&&e(this,f).email.value.trim().length>0,i=e(this,f).firstName&&e(this,f).firstName.value&&e(this,f).firstName.value.trim().length>0||e(this,f).lastName&&e(this,f).lastName.value&&e(this,f).lastName.value.trim().length>0;(t||i)&&(e(this,x).debug("User has started entering checkout information, firing beginCheckout event"),e(this,Q).events&&(e(this,Q).events.beginCheckout(),u(this,ce,!0),e(this,x).info("beginCheckout event fired")))},da=new WeakSet,Dh=function(){if(e(this,Yi)||e(this,ae)){e(this,x).debug("Cart already created or attempted, skipping");return}if(!n(this,ua,Bh).call(this)){e(this,x).debug("Not enough information to create a cart");return}let t=n(this,ha,Vh).call(this);if(e(this,Ji)&&n(this,ga,Wh).call(this,t,e(this,Ji))){e(this,x).debug("Form data has not changed since last attempt, skipping");return}u(this,Ji,t),u(this,ae,!0),n(this,ma,Hh).call(this)},ua=new WeakSet,Bh=function(){if(!(e(this,f).email&&e(this,f).email.value&&e(this,na).test(e(this,f).email.value)))return e(this,x).debug("Email is missing or invalid"),!1;let i=e(this,f).firstName&&e(this,f).firstName.value&&e(this,f).firstName.value.trim().length>=2,s=e(this,f).lastName&&e(this,f).lastName.value&&e(this,f).lastName.value.trim().length>=2;return!i&&!s?(e(this,x).debug("First name and last name are missing or too short"),!1):(e(this,x).debug("Minimum required fields are present"),!0)},ha=new WeakSet,Vh=function(){let t={};return Object.keys(e(this,f)).forEach(i=>{e(this,f)[i]&&(t[i]=e(this,f)[i].value)}),t},ga=new WeakSet,Wh=function(t,i){return t.email===i.email&&t.firstName===i.firstName&&t.lastName===i.lastName},ma=new WeakSet,Hh=function(){e(this,x).info("Creating prospect cart");let t=e(this,Q).state.getState("cart");if(!t||!t.items||t.items.length===0){e(this,x).warn("No cart items available, skipping cart creation"),u(this,ae,!1);return}let i=t.attribution||{};e(this,x).debug("Using attribution data from state",i);let s=e(this,f).firstName?e(this,f).firstName.value:"",r=e(this,f).lastName?e(this,f).lastName.value:"",a=e(this,f).email?e(this,f).email.value:"",c=n(this,fr,Sd).call(this);n(this,pa,jh).call(this,a,s,r,c);let d={lines:t.items.map(g=>{let m={package_id:g.id,quantity:g.quantity||1};return g.is_upsell===!0&&(m.is_upsell=!0,e(this,x).debug(`Adding upsell item to prospect cart: ${g.id}`)),m}),user:{first_name:s,last_name:r,email:a},attribution:i};c?d.user.phone_number=c:e(this,x).warn("Invalid phone number format - sending cart without phone number"),t.shippingMethod&&(d.shipping_method=t.shippingMethod.code||t.shippingMethod.id);let h=n(this,ya,Kh).call(this);h&&Object.keys(h).length>0?n(this,fa,Gh).call(this,h)?(e(this,x).debug("Adding valid address data to cart"),d.address=h):e(this,x).info("Address data is incomplete or invalid - sending cart with user info only"):e(this,x).debug("No address data available - sending cart with user info only"),n(this,ba,Yh).call(this,d)},pa=new WeakSet,jh=function(t,i,s,r){if(!e(this,Q).state){e(this,x).warn("State manager not available, cannot update user state");return}try{let a=e(this,Q).state.getState("user")||{},c={...a,email:t||a.email,firstName:i||a.firstName,lastName:s||a.lastName,phone:r||a.phone};e(this,Q).state.setState("user",c),e(this,x).debug("Updated user state with user information",c)}catch(a){e(this,x).error("Error updating user state:",a)}},fa=new WeakSet,Gh=function(t){return t.country==="US"&&(!t.postcode||!n(this,Qi,ea).call(this,t.postcode,"US"))?(e(this,x).warn("US address requires a valid postal code"),!1):!0},ya=new WeakSet,Kh=function(){let t=e(this,f).country&&e(this,f).country.value?e(this,f).country.value:"",i=e(this,f).postal&&e(this,f).postal.value?e(this,f).postal.value:"";if(t==="US"&&i&&!n(this,Qi,ea).call(this,i,t))return e(this,x).warn(`Invalid postal code for US: ${i} - omitting all address data`),null;let s={};e(this,f).firstName&&e(this,f).firstName.value&&(s.first_name=e(this,f).firstName.value),e(this,f).lastName&&e(this,f).lastName.value&&(s.last_name=e(this,f).lastName.value);let r=n(this,fr,Sd).call(this);return r&&(s.phone_number=r),e(this,f).address1&&e(this,f).address1.value&&(s.line1=e(this,f).address1.value),e(this,f).address2&&e(this,f).address2.value&&(s.line2=e(this,f).address2.value),e(this,f).city&&e(this,f).city.value&&(s.line4=e(this,f).city.value),e(this,f).province&&e(this,f).province.value&&(s.state=e(this,f).province.value),t&&(s.country=t),i&&(!t||n(this,Qi,ea).call(this,i,t))&&(s.postcode=i),s},Qi=new WeakSet,ea=function(t,i){if(!t||!i)return!0;switch(i.toUpperCase()){case"US":return/^\d{5}(-\d{4})?$/.test(t);case"CA":return/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/.test(t);case"GB":case"UK":return/^[A-Z]{1,2}[0-9][A-Z0-9]? ?[0-9][A-Z]{2}$/i.test(t);case"AU":return/^\d{4}$/.test(t);case"NZ":return/^\d{4}$/.test(t);case"DE":return/^\d{5}$/.test(t);case"FR":return/^\d{5}$/.test(t);default:return t.trim().length>0}},fr=new WeakSet,Sd=function(){if(!e(this,f).phone)return"";if(e(this,f).phone.iti&&typeof e(this,f).phone.iti.getNumber=="function"){let s=e(this,f).phone.iti.getNumber();return e(this,f).phone.iti.isValidNumber()?s:""}let t=e(this,f).phone.value;return t&&/^\+?[1-9]\d{1,14}$/.test(t.replace(/\D/g,""))?t:""},ba=new WeakSet,Yh=function(t){if(!e(this,Q).api||typeof e(this,Q).api.createCart!="function"){e(this,x).error("API client not available"),u(this,ae,!1);return}e(this,x).debug("Sending cart data to API",t),e(this,Q).api.createCart(t).then(i=>{e(this,x).info("Prospect cart created successfully",i),u(this,Yi,!0),e(this,Q).events&&(e(this,Q).events.trigger("prospect.cartCreated",{cart:i}),e(this,ce)?e(this,x).debug("beginCheckout event already fired, skipping"):(e(this,x).info("Triggering beginCheckout event for analytics"),e(this,Q).events.beginCheckout(),u(this,ce,!0)))}).catch(i=>{e(this,x).error("Error creating prospect cart",i),u(this,ae,!1)})};var yr,v,M,xt,wa,Sa,Jh,xa,Zh,Ca,Xh,_a,Qh,Ea,tg,Aa,eg,ka,ig,Ta,sg,$a,rg,La,ng,Pa,og,Ia,ag,qa,cg,Fa,lg,Ma,dg,va=class{constructor(t,i,s){o(this,Sa);o(this,xa);o(this,Ca);o(this,_a);o(this,Ea);o(this,Aa);o(this,ka);o(this,Ta);o(this,$a);o(this,La);o(this,Pa);o(this,Ia);o(this,qa);o(this,Fa);o(this,Ma);o(this,yr,void 0);o(this,v,void 0);o(this,M,void 0);o(this,xt,void 0);o(this,wa,void 0);if(u(this,yr,t),u(this,v,i),u(this,xt,s),u(this,M,document.querySelector('form[os-checkout="form"]')||document.querySelector("form#combo_form")),!e(this,M)){e(this,v).warn('No checkout form found with [os-checkout="form"] selector or form#combo_form');return}e(this,M).removeAttribute("action"),e(this,M).setAttribute("method","post"),e(this,M).setAttribute("novalidate","novalidate");let r=document.createElement("input");r.type="hidden",r.name="js_enabled",r.value="true",e(this,M).appendChild(r);let a=document.createElement("input");a.type="hidden",a.name="prevent_serialization",a.value="true",e(this,M).appendChild(a);let c=d=>(d&&(d.preventDefault(),d.stopPropagation(),d.stopImmediatePropagation()),e(this,M).removeAttribute("action"),e(this,M).setAttribute("method","post"),typeof window.stop=="function"&&window.stop(),e(this,v).debug("Form direct submission prevented"),!1);e(this,M).addEventListener("submit",c,!0),e(this,M).onsubmit=c,n(this,Ma,dg).call(this),e(this,v).debug("CheckoutPage initialized with form found"),n(this,Sa,Jh).call(this),n(this,xa,Zh).call(this)}};yr=new WeakMap,v=new WeakMap,M=new WeakMap,xt=new WeakMap,wa=new WeakMap,Sa=new WeakSet,Jh=function(){try{n(this,Ia,ag).call(this),n(this,_a,Qh).call(this),n(this,Ea,tg).call(this),n(this,Aa,eg).call(this),n(this,ka,ig).call(this),n(this,Ta,sg).call(this),n(this,$a,rg).call(this),n(this,La,ng).call(this),n(this,Pa,og).call(this),n(this,qa,cg).call(this),document.dispatchEvent(new CustomEvent("os:checkout.ready",{detail:{checkoutPage:this}})),e(this,v).info("Checkout page components initialized successfully")}catch(t){e(this,v).error("Error initializing checkout components",t)}},xa=new WeakSet,Zh=function(){try{u(this,wa,new Dt({callback:()=>n(this,Ca,Xh).call(this),logger:e(this,v)})),e(this,v).debug("Konami code handler initialized")}catch(t){e(this,v).error("Error initializing Konami code handler:",t)}},Ca=new WeakSet,Xh=function(){try{e(this,v).info("ðŸŽ® Konami code activated! Creating test order...");let t=Dt.showActivationMessage();setTimeout(()=>{document.body.removeChild(t),this.paymentHandler?(Dt.setTestMode(),this.paymentHandler.processPayment(),e(this,v).info("Konami code test order initiated")):(e(this,v).error("Payment handler not initialized, cannot create test order"),alert("Could not create test order: Payment handler not initialized"))},2e3)}catch(t){e(this,v).error("Error triggering Konami code Easter egg:",t)}},_a=new WeakSet,Qh=function(){try{this.addressHandler=new bn(e(this,M),e(this,v))}catch(t){e(this,v).error("Error initializing AddressHandler",t)}},Ea=new WeakSet,tg=function(){try{this.billingAddressHandler=new Lo(e(this,xt)),e(this,M)&&this.billingAddressHandler&&(e(this,M).__billingAddressHandler=this.billingAddressHandler,e(this,v).debug("BillingAddressHandler initialized and attached to form"))}catch(t){e(this,v).error("Error initializing BillingAddressHandler",t)}},Aa=new WeakSet,eg=function(){try{this.paymentSelector=new Uo(e(this,v))}catch(t){e(this,v).error("Error initializing PaymentSelector",t)}},ka=new WeakSet,ig=function(){try{this.formValidator=new Ii({debugMode:window.location.search.includes("debug=true"),logger:e(this,v)}),e(this,M)&&this.formValidator&&(e(this,M).__formValidator=this.formValidator,e(this,v).debug("FormValidator initialized and attached to form"))}catch(t){e(this,v).error("Error initializing FormValidator",t)}},Ta=new WeakSet,sg=function(){try{this.paymentHandler=new ro(e(this,yr),e(this,v),e(this,xt))}catch(t){e(this,v).error("Error initializing PaymentHandler",t)}},$a=new WeakSet,rg=function(){try{let t={enableGoogleMapsAutocomplete:e(this,xt).options.enableGoogleMapsAutocomplete};this.addressAutocomplete=new Do(e(this,v),t)}catch(t){e(this,v).error("Error initializing AddressAutocomplete",t)}},La=new WeakSet,ng=function(){try{this.phoneInputHandler=new Ko(e(this,v))}catch(t){e(this,v).error("Error initializing PhoneInputHandler",t)}},Pa=new WeakSet,og=function(){try{e(this,xt)?(this.prospectCartHandler=new ia(e(this,xt)),e(this,v).info("ProspectCartHandler initialized")):e(this,v).warn("App instance not provided, ProspectCartHandler not initialized")}catch(t){e(this,v).error("Error initializing ProspectCartHandler",t)}},Ia=new WeakSet,ag=function(){try{e(this,v).info("Fixing billing form by duplicating shipping form");let t=document.querySelector('[os-checkout-component="shipping-form"]'),i=document.querySelector('[os-checkout-component="billing-form"]');if(t&&i){e(this,v).info("Found shipping form and billing container");let s=t.cloneNode(!0),r={fname:"billing-fname",lname:"billing-lname",address1:"billing-address1",address2:"billing-address2",city:"billing-city",province:"billing-province",postal:"billing-postal",country:"billing-country",phone:"billing-phone"};s.querySelectorAll("input, select").forEach(c=>{let d=c.getAttribute("os-checkout-field");d&&r[d]&&(c.setAttribute("os-checkout-field",r[d]),c.id&&(c.id="billing_"+c.id),c.name&&(c.name="billing_"+c.name),c.getAttribute("data-name")&&c.setAttribute("data-name","Billing "+c.getAttribute("data-name")),c.getAttribute("autocomplete")&&c.setAttribute("autocomplete","billing "+c.getAttribute("autocomplete")))});let a=s.querySelector('[data-os-component="location"]');a&&a.setAttribute("data-os-component","billing-location"),i.innerHTML="",i.appendChild(s),e(this,v).info("Billing form successfully created from shipping form")}else{e(this,v).warn("Could not fix billing form - shipping form or billing container not found"),e(this,v).warn(`Shipping form found: ${!!t}, Billing container found: ${!!i}`);let s=document.querySelectorAll("[os-checkout-component]");e(this,v).warn(`Found ${s.length} checkout components:`),s.forEach(r=>{e(this,v).warn(`- ${r.getAttribute("os-checkout-component")}`)})}}catch(t){e(this,v).error("Error fixing billing form:",t)}},qa=new WeakSet,cg=function(){try{document.addEventListener("payment-method-changed",t=>{e(this,v).debug(`Payment method changed to: ${t.detail.mode}`),document.querySelector("[os-payment-mode]")?.setAttribute("os-payment-mode",t.detail.mode)}),e(this,M)&&(e(this,M).addEventListener("submit",t=>n(this,Fa,lg).call(this,t)),e(this,v).debug("Form submit event listener attached")),e(this,xt)&&e(this,xt).events&&this.prospectCartHandler&&e(this,xt).events.on("prospect.cartCreated",t=>{e(this,v).info("Prospect cart created successfully",t)}),e(this,xt)&&e(this,xt).events&&e(this,xt).events.on("order.created",t=>{e(this,v).info("Order created successfully",t)})}catch(t){e(this,v).error("Error setting up event listeners:",t)}},Fa=new WeakSet,lg=function(t){if(t&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()),e(this,v).debug("Form submission intercepted by #handleSubmit"),e(this,M)){e(this,M).removeAttribute("action"),e(this,M).setAttribute("method","post");let i=s=>(s&&(s.preventDefault(),s.stopPropagation(),s.stopImmediatePropagation()),e(this,M)&&(e(this,M).removeAttribute("action"),e(this,M).setAttribute("method","post")),typeof window.stop=="function"&&window.stop(),e(this,v).debug("Form direct submission prevented"),!1);e(this,M).onsubmit=i}return this.formValidator&&!this.formValidator.validateAllFields()?(e(this,v).warn("Form validation failed, stopping submission"),!1):(this.paymentHandler?(e(this,v).debug("Delegating to paymentHandler.processPayment()"),this.paymentHandler.processPayment()):e(this,v).error("Payment handler not initialized"),!1)},Ma=new WeakSet,dg=function(){try{if(!e(this,M))return;let t=e(this,M).querySelectorAll('button[type="submit"], input[type="submit"]');t.length>0?(e(this,v).debug(`Found ${t.length} submit buttons, converting to type="button"`),t.forEach((i,s)=>{i.setAttribute("type","button"),i.addEventListener("click",r=>{r.preventDefault(),e(this,v).debug(`Submit button ${s+1} clicked, delegating to payment handler`),this.paymentHandler?this.paymentHandler.processPayment():e(this,v).error("Payment handler not initialized")}),e(this,v).debug(`Converted submit button ${s+1} to type="button"`)})):e(this,v).debug("No submit buttons found in the form")}catch(t){e(this,v).error("Error disabling submit buttons:",t)}};var nt,le,Be,Na=class{constructor(t){o(this,nt,void 0);o(this,le,void 0);o(this,Be,!1);u(this,nt,t),u(this,le,t.logger.createModuleLogger("CAMPAIGN"))}getCampaignData(){let t=e(this,nt).campaignData;return t&&!e(this,Be)&&e(this,nt).events?.viewItemList&&(e(this,le).debug("Triggering view_item_list event from getCampaignData"),setTimeout(()=>{e(this,nt).events.viewItemList(t),u(this,Be,!0)},500)),t}getCampaignName(){return e(this,nt).campaignData?.name??""}getCampaignId(){return e(this,nt).campaignData?.id??""}getProducts(){let t=e(this,nt).campaignData?.products??[];return t.length>0&&!e(this,Be)&&e(this,nt).events?.viewItemList&&(e(this,le).debug("Triggering view_item_list event from getProducts"),e(this,nt).campaignData,setTimeout(()=>{e(this,nt).events.viewItemList(e(this,nt).campaignData),u(this,Be,!0)},500)),t}getProductById(t){return this.getProducts().find(i=>i.id===t)}getCurrency(){return e(this,nt).campaignData?.currency??"USD"}getLocale(){return e(this,nt).campaignData?.locale??"en-US"}formatPrice(t){if(typeof t!="number")return"";try{return new Intl.NumberFormat(this.getLocale(),{style:"currency",currency:this.getCurrency()}).format(t)}catch(i){return e(this,le).error("Error formatting price:",i),t.toString()}}triggerViewItemList(){if(!e(this,nt).campaignData){e(this,le).warn("Cannot trigger view_item_list: No campaign data available");return}if(!e(this,nt).events?.viewItemList){e(this,le).warn("Cannot trigger view_item_list: EventManager not initialized");return}e(this,le).debug("Manually triggering view_item_list event"),e(this,nt).events.viewItemList(e(this,nt).campaignData),u(this,Be,!0)}};nt=new WeakMap,le=new WeakMap,Be=new WeakMap;var Ct,D,ct,Ve,br,xd,Ua,ug,Ra,hg,We,ts,za,gg,He,es,vr,Cd,Oa=class{constructor(t){o(this,br);o(this,Ua);o(this,Ra);o(this,We);o(this,za);o(this,He);o(this,vr);o(this,Ct,void 0);o(this,D,void 0);o(this,ct,void 0);o(this,Ve,{});u(this,Ct,t),u(this,D,t.logger.createModuleLogger("STATE")),u(this,ct,n(this,br,xd).call(this)),n(this,Ua,ug).call(this),n(this,vr,Cd).call(this,!1),e(this,D).info("StateManager initialized")}getState(t=null){return t?t==="cart"?{...e(this,ct).cart,totals:n(this,He,es).call(this)}:t==="cart.totals"||t.startsWith("cart.totals.")?n(this,He,es).call(this):t.split(".").reduce((i,s)=>i?.[s]??null,e(this,ct)):{...e(this,ct),cart:{...e(this,ct).cart,totals:n(this,He,es).call(this)}}}setState(t,i,s=!0){let r=e(this,ct),a=t.split(".");for(let[c,d]of a.entries())c===a.length-1?r[d]=i:(r[d]??(r[d]={}),r=r[d]);return t.startsWith("cart.items")&&n(this,vr,Cd).call(this,!1),n(this,Ra,hg).call(this),s&&(n(this,We,ts).call(this,t,i),t.startsWith("cart.items")&&n(this,We,ts).call(this,"cart",this.getState("cart"))),this}subscribe(t,i){var s;(s=e(this,Ve))[t]??(s[t]=[]),e(this,Ve)[t].push(i);try{i(this.getState(t),t)}catch(r){e(this,D).error(`Error in initial subscriber callback for ${t}:`,r)}return()=>e(this,Ve)[t]=e(this,Ve)[t].filter(r=>r!==i)}clearState(){u(this,ct,n(this,br,xd).call(this)),sessionStorage.removeItem("os_state"),n(this,We,ts).call(this,"*",e(this,ct)),e(this,D).info("State cleared")}addToCart(t){if(!t?.id||!t.name||t.price===void 0)throw e(this,D).error("Invalid item:",t),new Error("Invalid item. Must have id, name, and price.");let i=this.getState("cart"),s=e(this,Ct).campaignData?.packages?.find(d=>d.ref_id.toString()===t.id.toString()||d.external_id?.toString()===t.id.toString()),r={...t,...s&&{name:s.name||t.name,price:Number.parseFloat(s.price)||t.price,price_total:Number.parseFloat(s.price_total)||t.price*(t.quantity||1),retail_price:Number.parseFloat(s.price_retail)??void 0,retail_price_total:Number.parseFloat(s.price_retail_total)??void 0,is_recurring:s.is_recurring??!1,price_recurring:s.price_recurring?Number.parseFloat(s.price_recurring):void 0,price_recurring_total:s.price_recurring_total?Number.parseFloat(s.price_recurring_total):void 0,interval:s.interval??void 0,interval_count:s.interval_count??void 0,image:s.image||t.image,external_id:s.external_id??void 0},quantity:t.quantity||1},a=i.items.findIndex(d=>d.id===t.id),c=a>=0?n(this,za,gg).call(this,i.items,a,r):[...i.items,r];return this.setState("cart.items",c),e(this,D).info(`Item added to cart: ${r.name}`),e(this,Ct).triggerEvent("cart.updated",{cart:this.getState("cart")}),this.getState("cart")}updateCartItem(t,i){let s=this.getState("cart"),r=s.items.findIndex(c=>c.id===t);if(r===-1)throw e(this,D).error(`Item not found in cart: ${t}`),new Error(`Item not found in cart: ${t}`);let a=[...s.items];return a[r]={...a[r],...i},a[r].quantity===0&&a.splice(r,1),this.setState("cart.items",a),e(this,D).info(`Cart item updated: ${t}`),e(this,Ct).triggerEvent("cart.updated",{cart:this.getState("cart")}),this.getState("cart")}removeFromCart(t){let i=this.getState("cart").items.filter(s=>s.id!==t);return this.setState("cart.items",i),e(this,D).info(`Item removed from cart: ${t}`),e(this,Ct).triggerEvent("cart.updated",{cart:this.getState("cart")}),this.getState("cart")}clearCart(){return this.setState("cart.items",[]),this.setState("cart.couponCode",null),this.setState("cart.shippingMethod",null),e(this,D).info("Cart cleared"),e(this,Ct).triggerEvent("cart.updated",{cart:this.getState("cart")}),this.getState("cart")}setShippingMethod(t){return this.setState("cart.shippingMethod",t),e(this,D).info(`Shipping method set: ${t.code}`),e(this,Ct).triggerEvent("cart.updated",{cart:this.getState("cart")}),this.getState("cart")}applyCoupon(t){return this.setState("cart.couponCode",t),e(this,D).info(`Coupon applied: ${t}`),e(this,Ct).triggerEvent("cart.updated",{cart:this.getState("cart")}),this.getState("cart")}removeCoupon(){return this.setState("cart.couponCode",null),e(this,D).info("Coupon removed"),e(this,Ct).triggerEvent("cart.updated",{cart:this.getState("cart")}),this.getState("cart")}isItemInCart(t){return e(this,ct).cart.items.some(i=>i.id===t)}getCartForApi(){let{items:t,shippingMethod:i,couponCode:s,attribution:r}=this.getState("cart"),{email:a,firstName:c,lastName:d,phone:h}=this.getState("user");return{lines:t.map(g=>({product_id:g.id,quantity:g.quantity||1,price:g.price})),shipping_method:i?.code??null,coupon_code:s,user:{email:a,first_name:c,last_name:d,phone:h},attribution:r||{}}}async syncCartWithApi(){try{this.setState("ui.loading",!0);let t=this.getCartForApi(),i=await e(this,Ct).api.createCart(t);return e(this,D).info("Cart synced with API"),e(this,Ct).triggerEvent("cart.synced",{cart:i}),i}catch(t){throw e(this,D).error("Error syncing cart with API:",t),this.setState("ui.errors.cart",t.message),t}finally{this.setState("ui.loading",!1)}}};Ct=new WeakMap,D=new WeakMap,ct=new WeakMap,Ve=new WeakMap,br=new WeakSet,xd=function(){return{cart:{items:[],totals:{subtotal:0,retail_subtotal:0,savings:0,savings_percentage:0,shipping:0,tax:0,total:0,recurring_total:0,currency:"USD",currency_symbol:"$"},shippingMethod:null,couponCode:null,attribution:{utm_source:"",utm_medium:"",utm_campaign:"",utm_content:"",utm_term:"",gclid:"",fbclid:"",sub1:"",sub2:"",sub3:"",sub4:"",sub5:"",referrer:"",landing_page:"",user_agent:"",device_type:"",fbc:"",fbp:""}},user:{email:null,firstName:null,lastName:null,phone:null},ui:{loading:!1,currentStep:"cart",errors:{}}}},Ua=new WeakSet,ug=function(){try{let t=sessionStorage.getItem("os_state");if(t){let i=JSON.parse(t);u(this,ct,{...e(this,ct),...i,ui:{...e(this,ct).ui}}),e(this,D).info("State loaded from sessionStorage")}}catch(t){e(this,D).error("Error loading state from sessionStorage:",t)}},Ra=new WeakSet,hg=function(){try{let t={cart:{...e(this,ct).cart,totals:n(this,He,es).call(this)},user:e(this,ct).user};sessionStorage.setItem("os_state",JSON.stringify(t)),e(this,D).debug("State saved to sessionStorage")}catch(t){e(this,D).error("Error saving state to sessionStorage:",t)}},We=new WeakSet,ts=function(t,i){e(this,D).debug(`Notifying subscribers for path: ${t}`);for(let[s,r]of Object.entries(e(this,Ve)))if(s===t||s==="*"||t.startsWith(`${s}.`)){let a=s==="*"?this.getState():this.getState(s);r.forEach(c=>{try{c(a,s)}catch(d){e(this,D).error(`Error in subscriber callback for ${s}:`,d)}})}},za=new WeakSet,gg=function(t,i,s){let r=[...t];return r[i]={...r[i],quantity:(r[i].quantity||1)+(s.quantity||1),price_total:r[i].price*(r[i].quantity||1+(s.quantity||1)),...r[i].retail_price&&{retail_price_total:r[i].retail_price*(r[i].quantity||1+(s.quantity||1))},...r[i].price_recurring&&{price_recurring_total:r[i].price_recurring*(r[i].quantity||1+(s.quantity||1))}},r},He=new WeakSet,es=function(){let{items:t,shippingMethod:i}=e(this,ct).cart,s=t.reduce((b,y)=>b+(y.price_total??y.price*(y.quantity||1)),0),r=t.reduce((b,y)=>b+(y.retail_price_total??(y.retail_price??y.price)*(y.quantity||1)),0),a=r-s,c=r>0?a/r*100:0,d=t.reduce((b,y)=>b+(y.is_recurring&&y.price_recurring?y.price_recurring*(y.quantity||1):0),0),h=i?.price?Number.parseFloat(i.price):0,g=0,m=s+h+g,p=e(this,Ct).campaignData?.currency??"USD",w={USD:"$",EUR:"â‚¬",GBP:"Â£"}[p]??"$";return{subtotal:s,retail_subtotal:r,savings:a,savings_percentage:c,shipping:h,tax:g,total:m,recurring_total:d,currency:p,currency_symbol:w}},vr=new WeakSet,Cd=function(t=!0){let i=n(this,He,es).call(this);return e(this,ct).cart.totals=i,e(this,D).debug("Cart totals recalculated"),t&&(n(this,We,ts).call(this,"cart.totals",i),n(this,We,ts).call(this,"cart",this.getState("cart"))),i};var is,ft,At,kt,Va,mg,wr,_d,Wa,pg,Sr,Ed,xr,Ad,ss,Da,Ba=class{constructor(t){o(this,Va);o(this,wr);o(this,Wa);o(this,Sr);o(this,xr);o(this,ss);o(this,is,void 0);o(this,ft,void 0);o(this,At,void 0);o(this,kt,void 0);u(this,is,t),u(this,ft,t.state),u(this,At,t.logger.createModuleLogger("CART")),n(this,Va,mg).call(this),e(this,At).info("CartManager initialized")}clearCart(){try{return e(this,ft).clearCart()}catch(t){throw e(this,At).error("Error clearing cart:",t),t}}addToCart(t){return n(this,Sr,Ed).call(this,t)}removeFromCart(t){return n(this,ss,Da).call(this,t)}setShippingMethod(t){try{return e(this,ft).setShippingMethod(t)}catch(i){throw e(this,At).error("Error setting shipping method:",i),i}}applyCoupon(t){try{return e(this,ft).applyCoupon(t)}catch(i){throw e(this,At).error("Error applying coupon:",i),i}}removeCoupon(){try{return e(this,ft).removeCoupon()}catch(t){throw e(this,At).error("Error removing coupon:",t),t}}async syncCartWithApi(){try{return await e(this,ft).syncCartWithApi()}catch(t){throw e(this,At).error("Error syncing cart with API:",t),t}}isItemInCart(t){return e(this,ft).isItemInCart?.(t)??e(this,ft).getState("cart").items.some(i=>i.id===t)}};is=new WeakMap,ft=new WeakMap,At=new WeakMap,kt=new WeakMap,Va=new WeakSet,mg=function(){u(this,kt,{addToCartButtons:document.querySelectorAll("[data-os-add-to-cart]"),cartCount:document.querySelectorAll("[data-os-cart-count]"),cartTotal:document.querySelectorAll("[data-os-cart-total]"),cartItems:document.querySelector("[data-os-cart-items]"),cartEmpty:document.querySelector("[data-os-cart-empty]"),cartContainer:document.querySelector("[data-os-cart-container]")}),e(this,kt).addToCartButtons.forEach(t=>{t.addEventListener("click",i=>{i.preventDefault();let s={id:t.getAttribute("data-os-product-id"),name:t.getAttribute("data-os-product-name"),price:Number.parseFloat(t.getAttribute("data-os-product-price")),quantity:Number.parseInt(t.getAttribute("data-os-product-quantity")??"1",10)};s.id&&s.name&&s.price?n(this,Sr,Ed).call(this,s):e(this,At).error("Invalid product data for add to cart button")})}),e(this,ft).subscribe("cart",()=>n(this,wr,_d).call(this)),n(this,wr,_d).call(this)},wr=new WeakSet,_d=function(){let t=e(this,ft).getState("cart");e(this,kt).cartCount.forEach(r=>{let a=t.items.reduce((c,d)=>c+(d.quantity||1),0);r.textContent=a.toString(),r.classList.toggle("hidden",a===0)});let i=r=>e(this,is).campaign?.formatPrice(r)??r.toFixed(2);e(this,kt).cartTotal.forEach(r=>r.textContent=i(t.totals.total));let s=(r,a,c=!1)=>{let d=document.querySelector(r);d&&(d.textContent=c?`${Math.round(a)}%`:i(a),c&&a===0?d.parentElement?.classList.add("hidden"):d.parentElement?.classList.remove("hidden"))};if(s("[data-os-cart-retail-subtotal]",t.totals.retail_subtotal),s("[data-os-cart-savings]",t.totals.savings,!0),s("[data-os-cart-savings-percentage]",t.totals.savings_percentage,!0),s("[data-os-cart-recurring-total]",t.totals.recurring_total,!0),s("[data-os-cart-subtotal]",t.totals.subtotal),s("[data-os-cart-shipping]",t.totals.shipping),e(this,kt).cartItems&&(e(this,kt).cartItems.innerHTML="",t.items.forEach(r=>e(this,kt).cartItems.appendChild(n(this,Wa,pg).call(this,r)))),e(this,kt).cartEmpty&&e(this,kt).cartContainer){let r=t.items.length===0;e(this,kt).cartEmpty.classList.toggle("hidden",!r),e(this,kt).cartContainer.classList.toggle("hidden",r)}},Wa=new WeakSet,pg=function(t){let i=p=>e(this,is).campaign?.formatPrice(p)??p.toFixed(2),s=document.createElement("div");s.className="os-cart-item",s.setAttribute("data-os-cart-item-id",t.id);let r=i(t.price),a=t.retail_price?i(t.retail_price):"",c=i(t.price*(t.quantity||1)),d=t.retail_price?(t.retail_price-t.price)*(t.quantity||1):0,h=d?`
      <div class="os-cart-item-savings">
        <span class="os-cart-item-savings-label">You save:</span>
        <span class="os-cart-item-savings-value">${i(d)} (${Math.round(d/(t.retail_price*(t.quantity||1))*100)}%)</span>
      </div>
    `:"",g=t.is_recurring&&t.price_recurring?`
      <div class="os-cart-item-recurring">
        <span class="os-cart-item-recurring-label">Recurring:</span>
        <span class="os-cart-item-recurring-value">${i(t.price_recurring)} ${t.interval_count>1?`every ${t.interval_count} ${t.interval}s`:`per ${t.interval}`}</span>
      </div>
    `:"",m=t.image?`
      <div class="os-cart-item-image">
        <img src="${t.image}" alt="${t.name}" />
      </div>
    `:"";return s.innerHTML=`
      ${m}
      <div class="os-cart-item-details">
        <div class="os-cart-item-name">${t.name}</div>
        <div class="os-cart-item-price-container">
          <div class="os-cart-item-price">${r}</div>
          ${a?`<div class="os-cart-item-retail-price">${a}</div>`:""}
        </div>
        ${h}
        ${g}
      </div>
      <div class="os-cart-item-quantity">
        <button class="os-cart-item-decrease" data-os-cart-decrease="${t.id}">-</button>
        <span class="os-cart-item-quantity-value">${t.quantity||1}</span>
        <button class="os-cart-item-increase" data-os-cart-increase="${t.id}">+</button>
      </div>
      <div class="os-cart-item-total">${c}</div>
      <button class="os-cart-item-remove" data-os-cart-remove="${t.id}">Ã—</button>
    `,s.querySelector(`[data-os-cart-decrease="${t.id}"]`)?.addEventListener("click",()=>n(this,xr,Ad).call(this,t.id,(t.quantity||1)-1)),s.querySelector(`[data-os-cart-increase="${t.id}"]`)?.addEventListener("click",()=>n(this,xr,Ad).call(this,t.id,(t.quantity||1)+1)),s.querySelector(`[data-os-cart-remove="${t.id}"]`)?.addEventListener("click",()=>n(this,ss,Da).call(this,t.id)),s},Sr=new WeakSet,Ed=function(t){try{return e(this,ft).addToCart(t)}catch(i){throw e(this,At).error("Error adding item to cart:",i),i}},xr=new WeakSet,Ad=function(t,i){try{return i<=0?n(this,ss,Da).call(this,t):e(this,ft).updateCartItem(t,{quantity:i})}catch(s){throw e(this,At).error("Error updating cart item quantity:",s),s}},ss=new WeakSet,Da=function(t){try{return e(this,ft).removeFromCart(t)}catch(i){throw e(this,At).error("Error removing item from cart:",i),i}};var rs,Ce,Zt,ns,gt=class{static initDebugMode(){let t=new URLSearchParams(window.location.search);return u(this,Ce,t.get("debugger")==="true"),e(this,Ce)&&!e(this,rs)&&(this.injectDebugStyles(),u(this,Zt,localStorage.getItem("os_debug_xray_enabled")==="true")),e(this,Ce)}static isDebugMode(){return e(this,Ce)}static isXrayEnabled(){return e(this,Zt)}static toggleXray(t=!e(this,Zt)){return e(this,Ce)?(u(this,Zt,t),localStorage.setItem("os_debug_xray_enabled",e(this,Zt).toString()),e(this,ns).forEach(i=>{i.style.display=e(this,Zt)?"block":"none"}),e(this,Zt)):!1}static injectDebugStyles(){if(e(this,rs))return;let t=document.createElement("style");t.id="os-debug-styles",t.textContent=`
      /* Common debug styles */
      .os-debug-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        border: 2px dashed rgba(255, 0, 0, 0.7);
        box-sizing: border-box;
      }
      .os-debug-label {
        position: absolute;
        top: 0;
        right: 0;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        font-size: 12px;
        padding: 2px 6px;
        border-radius: 0 0 0 4px;
        font-family: monospace;
        z-index: 10000;
      }
      
      /* Selector-specific styles */
      .os-debug-card-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9998;
        border: 1px solid rgba(0, 255, 255, 0.7);
        box-sizing: border-box;
      }
      .os-debug-card-label {
        position: absolute;
        top: 0;
        right: 0;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        font-size: 10px;
        padding: 1px 4px;
        border-radius: 0 0 0 4px;
        font-family: monospace;
        z-index: 9999;
      }
      .os--selected .os-debug-card-overlay {
        border: 2px solid rgba(0, 255, 0, 0.9);
      }
      .os--active .os-debug-card-overlay {
        background-color: rgba(255, 255, 0, 0.2);
      }
      
      /* Toggle-specific styles */
      .os-debug-toggle-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9998;
        border: 1px solid rgba(255, 165, 0, 0.7);
        box-sizing: border-box;
      }
      .os-debug-toggle-label {
        position: absolute;
        top: 0;
        right: 0;
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        font-size: 10px;
        padding: 1px 4px;
        border-radius: 0 0 0 4px;
        font-family: monospace;
        z-index: 9999;
      }
      [data-os-active="true"] .os-debug-toggle-overlay {
        background-color: rgba(255, 165, 0, 0.3);
        border: 2px solid rgba(255, 165, 0, 0.9);
      }
      
      /* Upsell styles */
      .os-debug-upsell-overlay {
        border: 2px dashed rgba(76, 175, 80, 0.9) !important;
      }
      .os-debug-upsell-label {
        background-color: rgba(76, 175, 80, 0.9) !important;
      }
      .os-debug-upsell-badge {
        display: inline-block;
        background-color: rgba(76, 175, 80, 0.9);
        color: white;
        font-size: 9px;
        padding: 1px 3px;
        border-radius: 2px;
        margin-left: 4px;
        vertical-align: middle;
      }
      
      /* Debug bar styles */
      .os-debug-bar {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: rgba(33, 33, 33, 0.9);
        color: white;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        font-size: 14px;
        z-index: 10001;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 16px;
        box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
      }
      
      .os-debug-bar-title {
        font-weight: 600;
        margin-right: 20px;
      }
      
      .os-debug-bar-controls {
        display: flex;
        align-items: center;
      }
      
      .os-debug-bar-control {
        margin: 0 10px;
        display: flex;
        align-items: center;
      }
      
      .os-debug-bar-toggle {
        position: relative;
        display: inline-block;
        width: 40px;
        height: 20px;
        margin-left: 8px;
      }
      
      .os-debug-bar-toggle input {
        opacity: 0;
        width: 0;
        height: 0;
      }
      
      .os-debug-bar-slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .4s;
        border-radius: 20px;
      }
      
      .os-debug-bar-slider:before {
        position: absolute;
        content: "";
        height: 16px;
        width: 16px;
        left: 2px;
        bottom: 2px;
        background-color: white;
        transition: .4s;
        border-radius: 50%;
      }
      
      input:checked + .os-debug-bar-slider {
        background-color: #2196F3;
      }
      
      input:checked + .os-debug-bar-slider:before {
        transform: translateX(20px);
      }
      
      .os-debug-bar-button {
        background-color: #2196F3;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 4px 10px;
        font-size: 12px;
        cursor: pointer;
        margin-left: 10px;
      }
      
      .os-debug-bar-button:hover {
        background-color: #0b7dda;
      }
    `,document.head.appendChild(t),u(this,rs,!0)}static addDebugOverlay(t,i,s,r={}){if(!e(this,Ce))return;window.getComputedStyle(t).position==="static"&&(t.style.position="relative");let c=document.createElement("div");c.className=`os-debug-${s}-overlay`;let d=document.createElement("div");d.className=`os-debug-${s}-label`,r.Upsell==="Yes"&&(c.classList.add("os-debug-upsell-overlay"),d.classList.add("os-debug-upsell-label"));let g=`ID: ${i}`;Object.entries(r).forEach(([m,p])=>{m==="Upsell"&&p==="Yes"?g+=` | ${m}: <span class="os-debug-upsell-badge">UPSELL</span>`:g+=` | ${m}: ${p}`}),d.innerHTML=g,e(this,Zt)||(c.style.display="none",d.style.display="none"),t.appendChild(c),t.appendChild(d),e(this,ns).push(c),e(this,ns).push(d)}};rs=new WeakMap,Ce=new WeakMap,Zt=new WeakMap,ns=new WeakMap,o(gt,rs,!1),o(gt,Ce,!1),o(gt,Zt,!1),o(gt,ns,[]);var B,I,de,Ee,gi,Ga,fg,Ka,yg,Ya,bg,Ja,vg,os,Ha,Za,wg,Cr,kd,_r,Td,Er,$d,Xa,Sg,Qa,xg,Ld,Sp,Xt,_e,ja=class{constructor(t){o(this,Ga);o(this,Ka);o(this,Ya);o(this,Ja);o(this,os);o(this,Za);o(this,Cr);o(this,_r);o(this,Er);o(this,Xa);o(this,Qa);o(this,Ld);o(this,Xt);o(this,B,void 0);o(this,I,void 0);o(this,de,{});o(this,Ee,{});o(this,gi,!1);u(this,B,t),u(this,I,t.logger.createModuleLogger("SELECTOR")),u(this,gi,gt.initDebugMode()),n(this,Ga,fg).call(this),e(this,I).info("SelectorManager initialized"),e(this,gi)&&e(this,I).info("Debug mode enabled for selectors")}initUnitPricing(){e(this,I).info("Initializing unit pricing for selectors"),setTimeout(()=>{Object.keys(e(this,de)).forEach(t=>{n(this,Xa,Sg).call(this,t)})},100)}refreshUnitPricing(){this.initUnitPricing()}};B=new WeakMap,I=new WeakMap,de=new WeakMap,Ee=new WeakMap,gi=new WeakMap,Ga=new WeakSet,fg=function(){document.querySelectorAll('[data-os-component="selector"][data-os-selection-mode="swap"]').forEach(t=>n(this,Ka,yg).call(this,t)),setTimeout(()=>n(this,Er,$d).call(this),0),e(this,B).state?.subscribe("cart",()=>n(this,Er,$d).call(this)),this.initUnitPricing()},Ka=new WeakSet,yg=function(t){let i=t.getAttribute("data-os-id");if(!i){e(this,I).warn("Selector missing data-os-id",t);return}let s=t.getAttribute("data-os-selection-mode")||"swap";e(this,de)[i]={element:t,items:[],mode:s},e(this,Ee)[i]=null,t.querySelectorAll('[data-os-element="card"]').forEach(r=>n(this,Ya,bg).call(this,i,r)),e(this,gi)&&gt.addDebugOverlay(t,i,"overlay",{Mode:s})},Ya=new WeakSet,bg=function(t,i){let s=i.getAttribute("data-os-package");if(!s){e(this,I).warn("Card missing data-os-package",i);return}let a=i.querySelector(".pb-quantity__price.pb--current")?.textContent.trim()??"$0.00 USD",c=Number.parseFloat(a.match(/\$(\d+\.\d+)/)?.[1]??"0"),h=i.querySelector(".card-title")?.textContent.trim()??`Package ${s}`,g=Number.parseInt(i.getAttribute("data-os-quantity")??"1",10),m=i.getAttribute("data-os-selected")==="true",p={element:i,packageId:s,quantity:g,price:c,name:h,isPreSelected:m};e(this,de)[t].items.push(p),i.addEventListener("click",()=>n(this,Ja,vg).call(this,t,p)),e(this,gi)&&gt.addDebugOverlay(i,s,"card",{Price:`$${c}`,Qty:g,PreSel:m?"Yes":"No"})},Ja=new WeakSet,vg=function(t,i){let s=e(this,Ee)[t];n(this,os,Ha).call(this,t,i),n(this,Za,wg).call(this,t,s)},os=new WeakSet,Ha=function(t,i){e(this,Ee)[t]!==i&&(e(this,de)[t].items.forEach(s=>{s.element.classList.remove("os--selected"),s.element.setAttribute("data-os-selected","false"),s.isSelected=!1}),i.element.classList.add("os--selected"),i.element.setAttribute("data-os-selected","true"),i.isSelected=!0,e(this,Ee)[t]=i,e(this,I).debug(`Selected item ${i.packageId} in selector ${t}`))},Za=new WeakSet,wg=function(t,i){if(!e(this,B).cart){e(this,I).error("Cart manager not available");return}let s=e(this,Ee)[t];s&&(i&&i.packageId!==s.packageId&&n(this,_r,Td).call(this,i),e(this,B).cart.isItemInCart(s.packageId)||n(this,Cr,kd).call(this,s))},Cr=new WeakSet,kd=function(t){if(!e(this,B).cart){e(this,I).error("Cart manager not available in addItemToCart");return}if(typeof e(this,B).cart.addToCart!="function"){e(this,I).error("addToCart is not a function on this.#app.cart:",e(this,B).cart);return}e(this,I).info(`Adding item ${t.packageId} to cart`),e(this,B).cart.addToCart({id:t.packageId,name:t.name,price:t.price,quantity:t.quantity,type:"package"}),t.element.classList.add("os--active"),t.element.setAttribute("data-os-active","true")},_r=new WeakSet,Td=function(t){if(!e(this,B).cart){e(this,I).error("Cart manager not available in removeItemFromCart");return}if(typeof e(this,B).cart.removeFromCart!="function"){e(this,I).error("removeFromCart is not a function on this.#app.cart:",e(this,B).cart);return}e(this,I).info(`Removing item ${t.packageId} from cart`),e(this,B).cart.removeFromCart(t.packageId),t.element.classList.remove("os--active"),t.element.setAttribute("data-os-active","false")},Er=new WeakSet,$d=function(){if(!e(this,B).cart){e(this,I).debug("Cart manager not available for sync");return}if(!e(this,B).state?.getState("cart")){e(this,I).debug("Cart state not available");return}e(this,I).debug("Syncing with cart, this.#app.cart:",e(this,B).cart),Object.keys(e(this,de)).forEach(i=>{let s=e(this,de)[i].items,r=s.filter(a=>e(this,B).cart.isItemInCart(a.packageId));if(r.length>0){let a=r[0];n(this,os,Ha).call(this,i,a),r.forEach(c=>{c.packageId!==a.packageId&&n(this,_r,Td).call(this,c)})}else if(!e(this,Ee)[i]){let a=s.find(c=>c.isPreSelected);a&&(n(this,os,Ha).call(this,i,a),n(this,Cr,kd).call(this,a))}s.forEach(a=>{let c=e(this,B).cart.isItemInCart(a.packageId);a.element.classList.toggle("os--active",c),a.element.setAttribute("data-os-active",c.toString())})})},Xa=new WeakSet,Sg=function(t){let i=e(this,de)[t];if(!i){e(this,I).warn(`Selector ${t} not found for unit pricing`);return}let s=e(this,B)?.campaignData;if(!s||!s.packages){e(this,I).warn("Campaign data not available for unit pricing");return}i.items.forEach(r=>{n(this,Qa,xg).call(this,r,s.packages)})},Qa=new WeakSet,xg=function(t,i){let s=i.find(L=>L.ref_id.toString()===t.packageId.toString()||L.external_id&&L.external_id.toString()===t.packageId.toString());if(!s){e(this,I).debug(`Package data not found for item ${t.packageId}`);return}let r=t.element;e(this,I).debug(`Processing unit pricing for package ${t.packageId}:`,{packageId:t.packageId,name:s.name,price:s.price,price_total:s.price_total,price_retail:s.price_retail,price_retail_total:s.price_retail_total,qty:s.qty});let a=s.qty||1,c=Number.parseFloat(s.price_total)||Number.parseFloat(s.price)*a,d=Number.parseFloat(s.price_retail_total)||Number.parseFloat(s.price_retail)*a||c,h=c/a,g=d/a,m=g-h,p=g>0?m/g*100:0,w=d-c,b=d>0?w/d*100:0;e(this,I).debug(`Calculated prices for package ${t.packageId}:`,{totalUnits:a,totalPrice:c,totalRetailPrice:d,totalSavings:w,totalSavingsPercentage:b,unitPrice:h,unitRetailPrice:g,unitSavings:m,unitSavingsPercentage:p});let y=L=>e(this,B).campaign?.formatPrice?e(this,B).campaign.formatPrice(L):`$${L.toFixed(2)}`,A=new Set,N=r.querySelectorAll("[data-divide-by]");N.length>0&&(e(this,I).debug(`Found ${N.length} elements with data-divide-by in card ${t.packageId}`),N.forEach(L=>{let O=parseFloat(L.getAttribute("data-divide-by"));if(!isNaN(O)&&O>0){let H=L.getAttribute("data-card-price");if(!H){e(this,I).debug("Skipping element with data-divide-by but no data-card-price attribute");return}let z;switch(H){case"each-sale":z=h/O;break;case"each-regular":z=g/O;break;case"saving-amount":z=m/O;break;case"saving-percentage":z=p;break;case"total-sale":z=c/O;break;case"total-regular":z=d/O;break;case"total-saving-amount":z=w/O;break;case"total-saving-percentage":z=b;break;default:e(this,I).debug(`Unknown price type: ${H}`);return}let Y;H.includes("percentage")?Y=`${Math.round(z)}%`:Y=y(z),e(this,I).debug(`Setting price for element with data-divide-by="${O}":`,{attributeType:H,originalValue:L.textContent,calculatedValue:z,formattedValue:Y,element:L.outerHTML}),L.textContent=Y,A.add(L),e(this,I).debug(`Updated element with data-divide-by="${O}" for ${H}: ${Y}`)}})),n(this,Xt,_e).call(this,r,"each-sale",y(h),A),n(this,Xt,_e).call(this,r,"each-regular",y(g),A),n(this,Xt,_e).call(this,r,"saving-amount",y(m),A),n(this,Xt,_e).call(this,r,"saving-percentage",`${Math.round(p)}%`,A),n(this,Xt,_e).call(this,r,"total-sale",y(c),A),n(this,Xt,_e).call(this,r,"total-regular",y(d),A),n(this,Xt,_e).call(this,r,"total-saving-amount",y(w),A),n(this,Xt,_e).call(this,r,"total-saving-percentage",`${Math.round(b)}%`,A),e(this,I).debug(`Updated pricing for card ${t.packageId}: ${y(h)} per unit, ${y(c)} total`)},Ld=new WeakSet,Sp=function(t){return e(this,B).campaign?.formatPrice?e(this,B).campaign.formatPrice(t):`$${t.toFixed(2)}`},Xt=new WeakSet,_e=function(t,i,s,r=new Set){let a=t.querySelectorAll(`[data-card-price="${i}"]`);a.length>0&&a.forEach(c=>{if(r.has(c))return;c.textContent=s;let d=c.getAttribute("data-hide-if-zero")==="true",h=parseFloat(s.replace(/[^0-9.-]+/g,""));if(d&&h<=0){c.style.display="none";let g=c.closest('[data-container="true"]');g&&(g.style.display="none")}else{c.style.display="";let g=c.closest('[data-container="true"]');g&&(g.style.display="")}})};var as,Nt,mt,cs,ic,Cg,sc,_g,rc,Eg,nc,Ag,Ar,Pd,ls,tc,oc,kg,kr,Id,ac,Tg,cc,$g,ec=class{constructor(t){o(this,ic);o(this,sc);o(this,rc);o(this,nc);o(this,Ar);o(this,ls);o(this,oc);o(this,kr);o(this,ac);o(this,cc);o(this,as,{});o(this,Nt,void 0);o(this,mt,void 0);o(this,cs,!1);u(this,Nt,t),u(this,mt,t.logger.createModuleLogger("TOGGLE")),u(this,cs,gt.initDebugMode()),n(this,ic,Cg).call(this),e(this,Nt).state.subscribe("cart",()=>n(this,oc,kg).call(this)),e(this,mt).info("ToggleManager initialized"),e(this,cs)&&e(this,mt).info("Debug mode enabled for toggle items")}};as=new WeakMap,Nt=new WeakMap,mt=new WeakMap,cs=new WeakMap,ic=new WeakSet,Cg=function(){let t=document.querySelectorAll('[data-os-action="toggle-item"]');if(!t.length){e(this,mt).debug("No toggle item buttons found in the DOM");return}e(this,mt).info(`Found ${t.length} toggle item buttons`),t.forEach(i=>n(this,sc,_g).call(this,i))},sc=new WeakSet,_g=function(t){let i=t.getAttribute("data-os-package");if(!i){e(this,mt).warn("Toggle item missing data-os-package attribute",t);return}let s=Number.parseInt(t.getAttribute("data-os-quantity")??"1",10),r=t.getAttribute("data-os-id")??`toggle-${i}`;e(this,as)[r]={element:t,packageId:i,quantity:s},n(this,ls,tc).call(this,t,i),t.addEventListener("click",a=>{a.preventDefault(),n(this,nc,Ag).call(this,r)}),e(this,cs)&&n(this,rc,Eg).call(this,t,r,i,s),e(this,mt).debug(`Initialized toggle item ${r} for package ${i}`)},rc=new WeakSet,Eg=function(t,i,s,r){let a=n(this,Ar,Pd).call(this,s),c=a?a.price:"N/A",d=t.hasAttribute("data-os-upsell")?t.getAttribute("data-os-upsell")==="true":t.closest("[data-os-upsell-section]")!==null;gt.addDebugOverlay(t,i,"toggle",{Package:s,Qty:r,Price:c,Upsell:d?"Yes":"No"})},nc=new WeakSet,Ag=function(t){let i=e(this,as)[t];if(!i){e(this,mt).error(`Toggle item ${t} not found`);return}let{packageId:s,quantity:r,element:a}=i,c=n(this,kr,Id).call(this,s);if(c)n(this,cc,$g).call(this,s),e(this,mt).info(`Toggled OFF item ${s}`);else{let d=n(this,Ar,Pd).call(this,s);if(!d){e(this,mt).error(`Package ${s} not found in campaign data`);return}let h=a.hasAttribute("data-os-upsell")?a.getAttribute("data-os-upsell")==="true":a.closest("[data-os-upsell-section]")!==null;n(this,ac,Tg).call(this,{id:s,name:d.name,price:Number.parseFloat(d.price),quantity:r,type:"package",is_upsell:h}),e(this,mt).info(`Toggled ON item ${s}${h?" (upsell)":""}`)}n(this,ls,tc).call(this,a,s),e(this,Nt).triggerEvent("toggle.changed",{toggleId:t,packageId:s,isActive:!c})},Ar=new WeakSet,Pd=function(t){return e(this,Nt).campaignData?.packages?e(this,Nt).campaignData.packages.find(i=>i.ref_id.toString()===t.toString())??null:(e(this,mt).error("Campaign data not available"),null)},ls=new WeakSet,tc=function(t,i){let s=n(this,kr,Id).call(this,i);t.classList.toggle("os--active",s),t.setAttribute("data-os-active",s.toString())},oc=new WeakSet,kg=function(){Object.values(e(this,as)).forEach(({element:t,packageId:i})=>n(this,ls,tc).call(this,t,i))},kr=new WeakSet,Id=function(t){return e(this,Nt).state.getState("cart").items.some(i=>i.id===t)},ac=new WeakSet,Tg=function(t){if(!e(this,Nt).cart){e(this,mt).error("Cart manager not available");return}e(this,Nt).cart.addToCart(t)},cc=new WeakSet,$g=function(t){if(!e(this,Nt).cart){e(this,mt).error("Cart manager not available");return}e(this,Nt).cart.removeFromCart(t)};var mi,Tt,Ae,ke,pi,Tr,gc,Lg,mc,Pg,$r,qd,ds,lc,us,dc,Lr,Fd,pc,Ig,hs,uc,hc=class{constructor(t){o(this,gc);o(this,mc);o(this,$r);o(this,ds);o(this,us);o(this,Lr);o(this,pc);o(this,hs);o(this,mi,void 0);o(this,Tt,void 0);o(this,Ae,!1);o(this,ke,null);o(this,pi,null);o(this,Tr,!1);u(this,mi,t),u(this,Tt,t.logger.createModuleLogger("DEBUG")),u(this,Tr,gt.initDebugMode()),n(this,gc,Lg).call(this),e(this,Tt).info("DebugManager initialized")}};mi=new WeakMap,Tt=new WeakMap,Ae=new WeakMap,ke=new WeakMap,pi=new WeakMap,Tr=new WeakMap,gc=new WeakSet,Lg=function(){window.showMiniCart=()=>n(this,ds,lc).call(this),window.hideMiniCart=()=>n(this,us,dc).call(this),window.toggleMiniCart=()=>n(this,Lr,Fd).call(this),window.toggleXray=t=>n(this,$r,qd).call(this,t),e(this,Tr)&&(e(this,Tt).info("Debug mode activated via URL parameter"),n(this,mc,Pg).call(this),localStorage.getItem("os_debug_mini_cart_visible")==="true"&&n(this,ds,lc).call(this)),e(this,mi).state?.subscribe("cart",()=>{e(this,Ae)&&n(this,hs,uc).call(this)}),e(this,Tt).debug("Debug methods exposed to window object")},mc=new WeakSet,Pg=function(){if(e(this,pi))return;let t=document.createElement("div");t.className="os-debug-bar";let i=document.createElement("div");i.className="os-debug-bar-left";let s=document.createElement("span");s.className="os-debug-bar-title",s.textContent="29next Debug Tools",i.appendChild(s);let r=document.createElement("div");r.className="os-debug-bar-controls";let a=document.createElement("div");a.className="os-debug-bar-control";let c=document.createElement("span");c.textContent="X-ray View";let d=document.createElement("label");d.className="os-debug-bar-toggle";let h=document.createElement("input");h.type="checkbox",h.checked=gt.isXrayEnabled(),h.addEventListener("change",()=>n(this,$r,qd).call(this,h.checked));let g=document.createElement("span");g.className="os-debug-bar-slider",d.append(h,g),a.append(c,d);let m=document.createElement("div");m.className="os-debug-bar-control";let p=document.createElement("button");p.className="os-debug-bar-button",p.textContent="Toggle Mini-Cart",p.addEventListener("click",()=>n(this,Lr,Fd).call(this)),m.appendChild(p),r.append(a,m),t.append(i,r),document.body.appendChild(t),u(this,pi,t)},$r=new WeakSet,qd=function(t){let i=gt.toggleXray(t);if(e(this,pi)){let s=e(this,pi).querySelector('input[type="checkbox"]');s&&(s.checked=i)}return e(this,Tt).info(`X-ray view ${i?"enabled":"disabled"}`),i},ds=new WeakSet,lc=function(){if(e(this,Ae)){e(this,Tt).debug("Mini-cart already visible");return}e(this,Tt).info("Showing mini-cart widget"),e(this,ke)??u(this,ke,n(this,pc,Ig).call(this)),e(this,ke).style.display="block",u(this,Ae,!0),localStorage.setItem("os_debug_mini_cart_visible","true"),n(this,hs,uc).call(this)},us=new WeakSet,dc=function(){if(!e(this,Ae)){e(this,Tt).debug("Mini-cart already hidden");return}e(this,Tt).info("Hiding mini-cart widget"),e(this,ke)&&(e(this,ke).style.display="none"),u(this,Ae,!1),localStorage.setItem("os_debug_mini_cart_visible","false")},Lr=new WeakSet,Fd=function(){e(this,Ae)?n(this,us,dc).call(this):n(this,ds,lc).call(this)},pc=new WeakSet,Ig=function(){let t=document.createElement("div");t.className="os-debug-mini-cart",t.style.cssText=`
      position: fixed;
      top: 20px;
      right: 20px;
      width: 300px;
      max-height: 400px;
      overflow-y: auto;
      background-color: white;
      border: 1px solid #ccc;
      border-radius: 4px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 9999;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      font-size: 14px;
      display: none;
    `;let i=document.createElement("div");i.className="os-debug-mini-cart-header",i.style.cssText=`
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      background-color: #f5f5f5;
      border-bottom: 1px solid #eee;
    `;let s=document.createElement("div");s.className="os-debug-mini-cart-title",s.textContent="Debug Mini-Cart",s.style.fontWeight="600";let r=document.createElement("div");r.style.display="flex",r.style.alignItems="center";let a=document.createElement("button");a.className="os-debug-mini-cart-refresh",a.textContent="â†»",a.title="Refresh cart data",a.style.cssText=`
      background: none;
      border: none;
      font-size: 16px;
      cursor: pointer;
      padding: 0 8px;
      line-height: 1;
      color: #666;
    `,a.addEventListener("click",()=>{n(this,hs,uc).call(this),e(this,Tt).info("Mini-cart data refreshed manually")});let c=document.createElement("button");c.className="os-debug-mini-cart-close",c.textContent="Ã—",c.style.cssText=`
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      padding: 0;
      line-height: 1;
    `,c.addEventListener("click",()=>n(this,us,dc).call(this)),r.append(a,c),i.append(s,r);let d=document.createElement("div");d.className="os-debug-mini-cart-content",d.style.padding="15px";let h=document.createElement("div");return h.className="os-debug-mini-cart-footer",h.style.cssText=`
      padding: 10px 15px;
      background-color: #f5f5f5;
      border-top: 1px solid #eee;
      font-size: 12px;
      color: #666;
      text-align: center;
    `,h.textContent="Use window.hideMiniCart() to hide this widget",t.append(i,d,h),document.body.appendChild(t),t},hs=new WeakSet,uc=function(){if(!e(this,ke))return;let t=e(this,ke).querySelector(".os-debug-mini-cart-content");if(!t)return;let i=e(this,mi).state?.getState("cart");if(!i){t.innerHTML='<div style="color: #999; text-align: center;">Cart data not available</div>';return}e(this,Tt).debug("Updating mini-cart with cart data:",i);let s=a=>e(this,mi).campaign?.formatPrice(a)??`$${a.toFixed(2)}`,r="";i.items?.length?(r+='<div style="margin-bottom: 15px;">',r+='<div style="font-weight: 600; margin-bottom: 10px;">Items:</div>',r+='<ul style="list-style: none; padding: 0; margin: 0;">',i.items.forEach(a=>{let c=!!a.is_upsell,d=c?'<span style="display: inline-block; background-color: #4CAF50; color: white; font-size: 10px; padding: 2px 5px; border-radius: 3px; margin-left: 5px;">UPSELL</span>':"";r+=`
          <li style="padding: 5px 0; border-bottom: 1px solid #eee; ${c?"background-color: rgba(76, 175, 80, 0.1);":""}">
            <div style="display: flex; justify-content: space-between;">
              <div style="font-weight: 500;">${a.name}${d}</div>
              <div>${a.quantity} Ã— ${s(a.price)}</div>
            </div>
            <div style="display: flex; justify-content: space-between; margin-top: 5px;">
              <div style="color: #666; font-size: 12px;">
                ID: ${a.id}
                ${c?'<span style="color: #4CAF50; margin-left: 5px;">âœ“ is_upsell=true</span>':""}
              </div>
              <div style="font-weight: 500;">${s(a.price*a.quantity)}</div>
            </div>
          </li>
        `}),r+="</ul></div>"):r+='<div style="color: #999; text-align: center; margin-bottom: 15px;">Cart is empty</div>',i.totals?(r+="<div>",r+='<div style="font-weight: 600; margin-bottom: 10px;">Totals:</div>',r+='<ul style="list-style: none; padding: 0; margin: 0;">',r+=`
        <li style="display: flex; justify-content: space-between; padding: 3px 0;">
          <div>Subtotal:</div>
          <div>${s(i.totals.subtotal)}</div>
        </li>
      `,i.totals.retail_subtotal>i.totals.subtotal&&(r+=`
          <li style="display: flex; justify-content: space-between; padding: 3px 0;">
            <div>Retail Subtotal:</div>
            <div>${s(i.totals.retail_subtotal)}</div>
          </li>
        `,i.totals.savings&&(r+=`
            <li style="display: flex; justify-content: space-between; padding: 3px 0; color: #e53935;">
              <div>Savings:</div>
              <div>${s(i.totals.savings)} (${Math.round(i.totals.savings_percentage)}%)</div>
            </li>
          `)),i.totals.shipping>0&&(r+=`
          <li style="display: flex; justify-content: space-between; padding: 3px 0;">
            <div>Shipping:</div>
            <div>${s(i.totals.shipping)}</div>
          </li>
        `),i.totals.recurring_total>0&&(r+=`
          <li style="display: flex; justify-content: space-between; padding: 3px 0; color: #2196f3;">
            <div>Recurring Total:</div>
            <div>${s(i.totals.recurring_total)}</div>
          </li>
        `),r+=`
        <li style="display: flex; justify-content: space-between; padding: 3px 0; font-weight: 600; margin-top: 5px; border-top: 1px solid #eee;">
          <div>Total:</div>
          <div>${s(i.totals.total)}</div>
        </li>
      `,r+="</ul></div>"):r+='<div style="color: #999; text-align: center; margin-bottom: 15px;">Cart totals not available</div>',t.innerHTML=r};var yc,yt,je,bc,Pr,Md,vc,qg,wc,Fg,Sc,Mg,Ir,Nd,fc=class{constructor(t){o(this,Pr);o(this,vc);o(this,wc);o(this,Sc);o(this,Ir);o(this,yc,void 0);o(this,yt,void 0);o(this,je,new Map);o(this,bc,"os-timer-");u(this,yc,t),u(this,yt,t.logger.createModuleLogger("TIMER")),n(this,Pr,Md).call(this),e(this,yt).infoWithTime("TimerManager initialized")}refreshTimers(){e(this,yt).infoWithTime("Refreshing timers"),e(this,je).forEach(t=>{t.intervalId&&(clearInterval(t.intervalId),t.intervalId=null)}),e(this,je).clear(),n(this,Pr,Md).call(this)}getTimers(){return e(this,je)}};yc=new WeakMap,yt=new WeakMap,je=new WeakMap,bc=new WeakMap,Pr=new WeakSet,Md=function(){e(this,yt).infoWithTime("Initializing timers");let t=document.querySelectorAll('[data-os-element="timer"]');if(t.length===0){e(this,yt).debugWithTime("No timer elements found on page");return}e(this,yt).debugWithTime(`Found ${t.length} timer elements`),t.forEach(i=>{n(this,vc,qg).call(this,i)})},vc=new WeakSet,qg=function(t){let i=t.closest('[data-os-element="timer-text"]');i||e(this,yt).warnWithTime('Timer element has no parent with data-os-element="timer-text", using default configuration');let s=n(this,wc,Fg).call(this,t,i);if(!s.duration){e(this,yt).warnWithTime(`Timer element is missing duration, skipping: ${t.outerHTML}`);return}let r=i?i.innerHTML:null,a=+new Date,c=s.persistenceId;if(c){let g=e(this,bc)+c,m=parseInt(localStorage.getItem(g)||"");m>0?(a=m,e(this,yt).debugWithTime(`Loaded persisted timer start time for ${c}: ${new Date(a).toISOString()}`)):(localStorage.setItem(g,String(a)),e(this,yt).debugWithTime(`Saved new timer start time for ${c}: ${new Date(a).toISOString()}`))}else e(this,yt).debugWithTime(`Timer has no persistence ID, it will reset with every page load: ${t.outerHTML}`);let d={element:t,parentElement:i,config:s,startTime:a,intervalId:null,originalParentContent:r};e(this,je).set(t,d);let h=()=>{let m=(+new Date-a)/1e3,p=Math.round(s.duration-m);if(p<=0){p=0,s.expiryText?i&&s.replaceEntireContent?i.innerHTML=s.expiryText:t.innerText=s.expiryText:t.innerText="00:00",d.intervalId&&(clearInterval(d.intervalId),d.intervalId=null),e(this,je).delete(t),n(this,Ir,Nd).call(this,"expired",t,{timerElement:t,parentElement:i,config:s});return}let w=Math.floor(p/3600);p-=w*3600;let b=Math.floor(p/60);p-=b*60;let y=n(this,Sc,Mg).call(this,w,b,p,s.format);t.innerText=y,n(this,Ir,Nd).call(this,"updated",t,{timerElement:t,parentElement:i,config:s,remaining:{hours:w,minutes:b,seconds:p},formattedTime:y})};h(),d.intervalId=setInterval(h,1e3),e(this,yt).debugWithTime(`Timer initialized: ${s.duration} seconds, persistence ID: ${s.persistenceId||"none"}`)},wc=new WeakSet,Fg=function(t,i){let s={duration:0,persistenceId:null,expiryText:null,format:"auto",replaceEntireContent:!1};return t.dataset.osDuration?s.duration=parseInt(t.dataset.osDuration):i?.dataset.osTimerDuration&&(s.duration=parseInt(i.dataset.osTimerDuration)),t.dataset.osPersistenceId?s.persistenceId=t.dataset.osPersistenceId:i?.dataset.osTimerPersistenceId&&(s.persistenceId=i.dataset.osTimerPersistenceId),t.dataset.osExpiryText?s.expiryText=t.dataset.osExpiryText:i?.dataset.osTimerExpiryText&&(s.expiryText=i.dataset.osTimerExpiryText),t.dataset.osFormat?s.format=t.dataset.osFormat:i?.dataset.osTimerFormat&&(s.format=i.dataset.osTimerFormat),(t.dataset.osReplaceEntireContent==="true"||i?.dataset.osTimerReplaceEntireContent==="true")&&(s.replaceEntireContent=!0),s.expiryText&&(s.expiryText.includes("<")||s.expiryText.includes(">"))&&(s.replaceEntireContent=!0),s},Sc=new WeakSet,Mg=function(t,i,s,r){let a=c=>c.toString().padStart(2,"0");return r==="hh:mm:ss"||r==="auto"&&t>0?`${a(t)}:${a(i)}:${a(s)}`:r==="mm:ss"||r==="auto"&&i>0?`${a(i)}:${a(s)}`:r==="ss"?a(s):`${a(i)}:${a(s)}`},Ir=new WeakSet,Nd=function(t,i,s={}){let r=new CustomEvent(`os:timer.${t}`,{bubbles:!0,cancelable:!0,detail:{...s,manager:this}});i.dispatchEvent(r),document.dispatchEvent(r),e(this,yt).debugWithTime(`Timer event triggered: ${t}`)};var gs,$t,ms,qr,Od,Cc,Ng,_c,Og,xc=class{constructor(t){o(this,qr);o(this,Cc);o(this,_c);o(this,gs,void 0);o(this,$t,void 0);o(this,ms,new Map);u(this,gs,t),u(this,$t,t.logger.createModuleLogger("DISPLAY")),n(this,qr,Od).call(this),e(this,gs).state.subscribe("cart",()=>this.refreshDisplayElements()),e(this,$t).infoWithTime("DisplayManager initialized")}refreshDisplayElements(){e(this,$t).debugWithTime("Refreshing display elements");let i=e(this,gs).state.getState("cart").items.map(s=>s.id.toString());e(this,ms).forEach((s,r)=>{n(this,Cc,Ng).call(this,r,s,i)})}refresh(){e(this,$t).infoWithTime("Manually refreshing display elements"),e(this,ms).clear(),n(this,qr,Od).call(this)}};gs=new WeakMap,$t=new WeakMap,ms=new WeakMap,qr=new WeakSet,Od=function(){e(this,$t).infoWithTime("Initializing display elements");let t=document.querySelectorAll('[data-os-cart="swap-display"]');if(t.length===0){e(this,$t).debugWithTime("No swap display containers found on page");return}e(this,$t).debugWithTime(`Found ${t.length} swap display containers`),t.forEach((i,s)=>{let r=i.dataset.osId||`auto-container-${s}`,a=i.querySelectorAll('[data-os-in-cart="display"]');if(a.length===0){e(this,$t).warnWithTime(`Container ${r} has no display elements`);return}e(this,ms).set(i,{id:r,elements:Array.from(a).map(c=>({element:c,packageId:c.dataset.osPackage}))}),e(this,$t).debugWithTime(`Initialized container ${r} with ${a.length} display elements`)}),this.refreshDisplayElements()},Cc=new WeakSet,Ng=function(t,i,s){let{id:r,elements:a}=i,c=!1;for(let{element:d,packageId:h}of a)h&&s.includes(h)?(d.style.display="block",c=!0,e(this,$t).debugWithTime(`Showing element for package ${h} in container ${r}`)):d.style.display="none";!c&&a.length>0,n(this,_c,Og).call(this,"updated",t,{containerId:r,hasVisibleElement:c,visiblePackageIds:a.filter(({element:d})=>d.style.display==="block").map(({packageId:d})=>d)})},_c=new WeakSet,Og=function(t,i,s={}){let r=new CustomEvent(`os:display.${t}`,{bubbles:!0,cancelable:!0,detail:{...s,manager:this}});i.dispatchEvent(r),document.dispatchEvent(r),e(this,$t).debugWithTime(`Display event triggered: ${t}`)};var Ge,C,_,ue,ps,Fr,Ud,Ac,Ug,kc,Rg,Tc,zg,$c,Dg,Lc,Bg,Pc,Vg,Ic,Wg,qc,Hg,bt,Lt,Fc,jg,Mc,Gg,Rd,xp,Ec=class{constructor(t){o(this,Fr);o(this,Ac);o(this,kc);o(this,Tc);o(this,$c);o(this,Lc);o(this,Pc);o(this,Ic);o(this,qc);o(this,bt);o(this,Fc);o(this,Mc);o(this,Rd);o(this,Ge,void 0);o(this,C,void 0);o(this,_,{lineDisplays:[],summaryContainers:[],savingsBars:[],shippingBars:[],grandTotals:[],subtotals:[],summaryBars:[],summaryPanels:[],summaryTexts:[],summaryIcons:[],compareTotalElements:[]});o(this,ue,{currencySymbol:"$",showComparePricing:!0,showProductImages:!0,showTaxPendingMessage:!0});o(this,ps,null);u(this,Ge,t),u(this,C,t.logger.createModuleLogger("CART_DISPLAY")),n(this,Fr,Ud).call(this),e(this,Ge).state.subscribe("cart",()=>this.updateCartDisplay()),e(this,C).infoWithTime("CartDisplayManager initialized")}updateCartDisplay(){e(this,C).debugWithTime("Updating cart display");let t=e(this,Ge).state.getState("cart");if(!t){e(this,C).warnWithTime("Cart data not available");return}e(this,C).debugWithTime(`Cart data: ${JSON.stringify(t)}`),n(this,Tc,zg).call(this,t.items),n(this,Lc,Bg).call(this,t.totals),n(this,Pc,Vg).call(this,t.totals.shipping,t.shippingMethod),n(this,Ic,Wg).call(this,t.totals),n(this,qc,Hg).call(this,t.totals.total),n(this,Mc,Gg).call(this,t.totals),e(this,C).debugWithTime("Cart display updated")}refresh(){e(this,C).infoWithTime("Manually refreshing cart display"),n(this,Fr,Ud).call(this)}};Ge=new WeakMap,C=new WeakMap,_=new WeakMap,ue=new WeakMap,ps=new WeakMap,Fr=new WeakSet,Ud=function(){if(e(this,C).infoWithTime("Initializing cart display"),e(this,_).lineDisplays=document.querySelectorAll('[data-os-cart-summary="line-display"]'),e(this,_).summaryContainers=document.querySelectorAll('[data-os-cart="summary"]'),e(this,_).savingsBars=document.querySelectorAll('[data-os-cart-summary="savings"]'),e(this,_).shippingBars=document.querySelectorAll('[data-os-cart-summary="shipping-bar"]'),e(this,_).grandTotals=document.querySelectorAll('[data-os-cart-summary="grand-total"]'),e(this,_).subtotals=document.querySelectorAll('[data-os-cart-summary="subtotal"]'),e(this,_).summaryBars=document.querySelectorAll('[os-checkout-element="summary-bar"]'),e(this,_).summaryPanels=document.querySelectorAll('[os-checkout-element="summary-mobile"]'),e(this,_).summaryTexts=document.querySelectorAll('[os-checkout-element="summary-text"]'),e(this,_).summaryIcons=document.querySelectorAll("[os-summary-icon]"),e(this,_).compareTotalElements=document.querySelectorAll('[data-os-cart-summary="compare-total"]'),e(this,C).debugWithTime(`Line displays found: ${e(this,_).lineDisplays.length}`),e(this,C).debugWithTime(`Summary containers found: ${e(this,_).summaryContainers.length}`),e(this,C).debugWithTime(`Savings bars found: ${e(this,_).savingsBars.length}`),e(this,C).debugWithTime(`Shipping bars found: ${e(this,_).shippingBars.length}`),e(this,C).debugWithTime(`Grand total elements found: ${e(this,_).grandTotals.length}`),e(this,C).debugWithTime(`Subtotal elements found: ${e(this,_).subtotals.length}`),e(this,C).debugWithTime(`Summary bars found: ${e(this,_).summaryBars.length}`),e(this,C).debugWithTime(`Summary panels found: ${e(this,_).summaryPanels.length}`),e(this,C).debugWithTime(`Summary texts found: ${e(this,_).summaryTexts.length}`),e(this,C).debugWithTime(`Summary icons found: ${e(this,_).summaryIcons.length}`),e(this,C).debugWithTime(`Compare total elements found: ${e(this,_).compareTotalElements.length}`),e(this,_).summaryContainers.length>0){let i=e(this,_).summaryContainers[0];e(this,ue).showComparePricing=i.dataset.showComparePricing!=="false",e(this,ue).showProductImages=i.dataset.showProductImages!=="false",e(this,ue).showTaxPendingMessage=i.dataset.showTaxPendingMessage!=="false",e(this,ue).currencySymbol=i.dataset.currencySymbol||"$"}let t=document.querySelector('[data-os-cart-summary="line-item"]');t&&u(this,ps,t.cloneNode(!0)),n(this,Ac,Ug).call(this),e(this,C).debugWithTime("Cart display elements initialized"),this.updateCartDisplay()},Ac=new WeakSet,Ug=function(){let{summaryBars:t,summaryPanels:i,summaryTexts:s,summaryIcons:r}=e(this,_);if(!t.length||!i.length){e(this,C).debugWithTime("Summary toggle elements not found, skipping initialization");return}e(this,C).debugWithTime("Initializing summary toggle"),i.forEach((a,c)=>{if(a.classList.add("no-transition"),!a.classList.contains("cc-expanded")){a.style.height="0",a.style.opacity="0",a.style.overflow="hidden";let d=s[c];d&&(d.textContent="Show Order Summary")}requestAnimationFrame(()=>{a.classList.remove("no-transition"),a.style.transition="height 0.3s ease-out, opacity 0.25s ease-out"})}),t.forEach((a,c)=>{a.addEventListener("click",d=>{d.preventDefault(),n(this,kc,Rg).call(this,c)})}),window.addEventListener("resize",n(this,Fc,jg).call(this,()=>{i.forEach(a=>{a.classList.contains("cc-expanded")&&(a.style.height="auto")})},250)),e(this,C).debugWithTime("Summary toggle initialized")},kc=new WeakSet,Rg=function(t=0){let{summaryPanels:i,summaryTexts:s,summaryIcons:r}=e(this,_),a=i[t],c=s[t],d=r[t];if(!a)return;if(!a.classList.contains("cc-expanded"))a.classList.add("cc-expanded"),a.style.height=`${a.scrollHeight}px`,a.style.opacity="1",c&&(c.textContent="Hide Order Summary"),d&&(d.style.transform="rotate(180deg)"),a.addEventListener("transitionend",()=>{a.classList.contains("cc-expanded")&&(a.style.height="auto")},{once:!0}),e(this,C).debugWithTime("Summary panel expanded");else{let g=a.scrollHeight;a.style.height=`${g}px`,a.offsetHeight,a.style.height="0",a.style.opacity="0",c&&(c.textContent="Show Order Summary"),d&&(d.style.transform="rotate(0deg)"),a.addEventListener("transitionend",()=>{a.style.height==="0px"&&a.classList.remove("cc-expanded")},{once:!0}),e(this,C).debugWithTime("Summary panel collapsed")}},Tc=new WeakSet,zg=function(t){if(!e(this,_).lineDisplays.length||!e(this,ps)){e(this,C).warnWithTime("Line displays or template not found");return}if(!t||t.length===0){e(this,C).debugWithTime("No items in cart");return}e(this,_).lineDisplays.forEach(s=>{s.innerHTML="",t.forEach(r=>{let a=n(this,$c,Dg).call(this,r);s.appendChild(a)})});let i=document.querySelectorAll('[data-os-cart-summary="summary-scroll"]');if(i.length){let s=t.length>2;i.forEach(r=>{r.classList.toggle("hide",!s)})}},$c=new WeakSet,Dg=function(t){let i=e(this,ps).cloneNode(!0),s=i.querySelector('[data-os-cart-summary="line-title"]');if(s&&(s.textContent=t.name),e(this,ue).showProductImages){let h=i.querySelector('[data-os-cart-summary="line-image"]');h&&t.image&&(h.src=t.image,h.alt=t.name)}let r=i.querySelector('[os-cart="line_item-qty"]');r&&(r.textContent=t.quantity||1);let a=i.querySelector('[data-os-cart-summary="line-compare"]'),c=i.querySelector('[data-os-cart-summary="line-sale"]');a&&t.retail_price&&e(this,ue).showComparePricing?(a.textContent=n(this,bt,Lt).call(this,t.retail_price*(t.quantity||1)),a.classList.remove("hide")):a&&a.classList.add("hide"),c&&(c.textContent=n(this,bt,Lt).call(this,t.price*(t.quantity||1)));let d=i.querySelector('[data-os-cart-summary="line-saving-percent"]');if(d&&t.retail_price){let h=Math.round((1-t.price/t.retail_price)*100);if(h>0){let g=d.dataset.osFormat||"default",m=`${h}% OFF`;g==="parenthesis"&&(m=`(${h}% OFF)`),d.textContent=m,d.classList.remove("hide")}else d.classList.add("hide")}else d&&d.classList.add("hide");return i},Lc=new WeakSet,Bg=function(t){t&&e(this,_).subtotals.length&&(e(this,_).subtotals.forEach(i=>{i.textContent=n(this,bt,Lt).call(this,t.subtotal)}),e(this,C).debugWithTime(`Updated subtotal to: ${n(this,bt,Lt).call(this,t.subtotal)}`))},Pc=new WeakSet,Vg=function(t,i){if(!e(this,_).shippingBars.length){e(this,C).warnWithTime("Shipping bars not found");return}e(this,_).shippingBars.forEach(s=>{let r=s.querySelector('[data-os-cart-summary="shipping-compare"]'),a=s.querySelector('[data-os-cart-summary="shipping-current"]');r&&a&&(t===0&&i?.standard_cost>0?(r.textContent=n(this,bt,Lt).call(this,i.standard_cost),a.textContent="FREE",r.classList.remove("hide")):t>0?(a.textContent=n(this,bt,Lt).call(this,t),r.classList.add("hide")):(a.textContent="FREE",r.classList.add("hide")))})},Ic=new WeakSet,Wg=function(t){if(!e(this,_).savingsBars.length){e(this,C).warnWithTime("Savings bars not found");return}e(this,_).savingsBars.forEach(r=>{let a=r.querySelector('[data-os-cart-summary="savings-amount"]'),c=r.querySelector('[data-os-cart-summary="savings-percentage"]');t.savings>0&&t.savings_percentage>0?(a&&(a.textContent=n(this,bt,Lt).call(this,t.savings),e(this,C).debugWithTime(`Updated savings amount to: ${n(this,bt,Lt).call(this,t.savings)}`)),c&&(c.textContent=`${Math.round(t.savings_percentage)}% OFF`,e(this,C).debugWithTime(`Updated savings percentage to: ${Math.round(t.savings_percentage)}% OFF`)),r.classList.remove("hide")):r.classList.add("hide")});let i=document.querySelectorAll('[data-os-cart-summary="savings-amount"]'),s=document.querySelectorAll('[data-os-cart-summary="savings-percentage"]');t.savings>0&&t.savings_percentage>0&&(i.forEach(r=>{r.textContent=n(this,bt,Lt).call(this,t.savings)}),s.forEach(r=>{r.textContent=`${Math.round(t.savings_percentage)}% OFF`}))},qc=new WeakSet,Hg=function(t){if(!e(this,_).grandTotals.length){e(this,C).warnWithTime("Grand total elements not found");return}e(this,_).grandTotals.forEach(i=>{i.textContent=n(this,bt,Lt).call(this,t)}),e(this,C).debugWithTime(`Updated grand total to: ${n(this,bt,Lt).call(this,t)}`)},bt=new WeakSet,Lt=function(t){return e(this,Ge).campaign?.formatPrice?e(this,Ge).campaign.formatPrice(t):`${e(this,ue).currencySymbol}${t.toFixed(2)} USD`},Fc=new WeakSet,jg=function(t,i){let s;return function(...a){let c=()=>{clearTimeout(s),t(...a)};clearTimeout(s),s=setTimeout(c,i)}},Mc=new WeakSet,Gg=function(t){if(!e(this,_).compareTotalElements.length){e(this,C).debugWithTime("No compare-total elements found");return}e(this,C).debugWithTime("Updating compare-total elements"),e(this,C).debugWithTime(`Cart totals: ${JSON.stringify(t)}`),e(this,_).compareTotalElements.forEach(i=>{let s=i.dataset.totalType||"retail",r=null;switch(s){case"retail":r=t.retail_subtotal;break;case"recurring":r=t.recurring_total;break;case"subtotal_compare":case"original":case"msrp":r=t[s]||null;break;default:r=t.retail_subtotal}r&&r>t.total?(i.textContent=n(this,bt,Lt).call(this,r),i.classList.remove("hide"),e(this,C).debugWithTime(`Updated compare-total (${s}) to: ${n(this,bt,Lt).call(this,r)}`)):(i.classList.add("hide"),e(this,C).debugWithTime(`Hiding compare-total element (${s}): compareValue=${r}, total=${t.total}`))})},Rd=new WeakSet,xp=function(t){return document.querySelectorAll(`[${t}]`)};var V,q,$,Uc,Rc,Kg,zc,Yg,Dc,Jg,fs,Nc,Bc,Zg,Mr,zd,Vc,Xg,Wc,Qg,Hc,tm,tt,ot,Nr,Dd,jc,em,Gc,im,Oc=class{constructor(t){o(this,Rc);o(this,zc);o(this,Dc);o(this,fs);o(this,Bc);o(this,Mr);o(this,Vc);o(this,Wc);o(this,Hc);o(this,tt);o(this,Nr);o(this,jc);o(this,Gc);o(this,V,void 0);o(this,q,void 0);o(this,$,{});o(this,Uc,!1);u(this,V,t),u(this,q,t.logger.createModuleLogger("ATTRIBUTION")),n(this,Rc,Kg).call(this)}updateAttributionData(t){t.metadata&&e(this,$).metadata&&(t.metadata={...e(this,$).metadata,...t.metadata}),t.funnel&&e(this,q).debug(`Updating funnel value to: ${t.funnel}`),u(this,$,{...e(this,$),...t}),n(this,fs,Nc).call(this),e(this,q).debug("Attribution data updated",t),e(this,V).events&&e(this,V).events.trigger("attribution.updated",{attribution:e(this,$)})}getAttributionData(){return{...e(this,$)}}getAttributionForApi(){return{affiliate:e(this,$).affiliate,funnel:e(this,$).funnel,gclid:e(this,$).gclid,metadata:e(this,$).metadata,utm_source:e(this,$).utm_source,utm_medium:e(this,$).utm_medium,utm_campaign:e(this,$).utm_campaign,utm_content:e(this,$).utm_content,utm_term:e(this,$).utm_term,subaffiliate1:e(this,$).subaffiliate1,subaffiliate2:e(this,$).subaffiliate2,subaffiliate3:e(this,$).subaffiliate3,subaffiliate4:e(this,$).subaffiliate4,subaffiliate5:e(this,$).subaffiliate5}}debug(){console.group("AttributionManager Debug Info");let t=document.querySelector('meta[name="os-tracking-tag"][data-tag-name="funnel_name"]'),i=t?t.getAttribute("data-tag-value"):"",s=e(this,V).campaign?.getCampaignName()||e(this,V).campaignData?.name||"";e(this,$).affiliate,e(this,$).funnel,console.group("API Formatted Attribution Data (What gets sent to API)");let r=this.getAttributionForApi();r.affiliate,r.funnel,r.gclid,r.utm_source,r.utm_medium,r.utm_campaign,r.utm_content,r.utm_term,r.subaffiliate1,r.subaffiliate2,r.subaffiliate3,r.subaffiliate4,r.subaffiliate5,console.group("Metadata Object:"),r.metadata.domain,r.metadata.device,r.metadata.device_type,r.metadata.fb_fbp,r.metadata.fb_fbc,r.metadata.fb_pixel_id,r.metadata,console.groupEnd(),console.groupEnd(),e(this,$),new URLSearchParams(window.location.search).toString(),console.group("Tracking Tags");let a=document.querySelectorAll('meta[name="os-tracking-tag"]');return a.length>0&&a.forEach(c=>{`${c.getAttribute("data-tag-name")}${c.getAttribute("data-tag-value")}`,c.getAttribute("data-persist")}),console.groupEnd(),t&&t.getAttribute("data-tag-value"),e(this,V).campaignData?.name,e(this,V).state&&e(this,V).state.getState("attribution"),console.groupEnd(),"Attribution debug info logged to console."}};V=new WeakMap,q=new WeakMap,$=new WeakMap,Uc=new WeakMap,Rc=new WeakSet,Kg=function(){e(this,q).info("Initializing AttributionManager"),n(this,zc,Yg).call(this),n(this,fs,Nc).call(this),n(this,Wc,Qg).call(this),u(this,Uc,!0),e(this,q).info("AttributionManager initialized successfully")},zc=new WeakSet,Yg=function(){let t=document.querySelector('meta[name="os-tracking-tag"][data-tag-name="funnel_name"]'),i=t?t.getAttribute("data-tag-value"):"",s=e(this,V).campaign?.getCampaignName()||e(this,V).campaignData?.name||"",r=i||s;e(this,q).debug(`Using funnel value: ${r} (from ${i?"meta tag":"campaign name"})`);let a=n(this,tt,ot).call(this,"affid")||n(this,tt,ot).call(this,"aff")||"",c=n(this,Nr,Dd).call(this,"_fbc")||"",d=n(this,Nr,Dd).call(this,"_fbp")||"",h=n(this,Gc,im).call(this),g={landing_page:window.location.href||"",referrer:document.referrer||"",device:navigator.userAgent||"",device_type:n(this,jc,em).call(this),timestamp:Date.now(),domain:window.location.hostname,fb_fbp:d,fb_fbc:c,fb_pixel_id:h},m=n(this,tt,ot).call(this,"fbclid")||"";m&&(g.fbclid=m),n(this,Dc,Jg).call(this,g),u(this,$,{affiliate:a,funnel:r,gclid:n(this,tt,ot).call(this,"gclid")||"",metadata:g,utm_source:n(this,tt,ot).call(this,"utm_source")||"",utm_medium:n(this,tt,ot).call(this,"utm_medium")||"",utm_campaign:n(this,tt,ot).call(this,"utm_campaign")||"",utm_content:n(this,tt,ot).call(this,"utm_content")||"",utm_term:n(this,tt,ot).call(this,"utm_term")||"",fbclid:m,subaffiliate1:n(this,tt,ot).call(this,"subaffiliate1")||n(this,tt,ot).call(this,"sub1")||"",subaffiliate2:n(this,tt,ot).call(this,"subaffiliate2")||n(this,tt,ot).call(this,"sub2")||"",subaffiliate3:n(this,tt,ot).call(this,"subaffiliate3")||n(this,tt,ot).call(this,"sub3")||"",subaffiliate4:n(this,tt,ot).call(this,"subaffiliate4")||n(this,tt,ot).call(this,"sub4")||"",subaffiliate5:n(this,tt,ot).call(this,"subaffiliate5")||n(this,tt,ot).call(this,"sub5")||"",first_visit_timestamp:n(this,Vc,Xg).call(this),current_visit_timestamp:Date.now()}),e(this,q).debug("Attribution data collected",e(this,$)),!s&&e(this,V).events&&e(this,q).debug("Campaign data not available yet, will update when loaded")},Dc=new WeakSet,Jg=function(t){let i=document.querySelectorAll('meta[name="os-tracking-tag"]');e(this,q).debug(`Found ${i.length} tracking tags`),i.forEach(s=>{let r=s.getAttribute("data-tag-name"),a=s.getAttribute("data-tag-value"),c=s.getAttribute("data-persist")==="true";if(r&&a&&(t[r]=a,e(this,q).debug(`Added tracking tag: ${r} = ${a}`),c))try{sessionStorage.setItem(`os_tag_${r}`,a),e(this,q).debug(`Persisted tracking tag: ${r} = ${a}`)}catch(d){e(this,q).error(`Error persisting tracking tag ${r}:`,d)}})},fs=new WeakSet,Nc=function(){if(!e(this,V).state){e(this,q).warn("State manager not available, attribution data will not be stored");return}e(this,V).state.setState("cart.attribution",e(this,$)),e(this,V).state.setState("attribution",this.getAttributionForApi()),e(this,q).info("Attribution data stored in state"),n(this,Bc,Zg).call(this)},Bc=new WeakSet,Zg=function(){try{localStorage.setItem("os_attribution",JSON.stringify(e(this,$))),e(this,q).debug("Attribution data persisted to localStorage")}catch(t){e(this,q).error("Error persisting attribution data to localStorage:",t)}},Mr=new WeakSet,zd=function(){try{let t=localStorage.getItem("os_attribution");if(t)return JSON.parse(t)}catch(t){e(this,q).error("Error loading attribution data from localStorage:",t)}return{}},Vc=new WeakSet,Xg=function(){let t=n(this,Mr,zd).call(this);return t.first_visit_timestamp?t.first_visit_timestamp:Date.now()},Wc=new WeakSet,Qg=function(){window.addEventListener("popstate",()=>{let t=e(this,$).metadata||{};t.landing_page=window.location.href,this.updateAttributionData({metadata:t})}),e(this,V).events&&(e(this,V).events.on("campaign.loaded",t=>{if(t&&t.campaign){let i=e(this,V).campaign?.getCampaignName()||t.campaign.name||"";if(!i){e(this,q).warn("Campaign loaded but name is not available");return}e(this,q).info(`Campaign loaded: ${i}`);let s=document.querySelector('meta[name="os-tracking-tag"][data-tag-name="funnel_name"]'),r=s?s.getAttribute("data-tag-value"):"",a=r||i;this.updateAttributionData({funnel:a}),n(this,Hc,tm).call(this),e(this,q).debug(`Updated funnel to: ${a} (from ${r?"meta tag":"campaign name"})`)}}),e(this,V).events.on("prospect.cartCreated",()=>{let t=e(this,$).metadata||{};t.conversion_timestamp=Date.now(),this.updateAttributionData({metadata:t}),e(this,q).debug("Cart created, updated metadata with conversion timestamp")}))},Hc=new WeakSet,tm=function(){e(this,q).info("Reinitializing attribution data with campaign information");let t=e(this,V).campaign?.getCampaignName()||e(this,V).campaignData?.name||"";if(!t){e(this,q).warn("Cannot reinitialize attribution data: Campaign name not available");return}let i=document.querySelector('meta[name="os-tracking-tag"][data-tag-name="funnel_name"]'),s=i?i.getAttribute("data-tag-value"):"",r=s||t;e(this,q).debug(`Using funnel value: ${r} (from ${s?"meta tag":"campaign name"})`),e(this,$).funnel=r,n(this,fs,Nc).call(this),e(this,q).info(`Attribution data reinitialized with funnel: ${r}`),e(this,V).events&&e(this,V).events.trigger("attribution.updated",{attribution:e(this,$)})},tt=new WeakSet,ot=function(t){let i=new URLSearchParams(window.location.search);if(i.has(t)){let r=i.get(t);try{sessionStorage.setItem(t,r)}catch(a){e(this,q).error(`Error storing ${t} in sessionStorage:`,a)}return r}try{if(sessionStorage.getItem(t))return sessionStorage.getItem(t)}catch(r){e(this,q).error(`Error reading ${t} from sessionStorage:`,r)}try{if(localStorage.getItem(t))return localStorage.getItem(t)}catch(r){e(this,q).error(`Error reading ${t} from localStorage:`,r)}let s=n(this,Mr,zd).call(this);return s[t]?s[t]:""},Nr=new WeakSet,Dd=function(t){let s=`; ${document.cookie}`.split(`; ${t}=`);return s.length===2?s.pop().split(";").shift():""},jc=new WeakSet,em=function(){let t=navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)?"mobile":"desktop"},Gc=new WeakSet,im=function(){let t=document.querySelector('meta[name="facebook-domain-verification"]');if(t){let s=t.getAttribute("content");if(s&&s.includes("=")){let r=s.split("=");if(r.length>1)return r[1]}}let i=document.querySelectorAll("script");for(let s of i){let r=s.textContent||"";if(r.includes("fbq(")&&r.includes("init")){let a=r.match(/fbq\s*\(\s*['"]init['"],\s*['"](\d+)['"]/);if(a&&a[1])return a[1]}}return""};var Qt,S,Yc,lt,Jc,fi,Zc,sm,Xc,rm,Qc,nm,tl,om,el,am,il,cm,Ke,ys,Kc=class{constructor(t){o(this,Zc);o(this,Xc);o(this,Qc);o(this,tl);o(this,el);o(this,il);o(this,Ke);o(this,Qt,void 0);o(this,S,void 0);o(this,Yc,!1);o(this,lt,{gtm:{enabled:!1,initialized:!1},fbPixel:{enabled:!1,initialized:!1},ga4:{enabled:!1,initialized:!1}});o(this,Jc,!1);o(this,fi,new Set);u(this,Qt,t),u(this,S,t.logger.createModuleLogger("EVENT")),u(this,Jc,t.options?.debug||!1),this.init()}init(){e(this,S).info("Initializing EventManager"),n(this,Qc,nm).call(this),n(this,tl,om).call(this),n(this,Zc,sm).call(this),u(this,Yc,!0),e(this,S).info("EventManager initialized")}viewItemList(t){if(e(this,S).debug("viewItemList called with campaign data:",t?"present":"missing"),!t||!t.packages||t.packages.length===0){e(this,S).warn("Cannot fire view_item_list event: No packages found in campaign data");return}e(this,S).debug(`Found ${t.packages.length} packages in campaign data`);let i=t.packages.map(r=>({item_id:r.external_id||r.ref_id,item_name:r.name,price:parseFloat(r.price)||0,currency:t.currency||"USD",quantity:1})),s={event:"view_item_list",ecommerce:{currency:t.currency||"USD",items:i}};e(this,S).debug("Firing view_item_list event with data:",s),n(this,Ke,ys).call(this,"view_item_list",s)}addToCart(t){let i=!t.items&&!t.totals,s=[],r="USD",a=0;if(i){if(e(this,S).debug("addToCart called with single package, converting to cart format"),!t){e(this,S).warn("Cannot fire add_to_cart event: No package data provided");return}let d=t,h={item_id:d.external_id||d.ref_id||d.id,item_name:d.name,price:parseFloat(d.price)||0,currency:d.currency||e(this,Qt).getCampaignData()?.currency||"USD",quantity:d.quantity||1};s=[h],r=h.currency,a=h.price*h.quantity}else{if(!t||!t.items||t.items.length===0){e(this,S).warn("Cannot fire add_to_cart event: No items in cart");return}s=t.items.map(d=>({item_id:d.external_id||d.id,item_name:d.name,price:parseFloat(d.price)||0,currency:t.totals?.currency||"USD",quantity:d.quantity||1})),r=t.totals?.currency||"USD",a=t.totals?.total||0}let c={event:"add_to_cart",ecommerce:{currency:r,value:a,items:s}};n(this,Ke,ys).call(this,"add_to_cart",c)}purchase(t,i=!1){if(!t||!t.lines||t.lines.length===0){e(this,S).warn("Cannot fire purchase event: No items in order");return}let s=t.number||t.ref_id;if(!i&&s&&e(this,fi).has(s)){e(this,S).info(`Purchase event for order ${s} already fired, skipping`);return}let r=t.lines.map(d=>({item_id:d.product_id||d.id,item_name:d.product_title||d.name,price:parseFloat(d.price_incl_tax||d.price)||0,currency:t.currency||"USD",quantity:d.quantity||1})),a=n(this,el,am).call(this,t),c={event:"purchase",ecommerce:{transaction_id:s,value:parseFloat(t.total_incl_tax||t.total)||0,tax:parseFloat(t.total_tax)||0,shipping:parseFloat(t.shipping_incl_tax||t.shipping)||0,currency:t.currency||"USD",coupon:t.vouchers?.length>0?t.vouchers[0].code:"",...a,items:r}};n(this,Ke,ys).call(this,"purchase",c),s&&(e(this,fi).add(s),n(this,Xc,rm).call(this),e(this,S).debug(`Marked order ${s} as processed`))}viewItem(t){if(!t){e(this,S).warn("Cannot fire view_item event: No package data provided");return}let i={item_id:t.ref_id||t.external_id||t.id,item_name:t.name,price:parseFloat(t.price)||0,currency:t.currency||e(this,Qt).getCampaignData()?.currency||"USD",quantity:1},s={event:"view_item",ecommerce:{currency:i.currency,value:i.price,items:[i]}};n(this,Ke,ys).call(this,"view_item",s)}beginCheckout(){let t=e(this,Qt).state.getState("cart");if(!t||!t.items||t.items.length===0){e(this,S).warn("Cannot fire begin_checkout event: No items in cart");return}let i=t.items.map(r=>({item_id:r.external_id||r.id,item_name:r.name,price:parseFloat(r.price)||0,currency:t.totals?.currency||"USD",quantity:r.quantity||1})),s={event:"begin_checkout",ecommerce:{currency:t.totals?.currency||"USD",value:t.totals?.total||0,items:i}};n(this,Ke,ys).call(this,"begin_checkout",s)}fireCustomEvent(t,i={}){if(!t){e(this,S).warn("Cannot fire custom event: No event name provided");return}let s={event:t,...i};e(this,S).debug(`Firing custom event: ${t}`,s),e(this,lt).gtm.enabled&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push(s),e(this,S).debug(`Custom event ${t} fired to Google Tag Manager`)),e(this,lt).fbPixel.enabled&&typeof window.fbq=="function"&&(window.fbq("trackCustom",t,i),e(this,S).debug(`Custom event ${t} fired to Facebook Pixel`)),e(this,lt).ga4.enabled&&typeof window.gtag=="function"&&(window.gtag("event",t,i),e(this,S).debug(`Custom event ${t} fired to Google Analytics 4`));let r=new CustomEvent(`os:${t}`,{bubbles:!0,detail:s});document.dispatchEvent(r)}setPlatformEnabled(t,i){e(this,lt)[t]?(e(this,lt)[t].enabled=i,e(this,S).info(`${t} ${i?"enabled":"disabled"}`)):e(this,S).warn(`Unknown platform: ${t}`)}getPlatformStatus(){return{...e(this,lt)}}};Qt=new WeakMap,S=new WeakMap,Yc=new WeakMap,lt=new WeakMap,Jc=new WeakMap,fi=new WeakMap,Zc=new WeakSet,sm=function(){try{let t=sessionStorage.getItem("os_processed_order_ids");if(t){let i=JSON.parse(t);Array.isArray(i)&&(i.forEach(s=>e(this,fi).add(s)),e(this,S).debug(`Loaded ${i.length} processed order IDs from sessionStorage`))}}catch(t){e(this,S).error("Error loading processed order IDs from sessionStorage:",t)}},Xc=new WeakSet,rm=function(){try{let t=Array.from(e(this,fi));sessionStorage.setItem("os_processed_order_ids",JSON.stringify(t)),e(this,S).debug(`Saved ${t.length} processed order IDs to sessionStorage`)}catch(t){e(this,S).error("Error saving processed order IDs to sessionStorage:",t)}},Qc=new WeakSet,nm=function(){typeof window.dataLayer<"u"?(e(this,lt).gtm.enabled=!0,e(this,lt).gtm.initialized=!0,e(this,S).info("Google Tag Manager detected")):e(this,S).info("Google Tag Manager not detected"),typeof window.fbq<"u"?(e(this,lt).fbPixel.enabled=!0,e(this,lt).fbPixel.initialized=!0,e(this,S).info("Facebook Pixel detected")):e(this,S).info("Facebook Pixel not detected"),typeof window.gtag<"u"?(e(this,lt).ga4.enabled=!0,e(this,lt).ga4.initialized=!0,e(this,S).info("Google Analytics 4 detected")):e(this,S).info("Google Analytics 4 not detected")},tl=new WeakSet,om=function(){e(this,Qt).on("campaign.loaded",t=>{e(this,S).debug("Campaign loaded event received, firing view_item_list"),t&&t.campaign?this.viewItemList(t.campaign):e(this,S).warn("Campaign loaded event received but no campaign data found")}),e(this,Qt).on("cart.updated",t=>{t.cart&&t.cart.items&&t.cart.items.length>0&&this.addToCart(t.cart)}),e(this,Qt).on("order.created",t=>{this.purchase(t)}),e(this,Qt).on("order.loaded",t=>{t.order&&(e(this,S).info("Order loaded on receipt page, checking if purchase event needed"),this.purchase(t.order))})},el=new WeakSet,am=function(t){let i={};return t.user&&(t.user.first_name&&(i.firstname=t.user.first_name),t.user.last_name&&(i.lastname=t.user.last_name),t.user.email&&(i.email_hash=n(this,il,cm).call(this,t.user.email))),t.shipping_address&&(i.city=t.shipping_address.line4||"",i.state=t.shipping_address.state||"",i.zipcode=t.shipping_address.postcode||"",i.country=t.shipping_address.country||""),i},il=new WeakSet,cm=function(t){let i=0;if(t.length===0)return i.toString();for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);i=(i<<5)-i+r,i=i&i}return i.toString()},Ke=new WeakSet,ys=function(t,i){if(e(this,S).debug(`Firing ${t} event`,i),e(this,lt).gtm.enabled?(window.dataLayer=window.dataLayer||[],e(this,S).debug("Clearing previous ecommerce data in dataLayer"),window.dataLayer.push({ecommerce:null}),`${t}`,window.dataLayer.push(i),e(this,S).debug(`${t} event fired to Google Tag Manager`)):(e(this,S).warn(`Cannot fire ${t} event to GTM: GTM not enabled`),window.dataLayer=window.dataLayer||[],window.dataLayer.push({ecommerce:null}),window.dataLayer.push(i)),e(this,lt).fbPixel.enabled){switch(t){case"view_item_list":window.fbq("track","ViewContent",{content_type:"product_group",content_ids:i.ecommerce.items.map(r=>r.item_id),currency:i.ecommerce.currency});break;case"add_to_cart":window.fbq("track","AddToCart",{content_type:"product_group",content_ids:i.ecommerce.items.map(r=>r.item_id),currency:i.ecommerce.currency,value:i.ecommerce.value});break;case"purchase":window.fbq("track","Purchase",{content_type:"product_group",content_ids:i.ecommerce.items.map(r=>r.item_id),currency:i.ecommerce.currency,value:i.ecommerce.value});break}e(this,S).debug(`${t} event fired to Facebook Pixel`)}e(this,lt).ga4.enabled&&(window.gtag("event",t,{currency:i.ecommerce.currency,value:i.ecommerce.value,items:i.ecommerce.items}),e(this,S).debug(`${t} event fired to Google Analytics 4`));let s=new CustomEvent(`os:${t}`,{bubbles:!0,detail:i});document.dispatchEvent(s)};var yi=Math.min,Ye=Math.max,Ur=Math.round;var te=l=>({x:l,y:l}),Cp={left:"right",right:"left",bottom:"top",top:"bottom"},_p={start:"end",end:"start"};function rl(l,t,i){return Ye(l,yi(t,i))}function bs(l,t){return typeof l=="function"?l(t):l}function Je(l){return l.split("-")[0]}function vs(l){return l.split("-")[1]}function Bd(l){return l==="x"?"y":"x"}function nl(l){return l==="y"?"height":"width"}function bi(l){return["top","bottom"].includes(Je(l))?"y":"x"}function ol(l){return Bd(bi(l))}function lm(l,t,i){i===void 0&&(i=!1);let s=vs(l),r=ol(l),a=nl(r),c=r==="x"?s===(i?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(c=Or(c)),[c,Or(c)]}function dm(l){let t=Or(l);return[sl(l),t,sl(t)]}function sl(l){return l.replace(/start|end/g,t=>_p[t])}function Ep(l,t,i){let s=["left","right"],r=["right","left"],a=["top","bottom"],c=["bottom","top"];switch(l){case"top":case"bottom":return i?t?r:s:t?s:r;case"left":case"right":return t?a:c;default:return[]}}function um(l,t,i,s){let r=vs(l),a=Ep(Je(l),i==="start",s);return r&&(a=a.map(c=>c+"-"+r),t&&(a=a.concat(a.map(sl)))),a}function Or(l){return l.replace(/left|right|bottom|top/g,t=>Cp[t])}function Ap(l){return{top:0,right:0,bottom:0,left:0,...l}}function Vd(l){return typeof l!="number"?Ap(l):{top:l,right:l,bottom:l,left:l}}function vi(l){let{x:t,y:i,width:s,height:r}=l;return{width:s,height:r,top:i,left:t,right:t+s,bottom:i+r,x:t,y:i}}function hm(l,t,i){let{reference:s,floating:r}=l,a=bi(t),c=ol(t),d=nl(c),h=Je(t),g=a==="y",m=s.x+s.width/2-r.width/2,p=s.y+s.height/2-r.height/2,w=s[d]/2-r[d]/2,b;switch(h){case"top":b={x:m,y:s.y-r.height};break;case"bottom":b={x:m,y:s.y+s.height};break;case"right":b={x:s.x+s.width,y:p};break;case"left":b={x:s.x-r.width,y:p};break;default:b={x:s.x,y:s.y}}switch(vs(t)){case"start":b[c]-=w*(i&&g?-1:1);break;case"end":b[c]+=w*(i&&g?-1:1);break}return b}var gm=async(l,t,i)=>{let{placement:s="bottom",strategy:r="absolute",middleware:a=[],platform:c}=i,d=a.filter(Boolean),h=await(c.isRTL==null?void 0:c.isRTL(t)),g=await c.getElementRects({reference:l,floating:t,strategy:r}),{x:m,y:p}=hm(g,s,h),w=s,b={},y=0;for(let A=0;A<d.length;A++){let{name:N,fn:L}=d[A],{x:O,y:H,data:z,reset:Y}=await L({x:m,y:p,initialPlacement:s,placement:w,strategy:r,middlewareData:b,rects:g,platform:c,elements:{reference:l,floating:t}});m=O??m,p=H??p,b={...b,[N]:{...b[N],...z}},Y&&y<=50&&(y++,typeof Y=="object"&&(Y.placement&&(w=Y.placement),Y.rects&&(g=Y.rects===!0?await c.getElementRects({reference:l,floating:t,strategy:r}):Y.rects),{x:m,y:p}=hm(g,w,h)),A=-1)}return{x:m,y:p,placement:w,strategy:r,middlewareData:b}};async function Wd(l,t){var i;t===void 0&&(t={});let{x:s,y:r,platform:a,rects:c,elements:d,strategy:h}=l,{boundary:g="clippingAncestors",rootBoundary:m="viewport",elementContext:p="floating",altBoundary:w=!1,padding:b=0}=bs(t,l),y=Vd(b),N=d[w?p==="floating"?"reference":"floating":p],L=vi(await a.getClippingRect({element:(i=await(a.isElement==null?void 0:a.isElement(N)))==null||i?N:N.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(d.floating)),boundary:g,rootBoundary:m,strategy:h})),O=p==="floating"?{x:s,y:r,width:c.floating.width,height:c.floating.height}:c.reference,H=await(a.getOffsetParent==null?void 0:a.getOffsetParent(d.floating)),z=await(a.isElement==null?void 0:a.isElement(H))?await(a.getScale==null?void 0:a.getScale(H))||{x:1,y:1}:{x:1,y:1},Y=vi(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:O,offsetParent:H,strategy:h}):O);return{top:(L.top-Y.top+y.top)/z.y,bottom:(Y.bottom-L.bottom+y.bottom)/z.y,left:(L.left-Y.left+y.left)/z.x,right:(Y.right-L.right+y.right)/z.x}}var mm=l=>({name:"arrow",options:l,async fn(t){let{x:i,y:s,placement:r,rects:a,platform:c,elements:d,middlewareData:h}=t,{element:g,padding:m=0}=bs(l,t)||{};if(g==null)return{};let p=Vd(m),w={x:i,y:s},b=ol(r),y=nl(b),A=await c.getDimensions(g),N=b==="y",L=N?"top":"left",O=N?"bottom":"right",H=N?"clientHeight":"clientWidth",z=a.reference[y]+a.reference[b]-w[b]-a.floating[y],Y=w[b]-a.reference[b],Ai=await(c.getOffsetParent==null?void 0:c.getOffsetParent(g)),Ze=Ai?Ai[H]:0;(!Ze||!await(c.isElement==null?void 0:c.isElement(Ai)))&&(Ze=d.floating[H]||a.floating[y]);let Ls=z/2-Y/2,Xe=Ze/2-A[y]/2-1,$e=yi(p[L],Xe),Ps=yi(p[O],Xe),Qe=$e,Is=Ze-A[y]-Ps,wt=Ze/2-A[y]/2+Ls,ki=rl(Qe,wt,Is),ge=!h.arrow&&vs(r)!=null&&wt!==ki&&a.reference[y]/2-(wt<Qe?$e:Ps)-A[y]/2<0,se=ge?wt<Qe?wt-Qe:wt-Is:0;return{[b]:w[b]+se,data:{[b]:ki,centerOffset:wt-ki-se,...ge&&{alignmentOffset:se}},reset:ge}}});var pm=function(l){return l===void 0&&(l={}),{name:"flip",options:l,async fn(t){var i,s;let{placement:r,middlewareData:a,rects:c,initialPlacement:d,platform:h,elements:g}=t,{mainAxis:m=!0,crossAxis:p=!0,fallbackPlacements:w,fallbackStrategy:b="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:A=!0,...N}=bs(l,t);if((i=a.arrow)!=null&&i.alignmentOffset)return{};let L=Je(r),O=bi(d),H=Je(d)===d,z=await(h.isRTL==null?void 0:h.isRTL(g.floating)),Y=w||(H||!A?[Or(d)]:dm(d)),Ai=y!=="none";!w&&Ai&&Y.push(...um(d,A,y,z));let Ze=[d,...Y],Ls=await Wd(t,N),Xe=[],$e=((s=a.flip)==null?void 0:s.overflows)||[];if(m&&Xe.push(Ls[L]),p){let wt=lm(r,c,z);Xe.push(Ls[wt[0]],Ls[wt[1]])}if($e=[...$e,{placement:r,overflows:Xe}],!Xe.every(wt=>wt<=0)){var Ps,Qe;let wt=(((Ps=a.flip)==null?void 0:Ps.index)||0)+1,ki=Ze[wt];if(ki)return{data:{index:wt,overflows:$e},reset:{placement:ki}};let ge=(Qe=$e.filter(se=>se.overflows[0]<=0).sort((se,Le)=>se.overflows[1]-Le.overflows[1])[0])==null?void 0:Qe.placement;if(!ge)switch(b){case"bestFit":{var Is;let se=(Is=$e.filter(Le=>{if(Ai){let Pe=bi(Le.placement);return Pe===O||Pe==="y"}return!0}).map(Le=>[Le.placement,Le.overflows.filter(Pe=>Pe>0).reduce((Pe,hp)=>Pe+hp,0)]).sort((Le,Pe)=>Le[1]-Pe[1])[0])==null?void 0:Is[0];se&&(ge=se);break}case"initialPlacement":ge=d;break}if(r!==ge)return{reset:{placement:ge}}}return{}}}};async function kp(l,t){let{placement:i,platform:s,elements:r}=l,a=await(s.isRTL==null?void 0:s.isRTL(r.floating)),c=Je(i),d=vs(i),h=bi(i)==="y",g=["left","top"].includes(c)?-1:1,m=a&&h?-1:1,p=bs(t,l),{mainAxis:w,crossAxis:b,alignmentAxis:y}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return d&&typeof y=="number"&&(b=d==="end"?y*-1:y),h?{x:b*m,y:w*g}:{x:w*g,y:b*m}}var fm=function(l){return l===void 0&&(l=0),{name:"offset",options:l,async fn(t){var i,s;let{x:r,y:a,placement:c,middlewareData:d}=t,h=await kp(t,l);return c===((i=d.offset)==null?void 0:i.placement)&&(s=d.arrow)!=null&&s.alignmentOffset?{}:{x:r+h.x,y:a+h.y,data:{...h,placement:c}}}}},ym=function(l){return l===void 0&&(l={}),{name:"shift",options:l,async fn(t){let{x:i,y:s,placement:r}=t,{mainAxis:a=!0,crossAxis:c=!1,limiter:d={fn:N=>{let{x:L,y:O}=N;return{x:L,y:O}}},...h}=bs(l,t),g={x:i,y:s},m=await Wd(t,h),p=bi(Je(r)),w=Bd(p),b=g[w],y=g[p];if(a){let N=w==="y"?"top":"left",L=w==="y"?"bottom":"right",O=b+m[N],H=b-m[L];b=rl(O,b,H)}if(c){let N=p==="y"?"top":"left",L=p==="y"?"bottom":"right",O=y+m[N],H=y-m[L];y=rl(O,y,H)}let A=d.fn({...t,[w]:b,[p]:y});return{...A,data:{x:A.x-i,y:A.y-s,enabled:{[w]:a,[p]:c}}}}}};function cl(){return typeof window<"u"}function wi(l){return vm(l)?(l.nodeName||"").toLowerCase():"#document"}function Pt(l){var t;return(l==null||(t=l.ownerDocument)==null?void 0:t.defaultView)||window}function he(l){var t;return(t=(vm(l)?l.ownerDocument:l.document)||window.document)==null?void 0:t.documentElement}function vm(l){return cl()?l instanceof Node||l instanceof Pt(l).Node:!1}function Vt(l){return cl()?l instanceof Element||l instanceof Pt(l).Element:!1}function ee(l){return cl()?l instanceof HTMLElement||l instanceof Pt(l).HTMLElement:!1}function bm(l){return!cl()||typeof ShadowRoot>"u"?!1:l instanceof ShadowRoot||l instanceof Pt(l).ShadowRoot}function ws(l){let{overflow:t,overflowX:i,overflowY:s,display:r}=Wt(l);return/auto|scroll|overlay|hidden|clip/.test(t+s+i)&&!["inline","contents"].includes(r)}function wm(l){return["table","td","th"].includes(wi(l))}function Rr(l){return[":popover-open",":modal"].some(t=>{try{return l.matches(t)}catch{return!1}})}function ll(l){let t=dl(),i=Vt(l)?Wt(l):l;return["transform","translate","scale","rotate","perspective"].some(s=>i[s]?i[s]!=="none":!1)||(i.containerType?i.containerType!=="normal":!1)||!t&&(i.backdropFilter?i.backdropFilter!=="none":!1)||!t&&(i.filter?i.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(s=>(i.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(i.contain||"").includes(s))}function Sm(l){let t=Te(l);for(;ee(t)&&!Si(t);){if(ll(t))return t;if(Rr(t))return null;t=Te(t)}return null}function dl(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Si(l){return["html","body","#document"].includes(wi(l))}function Wt(l){return Pt(l).getComputedStyle(l)}function zr(l){return Vt(l)?{scrollLeft:l.scrollLeft,scrollTop:l.scrollTop}:{scrollLeft:l.scrollX,scrollTop:l.scrollY}}function Te(l){if(wi(l)==="html")return l;let t=l.assignedSlot||l.parentNode||bm(l)&&l.host||he(l);return bm(t)?t.host:t}function xm(l){let t=Te(l);return Si(t)?l.ownerDocument?l.ownerDocument.body:l.body:ee(t)&&ws(t)?t:xm(t)}function al(l,t,i){var s;t===void 0&&(t=[]),i===void 0&&(i=!0);let r=xm(l),a=r===((s=l.ownerDocument)==null?void 0:s.body),c=Pt(r);if(a){let d=ul(c);return t.concat(c,c.visualViewport||[],ws(r)?r:[],d&&i?al(d):[])}return t.concat(r,al(r,[],i))}function ul(l){return l.parent&&Object.getPrototypeOf(l.parent)?l.frameElement:null}function Em(l){let t=Wt(l),i=parseFloat(t.width)||0,s=parseFloat(t.height)||0,r=ee(l),a=r?l.offsetWidth:i,c=r?l.offsetHeight:s,d=Ur(i)!==a||Ur(s)!==c;return d&&(i=a,s=c),{width:i,height:s,$:d}}function Am(l){return Vt(l)?l:l.contextElement}function Ss(l){let t=Am(l);if(!ee(t))return te(1);let i=t.getBoundingClientRect(),{width:s,height:r,$:a}=Em(t),c=(a?Ur(i.width):i.width)/s,d=(a?Ur(i.height):i.height)/r;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}var Tp=te(0);function km(l){let t=Pt(l);return!dl()||!t.visualViewport?Tp:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function $p(l,t,i){return t===void 0&&(t=!1),!i||t&&i!==Pt(l)?!1:t}function Dr(l,t,i,s){t===void 0&&(t=!1),i===void 0&&(i=!1);let r=l.getBoundingClientRect(),a=Am(l),c=te(1);t&&(s?Vt(s)&&(c=Ss(s)):c=Ss(l));let d=$p(a,i,s)?km(a):te(0),h=(r.left+d.x)/c.x,g=(r.top+d.y)/c.y,m=r.width/c.x,p=r.height/c.y;if(a){let w=Pt(a),b=s&&Vt(s)?Pt(s):s,y=w,A=ul(y);for(;A&&s&&b!==y;){let N=Ss(A),L=A.getBoundingClientRect(),O=Wt(A),H=L.left+(A.clientLeft+parseFloat(O.paddingLeft))*N.x,z=L.top+(A.clientTop+parseFloat(O.paddingTop))*N.y;h*=N.x,g*=N.y,m*=N.x,p*=N.y,h+=H,g+=z,y=Pt(A),A=ul(y)}}return vi({width:m,height:p,x:h,y:g})}function jd(l,t){let i=zr(l).scrollLeft;return t?t.left+i:Dr(he(l)).left+i}function Tm(l,t,i){i===void 0&&(i=!1);let s=l.getBoundingClientRect(),r=s.left+t.scrollLeft-(i?0:jd(l,s)),a=s.top+t.scrollTop;return{x:r,y:a}}function Lp(l){let{elements:t,rect:i,offsetParent:s,strategy:r}=l,a=r==="fixed",c=he(s),d=t?Rr(t.floating):!1;if(s===c||d&&a)return i;let h={scrollLeft:0,scrollTop:0},g=te(1),m=te(0),p=ee(s);if((p||!p&&!a)&&((wi(s)!=="body"||ws(c))&&(h=zr(s)),ee(s))){let b=Dr(s);g=Ss(s),m.x=b.x+s.clientLeft,m.y=b.y+s.clientTop}let w=c&&!p&&!a?Tm(c,h,!0):te(0);return{width:i.width*g.x,height:i.height*g.y,x:i.x*g.x-h.scrollLeft*g.x+m.x+w.x,y:i.y*g.y-h.scrollTop*g.y+m.y+w.y}}function Pp(l){return Array.from(l.getClientRects())}function Ip(l){let t=he(l),i=zr(l),s=l.ownerDocument.body,r=Ye(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),a=Ye(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight),c=-i.scrollLeft+jd(l),d=-i.scrollTop;return Wt(s).direction==="rtl"&&(c+=Ye(t.clientWidth,s.clientWidth)-r),{width:r,height:a,x:c,y:d}}function qp(l,t){let i=Pt(l),s=he(l),r=i.visualViewport,a=s.clientWidth,c=s.clientHeight,d=0,h=0;if(r){a=r.width,c=r.height;let g=dl();(!g||g&&t==="fixed")&&(d=r.offsetLeft,h=r.offsetTop)}return{width:a,height:c,x:d,y:h}}function Fp(l,t){let i=Dr(l,!0,t==="fixed"),s=i.top+l.clientTop,r=i.left+l.clientLeft,a=ee(l)?Ss(l):te(1),c=l.clientWidth*a.x,d=l.clientHeight*a.y,h=r*a.x,g=s*a.y;return{width:c,height:d,x:h,y:g}}function Cm(l,t,i){let s;if(t==="viewport")s=qp(l,i);else if(t==="document")s=Ip(he(l));else if(Vt(t))s=Fp(t,i);else{let r=km(l);s={x:t.x-r.x,y:t.y-r.y,width:t.width,height:t.height}}return vi(s)}function $m(l,t){let i=Te(l);return i===t||!Vt(i)||Si(i)?!1:Wt(i).position==="fixed"||$m(i,t)}function Mp(l,t){let i=t.get(l);if(i)return i;let s=al(l,[],!1).filter(d=>Vt(d)&&wi(d)!=="body"),r=null,a=Wt(l).position==="fixed",c=a?Te(l):l;for(;Vt(c)&&!Si(c);){let d=Wt(c),h=ll(c);!h&&d.position==="fixed"&&(r=null),(a?!h&&!r:!h&&d.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||ws(c)&&!h&&$m(l,c))?s=s.filter(m=>m!==c):r=d,c=Te(c)}return t.set(l,s),s}function Np(l){let{element:t,boundary:i,rootBoundary:s,strategy:r}=l,c=[...i==="clippingAncestors"?Rr(t)?[]:Mp(t,this._c):[].concat(i),s],d=c[0],h=c.reduce((g,m)=>{let p=Cm(t,m,r);return g.top=Ye(p.top,g.top),g.right=yi(p.right,g.right),g.bottom=yi(p.bottom,g.bottom),g.left=Ye(p.left,g.left),g},Cm(t,d,r));return{width:h.right-h.left,height:h.bottom-h.top,x:h.left,y:h.top}}function Op(l){let{width:t,height:i}=Em(l);return{width:t,height:i}}function Up(l,t,i){let s=ee(t),r=he(t),a=i==="fixed",c=Dr(l,!0,a,t),d={scrollLeft:0,scrollTop:0},h=te(0);if(s||!s&&!a)if((wi(t)!=="body"||ws(r))&&(d=zr(t)),s){let w=Dr(t,!0,a,t);h.x=w.x+t.clientLeft,h.y=w.y+t.clientTop}else r&&(h.x=jd(r));let g=r&&!s&&!a?Tm(r,d):te(0),m=c.left+d.scrollLeft-h.x-g.x,p=c.top+d.scrollTop-h.y-g.y;return{x:m,y:p,width:c.width,height:c.height}}function Hd(l){return Wt(l).position==="static"}function _m(l,t){if(!ee(l)||Wt(l).position==="fixed")return null;if(t)return t(l);let i=l.offsetParent;return he(l)===i&&(i=i.ownerDocument.body),i}function Lm(l,t){let i=Pt(l);if(Rr(l))return i;if(!ee(l)){let r=Te(l);for(;r&&!Si(r);){if(Vt(r)&&!Hd(r))return r;r=Te(r)}return i}let s=_m(l,t);for(;s&&wm(s)&&Hd(s);)s=_m(s,t);return s&&Si(s)&&Hd(s)&&!ll(s)?i:s||Sm(l)||i}var Rp=async function(l){let t=this.getOffsetParent||Lm,i=this.getDimensions,s=await i(l.floating);return{reference:Up(l.reference,await t(l.floating),l.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function zp(l){return Wt(l).direction==="rtl"}var Dp={convertOffsetParentRelativeRectToViewportRelativeRect:Lp,getDocumentElement:he,getClippingRect:Np,getOffsetParent:Lm,getElementRects:Rp,getClientRects:Pp,getDimensions:Op,getScale:Ss,isElement:Vt,isRTL:zp};var Pm=fm;var Im=ym,qm=pm;var Fm=mm;var Mm=(l,t,i)=>{let s=new Map,r={platform:Dp,...i},a={...r.platform,_c:s};return gm(l,t,{...r,platform:a})};var ml,xi,It,xs,Br,Cs,_s,Vr,Es,pl,Nm,fl,Om,yl,Um,Wr,Gd,As,hl,gl=class{constructor(t){o(this,pl);o(this,fl);o(this,yl);o(this,Wr);o(this,As);o(this,ml,void 0);o(this,xi,void 0);o(this,It,void 0);o(this,xs,void 0);o(this,Br,void 0);o(this,Cs,null);o(this,_s,null);o(this,Vr,null);o(this,Es,!1);u(this,ml,t),u(this,xi,t.logger.createModuleLogger("TOOLTIP")),n(this,pl,Nm).call(this),e(this,xi).info("TooltipManager initialized")}};ml=new WeakMap,xi=new WeakMap,It=new WeakMap,xs=new WeakMap,Br=new WeakMap,Cs=new WeakMap,_s=new WeakMap,Vr=new WeakMap,Es=new WeakMap,pl=new WeakSet,Nm=function(){e(this,Es)||(u(this,It,n(this,fl,Om).call(this)),u(this,xs,e(this,It).querySelector("#checkout-tooltip-arrow")),u(this,Br,e(this,It).querySelector("#checkout-tooltip-text")),n(this,yl,Um).call(this),u(this,Es,!0),e(this,xi).info("Tooltip system initialized with floating-ui"))},fl=new WeakSet,Om=function(){let t=document.getElementById("checkout-tooltip");if(t)return t;let i=document.createElement("div");i.setAttribute("role","tooltip"),i.id="checkout-tooltip",i.style.display="none";let s=document.createElement("div");s.id="checkout-tooltip-text",i.appendChild(s);let r=document.createElement("div");return r.id="checkout-tooltip-arrow",i.appendChild(r),document.body.appendChild(i),i},yl=new WeakSet,Um=function(){document.addEventListener("mouseover",t=>{let i=t.target.closest("[data-os-tooltip]");i&&(clearTimeout(e(this,_s)),u(this,_s,setTimeout(()=>{n(this,Wr,Gd).call(this,i)},200)))}),document.addEventListener("mouseout",t=>{t.target.closest("[data-os-tooltip]")&&(clearTimeout(e(this,_s)),n(this,As,hl).call(this))}),document.addEventListener("focus",t=>{let i=t.target.closest("[data-os-tooltip]");i&&n(this,Wr,Gd).call(this,i)},!0),document.addEventListener("blur",t=>{t.target.closest("[data-os-tooltip]")&&n(this,As,hl).call(this)},!0),document.addEventListener("keydown",t=>{t.key==="Escape"&&e(this,Cs)&&n(this,As,hl).call(this)})},Wr=new WeakSet,Gd=function(t){if(!e(this,Es)){e(this,xi).warn("Cannot show tooltip: system not initialized");return}clearTimeout(e(this,Vr)),u(this,Cs,t);let i=t.getAttribute("data-os-tooltip"),s=t.getAttribute("data-os-tooltip-position")||"top";e(this,Br).textContent=i,e(this,It).style.display="block",Mm(t,e(this,It),{placement:s,middleware:[Pm(8),qm({fallbackPlacements:["top","right","bottom","left"]}),Im({padding:5}),Fm({element:e(this,xs)})]}).then(({x:r,y:a,placement:c,middlewareData:d})=>{Object.assign(e(this,It).style,{left:`${r}px`,top:`${a}px`});let{x:h,y:g}=d.arrow,m={top:"bottom",right:"left",bottom:"top",left:"right"}[c.split("-")[0]];Object.assign(e(this,xs).style,{left:h!=null?`${h}px`:"",top:g!=null?`${g}px`:"",right:"",bottom:"",[m]:"-4px"}),requestAnimationFrame(()=>{e(this,It).classList.add("checkout-tooltip-visible")})})},As=new WeakSet,hl=function(){e(this,It)&&(e(this,It).classList.remove("checkout-tooltip-visible"),u(this,Vr,setTimeout(()=>{e(this,It).classList.contains("checkout-tooltip-visible")||(e(this,It).style.display="none"),u(this,Cs,null)},200)))};var bl,it,jr,Gr,Ht,ie,vl,Rm,wl,zm,Sl,Dm,xl,Bm,Kr,Kd,Cl,Vm,Yr,Yd,_l,Wm,Hr=class{constructor(t){o(this,vl);o(this,wl);o(this,Sl);o(this,xl);o(this,Kr);o(this,Cl);o(this,Yr);o(this,_l);o(this,bl,void 0);o(this,it,void 0);o(this,jr,void 0);o(this,Gr,void 0);o(this,Ht,{});o(this,ie,null);u(this,bl,t),u(this,it,t.logger.createModuleLogger("UPSELL")),u(this,jr,t.state),u(this,Gr,t.api),n(this,vl,Rm).call(this),e(this,it).info("UpsellManager initialized")}async acceptUpsell(t,i=1,s){if(!e(this,ie)){e(this,it).error("Cannot accept upsell: No order reference ID found");return}e(this,it).info(`Accepting upsell: Package ${t}, Quantity ${i}`),n(this,Kr,Kd).call(this);try{document.body.classList.add("os-loading");let r={lines:[{package_id:Number(t),quantity:Number(i),is_upsell:!0}]},a=await e(this,Gr).createOrderUpsell(e(this,ie),r);e(this,it).info("Upsell successfully added to order",a),n(this,Yr,Yd).call(this,s)}catch(r){e(this,it).error("Error accepting upsell:",r),document.body.classList.remove("os-loading"),n(this,Cl,Vm).call(this),n(this,_l,Wm).call(this,"There was an error processing your upsell. Please try again.")}}declineUpsell(t){e(this,it).info("Declining upsell offer"),n(this,Kr,Kd).call(this),n(this,Yr,Yd).call(this,t)}};bl=new WeakMap,it=new WeakMap,jr=new WeakMap,Gr=new WeakMap,Ht=new WeakMap,ie=new WeakMap,vl=new WeakSet,Rm=function(){u(this,ie,n(this,wl,zm).call(this)),e(this,ie)?(e(this,it).info(`Order reference ID found: ${e(this,ie)}`),e(this,jr).setState("order.ref_id",e(this,ie))):e(this,it).warn("No order reference ID found, upsell functionality will be limited"),n(this,Sl,Dm).call(this),n(this,xl,Bm).call(this)},wl=new WeakSet,zm=function(){let i=new URLSearchParams(window.location.search).get("ref_id");return i?(e(this,it).debug("Getting order ref_id from URL parameters:",i),sessionStorage.setItem("order_ref_id",i)):(i=sessionStorage.getItem("order_ref_id"),e(this,it).debug("Getting order ref_id from sessionStorage:",i)),i},Sl=new WeakSet,Dm=function(){u(this,Ht,{acceptButtons:document.querySelectorAll('[data-os-upsell="accept"]'),declineButtons:document.querySelectorAll('[data-os-upsell="decline"]')}),e(this,it).debug(`Found ${e(this,Ht).acceptButtons.length} accept buttons and ${e(this,Ht).declineButtons.length} decline buttons`)},xl=new WeakSet,Bm=function(){e(this,Ht).acceptButtons.forEach(t=>{t.addEventListener("click",i=>{i.preventDefault();let s=t.getAttribute("data-os-package-id"),r=parseInt(t.getAttribute("data-os-quantity")||"1",10),a=t.getAttribute("data-os-next-url");if(!s){e(this,it).error("No package ID specified for upsell accept button");return}this.acceptUpsell(s,r,a)})}),e(this,Ht).declineButtons.forEach(t=>{t.addEventListener("click",i=>{i.preventDefault();let s=t.getAttribute("data-os-next-url");s?this.declineUpsell(s):e(this,it).error("No next URL specified for upsell decline button")})})},Kr=new WeakSet,Kd=function(){e(this,it).debug("Disabling upsell buttons"),e(this,Ht).acceptButtons.forEach(t=>{t.style.pointerEvents="none",t.classList.add("os-button-disabled")}),e(this,Ht).declineButtons.forEach(t=>{t.style.pointerEvents="none",t.classList.add("os-button-disabled")})},Cl=new WeakSet,Vm=function(){e(this,it).debug("Re-enabling upsell buttons"),e(this,Ht).acceptButtons.forEach(t=>{t.style.pointerEvents="",t.classList.remove("os-button-disabled")}),e(this,Ht).declineButtons.forEach(t=>{t.style.pointerEvents="",t.classList.remove("os-button-disabled")})},Yr=new WeakSet,Yd=function(t){if(!t){e(this,it).warn("No URL provided for redirect");return}let i=new URL(t,window.location.origin);e(this,ie)&&!i.searchParams.has("ref_id")&&i.searchParams.append("ref_id",e(this,ie)),e(this,it).info(`Redirecting to ${i.href}`),window.location.href=i.href},_l=new WeakSet,Wm=function(t){let i=document.querySelector("[data-os-error-container]");i?(i.textContent=t,i.style.display="block"):alert(t)};var Jd=class{constructor(){this.cleanupInitialState(),this.init()}cleanupInitialState(){document.querySelectorAll('[pb-component="accordion"]').forEach(t=>{let i=t.querySelector('[pb-accordion-element="group"]');if(!i)return;let s=i.querySelectorAll('[pb-accordion-element="accordion"]');s.forEach(a=>{let c=a.querySelector('[pb-accordion-element="content"]'),d=a.querySelector('[pb-accordion-element="trigger"]'),h=a.querySelector('[pb-accordion-element="arrow"]'),g=a.querySelector('[pb-accordion-element="plus"]');c&&(c.style.maxHeight="0",c.style.opacity="0",c.style.visibility="hidden",c.style.display="none"),d&&d.setAttribute("aria-expanded","false"),a.classList.remove("is-active-accordion"),c?.classList.remove("is-active-accordion"),h&&h.classList.remove("is-active-accordion"),g&&g.classList.remove("is-active-accordion")});let r=i.getAttribute("pb-accordion-initial");if(r&&r!=="none"){let a=s[parseInt(r)-1];a&&this.openAccordion(a)}})}init(){document.querySelectorAll('[pb-component="accordion"]').forEach(t=>{let i=t.querySelector('[pb-accordion-element="group"]');i&&i.addEventListener("click",s=>this.handleClick(s,i))})}handleClick(t,i){let s=t.target.closest('[pb-accordion-element="accordion"]');if(!s)return;let r=s.classList.contains("is-active-accordion");i.getAttribute("pb-accordion-single")==="true"&&i.querySelectorAll('[pb-accordion-element="accordion"]').forEach(c=>{c!==s&&c.classList.contains("is-active-accordion")&&this.closeAccordion(c)}),r?this.closeAccordion(s):this.openAccordion(s)}openAccordion(t){let i=t.querySelector('[pb-accordion-element="trigger"]'),s=t.querySelector('[pb-accordion-element="content"]'),r=t.querySelector('[pb-accordion-element="arrow"]'),a=t.querySelector('[pb-accordion-element="plus"]');s.style.visibility="visible",s.style.display="block",s.offsetHeight;let c=s.scrollHeight;requestAnimationFrame(()=>{s.style.maxHeight=`${c}px`,s.style.opacity="1",i.setAttribute("aria-expanded","true"),t.classList.add("is-active-accordion"),s.classList.add("is-active-accordion"),r&&r.classList.add("is-active-accordion"),a&&a.classList.add("is-active-accordion")}),s.addEventListener("transitionend",()=>{t.classList.contains("is-active-accordion")&&(s.style.maxHeight="none")},{once:!0})}closeAccordion(t){let i=t.querySelector('[pb-accordion-element="trigger"]'),s=t.querySelector('[pb-accordion-element="content"]'),r=t.querySelector('[pb-accordion-element="arrow"]'),a=t.querySelector('[pb-accordion-element="plus"]');s.style.maxHeight=`${s.scrollHeight}px`,s.style.display="block",s.offsetHeight,requestAnimationFrame(()=>{s.style.maxHeight="0",s.style.opacity="0",i.setAttribute("aria-expanded","false"),t.classList.remove("is-active-accordion"),s.classList.remove("is-active-accordion"),r&&r.classList.remove("is-active-accordion"),a&&a.classList.remove("is-active-accordion")}),s.addEventListener("transitionend",()=>{t.classList.contains("is-active-accordion")||(s.style.visibility="hidden",s.style.display="none")},{once:!0})}},Hm=()=>document.querySelector('[pb-component="accordion"]')?new Jd:null;var Zd=class{constructor(){this.config={enabled:!0,applyToExternalLinks:!1,excludedDomains:[],paramsToCopy:[]},this.loadConfig()}loadConfig(){window.osConfig&&window.osConfig.utmTransfer&&(this.config={...this.config,...window.osConfig.utmTransfer}),(this.config.paramsToCopy===null||this.config.paramsToCopy===void 0)&&(this.config.paramsToCopy=[]),JSON.stringify(this.config)}init(){if(!this.config.enabled)return;let t=new URLSearchParams(window.location.search);if(t.toString()==="")return;let i=[];t.forEach((a,c)=>{i.push(`${c}=${a}`)}),`${i.join(", ")}`;let s=t;if(Array.isArray(this.config.paramsToCopy)&&this.config.paramsToCopy.length>0&&(`${this.config.paramsToCopy.join(", ")}`,s=new URLSearchParams,this.config.paramsToCopy.forEach(a=>{t.has(a)&&(s.append(a,t.get(a)),`${a}${t.get(a)}`)}),s.toString()===""))return;let r=document.querySelectorAll("a");`${r.length}`,r.forEach(a=>{a.addEventListener("click",c=>{this.applyParamsToLink(a,s)})})}applyParamsToLink(t,i=null){if(!t||!t.getAttribute){console.error("UTM Transfer: Invalid link element provided");return}let s=t.getAttribute("href");if(!s||s.startsWith("#")||s.startsWith("javascript:")||s.startsWith("mailto:")||s.startsWith("tel:"))return;if(s.includes("://")&&!s.includes(window.location.hostname)){if(!this.config.applyToExternalLinks)return;if(this.config.excludedDomains&&this.config.excludedDomains.length>0){for(let h of this.config.excludedDomains)if(s.includes(h))return}}let a=i||new URLSearchParams(window.location.search);if(a.toString()==="")return;let c;try{c=new URL(s,window.location.origin)}catch{console.error("UTM Transfer: Invalid URL:",s);return}let d=new URLSearchParams(c.search);a.forEach((h,g)=>{d.has(g)||d.append(g,h)}),c.search=d.toString(),t.setAttribute("href",c.toString()),this.config.debug&&`${s}${c.toString()}`}},jm=()=>{let l=new Zd;return l.init(),l};var $s,Ei,st,Il,Qm,ql,tp,Fl,ep,Ml,ip,Nl,sp,Ol,rp,Ul,np,Rl,op,zl,ap,Dl,cp,Bl,lp,Vl,dp,nn=class{constructor(t={}){o(this,Il);o(this,ql);o(this,Fl);o(this,Ml);o(this,Nl);o(this,Ol);o(this,Ul);o(this,Rl);o(this,zl);o(this,Dl);o(this,Bl);o(this,Vl);o(this,$s,!1);o(this,Ei,!1);o(this,st,null);let i=window.osConfig?.googleMaps||{};this.options={debug:!1,autoInit:!0,googleMapsApiKey:i.apiKey||"YOUR_API_KEY_HERE",googleMapsRegion:i.region||"US",enableGoogleMapsAutocomplete:i.enableAutocomplete!==!1,...t},this.logger=new cn(this.options.debug),this.coreLogger=this.logger.createModuleLogger("CORE"),this.api=new on(this),this.config=n(this,Il,Qm).call(this),this.state=new Oa(this),this.attribution=new Oc(this),this.cart=new Ba(this),this.campaign=new Na(this),this.upsell=new Hr(this),this.events={on:(s,r)=>this.on(s,r),once:(s,r)=>this.once(s,r),off:(s,r)=>this.off(s,r),trigger:(s,r)=>this.triggerEvent(s,r)},this.options.autoInit&&this.init()}on(t,i){let s=r=>{try{i(r.detail)}catch(a){this.coreLogger.error(`Error in event callback for "${t}":`,a)}};return document.addEventListener(`os:${t}`,s),this.coreLogger.debug(`Event listener registered for "${t}"`),this}once(t,i){let s=r=>{try{i(r.detail)}catch(a){this.coreLogger.error(`Error in one-time event callback for "${t}":`,a)}document.removeEventListener(`os:${t}`,s)};return document.addEventListener(`os:${t}`,s),this.coreLogger.debug(`One-time event listener registered for "${t}"`),this}off(t,i){return document.removeEventListener(`os:${t}`,i),this}async init(){this.coreLogger.info("Initializing 29next client"),this.api.init(),typeof window.on29NextReady<"u"&&!Array.isArray(window.on29NextReady)&&(this.coreLogger.warn("window.on29NextReady is not an array, resetting it"),window.on29NextReady=[]),await n(this,Ml,ip).call(this),await n(this,Fl,ep).call(this),u(this,Ei,n(this,Rl,op).call(this)),e(this,Ei)&&n(this,zl,ap).call(this),n(this,Nl,sp).call(this),n(this,Vl,dp).call(this),u(this,$s,!0),this.triggerEvent("initialized",{client:this}),await n(this,Ol,rp).call(this)}triggerEvent(t,i={}){this.coreLogger.debug(`Triggering event: ${t}`);let s={...i,timestamp:Date.now(),client:this},r=new CustomEvent(`os:${t}`,{bubbles:!0,cancelable:!0,detail:s});return document.dispatchEvent(r),r}getCampaignData(){return e(this,st)}get isInitialized(){return e(this,$s)}get isCheckoutPage(){return e(this,Ei)}debugTriggerViewItemList(){return e(this,st)?this.events.viewItemList?(window.dataLayer=window.dataLayer||[],window.dataLayer.push({ecommerce:null}),this.events.viewItemList(e(this,st)),{success:!0,message:"view_item_list event triggered",campaignData:e(this,st)}):(console.error("âŒ events.viewItemList not available"),{success:!1,message:"Event manager not initialized"}):(console.error("âŒ No campaign data available"),{success:!1,message:"No campaign data"})}isReady(){return e(this,$s)&&e(this,st)!==null&&Array.isArray(e(this,st).packages)}onReady(t){if(!t||typeof t!="function")return this;if(this.isReady())try{t(this)}catch(i){this.coreLogger.error("Error in onReady callback:",i)}else this.once("initialized",()=>{this.isReady()&&t(this)});return this}};$s=new WeakMap,Ei=new WeakMap,st=new WeakMap,Il=new WeakSet,Qm=function(){let t={apiKey:null,campaignId:null,debug:this.options.debug},i=document.querySelector('meta[name="os-api-key"]');t.apiKey=i?.getAttribute("content")??null,this.coreLogger.info(`API key: ${t.apiKey?"âœ“ Set":"âœ— Not set"}`);let s=document.querySelector('meta[name="os-campaign-id"]');return t.campaignId=s?.getAttribute("content")??null,this.coreLogger.info(`Campaign ID: ${t.campaignId?"âœ“ Set":"âœ— Not set"}`),document.querySelector('meta[name="os-debug"]')?.getAttribute("content")==="true"&&(t.debug=!0,this.logger.setDebug(!0),this.coreLogger.info("Debug mode: âœ“ Enabled")),n(this,ql,tp).call(this),t},ql=new WeakSet,tp=function(){window.osConfig=window.osConfig||{},window.osConfig.spreedlyConfig?this.coreLogger.info("Found custom Spreedly configuration"):(this.coreLogger.debug("Initializing default Spreedly configuration"),window.osConfig.spreedlyConfig={fieldType:{number:"text",cvv:"text"},numberFormat:"prettyFormat",placeholder:{number:"Credit Card Number",cvv:"CVV *"},labels:{number:"Card Number",cvv:"CVV"}})},Fl=new WeakSet,ep=async function(){if(!this.options.enableGoogleMapsAutocomplete){this.coreLogger.debug("Google Maps Autocomplete is disabled in configuration");return}if(typeof google<"u"&&typeof google.maps<"u"){this.coreLogger.debug("Google Maps API already loaded");return}return this.coreLogger.debug("Loading Google Maps API..."),new Promise(t=>{let i=document.createElement("script"),s=this.options.googleMapsRegion?`&region=${this.options.googleMapsRegion}`:"";i.src=`https://maps.googleapis.com/maps/api/js?key=${this.options.googleMapsApiKey}&libraries=places${s}`,i.async=!0,i.defer=!0,i.onload=()=>{this.coreLogger.debug("Google Maps API loaded successfully"),t()},i.onerror=()=>{this.coreLogger.error("Failed to load Google Maps API"),t()},document.head.appendChild(i)})},Ml=new WeakSet,ip=async function(){try{this.coreLogger.info("Fetching campaign data..."),u(this,st,await this.api.getCampaign()),u(this,st,e(this,st)||{packages:[]}),e(this,st).packages=e(this,st).packages||[],this.campaignData=e(this,st),this.coreLogger.info("Campaign data retrieved successfully"),window.osConfig=window.osConfig||{},window.osConfig.campaign=e(this,st),window.dataLayer=window.dataLayer||[],this.triggerEvent("campaign.loaded",{campaign:e(this,st)})}catch(t){this.coreLogger.error("Failed to retrieve campaign data:",t),u(this,st,{name:"Default Campaign",packages:[],currency:"USD",locale:"en-US"}),this.campaignData=e(this,st)}},Nl=new WeakSet,sp=function(){this.selector=new ja(this),this.toggle=new ec(this),this.timer=new fc(this),this.display=new xc(this),this.eventManager=new Kc(this),this.tooltip=new gl(this),(e(this,Ei)||document.querySelector('[data-os-cart="line-display"]')||document.querySelector('[os-cart="checkout-summary"]')||document.querySelector('[data-os-cart-summary="grand-total"]'))&&(this.coreLogger.info("Cart display elements detected, initializing CartDisplayManager"),this.cartDisplay=new Ec(this)),this.debug=new hc(this),Object.assign(this.events,{emit:(t,i)=>this.triggerEvent(t,i),viewItemList:t=>this.eventManager.viewItemList(t||e(this,st)),viewItem:t=>this.eventManager.viewItem(t),addToCart:t=>this.eventManager.addToCart(t),beginCheckout:()=>this.eventManager.beginCheckout(),purchase:(t,i)=>this.eventManager.purchase(t,i),fireCustomEvent:(t,i)=>this.eventManager.fireCustomEvent(t,i)})},Ol=new WeakSet,rp=async function(){this.events.viewItemList(e(this,st)),await new Promise(t=>setTimeout(t,800)),n(this,Ul,np).call(this)},Ul=new WeakSet,np=function(){let t=document.querySelector('div[os-element="preloader"]');t&&(this.coreLogger.info("Hiding preloader element"),t.style.transition="opacity 0.5s ease",t.style.opacity="0",t.style.pointerEvents="none",this.coreLogger.debug("Preloader hidden"))},Rl=new WeakSet,op=function(){let i=document.querySelector('meta[name="os-page-type"]')?.getAttribute("content");return i==="checkout"||!i&&document.querySelector('form[os-checkout="form"]')?(this.coreLogger.info("Checkout page detected"),!0):(i==="receipt"&&(this.coreLogger.info("Receipt page detected"),n(this,Dl,cp).call(this)),(i==="upsell"||document.querySelector("[data-os-upsell]"))&&(this.coreLogger.info("Upsell page detected"),n(this,Bl,lp).call(this)),!1)},zl=new WeakSet,ap=function(){this.checkout=new va(this.api,this.coreLogger,this)},Dl=new WeakSet,cp=function(){Promise.resolve().then(()=>(Xm(),Zm)).then(t=>{let i=t.ReceiptPage;this.receipt=new i(this.api,this.coreLogger,this),this.coreLogger.info("Receipt page initialized");let s=new URLSearchParams(window.location.search).get("ref_id");s&&this.api.getOrder(s).then(r=>{r&&this.triggerEvent("order.loaded",{order:r})}).catch(r=>this.coreLogger.error("Failed to load order data:",r))}).catch(t=>this.coreLogger.error("Failed to load ReceiptPage module:",t))},Bl=new WeakSet,lp=function(){this.coreLogger.info("Initializing upsell page"),this.upsell||(this.upsell=new Hr(this),this.coreLogger.info("UpsellManager initialized for upsell page")),this.triggerEvent("upsell.pageview",{ref_id:new URLSearchParams(window.location.search).get("ref_id")||sessionStorage.getItem("order_ref_id")})},Vl=new WeakSet,dp=function(){this.coreLogger.info("Initializing UI utilities");try{let t=Hm();t&&(this.pbAccordion=t,this.coreLogger.info("PBAccordion initialized"))}catch(t){this.coreLogger.error("Failed to initialize PBAccordion:",t)}try{let t=jm();t&&(this.utmTransfer=t,this.coreLogger.info("UTM parameter transfer initialized"))}catch(t){this.coreLogger.error("Failed to initialize UTM transfer:",t)}};var up=()=>{try{if(document.querySelector('meta[name="os-disable-auto-init"]'))return;let l={apiKey:document.querySelector('meta[name="os-api-key"]')?.getAttribute("content")??null,campaignId:document.querySelector('meta[name="os-campaign-id"]')?.getAttribute("content")??null,debug:document.querySelector('meta[name="os-debug"]')?.getAttribute("content")==="true",paypalClientId:document.querySelector('meta[name="os-paypal-client-id"]')?.getAttribute("content")??null};JSON.stringify({apiKey:l.apiKey?"âœ“ Set":"âœ— Not set",campaignId:l.campaignId?"âœ“ Set":"âœ— Not set",debug:l.debug}),window.on29NextReady=Array.isArray(window.on29NextReady)?window.on29NextReady:[];let t=[...window.on29NextReady];window.twentyNineNext=new nn(l),t.forEach(i=>{window.twentyNineNext.onReady(i)}),window.on29NextReady={push:i=>window.twentyNineNext.onReady(i)}}catch(l){console.error("29next Client: Error during initialization",l)}};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",up):up();return bp(Bp);})();
//# sourceMappingURL=29next.min.js.map
